{"version":3,"sources":["vs/code/electron-browser/issue/fake","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/iframe.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/assert.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/collections.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/color.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/decorators.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/errors.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/arrays.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/functional.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/iterator.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/json.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/jsonFormatter.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/jsonEdit.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/keyCodes.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/lifecycle.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/linkedList.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/event.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/browser.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/event.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/cancellation.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/async.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/network.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/platform.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/keyboardEvent.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/mouseEvent.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/dom.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/touch.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/process.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/path.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/strings.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/date.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/extpath.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/types.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/objects.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/uri.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/amd.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/map.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/glob.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/normalization.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/resources.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/labels.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/common/uuid.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/flow.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/paths.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/stream.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/encoding.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/extfs.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/node/pfs.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/parts/ipc/node/ipc.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/parts/ipc/node/ipc.electron.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/parts/ipc/electron-browser/ipc.electron-browser.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/parts/ipc/node/ipc.net.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/code/electron-browser/issue/issueReporterModel.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/code/electron-browser/issue/issueReporterUtil.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/ui/button/button.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/base/browser/ui/octiconLabel/octiconLabel.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/code/electron-browser/issue/issueReporterPage.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/instantiation/common/descriptors.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/instantiation/common/graph.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/instantiation/common/instantiation.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/history/common/history.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/instantiation/common/serviceCollection.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/instantiation/common/instantiationService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/ipc/electron-browser/mainProcessService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/log/common/log.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/log/node/logIpc.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/log/node/spdlogService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/product/node/package.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/product/node/product.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/environment/node/environmentService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/registry/common/platform.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/jsonschemas/common/jsonContributionRegistry.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/configuration/common/configurationRegistry.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/configuration/common/configuration.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/telemetry/common/telemetryService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/telemetry/common/telemetryUtils.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/telemetry/node/commonProperties.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/telemetry/node/telemetryIpc.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/windows/common/windows.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/workspaces/common/workspaces.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/platform/windows/electron-browser/windowsService.ts","vs/code/electron-browser/issue/file:/Users/zhengfankai/Desktop/workspace/vs-editor/src/vs/code/electron-browser/issue/issueReporterMain.ts"],"names":["__m","__M","deps","result","i","len","length","getParentWindowIfSameOrigin","w","parent","location","parentLocation","protocol","hostname","port","hasDifferentOriginAncestorFlag","e","findIframeElementInParentWindow","parentWindow","childWindow","iframe","parentWindowIframes","document","getElementsByTagName","contentWindow","sameOriginWindowChainCache","IframeUtils","[object Object]","window","push","iframeElement","slice","this","getSameOriginWindowChain","ancestorWindow","top","left","windowChain","windowChainEl","boundingRect","getBoundingClientRect","exports","ok","value","message","Error","hasOwnProperty","Object","prototype","values","from","key","call","size","count","first","forEach","callback","groupBy","data","groupFn","create","element","target","fromMap","original","roundFloat","number","decimalPoints","decimal","Math","pow","round","RGBA","r","g","b","a","min","max","HSLA","h","s","l","rgba","chroma","p","q","t","hsla","_hue2rgb","HSVA","v","cmax","delta","m","hsva","c","x","abs","Color","arg","_hsla","toRGBA","_hsva","hex","Format","CSS","parseHex","red","fromRGBA","other","equals","_relativeLuminanceForComponent","color","another","lum1","getRelativeLuminance","lum2","factor","thisA","colorA","transparent","backgrounds","background","reduceRight","accumulator","_flatten","foreground","backgroundAlpha","format","of","relative","isLighterThan","lighten","isDarkerThan","darken","white","black","blue","green","cyan","lightgrey","_toTwoDigitHex","n","toString","_parseHexDigit","charCode","formatRGB","formatRGBA","toFixed","formatHSL","formatHSLA","formatHex","formatHexA","compact","isOpaque","charCodeAt","createDecorator","mapFn","descriptor","fnKey","fn","get","memoize","console","warn","memoizeKey","args","defineProperty","configurable","enumerable","writable","apply","debounce","delay","reducer","initialValueProvider","timerKey","resultKey","undefined","clearTimeout","setTimeout","isPromiseCanceledError","error","name","canceledName","ErrorHandler","listeners","unexpectedErrorHandler","stack","listener","_removeListener","splice","indexOf","newUnexpectedErrorHandler","emit","errorHandler","setUnexpectedErrorHandler","onUnexpectedError","onUnexpectedExternalError","transformErrorForSerialization","$isError","stacktrace","canceled","illegalArgument","illegalState","readonly","disposed","what","getErrorMessage","err","split","String","findFirstInSorted","array","low","high","mid","floor","mergeSort","compare","_sort","lo","hi","aux","leftIdx","rightIdx","_merge","sortedDiff","before","after","pushSplice","start","deleteCount","toInsert","latest","beforeIdx","afterIdx","beforeElement","afterElement","topStep","pop","j","firstIndex","tail","tail2","arr","one","itemEquals","binarySearch","comparator","comp","currentGroup","splices","removed","added","sort","topAsync","batch","token","Promise","resolve","reject","__awaiter","o","isCancellationRequested","errors_1","then","coalesce","filter","coalesceInPlace","to","move","isFalsyOrEmpty","obj","Array","isArray","isNonEmptyArray","distinct","keyFn","position","seen","elem","uniqueFilter","notFoundValue","index","commonPrefixLength","flatten","concat","range","fill","num","indexer","merger","reduce","insert","arrayInsert","insertIndex","insertArr","shuffle","_seed","rand","seed","sin","random","temp","pushToStart","unshift","pushToEnd","find","predicate","mapArrayOrNot","items","map","once","_this","didCall","arguments","FIN","done","Iterator","iterator","next","_empty","empty","fromArray","elements","collect","getSequenceIterator","ArrayIterator","end","current","ArrayNavigator","super","MappedIterator","MappedNavigator","navigator","previous","last","createScanner","text","ignoreTrivia","scanHexDigits","digits","ch","pos","scanNext","scanError","tokenOffset","code","isWhiteSpace","fromCharCode","isLineBreak","substring","scanString","safeLength","commentClosed","isDigit","scanNumber","isUnknownContentCharacter","setPosition","newPosition","getPosition","scan","getToken","getTokenValue","getTokenOffset","getTokenLength","getTokenError","getNodePath","node","children","path","type","getNodeValue","prop","valueNode","contains","offset","includeRightBound","findNodeAtOffset","item","visit","visitor","options","ParseOptions","DEFAULT","toNoArgVisit","visitFunction","_scanner","toOneArgVisit","handleError","disallowComments","onComment","skipUntilAfter","skipUntil","onError","parseString","isValue","onLiteralValue","onObjectProperty","parseProperty","onSeparator","parseValue","onArrayBegin","needsComma","allowTrailingComma","onArrayEnd","parseArray","onObjectBegin","onObjectEnd","parseObject","JSON","parse","parseLiteral","getLiteralNodeType","ScanError","SyntaxKind","ParseErrorCode","CharacterCodes","getLocation","setPreviousNode","previousNodeInst","colonOffset","previousNode","segments","earlyReturnException","isAtPropertyKey","sep","matches","pattern","k","errors","onValue","currentParent","currentProperty","previousParents","object","parseTree","ensurePropertyComplete","endOffset","findNodeAtLocation","root","segment","found","propertyNode","stripComments","replaceCh","kind","parts","replace","join","documentText","newLineAndIndent","eol","repeat","indentValue","initialIndentLevel","indentLevel","scanner","lineBreak","hasError","addEdit","startOffset","rangeEnd","rangeStart","editOperations","content","formatText","formatTextStart","isEOL","nChars","tabSize","charAt","computeIndentLevel","getEOL","insertSpaces","json_1","firstToken","firstTokenStart","firstTokenEnd","secondToken","replaceContent","setProperty","originalPath","formattingOptions","getInsertionIndex","lastSegment","existing","propertyIndex","removeBegin","removeEnd","withFormatting","stringify","newProperty","edit","removalIndex","toRemove","newText","applyEdit","begin","jsonFormatter_1","edits","removeProperty","isWS","createSimpleKeybinding","keybinding","OS","ctrlCmd","winCtrl","SimpleKeybinding","KeyCode","KeyCodeStrMap","_keyCodeToStr","_strToKeyCode","keyCode","str","toLowerCase","uiMap","userSettingsUSMap","userSettingsGeneralMap","define","uiLabel","usUserSettingsLabel","generalUserSettingsLabel","KeyCodeUtils","keyCodeToStr","fromString","strToKeyCode","toUserSettingsUS","toUserSettingsGeneral","fromUserSettings","BinaryKeybindingsMask","KeyMod","KeyChord","firstPart","secondPart","createKeybinding","chordPart","ChordKeybinding","ctrlKey","shiftKey","altKey","metaKey","getHashCode","ResolvedKeybindingPart","kbLabel","kbAriaLabel","keyLabel","keyAriaLabel","ResolvedKeybinding","dispose","rest","d","isDisposable","thing","combinedDisposable","disposables","toDisposable","Disposable","_toDispose","_lifecycle_disposable_isDisposed","toDispose","None","freeze","ReferenceCollection","references","reference","counter","createReferencedObject","functional_1","destroyReferencedObject","ImmortalReference","Node","LinkedList","_size","_first","_last","_insert","atTheEnd","newNode","oldLast","prev","oldFirst","_remove","bind","res","candidate","anchor","iterator_1","Event","event","thisArgs","didFire","snapshot","each","merge","initial","output","emitter","Emitter","fire","latch","cache","firstCall","shouldEmit","_disposable","signal","any","events","lifecycle_1","leading","leakWarningThreshold","subscription","handle","numDebouncedCalls","cur","_output","stopwatch","Date","getTime","_","buffer","nextTick","_buffer","flush","echo","ChainableEvent","chain","fromNodeEventEmitter","eventName","id","onFirstListenerAdd","on","onLastListenerRemove","removeListener","fromPromise","promise","toPromise","_globalLeakWarningThreshold","setGlobalLeakWarningThreshold","oldValue","LeakageMonitor","customThreshold","_warnCountdown","_stacks","clear","listenerCount","threshold","Map","set","topStack","topCount","_disposed","_options","_leakageMon","_event","_listeners","linkedList_1","firstListener","isEmpty","remove","onFirstListenerDidAdd","onListenerDidAdd","removeMonitor","check","_noop","_deliveryQueue","iter","shift","AsyncEmitter","eventFn","_asyncDeliveryQueue","thenables","all","EventMultiplexer","hasListeners","hook","unhook","idx","EventBufferer","buffers","Relay","listening","inputEvent","inputEventListener","input","WindowManager","_zoomLevel","_lastZoomLevelChangeTime","_onDidChangeZoomLevel","event_1","onDidChangeZoomLevel","_zoomFactor","_onDidChangeFullscreen","onDidChangeFullscreen","now","zoomLevel","isTrusted","zoomFactor","ctx","createElement","getContext","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","fullscreen","_fullscreen","INSTANCE","setZoomLevel","getZoomLevel","getTimeSinceLastZoomLevelChanged","getZoomFactor","setZoomFactor","getPixelRatio","setFullscreen","isFullscreen","userAgent","isIE","isEdge","isEdgeOrIE","isOpera","isFirefox","isWebKit","isChrome","isSafari","isWebkitWebView","isIPad","isEdgeWebView","hasClipboardSupport","version","parseInt","domEvent","useCapture","addEventListener","removeEventListener","stop","preventDefault","stopPropagation","shortcutEvent","context","CancellationToken","isCancellationToken","Cancelled","MutableToken","onCancellationRequested","_isCancelled","_emitter","CancellationTokenSource","_token","cancel","isThenable","createCancelablePromise","source","cancellation_1","thenable","onfinally","finally","timeout","millis","sequence","promiseFactories","thenHandler","results","asPromise","Throttler","activePromise","queuedPromise","queuedPromiseFactory","promiseFactory","onComplete","queue","Sequencer","promiseTask","Delayer","defaultDelay","completionPromise","doResolve","task","cancelTimeout","doReject","ThrottledDelayer","delayer","throttler","trigger","isTriggered","Barrier","_isOpen","_promise","_completePromise","disposableTimeout","handler","timer","ignoreErrors","shouldStop","defaultValue","loop","factory","Limiter","maxDegreeOfParalellism","outstandingPromises","runningPromises","_onFinished","onFinished","consume","iLimitedTask","consumed","Queue","ResourceQueue","queues","resource","TimeoutTimer","runner","setIfNotSet","IntervalTimer","clearInterval","interval","setInterval","RunOnceScheduler","timeoutToken","timeoutHandler","onTimeout","isScheduled","doRun","RunOnceWorker","units","unit","schedule","nfcall","ninvoke","thisArg","requestIdleCallback","cancelIdleCallback","dummyIdle","didTimeout","timeRemaining","runWhenIdle","IdleValue","executor","_executor","_value","_error","_didRun","_handle","Schemas","inMemory","vscode","internal","walkThrough","walkThroughSnippet","http","https","file","mailto","untitled","command","LANGUAGE_DEFAULT","_isWindows","_isMacintosh","_isNative","_locale","_language","_translationsConfigFile","isElectronRenderer","process","versions","electron","platform","rawNlsConfig","env","nlsConfig","resolved","availableLanguages","locale","language","Platform","PlatformToString","isRealWindows","isWindows","isMacintosh","isLinux","isNative","isWeb","isRootUser","getuid","translationsConfigFile","_globals","self","global","globals","_setImmediate","setImmediate","OperatingSystem","KEY_CODE_MAP","INVERSE_KEY_CODE_MAP","browser","getCodeForKeyCode","ctrlKeyMod","metaKeyMod","StandardKeyboardEvent","_standardKeyboardEventBrand","browserEvent","char","toUpperCase","keyCodes_1","extractKeyCode","_asKeybinding","_computeKeybinding","_asRuntimeKeybinding","_computeRuntimeKeybinding","StandardMouseEvent","timestamp","leftButton","button","middleButton","rightButton","detail","pageX","posx","posy","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","iframeOffsets","iframe_1","getPositionOfChildWindowRelativeToAncestorWindow","view","DragMouseEvent","dataTransfer","StandardWheelEvent","deltaX","deltaY","targetNode","srcElement","e1","e2","wheelDeltaY","VERTICAL_AXIS","axis","wheelDeltaX","HORIZONTAL_AXIS","wheelDelta","addDisposableListener","DomListener","getComputedStyle","el","defaultView","getDimension","cssPropertyName","jsPropertyName","computedStyle","getPropertyValue","getAttribute","convertToPixels","getTopLeftOffset","offsetParent","offsetTop","offsetLeft","parentNode","direction","sizeUtils","getBorderLeftWidth","getBorderTopWidth","getTotalWidth","margin","getMarginLeft","getMarginRight","offsetWidth","getTotalScrollWidth","scrollWidth","getLargestChildWidth","childWidths","child","elementPosition","parentPosition","getRelativeLeft","isAncestor","testChild","testAncestor","createStyleSheet","container","style","media","appendChild","getSharedStyleSheet","_sharedStyleSheet","removeTabIndexAndUpdateFocus","hasAttribute","activeElement","parentFocusable","attribute","HTMLElement","findParentWithAttribute","parentElement","focus","removeAttribute","clearNode","firstChild","removeChild","removeNode","isInDOM","_manualClassList","className","classes","_lastStart","trim","classesLen","classLen","_lastEnd","idxEnd","_findClassName","classNames","nameValue","addClass","removeClass","shouldHaveIt","_nativeClassList","Boolean","classList","add","toggle","_classList","hasClass","addClasses","removeClasses","toggleClass","_node","_type","_handler","_useCapture","addStandardDisposableListener","wrapHandler","mouseEvent_1","_wrapAsStandardMouseEvent","keyboardEvent_1","_wrapAsStandardKeyboardEvent","addDisposableNonBubblingMouseOutListener","toElement","relatedTarget","_animationFrame","AnimationFrameQueueItem","priority","_runner","_canceled","NEXT_QUEUE","CURRENT_QUEUE","animFrameRequested","inAnimationFrameRunner","scheduleAtNextAnimationFrame","requestAnimationFrame","msRequestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","doRequestAnimationFrame","execute","runAtThisOrScheduleAtNextAnimationFrame","measure","modify","TimeoutThrottledDomListener","eventMerger","lastEvent","currentEvent","minimumTimeMs","lastHandlerTime","_register","async_1","invokeHandler","elapsedTime","addDisposableThrottledListener","parseFloat","getClientArea","Dimension","clientWidth","clientHeight","innerWidth","innerHeight","getBorderRightWidth","getBorderBottomWidth","getPaddingLeft","getPaddingRight","getPaddingTop","getPaddingBottom","getMarginTop","getMarginBottom","__commaSentinel","width","height","right","bottom","getDomNodePagePosition","domNode","bb","StandardWindow","scrollX","scrollY","getContentWidth","border","padding","getContentHeight","offsetHeight","getTotalHeight","findParentWithClass","clazz","stopAtClazzOrNode","createCSSRule","selector","cssText","sheet","insertRule","removeCSSRulesContainingSelector","ruleName","rules","cssRules","getDynamicStyleSheetRules","toDelete","selectorText","deleteRule","isHTMLElement","nodeType","nodeName","EventType","CLICK","DBLCLICK","MOUSE_UP","MOUSE_DOWN","MOUSE_OVER","MOUSE_MOVE","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","CONTEXT_MENU","WHEEL","KEY_DOWN","KEY_PRESS","KEY_UP","LOAD","UNLOAD","ABORT","ERROR","RESIZE","SCROLL","SELECT","CHANGE","SUBMIT","RESET","FOCUS","FOCUS_IN","FOCUS_OUT","BLUR","INPUT","STORAGE","DRAG_START","DRAG","DRAG_ENTER","DRAG_LEAVE","DRAG_OVER","DROP","DRAG_END","ANIMATION_START","ANIMATION_END","ANIMATION_ITERATION","EventHelper","cancelBubble","returnValue","saveParentsScrollTop","ELEMENT_NODE","restoreParentsScrollTop","state","FocusTracker","_onDidFocus","event_2","onDidFocus","_onDidBlur","onDidBlur","hasFocus","loosingFocus","trackFocus","append","prepend","insertBefore","SELECTOR_REGEX","$","description","attrs","match","exec","keys","test","setAttribute","arrays_1","createTextNode","nodes","separator","cloneNode","show","display","hide","tag","finalHandler","domContentLoaded","readyState","computeScreenAwareSize","cssPx","screenPx","windowOpenNoOpener","url","open","newTab","opener","href","animate","step","stepDisposable","Tap","Change","Start","End","Contextmenu","Gesture","activeTouches","targets","DomUtils","onTouchStart","onTouchEnd","onTouchMove","isTouchDevice","maxTouchPoints","msMaxTouchPoints","targetTouches","touch","identifier","initialTarget","initialTimeStamp","initialPageX","initialPageY","rollingTimestamps","rollingPageX","rollingPageY","evt","newGestureEvent","dispatchEvent","dispatched","activeTouchCount","changedTouches","holdTime","HOLD_DELAY","arrays","finalX","finalY","deltaT","dispatchTo","inertia","intialTarget","createEvent","initEvent","t1","vX","dirX","vY","dirY","y","delta_pos_x","delta_pos_y","stopped","SCROLL_FRICTION","translationX","translationY","__decorate","decorators_1","safeProcess","cwd","platform_1","validateString","ErrorInvalidArgType","isPathSeparator","CHAR_FORWARD_SLASH","CHAR_BACKWARD_SLASH","isPosixPathSeparator","isWindowsDeviceRoot","CHAR_UPPERCASE_A","CHAR_UPPERCASE_Z","CHAR_LOWERCASE_A","CHAR_LOWERCASE_Z","normalizeString","allowAboveRoot","lastSegmentLength","lastSlash","dots","CHAR_DOT","lastSlashIndex","lastIndexOf","_format","pathObject","dir","base","ext","expected","actual","determiner","msg","win32","pathSegments","resolvedDevice","resolvedTail","resolvedAbsolute","rootEnd","device","isAbsolute","paths","joined","needsReplace","slashCount","firstLen","normalize","fromOrig","toOrig","fromStart","fromEnd","fromLen","toStart","toEnd","toLen","lastCommonSep","fromCode","out","resolvedPath","matchedSlash","extIdx","firstNonSlashEnd","startDot","startPart","preDotState","ret","delimiter","posix","trailingSeparator","toNamespacedPath","hasRoot","dirname","basename","extname","escapeRegExpCharacters","ltrim","haystack","needle","needleLen","rtrim","haystackLen","isLowerAsciiLetter","isUpperAsciiLetter","isAsciiLetter","doEqualsIgnoreCase","stopAt","codeA","codeB","diff","substrEquals","aStart","aEnd","bStart","bEnd","isFullWidthCharacter","startsWithUTF8BOM","isFalsyOrWhitespace","pad","reverse","_formatRegexp","group","isNaN","escape","html","convertSimple2RegExpPattern","stripWildcards","startsWith","endsWith","createRegExp","searchString","isRegex","wholeWord","modifiers","matchCase","multiline","unicode","RegExp","regExpLeadsToEndlessLoop","regexp","lastIndex","regExpContainsBackreference","regexpValue","regExpFlags","ignoreCase","firstNonWhitespaceIndex","chCode","getLeadingWhitespace","lastNonWhitespaceIndex","startIndex","compareIgnoreCase","equalsIgnoreCase","startsWithIgnoreCase","candidateLength","commonSuffixLength","aLastIndex","bLastIndex","overlap","isHighSurrogate","isLowSurrogate","CONTAINS_RTL","containsRTL","CONTAINS_EMOJI","containsEmoji","IS_BASIC_ASCII","isBasicASCII","containsFullWidthCharacter","lcut","re","EL","COLOR_START","COLOR_END","removeAnsiEscapeCodes","removeAccents","regex","UTF8_BOM_CHARACTER","stripUTF8BOM","substr","safeBtoa","btoa","encodeURIComponent","fuzzyContains","query","queryLen","targetLower","containsUppercaseCharacter","ignoreEscapedChars","uppercaseFirstLetter","getNLines","toLocalISOString","date","getFullYear","strings_1","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","isWindowsDriveLetter","char0","toSlashes","osPath","path_1","getRoot","firstLetter","isUNC","INVALID_FILE_CHARS","WINDOWS_FORBIDDEN_NAMES","isValidBasename","isEqual","pathA","pathB","identityEquals","isEqualOrParent","sepOffset","_typeof","constructor","isString","string","isObject","isUndefined","isUndefinedOrNull","isFunction","function","validateConstraint","constraint","_a","isStringArray","every","isNumber","Number","isBoolean","isEmptyObject","areFunctions","objects","validateConstraints","constraints","ctor","isNativeClass","getAllPropertyNames","proto","getPrototypeOf","getOwnPropertyNames","withNullAsUndefined","withUndefinedAsNull","deepClone","_cloneAndChange","changer","types_1","changed","r1","has","r2","i2","_hasOwnProperty","delete","mixin","destination","overwrite","oneKeys","otherKeys","deepFreeze","isFrozen","cloneAndChange","Set","assign","sources","createKeywordMatcher","caseInsensitive","hash","arrayToHash","word","safeStringify","getOrDefault","baseValue","targetValue","encodeURIComponentFast","uriComponent","allowSlash","nativeEncodePos","escaped","encodeTable","_makeFsPath","uri","authority","scheme","_asFormatted","skipEncoding","encoder","fragment","_slash","userinfo","_schemePattern","_singleSlashStart","_doubleSlashStart","_throwOnMissingSchema","setUriThrowOnMissingScheme","old","_regexp","URI","fsPath","with","schemeOrData","_strict","trace","_schemeFix","_referenceResolution","_validateUri","change","_URI","decodeURIComponent","components","_fsPath","_formatted","external","$mid","58","47","63","35","91","93","64","33","36","38","39","40","41","42","43","44","59","61","32","getPathFromAmdModule","requirefn","relativePath","uri_1","toUrl","forEachable","getOrSet","mapToString","entries","setToString","mapToSerializable","serializable","serializableToMap","StringIterator","_pos","PathIterator","_from","_to","justSeps","aPos","aLen","thisPos","cmp","TernarySearchTreeNode","TernarySearchTree","_iter","_root","reset","val","hasNext","oldElement","_nodeIterator","_forEach","ResourceMap","toKey","clb","resourceMap","Touch","LinkedMap","_map","_head","_tail","addItemLast","addItemFirst","removeItem","callbackfn","newSize","currentSize","LRUCache","limit","ratio","_limit","_ratio","checkTrim","trimOld","starsToRegExp","starCount","NO_PATH_REGEX","PATH_REGEX","splitGlobAware","splitChar","inBraces","inBrackets","curVal","parseRegExp","regEx","GLOB_SPLIT","GLOBSTAR","previousSegmentWasGlobStar","braceVal","bracketVal","braceRegExp","strings","parsePattern","arg1","NULL","patternKey","trimForExclusions","parsedPattern","CACHE","wrapRelativePattern","T1","T2","originalPattern","slashBase","backslashBase","basenames","patterns","allBasenames","trivia2","T3_2","T3","parsedPatterns","aggregateBasenameMatches","withBasenames","allPaths","trivia3","T4","trivia4and5","T5","regExp","toRegExp","arg2","extpath","matchPathEnds","nativePath","ALL_FORWARD_SLASHES","nativePathEnd","FALSE","isRelativePattern","resultPattern","expression","when","hasSibling","clausePattern","matched","requiresSiblings","parseExpressionPattern","some","resultExpression","parsedExpression","listToMap","list","rp","basenamePatterns","aggregate","aggregatedPatterns","getEmptyExpression","map_1","hasSiblingPromiseFn","siblingsFn","siblings","hasSiblingFn","parseToAsync","getBasenameTerms","patternOrExpression","getPathTerms","form","normalizedCache","canNormalize","cached","nonAsciiCharactersPattern","nfcCache","normalizeNFC","nfdCache","normalizeNFD","hasToIgnoreCase","network_1","parentCandidate","originalFSPath","isEqualAuthority","a1","a2","uriPath","hasTrailingPathSeparator","fsp","getComparisonKey","basenameOrAuthority","second","p1","p2","joinPath","pathFragment","joinedPath","normalizePath","normalizedPath","isAbsolutePath","removeTrailingPathSeparator","resolvePath","distinctParents","resourceAccessor","candidateResource","otherItem","DataUri","META_DATA_LABEL","META_DATA_DESCRIPTION","META_DATA_SIZE","META_DATA_MIME","parseMetaData","dataUri","metadata","property","mime","ResourceGlobMatcher","globalExpression","rootExpressions","expressionsByRoot","forPaths","glob_1","rootExpression","findSubstr","hasDriveLetter","normalizeDriveLetter","tildify","userHome","normalizedUserHome","normalizedUserHomeCached","normalized","getPathLabel","userHomeProvider","rootProvider","baseResource","getWorkspaceFolder","hasMultipleRoots","getWorkspace","folders","pathLabel","resources_1","rootName","getBaseLabel","untildify","ellipsis","unc","home","shorten","shortenedPaths","pathIndex","prefix","subpathLength","subpath","otherPathIndex","isSubpathEnding","subpathWithSep","isOtherPathEnding","Type","template","inVariable","TEXT","VARIABLE","prevSegment","SEPARATOR","label","mnemonicMenuLabel","forceDisableMnemonics","mnemonicButtonLabel","unmnemonicLabel","splitName","fullPath","parentPath","v4","V4UUID","isUUID","_UUIDPattern","ValueUUID","_randomHex","_oneOf","_timeHighBits","_chars","generateUuid","asHex","param","assert","looper","sequences","sequenceResult","sequenceFunction","Sequence","parallel","didErrorOccur","doneCount","pathsPath","amd_1","require","__$__nodeRequire","getAppDataPath","getDefaultUserDataPath","readExactlyByFile","totalBytes","fs","fd","resultBuffer","bytesRead","close","closeError","readChunk","read","Buffer","allocUnsafe","readToMatchingString","matchingString","chunkBytes","maximumBytesToRead","newLineIndex","decodeStream","encoding","iconv","toNodeEncoding","enc","UTF8_with_bom","UTF8","detectEncodingByBOMFromBuffer","b0","readUInt8","b1","UTF16be","UTF16le","b2","guessEncodingByBuffer","resolve_1","reject_1","jschardet","Constants","MINIMUM_THRESHOLD","guessed","detect","IGNORE_ENCODINGS","toIconvLiteEncoding","encodingName","normalizedEncodingName","JSCHARDET_TO_ICONV_ENCODINGS","detectEncodingFromBuffer","autoGuessEncoding","seemsBinary","couldBeUTF16LE","couldBeUTF16BE","containsZeroByte","ZERO_BYTE_DETECTION_BUFFER_MAX_LEN","isEndian","isZeroByte","readInt8","guessedEncoding","toDecodeStream","readable","minBytesRequiredForDetection","guessEncoding","AUTO_GUESS_BUFFER_MAX_LEN","NO_GUESS_BUFFER_MAX_LEN","overwriteEncoding","detected","pipe","stream_1","Writable","_bytesBuffered","chunk","isBuffer","_decodeStream","write","_decodeStreamConstruction","_startDecodeStream","stream","bomLength","decode","encode","encodingExists","encodeStream","detectEncodingByBOM","ibm866","big5","toCanonicalName","windowsTerminalEncodings","437","850","852","855","857","860","861","863","865","866","869","936","1252","resolveTerminalEncoding","verbose","rawEncodingPromise","cliEncodingEnv","log","child_process_1","stdout","stderr","windowsTerminalEncodingKeys","rawEncoding","iconvEncoding","readdirSync","normalization_1","readdir","copy","copiedSourcesIn","copiedSources","stat","isDirectory","mode","reader","createReadStream","writer","createWriteStream","finished","finish","chmod","doCopyFile","proceed","files","mkdirp","mkdir","mkdirErr","statErr","rmRecursive","exists","lstat","isSymbolicLink","unlink","rmdir","firstError","childrenLeft","delSync","lstatSync","rmdirSync","unlinkSync","writeFileAndFlush","ensureOptions","encoding_1","charset","addBOM","canFlush","writeFile","flag","openError","writeError","fdatasync","syncError","doWriteFileAndFlush","isBrowser","isOpen","destroy","flags","autoClose","doWriteFileStreamAndFlush","ensuredOptions","realcaseSync","ix","flow","statLink","del","tmpFolder","pathInTemp","uuid","rename","mv","updateMtime","futimes","atime","writeFileAndFlushSync","writeFileSync","openSync","fdatasyncSync","closeSync","realpathSync","accessSync","constants","R_OK","realpath","access","watch","onChange","watcher","raw","removeAllListeners","sanitizeFilePath","extfs","rimraf","queueKey","writeFileQueue","writeFilePathQueue","onFinish","ensureWriteFileQueue","toQueueKey","dirExists","tmp","_tmpDir","os","tmpdir","oldPath","newPath","renameIgnoreError","symlink","readlink","truncate","readFile","readDirsInDir","dirPath","fileExists","isFile","whenDeleted","running","createSizeBuffer","writeUInt32BE","readSizeBuffer","readUInt32BE","serialize","BufferPresets","Undefined","deserialize","DataType","getDelayedChannel","cancellationToken","relay","listen","RequestType","ResponseType","State","BufferReader","bytes","BufferWriter","alloc","ChannelServer","channels","activeRequests","protocolListener","onMessage","onRawMessage","sendResponse","channelName","channel","response","send","header","sendBuffer","onPromise","onEventListen","disposeActiveRequest","request","cancellationTokenSource","disposable","ChannelClient","Uninitialized","handlers","lastRequestId","_onDidInitialize","onDidInitialize","onBuffer","that","requestPromise","requestEvent","uninitializedPromise","whenInitialized","sendRequest","cancellationTokenListener","onResponse","Idle","IPCServer","onDidClientConnect","_connections","_onDidChangeConnections","onDidChangeConnections","onDidClientDisconnect","onFirstMessage","channelServer","channelClient","registerChannel","connection","connections","router","routeCall","getChannel","routeEvent","IPCClient","getNextTickChannel","didTick","StaticRouter","hub","route","Protocol","sender","Client","ipc_1","electron_1","ipcRenderer","ipc_electron_1","createProtocol","createBufferedEvent","isDeliveringMessages","bufferedMessages","deliverMessages","generateRandomPipeName","randomSuffix","uuid_1","os_1","ChunkStream","byteLength","_totalLength","_chunks","buff","byteCount","resultOffset","_socket","_onMessage","_onClose","onClose","_writeBuffer","_data","head","wasEmpty","_isDisposed","_incomingData","readHead","bodyLen","_socketDataListener","acceptChunk","_headerLen","_socketEndListener","_socketCloseListener","_writeSoon","destroyed","take","Server","server","onConnection","socket","toClientConnectionEvent","serve","net_1","createServer","connect","clientId","createConnection","fromSocket","BufferedProtocol","_actual","IssueReporterModel","initialData","defaultData","issueType","includeSystemInfo","includeWorkspaceInfo","includeProcessInfo","includeExtensions","includeSearchedExtensions","includeSettingsSearchDetails","allExtensions","objects_1","newData","getIssueTypeTitle","issueDescription","getExtensionVersion","versionInfo","vscodeVersion","getInfos","fileOnExtension","selectedExtension","info","systemInfo","generateSystemInfoMd","generateProcessInfoMd","generateWorkspaceInfoMd","generateExtensionsMd","generateSettingSearchResultsMd","generateSettingsSearchResultDetailsMd","md","processInfo","workspaceInfo","extensionsDisabled","themeExclusionStr","numberOfThemeExtesions","enabledNonThemeExtesions","table","publisher","filterResultCount","actualSearchResults","setting","extensionId","score","normalizeGitHubUrl","defaultOptions","buttonBackground","color_1","fromHex","buttonHoverBackground","buttonForeground","Button","_onDidClick","buttonBorder","_element","DOM","tabIndex","touch_1","addTarget","eventType","enabled","eventHandled","blur","setHoverBackground","applyStyles","focusTracker","onDidClick","hoverBackground","backgroundColor","styles","borderWidth","borderStyle","borderColor","textContent","title","icon","iconClassName","ButtonGroup","_buttons","buttons","buttonIndexToFocus","renderOcticons","_match","_g1","_g3","animation","expand","OcticonLabel","_container","innerHTML","nls","default","nls_1","localize","SyncDescriptor","staticArguments","supportsDelayedInstantiation","createSyncDescriptor","Graph","_hashFn","_nodes","collections_1","entry","outgoing","fromNode","lookupOrInsertNode","toNode","incoming","_key","storeServiceDependency","optional","_util","DI_TARGET","DI_DEPENDENCIES","serviceId","serviceIds","getServiceDependencies","IInstantiationService","serviceIdentifier","IHistoryMainService","instantiation_1","isRecentWorkspace","curr","isRecentFolder","isRecentFile","ServiceCollection","_entries","service","instanceOrDescriptor","_canUseProxy","Proxy","InstantiationService","services","serviceCollection_1","strict","_services","_parent","_trace","Trace","traceInvocation","_done","accessor","isOptional","_getOrCreateServiceInstance","ctorOrDescriptor","descriptors_1","traceCreation","_createInstance","serviceDependencies","serviceArgs","dependency","firstServiceArgPos","instance","_setServiceInstance","instanceOrDesc","_getServiceInstanceOrDescriptor","_createAndCacheServiceInstance","branch","desc","throwCycleError","graph","graph_1","dependencies","insertEdge","roots","_createServiceInstanceWithOwner","_createServiceInstance","_supportsDelayedInstantiation","idle","_target","getValue","TraceType","_start","_dep","_None","printChild","causedCreation","nested","dur","_totals","lines","IMainProcessService","MainProcessService","windowId","mainProcessConnection","ipc_electron_browser_1","toISOString","ILogService","LogLevel","DEFAULT_LOG_LEVEL","Info","AbstractLogService","level","_onDidChangeLogLevel","onDidChangeLogLevel","ConsoleLogMainService","logLevel","setLevel","useColors","getLevel","Debug","Warning","Critical","ConsoleLogService","MultiplexLogService","logServices","logService","debug","critical","DelegatedLogService","NullLogService","getLogLevel","environmentService","Off","LogLevelSetterChannel","LogLevelSetterChannelClient","FollowerLogService","log_1","master","createSpdLogService","processName","logsFolder","_spdlog","setAsyncMode","logfilePath","logger","RotatingLogger","SpdLogService","createRotatingLogger","filename","filesize","filecount","postMessage","$type","$data","dirs","abDirPath","existsSync","mkdirSync","fileContent","readFileSync","clearFormatters","drop","rootPath","packageJsonPath","productJsonPath","product","nameShort","nameLong","dataFolderName","getIPCHandle","userDataPath","crypto","createHash","update","digest","package_1","getWin32IPCHandle","xdgRuntimeDir","scope","getNixIPCHandle","parseExtensionHostPort","isBuild","parseDebugPort","debugId","parseSearchPort","debugArg","debugBrkArg","defaultBuildPort","portStr","break","parsePathArg","parseUserDataDir","EnvironmentService","_args","_execPath","date_1","logsPath","appRoot","execPath","cliPath","isBuilt","product_1","applicationName","getCLIPath","homedir","vscodePortable","appNameLong","appQuality","quality","appSettingsHome","appSettingsPath","globalStorageHome","workspaceStorageHome","settingsSearchBuildId","settingsSearchUrl","appKeybindingsPath","isExtensionDevelopment","extensionDevelopmentPath","backupHome","backupWorkspacesPath","untitledWorkspacesHome","installSourcePath","builtinExtensionsPath","fromArgs","extensionsPath","vscodeExtensions","extensionDevelopmentLocationURI","extensionTestsLocationURI","extensionTestsPath","disableExtensions","skipGettingStarted","skipReleaseNotes","skipAddToRecentlyOpened","debugExtensionHost","debugSearch","wait","logExtensionHostCommunication","status","mainIPCHandle","sharedIPCHandle","nodeCachedDataDir","disableUpdates","disableCrashReporter","driverHandle","driverVerbose","RegistryImpl","Assert","Types","Registry","Extensions","JSONContribution","JSONContributionRegistry","_onDidChangeSchema","onDidChangeSchema","schemasById","unresolvedSchemaContent","normalizeId","schemas","jsonContributionRegistry","getDefaultValue","validateProperty","OVERRIDE_PROPERTY_PATTERN","configurationRegistry","getConfigurationProperties","Configuration","ConfigurationScope","allSettings","properties","patternProperties","applicationSettings","windowSettings","resourceSettings","editorConfigurationSchemaId","contributionRegistry","as","jsonContributionRegistry_1","ConfigurationRegistry","overrideIdentifiers","_onDidSchemaChange","onDidSchemaChange","_onDidUpdateConfiguration","onDidUpdateConfiguration","defaultOverridesConfigurationNode","configurationContributors","editorConfigurationSchema","additionalProperties","errorMessage","configurationProperties","excludedConfigurationProperties","computeOverridePropertyPattern","registerSchema","configuration","validate","registerConfigurations","configurations","validateAndRegisterProperties","registerJSONConfiguration","updateSchemaForOverrideSettingsConfiguration","deregisterConfiguration","allOf","defaultConfigurations","defaultConfiguration","defaults","propertySchema","$ref","updateOverridePropertyPatternKey","overridable","types","propertyKeys","included","subNodes","register","SETTINGS_OVERRRIDE_NODE_ID","overridePropertyPattern","subNode","OVERRIDE_PATTERN_WITH_SUBSTITUTION","OVERRIDE_PROPERTY","getScopes","scopes","toValuesTree","conflictReporter","addToValueTree","settingsTreeRoot","doRemoveFromValueTree","valueTree","getConfigurationValue","config","settingPath","component","accessSetting","overrideIdentifierFromKey","IConfigurationService","isConfigurationOverrides","overrideIdentifier","ConfigurationTarget","ConfigurationTargetToString","configurationTarget","updated","value1","contents","value2","toOverrides","overrides","configurationRegistry_1","overrideRaw","keyInOverrideRaw","identifiers","removeFromValueTree","getConfigurationKeys","getDefaultValues","valueTreeRoot","keyFromOverrideIdentifier","getMigratedSettingValue","configurationService","currentSettingName","legacySettingName","inspect","legacySetting","user","workspace","workspaceFolder","TelemetryService","_configurationService","_disposables","_cleanupPatterns","_appender","appender","_commonProperties","commonProperties","_piiPaths","piiPaths","_userOptIn","piiPath","_updateUserOptIn","onDidChangeConfiguration","publicLog","optIn","isHashedId","usingFallbackGuid","TELEMETRY_SECTION_ID","enableTelemetry","isOptedIn","sessionId","instanceId","machineId","anonymizeFilePaths","_cleanupInfo","updatedStack","cleanUpIndexes","nodeModulesRegex","fileRegex","IDLE_START_EVENT_NAME","IDLE_STOP_EVENT_NAME","__param","configuration_1","registerConfiguration","order","telemetry.enableTelemetry","tags","configurationTelemetry","telemetryService","configurationSource","configurationKeys","flatKeys","flattenKeys","sourceConfig","configurationValues","flattenValues","configurationValueWhitelist","NullTelemetryService","combinedAppender","appenders","NullAppender","LogAppender","_logService","commonPropertiesRegex","strippedData","keybindingsTelemetry","keybindingService","onDidUpdateKeybindings","keybindings","bindings","binding","resolveCommonProperties","commit","release","arch","seq","startTime","defineProperties","common.timesincesessionstart","common.sequence","pfs_1","TelemetryAppenderChannel","TelemetryAppenderClient","IWindowsService","IWindowService","getTitleBarStyle","environment","isDev","nativeTabs","nativeFullScreen","titleBarStyle","OpenContext","ReadyState","ActiveWindowManager","windowsService","onWindowOpen","onWindowFocus","onActiveWindowChange","setActiveWindow","firstActiveWindowIdPromise","getActiveWindowId","_activeWindowId","isStoredWorkspaceFolder","isRawFileWorkspaceFolder","isRawUriWorkspaceFolder","isSingleFolderWorkspaceIdentifier","getStoredWorkspaceFolder","folderURI","folderName","targetConfigFolderURI","useSlashForPath","folderPath","labels_1","extpath_1","rewriteWorkspaceFileForNewLocation","rawWorkspaceContents","configPathURI","targetConfigPathURI","storedWorkspace","json","folder","doParseStoredWorkspace","sourceConfigFolder","targetConfigFolder","rewrittenFolders","slashForPath","newRawWorkspaceContents","jsonEdit","storedFolders","SLASH","IWorkspacesMainService","IWorkspacesService","WORKSPACE_EXTENSION","WORKSPACE_FILTER","extensions","UNTITLED_WORKSPACE_NAME","reviveWorkspaceIdentifier","configPath","revive","isWorkspaceIdentifier","workspaceIdentifier","toWorkspaceIdentifier","isSingleFolderWorkspaceInitializationPayload","WORKSPACE_SUFFIX","hasWorkspaceFileExtension","WindowsService","mainProcessService","onWindowBlur","onWindowMaximize","onWindowUnmaximize","onRecentlyOpenedChange","workspaces_1","fileName","recent","recentlyOpened","workspaces","history_1","folderUri","fileUri","uris","win","severity","messages","mainProcessService_1","MAX_URL_LENGTH","startup","issueReporterPage_1","IssueReporter","render","numberOfSearchResultsDisplayed","receivedSystemInfo","receivedPerformanceInfo","shouldQueueSearch","hasBeenSubmitted","updateSystemInfo","querySelector","tableHtml","updateProcessInfo","updateWorkspaceInfo","initServices","issueReporterModel","issueReporterModel_1","issueReporterElement","getElementById","previewButton","button_1","getData","updatePreviewButtonState","lang","setUpTypes","setEventHandlers","applyZoom","handleExtensionData","enabledExtensions","handleSettingsSearchData","renderBlocks","webFrame","styleTag","inputBackground","inputBorder","inputForeground","inputErrorBorder","inputActiveBorder","textLinkColor","textLinkActiveForeground","sliderBackgroundColor","sliderActiveColor","sliderHoverColor","nonThemes","themes","collections","isTheme","updateExtensionTable","disabled","updateExtensionSelector","updateSearchedExtensionTable","updateSettingsSearchDetails","details","serviceCollection","windows_1","windowsService_1","environmentService_1","spdlogService_1","logLevelClient","logIpc_1","sharedProcess","whenSharedProcessReady","ipc_net_1","instantiationService","instantiationService_1","telemetryUtils_1","telemetryIpc_1","commonProperties_1","createInstance","telemetryService_1","sendWorkbenchCommand","commandId","setSourceOptions","elementId","showInfoElements","getElementsByClassName","containingElement","lastElementChild","problemSourceHelpText","clearSearchResults","searchExtensionIssues","searchVSCodeIssues","lengthValidationMessage","getIssueUrlWithTitle","createIssue","onkeydown","cmdOrCtrlKey","issueTitle","HTMLInputElement","HTMLTextAreaElement","select","isPreviewEnabled","repositoryUrl","bugsUrl","searchDuplicates","getExtensionGitHubUrl","repo","searchGitHub","displaySearchResults","similarIssues","fetch","dom_1","resetTime","headers","timeToWait","catch","logSearchError","init","method","Headers","Content-Type","candidates","issues","issuesText","issue","link","html_url","openLink","issueState","issueIcon","octiconLabel_1","issueStateLabel","makeOption","valueOf","typeSelect","option","sourceSelect","selected","selectedIndex","blockContainer","systemBlock","processBlock","workspaceBlock","extensionsBlock","searchedExtensionsBlock","settingsSearchResultsBlock","problemSource","descriptionTitle","descriptionSubtitle","extensionSelector","inputId","inputElement","isValid","validateInput","validateInputs","invalidInput","numSimilarIssuesDisplayed","baseUrl","issueBody","clipboard","writeText","getExtensionBugsUrl","extensionUrl","getExtensionRepositoryUrl","issueReporterUtil_1","reportIssueUrl","extensionGitHubUrl","extensionOptions","extension","displayName","aName","bName","extensionsSelector","selectedExtensionId","numThemeExtensions","getExtensionTableHtml","which","shell","openExternal"],"mappings":";;;CAAA;AACA,IAAAA,GAAA,UAAA,UAAA,0BAAA,uBAAA,2BAAA,yBAAA,sBAAA,qBAAA,iDAAA,wBAAA,uBAAA,uBAAA,0BAAA,uCAAA,6BAAA,0DAAA,yBAAA,qBAAA,KAAA,0DAAA,sBAAA,yBAAA,sBAAA,qBAAA,6BAAA,KAAA,SAAA,4BAAA,wBAAA,yBAAA,sBAAA,0BAAA,2BAAA,iDAAA,gCAAA,8BAAA,qDAAA,sDAAA,6BAAA,mCAAA,mCAAA,4BAAA,yDAAA,qBAAA,sBAAA,yBAAA,wBAAA,uBAAA,wBAAA,mBAAA,sBAAA,+BAAA,sCAAA,0DAAA,WAAA,iCAAA,oDAAA,mDAAA,0CAAA,0BAAA,mCAAA,2DAAA,sEAAA,+CAAA,4DAAA,0DAAA,0BAAA,wBAAA,mDAAA,gEAAA,uDAAA,kDAAA,+CAAA,yCAAA,4BAAA,qCAAA,6BAAA,wDAAA,sBAAA,+BAAA,8BAAA,qCAAA,yBAAA,wBAAA,kDAAA,wBAAA,0DAAA,oBAAA,qBAAA,gDAAA,8CAAA,8CAAA,0CAAA,qCAAA,2CAAA,sDAAA,SAAA,MAAA,SAAA,aAAA,gBAAA,mDAAA,UACAC,EAAA,SAAAC;AAEA,IAAA,IADAC,KACAC,EAAA,EAAAC,EAAAH,EAAAI,OAAAF,EAAAC,EAAAD,IACAD,EAAAC,GAAAJ,EAAAE,EAAAE,IAEA,OAAAD,oDCeA,SAASI,EAA4BC,GACpC,IAAKA,EAAEC,QAAUD,EAAEC,SAAWD,EAC7B,OAAO,KAIR,IACC,IAAIE,EAAWF,EAAEE,SACbC,EAAiBH,EAAEC,OAAOC,SAC9B,GAAIA,EAASE,WAAaD,EAAeC,UAAYF,EAASG,WAAaF,EAAeE,UAAYH,EAASI,OAASH,EAAeG,KAEtI,OADAC,GAAiC,EAC1B,KAEP,MAAOC,GAER,OADAD,GAAiC,EAC1B,KAGR,OAAOP,EAAEC,OAGV,SAASQ,EAAgCC,EAAsBC,GAC9D,IACIC,EADAC,EAAsBH,EAAaI,SAASC,qBAAqB,UAErE,IAAK,IAAInB,EAAI,EAAGC,EAAMgB,EAAoBf,OAAQF,EAAIC,EAAKD,IAE1D,IADAgB,EAASC,EAAoBjB,IAClBoB,gBAAkBL,EAC5B,OAAOC,EAGT,OAAO,sDAjCR,IAAIL,GAA0C,EAC1CU,EAA2D,WAmClDC,EAOLC,kCACN,IAAKF,EAA4B,CAChCA,KACA,IACIhB,EADAD,EAAmBoB,OAEvB,IACCnB,EAASF,EAA4BC,IAEpCiB,EAA2BI,MAC1BD,OAAQpB,EACRsB,cAAeb,EAAgCR,EAAQD,KAGxDiB,EAA2BI,MAC1BD,OAAQpB,EACRsB,cAAe,OAGjBtB,EAAIC,QACID,GAEV,OAAOiB,EAA2BM,MAAM,GAOlCJ,oCAIN,OAHKF,GACJO,KAAKC,2BAEClB,EAMDY,wDAAwDR,EAAqBe,GAEnF,IAAKA,GAAkBf,IAAgBe,EACtC,OACCC,IAAK,EACLC,KAAM,GAIR,IAAID,EAAM,EAAGC,EAAO,EAEhBC,EAAcL,KAAKC,2BAEvB,IAAK,MAAMK,KAAiBD,EAAa,CAExC,GAAIC,EAAcV,SAAWM,EAC5B,MAGD,IAAKI,EAAcR,cAClB;CAGD,IAAIS,EAAeD,EAAcR,cAAcU,wBAC/CL,GAAOI,EAAaJ,IACpBC,GAAQG,EAAaH,KAGtB,OACCD,IAAKA,EACLC,KAAMA,IA3ETK,EAAAf,YAAAA,sGC/CAe,EAAAC,GAAA,SAAmBC,EAAaC,GAC/B,IAAKD,EACJ,MAAM,IAAIE,MAAMD,EAAU,qBAAuBA,EAAU,IAAM,yHCWnE,MAAME,EAAiBC,OAAOC,UAAUF,eAMxCL,EAAAQ,OAAA,SAA0BC,GACzB,MAAM/C,KACN,IAAK,IAAIgD,KAAOD,EACXJ,EAAeM,KAAKF,EAAMC,IAC7BhD,EAAO0B,KAAMqB,EAAaC,IAG5B,OAAOhD,GAGRsC,EAAAY,KAAA,SAAwBH,GACvB,IAAII,EAAQ,EACZ,IAAK,IAAIH,KAAOD,EACXJ,EAAeM,KAAKF,EAAMC,KAC7BG,GAAS,GAGX,OAAOA,GAGRb,EAAAc,MAAA,SAAyBL,GACxB,IAAK,IAAIC,KAAOD,EACf,GAAIJ,EAAeM,KAAKF,EAAMC,GAC7B,OAAOD,EAAKC,IAUfV,EAAAe,QAAA,SAA2BN,EAAmDO,GAC7E,IAAK,IAAIN,KAAOD,EACf,GAAIJ,EAAeM,KAAKF,EAAMC,KAId,IAHAM,GAAWN,IAAKA,EAAKR,MAAQO,EAAaC,IAAQ,kBACxDD,EAAaC,KAGrB,QAUJV,EAAAiB,QAAA,SAA2BC,EAAWC,GACrC,MAAMzD,EAAiC4C,OAAOc,OAAO,MACrD,IAAK,MAAMC,KAAWH,EAAM,CAC3B,MAAMR,EAAMS,EAAQE,GACpB,IAAIC,EAAS5D,EAAOgD,GACfY,IACJA,EAAS5D,EAAOgD,OAEjBY,EAAOlC,KAAKiC,GAEb,OAAO3D,GAGRsC,EAAAuB,QAAA,SAA2BC,GAC1B,MAAM9D,EAA+B4C,OAAOc,OAAO,MAMnD,OALII,GACHA,EAAST,QAAQ,CAACb,EAAOQ,KACxBhD,EAAOgD,GAAOR,IAGTxC;aC1FR,SAAS+D,EAAWC,EAAgBC,GACnC,MAAMC,EAAUC,KAAKC,IAAI,GAAIH,GAC7B,OAAOE,KAAKE,MAAML,EAASE,GAAWA,yDAG1BI,EAuBZ9C,YAAY+C,EAAWC,EAAWC,EAAWC,EAAY,GACxD7C,KAAK0C,EAAoC,EAAhCJ,KAAKQ,IAAI,IAAKR,KAAKS,IAAI,EAAGL,IACnC1C,KAAK2C,EAAoC,EAAhCL,KAAKQ,IAAI,IAAKR,KAAKS,IAAI,EAAGJ,IACnC3C,KAAK4C,EAAoC,EAAhCN,KAAKQ,IAAI,IAAKR,KAAKS,IAAI,EAAGH,IACnC5C,KAAK6C,EAAIX,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGD,GAAI,GAAI,GAGlDlD,cAAckD,EAASD,GACtB,OAAOC,EAAEH,IAAME,EAAEF,GAAKG,EAAEF,IAAMC,EAAED,GAAKE,EAAED,IAAMA,EAAEA,GAAKC,EAAEA,IAAMD,EAAEC,GA/BhEpC,EAAAgC,KAAAA,QAmCaO,EAwBZrD,YAAYsD,EAAWC,EAAWC,EAAWN,GAC5C7C,KAAKiD,EAAoC,EAAhCX,KAAKS,IAAIT,KAAKQ,IAAI,IAAKG,GAAI,GACpCjD,KAAKkD,EAAIhB,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGI,GAAI,GAAI,GACjDlD,KAAKmD,EAAIjB,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGK,GAAI,GAAI,GACjDnD,KAAK6C,EAAIX,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGD,GAAI,GAAI,GAGlDlD,cAAckD,EAASD,GACtB,OAAOC,EAAEI,IAAML,EAAEK,GAAKJ,EAAEK,IAAMN,EAAEM,GAAKL,EAAEM,IAAMP,EAAEO,GAAKN,EAAEA,IAAMD,EAAEC,EAS/DlD,gBAAgByD,GACf,MAAMV,EAAIU,EAAKV,EAAI,IACbC,EAAIS,EAAKT,EAAI,IACbC,EAAIQ,EAAKR,EAAI,IACbC,EAAIO,EAAKP,EAETE,EAAMT,KAAKS,IAAIL,EAAGC,EAAGC,GACrBE,EAAMR,KAAKQ,IAAIJ,EAAGC,EAAGC,GAC3B,IAAIK,EAAI,EACJC,EAAI,EACR,MAAMC,GAAKL,EAAMC,GAAO,EAClBM,EAASN,EAAMD,EAErB,GAAIO,EAAS,EAAG,CAGf,OAFAH,EAAIZ,KAAKQ,IAAKK,GAAK,GAAME,GAAU,EAAIF,GAAKE,GAAU,EAAK,EAAIF,GAAM,GAE7DJ,GACP,KAAKL,EAAGO,GAAKN,EAAIC,GAAKS,GAAUV,EAAIC,EAAI,EAAI,GAAI,MAChD,KAAKD,EAAGM,GAAKL,EAAIF,GAAKW,EAAS,EAAG,MAClC,KAAKT,EAAGK,GAAKP,EAAIC,GAAKU,EAAS,EAGhCJ,GAAK,GACLA,EAAIX,KAAKE,MAAMS,GAEhB,OAAO,IAAID,EAAKC,EAAGC,EAAGC,EAAGN,GAGlBlD,gBAAgB2D,EAAWC,EAAWC,GAO7C,OANIA,EAAI,IACPA,GAAK,GAEFA,EAAI,IACPA,GAAK;AAEFA,EAAI,EAAI,EACJF,EAAc,GAATC,EAAID,GAASE,EAEtBA,EAAI,GACAD,EAEJC,EAAI,EAAI,EACJF,GAAKC,EAAID,IAAM,EAAI,EAAIE,GAAK,EAE7BF,EASR3D,cAAc8D,GACb,MAAMR,EAAIQ,EAAKR,EAAI,KACbC,EAAEA,EAACC,EAAEA,EAACN,EAAEA,GAAMY,EACpB,IAAIf,EAAWC,EAAWC,EAE1B,GAAU,IAANM,EACHR,EAAIC,EAAIC,EAAIO,MACN,CACN,MAAMI,EAAIJ,EAAI,GAAMA,GAAK,EAAID,GAAKC,EAAID,EAAIC,EAAID,EACxCI,EAAI,EAAIH,EAAII,EAClBb,EAAIM,EAAKU,SAASJ,EAAGC,EAAGN,EAAI,EAAI,GAChCN,EAAIK,EAAKU,SAASJ,EAAGC,EAAGN,GACxBL,EAAII,EAAKU,SAASJ,EAAGC,EAAGN,EAAI,EAAI,GAGjC,OAAO,IAAIR,EAAKH,KAAKE,MAAU,IAAJE,GAAUJ,KAAKE,MAAU,IAAJG,GAAUL,KAAKE,MAAU,IAAJI,GAAUC,IA7GjFpC,EAAAuC,KAAAA,QAiHaW,EAwBZhE,YAAYsD,EAAWC,EAAWU,EAAWf,GAC5C7C,KAAKiD,EAAoC,EAAhCX,KAAKS,IAAIT,KAAKQ,IAAI,IAAKG,GAAI,GACpCjD,KAAKkD,EAAIhB,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGI,GAAI,GAAI,GACjDlD,KAAK4D,EAAI1B,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGc,GAAI,GAAI,GACjD5D,KAAK6C,EAAIX,EAAWI,KAAKS,IAAIT,KAAKQ,IAAI,EAAGD,GAAI,GAAI,GAGlDlD,cAAckD,EAASD,GACtB,OAAOC,EAAEI,IAAML,EAAEK,GAAKJ,EAAEK,IAAMN,EAAEM,GAAKL,EAAEe,IAAMhB,EAAEgB,GAAKf,EAAEA,IAAMD,EAAEC,EAI/DlD,gBAAgByD,GACf,MAAMV,EAAIU,EAAKV,EAAI,IACbC,EAAIS,EAAKT,EAAI,IACbC,EAAIQ,EAAKR,EAAI,IACbiB,EAAOvB,KAAKS,IAAIL,EAAGC,EAAGC,GAEtBkB,EAAQD,EADDvB,KAAKQ,IAAIJ,EAAGC,EAAGC,GAEtBM,EAAa,IAATW,EAAa,EAAKC,EAAQD,EACpC,IAAIE,EAYJ,OATCA,EADa,IAAVD,EACC,EACMD,IAASnB,IACXC,EAAIC,GAAKkB,EAAS,EAAK,GAAK,EAC1BD,IAASlB,GACbC,EAAIF,GAAKoB,EAAS,GAElBpB,EAAIC,GAAKmB,EAAS,EAGlB,IAAIH,EAAKrB,KAAKE,MAAU,GAAJuB,GAASb,EAAGW,EAAMT,EAAKP,GAInDlD,cAAcqE,GACb,MAAMf,EAAEA,EAACC,EAAEA,EAACU,EAAEA,EAACf,EAAEA,GAAMmB,EACjBC,EAAIL,EAAIV,EACRgB,EAAID,GAAK,EAAI3B,KAAK6B,IAAKlB,EAAI,GAAM,EAAI,IACrCc,EAAIH,EAAIK,EACd,IAAKvB,EAAGC,EAAGC,IAAM,EAAG,EAAG,GA0BvB,OAxBIK,EAAI,IACPP,EAAIuB,EACJtB,EAAIuB,GACMjB,EAAI,KACdP,EAAIwB,EACJvB,EAAIsB,GACMhB,EAAI,KACdN,EAAIsB,EACJrB,EAAIsB,GACMjB,EAAI,KACdN,EAAIuB,EACJtB,EAAIqB,GACMhB,EAAI,KACdP,EAAIwB,EACJtB,EAAIqB,GACMhB,EAAI,MACdP,EAAIuB,EACJrB,EAAIsB,GAGLxB,EAAIJ,KAAKE,MAAgB,KAATE,EAAIqB;AACpBpB,EAAIL,KAAKE,MAAgB,KAATG,EAAIoB,IACpBnB,EAAIN,KAAKE,MAAgB,KAATI,EAAImB,IAEb,IAAItB,EAAKC,EAAGC,EAAGC,EAAGC,IA3F3BpC,EAAAkD,KAAAA,QA+FaS,EAwBZzE,YAAY0E,GACX,IAAKA,EACJ,MAAM,IAAIxD,MAAM,uBACV,GAAIwD,aAAe5B,EACzBzC,KAAKoD,KAAOiB,OACN,GAAIA,aAAerB,EACzBhD,KAAKsE,MAAQD,EACbrE,KAAKoD,KAAOJ,EAAKuB,OAAOF,OAClB,CAAA,KAAIA,aAAeV,GAIzB,MAAM,IAAI9C,MAAM,+BAHhBb,KAAKwE,MAAQH,EACbrE,KAAKoD,KAAOO,EAAKY,OAAOF,IAhC1B1E,eAAe8E,GACd,OAAOL,EAAMM,OAAOC,IAAIC,SAASH,IAAQL,EAAMS,IAKhDpB,WACC,OAAIzD,KAAKsE,MACDtE,KAAKsE,MAELtB,EAAK8B,SAAS9E,KAAKoD,MAK5BY,WACC,OAAIhE,KAAKwE,MACDxE,KAAKwE,MAENb,EAAKmB,SAAS9E,KAAKoD,MAmB3BzD,OAAOoF,GACN,QAASA,GAAStC,EAAKuC,OAAOhF,KAAKoD,KAAM2B,EAAM3B,OAASJ,EAAKgC,OAAOhF,KAAKyD,KAAMsB,EAAMtB,OAASE,EAAKqB,OAAOhF,KAAKgE,KAAMe,EAAMf,MAO5HrE,uBAMC,OAAOuC,EAFW,MAHRkC,EAAMa,+BAA+BjF,KAAKoD,KAAKV,GAG1B,MAFrB0B,EAAMa,+BAA+BjF,KAAKoD,KAAKT,GAEb,MADlCyB,EAAMa,+BAA+BjF,KAAKoD,KAAKR,GAG5B,GAGtBjD,sCAAsCuF,GAC7C,MAAMjB,EAAIiB,EAAQ,IAClB,OAAQjB,GAAK,OAAWA,EAAI,MAAQ3B,KAAKC,KAAM0B,EAAI,MAAS,MAAQ,KAOrEtE,iBAAiBwF,GAChB,MAAMC,EAAOpF,KAAKqF,uBACZC,EAAOH,EAAQE;CACrB,OAAOD,EAAOE,GAAQF,EAAO,MAASE,EAAO,MAASA,EAAO,MAASF,EAAO,KAO9EzF,WAEC,OAD2B,IAAdK,KAAKoD,KAAKV,EAAwB,IAAd1C,KAAKoD,KAAKT,EAAwB,IAAd3C,KAAKoD,KAAKR,GAAW,IAC7D,IAOdjD,YAEC,OAD2B,IAAdK,KAAKoD,KAAKV,EAAwB,IAAd1C,KAAKoD,KAAKT,EAAwB,IAAd3C,KAAKoD,KAAKR,GAAW,KAC5D,IAGfjD,cAAcwF,GAGb,OAFanF,KAAKqF,uBACLF,EAAQE,uBAItB1F,aAAawF,GAGZ,OAFanF,KAAKqF,uBACLF,EAAQE,uBAItB1F,QAAQ4F,GACP,OAAO,IAAInB,EAAM,IAAIpB,EAAKhD,KAAKyD,KAAKR,EAAGjD,KAAKyD,KAAKP,EAAGlD,KAAKyD,KAAKN,EAAInD,KAAKyD,KAAKN,EAAIoC,EAAQvF,KAAKyD,KAAKZ,IAGnGlD,OAAO4F,GACN,OAAO,IAAInB,EAAM,IAAIpB,EAAKhD,KAAKyD,KAAKR,EAAGjD,KAAKyD,KAAKP,EAAGlD,KAAKyD,KAAKN,EAAInD,KAAKyD,KAAKN,EAAIoC,EAAQvF,KAAKyD,KAAKZ,IAGnGlD,YAAY4F,GACX,MAAM7C,EAAEA,EAACC,EAAEA,EAACC,EAAEA,EAACC,EAAEA,GAAM7C,KAAKoD,KAC5B,OAAO,IAAIgB,EAAM,IAAI3B,EAAKC,EAAGC,EAAGC,EAAGC,EAAI0C,IAGxC5F,gBACC,OAAuB,IAAhBK,KAAKoD,KAAKP,EAGlBlD,WACC,OAAuB,IAAhBK,KAAKoD,KAAKP,EAGlBlD,WACC,OAAO,IAAIyE,EAAM,IAAI3B,EAAK,IAAMzC,KAAKoD,KAAKV,EAAG,IAAM1C,KAAKoD,KAAKT,EAAG,IAAM3C,KAAKoD,KAAKR,EAAG5C,KAAKoD,KAAKP,IAG9FlD,MAAMsE,GACL,MAAMb,EAAOa,EAAEb,KAGToC,EAAQxF,KAAKoD,KAAKP,EAClB4C,EAASrC,EAAKP,EAEdA,EAAI2C,EAAQC,GAAU,EAAID,GAChC,GAAI3C,EAAI,KACP,OAAOuB,EAAMsB,YAGd,MAAMhD,EAAI1C,KAAKoD,KAAKV,EAAI8C,EAAQ3C,EAAIO,EAAKV,EAAI+C,GAAU,EAAID,GAAS3C,EAC9DF,EAAI3C,KAAKoD,KAAKT,EAAI6C,EAAQ3C,EAAIO,EAAKT,EAAI8C,GAAU,EAAID,GAAS3C,EAC9DD,EAAI5C,KAAKoD,KAAKR,EAAI4C,EAAQ3C,EAAIO,EAAKR,EAAI6C,GAAU,EAAID,GAAS3C,EAEpE,OAAO,IAAIuB,EAAM,IAAI3B,EAAKC,EAAGC,EAAGC,EAAGC,IAGpClD,WAAWgG;AACV,MAAMC,EAAaD,EAAYE,YAAY,CAACC,EAAaZ,IACjDd,EAAM2B,SAASb,EAAOY,IAE9B,OAAO1B,EAAM2B,SAAS/F,KAAM4F,GAGrBjG,gBAAgBqG,EAAmBJ,GAC1C,MAAMK,EAAkB,EAAID,EAAW5C,KAAKP,EAC5C,OAAO,IAAIuB,EAAM,IAAI3B,EACpBwD,EAAkBL,EAAWxC,KAAKV,EAAIsD,EAAW5C,KAAKP,EAAImD,EAAW5C,KAAKV,EAC1EuD,EAAkBL,EAAWxC,KAAKT,EAAIqD,EAAW5C,KAAKP,EAAImD,EAAW5C,KAAKT,EAC1EsD,EAAkBL,EAAWxC,KAAKR,EAAIoD,EAAW5C,KAAKP,EAAImD,EAAW5C,KAAKR,IAI5EjD,WACC,MAAO,GAAKyE,EAAMM,OAAOC,IAAIuB,OAAOlG,MAGrCL,uBAAuBwG,EAAWC,EAAiBb,GAClD,GAAIY,EAAGE,cAAcD,GACpB,OAAOD,EAERZ,EAASA,GAAkB,GAC3B,MAAMH,EAAOe,EAAGd,uBACVC,EAAOc,EAASf,uBAEtB,OADAE,EAASA,GAAUD,EAAOF,GAAQE,EAC3Ba,EAAGG,QAAQf,GAGnB5F,sBAAsBwG,EAAWC,EAAiBb,GACjD,GAAIY,EAAGI,aAAaH,GACnB,OAAOD,EAERZ,EAASA,GAAkB,GAC3B,MAAMH,EAAOe,EAAGd,uBAGhB,OADAE,EAASA,GAAUH,EADNgB,EAASf,wBACYD,EAC3Be,EAAGK,OAAOjB,IAGFnB,EAAAqC,MAAQ,IAAIrC,EAAM,IAAI3B,EAAK,IAAK,IAAK,IAAK,IAC1C2B,EAAAsC,MAAQ,IAAItC,EAAM,IAAI3B,EAAK,EAAG,EAAG,EAAG,IACpC2B,EAAAS,IAAM,IAAIT,EAAM,IAAI3B,EAAK,IAAK,EAAG,EAAG,IACpC2B,EAAAuC,KAAO,IAAIvC,EAAM,IAAI3B,EAAK,EAAG,EAAG,IAAK,IACrC2B,EAAAwC,MAAQ,IAAIxC,EAAM,IAAI3B,EAAK,EAAG,IAAK,EAAG,IACtC2B,EAAAyC,KAAO,IAAIzC,EAAM,IAAI3B,EAAK,EAAG,IAAK,IAAK,IACvC2B,EAAA0C,UAAY,IAAI1C,EAAM,IAAI3B,EAAK,IAAK,IAAK,IAAK,IAC9C2B,EAAAsB,YAAc,IAAItB,EAAM,IAAI3B,EAAK,EAAG,EAAG,EAAG,IAnM3DhC,EAAA2D,MAAAA,EAsMA,SAAiBA,GAChB,IAAiBM,GAAjB,SAAiBA,GAChB,IAAiBC,GAAjB,SAAiBA,GA0BhB,SAASoC,EAAeC,GACvB,MAAMtE,EAAIsE,EAAEC,SAAS,IACrB,OAAoB,IAAbvE,EAAEpE,OAAe,IAAMoE,EAAIA,EAkGnC,SAASwE,EAAeC,GACvB,OAAQA,GACP,KAAA,GAAsB,OAAO,EAC7B,KAAA;AAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GAAsB,OAAO,EAC7B,KAAA,GACA,KAAA,GAAiB,OAAO,GACxB,KAAA,GACA,KAAA,GAAiB,OAAO,GACxB,KAAA,GACA,KAAA,GAAiB,OAAO,GACxB,KAAA,IACA,KAAA,GAAiB,OAAO,GACxB,KAAA,IACA,KAAA,GAAiB,OAAO,GACxB,KAAA,IACA,KAAA,GAAiB,OAAO,GAEzB,OAAO,EArJQxC,EAAAyC,UAAhB,SAA0BlC,GACzB,OAAqB,IAAjBA,EAAM9B,KAAKP,SACAqC,EAAM9B,KAAKV,MAAMwC,EAAM9B,KAAKT,MAAMuC,EAAM9B,KAAKR,KAGrDwB,EAAMM,OAAOC,IAAI0C,WAAWnC,IAGpBP,EAAA0C,WAAhB,SAA2BnC,GAC1B,cAAeA,EAAM9B,KAAKV,MAAMwC,EAAM9B,KAAKT,MAAMuC,EAAM9B,KAAKR,OAAQsC,EAAM9B,KAAO,EAACkE,QAAQ,OAG3E3C,EAAA4C,UAAhB,SAA0BrC,GACzB,OAAqB,IAAjBA,EAAMzB,KAAKZ,SACAqC,EAAMzB,KAAKR,OAAsB,IAAfiC,EAAMzB,KAAKP,GAASoE,QAAQ,SAAwB,IAAfpC,EAAMzB,KAAKN,GAASmE,QAAQ,OAG3FlD,EAAMM,OAAOC,IAAI6C,WAAWtC,IAGpBP,EAAA6C,WAAhB,SAA2BtC,GAC1B,cAAeA,EAAMzB,KAAKR,OAAsB,IAAfiC,EAAMzB,KAAKP,GAASoE,QAAQ,SAAwB,IAAfpC,EAAMzB,KAAKN,GAASmE,QAAQ,QAAQpC,EAAMzB,KAAKZ,EAAEyE,QAAQ,OAWhH3C,EAAA8C,UAAhB,SAA0BvC,GACzB,UAAW6B,EAAe7B,EAAM9B,KAAKV,KAAKqE,EAAe7B,EAAM9B,KAAKT,KAAKoE,EAAe7B,EAAM9B,KAAKR,MAOpF+B,EAAA+C,WAAhB,SAA2BxC,EAAcyC,GAAU;AAClD,OAAIA,GAA4B,IAAjBzC,EAAM9B,KAAKP,EAClBuB,EAAMM,OAAOC,IAAI8C,UAAUvC,OAGxB6B,EAAe7B,EAAM9B,KAAKV,KAAKqE,EAAe7B,EAAM9B,KAAKT,KAAKoE,EAAe7B,EAAM9B,KAAKR,KAAKmE,EAAezE,KAAKE,MAAqB,IAAf0C,EAAM9B,KAAKP,OAM9H8B,EAAAuB,OAAhB,SAAuBhB,GACtB,OAAKA,EAIDA,EAAM0C,WACFxD,EAAMM,OAAOC,IAAI8C,UAAUvC,GAG5Bd,EAAMM,OAAOC,IAAI0C,WAAWnC,GAP3B,MAeOP,EAAAC,SAAhB,SAAyBH,GACxB,IAAKA,EAEJ,OAAO,KAGR,MAAMnG,EAASmG,EAAInG,OAEnB,GAAe,IAAXA,EAEH,OAAO,KAGR,GAAqB,KAAjBmG,EAAIoD,WAAW,GAElB,OAAO,KAGR,GAAe,IAAXvJ,EAAc,CAEjB,MAAMoE,EAAI,GAAKwE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IAC3ElF,EAAI,GAAKuE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IAC3EjF,EAAI,GAAKsE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IACjF,OAAO,IAAIzD,EAAM,IAAI3B,EAAKC,EAAGC,EAAGC,EAAG,IAGpC,GAAe,IAAXtE,EAAc,CAEjB,MAAMoE,EAAI,GAAKwE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IAC3ElF,EAAI,GAAKuE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IAC3EjF,EAAI,GAAKsE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IAC3EhF,EAAI,GAAKqE,EAAezC,EAAIoD,WAAW,IAAMX,EAAezC,EAAIoD,WAAW,IACjF,OAAO,IAAIzD,EAAM,IAAI3B,EAAKC,EAAGC,EAAGC,EAAGC,EAAI,MAGxC,GAAe,IAAXvE,EAAc,CAEjB,MAAMoE,EAAIwE,EAAezC,EAAIoD,WAAW,IAClClF,EAAIuE,EAAezC,EAAIoD,WAAW,IAClCjF,EAAIsE,EAAezC,EAAIoD,WAAW,IACxC,OAAO,IAAIzD,EAAM,IAAI3B,EAAK,GAAKC,EAAIA,EAAG,GAAKC,EAAIA,EAAG,GAAKC,EAAIA,IAG5D,GAAe,IAAXtE,EAAc,CAEjB,MAAMoE,EAAIwE,EAAezC,EAAIoD,WAAW,IAClClF,EAAIuE,EAAezC,EAAIoD,WAAW,IAClCjF,EAAIsE,EAAezC,EAAIoD,WAAW,IAClChF,EAAIqE,EAAezC,EAAIoD,WAAW,IACxC,OAAO,IAAIzD,EAAM,IAAI3B,EAAK,GAAKC,EAAIA,EAAG,GAAKC,EAAIA,EAAG,GAAKC,EAAIA,GAAI,GAAKC,EAAIA,GAAK;AAI9E,OAAO,MA3HT,CAAiB8B,EAAAD,EAAAC,MAAAD,EAAAC,SADlB,CAAiBD,EAAAN,EAAAM,SAAAN,EAAAM,YADlB,CAAiBN,EAAA3D,EAAA2D,QAAA3D,EAAA2D,8DChcjB,SAAgB0D,EAAgBC,GAC/B,MAAO,CAAChG,EAAaZ,EAAa6G,KACjC,IAAIC,EAAuB,KACvBC,EAAsB,KAU1B,GARgC,mBAArBF,EAAWrH,OACrBsH,EAAQ,QACRC,EAAKF,EAAWrH,OACoB,mBAAnBqH,EAAWG,MAC5BF,EAAQ,MACRC,EAAKF,EAAWG,MAGZD,EACJ,MAAM,IAAIrH,MAAM,iBAGjBmH,EAAWC,GAAUF,EAAMG,EAAI/G,qDAjBjCV,EAAAqH,gBAAAA,EAqBArH,EAAA2H,QAAA,SAAwBrG,EAAaZ,EAAa6G,GACjD,IAAIC,EAAuB,KACvBC,EAAsB,KAc1B,GAZgC,mBAArBF,EAAWrH,OACrBsH,EAAQ,QAGW,KAFnBC,EAAKF,EAAWrH,OAERrC,QACP+J,QAAQC,KAAK,kEAEsB,mBAAnBN,EAAWG,MAC5BF,EAAQ,MACRC,EAAKF,EAAWG,MAGZD,EACJ,MAAM,IAAIrH,MAAM,iBAGjB,MAAM0H,cAAyBpH,IAE/B6G,EAAWC,GAAU,YAAaO,GAUjC,OATKxI,KAAKc,eAAeyH,IACxBxH,OAAO0H,eAAezI,KAAMuI,GAC3BG,cAAc,EACdC,YAAY,EACZC,UAAU,EACVjI,MAAOuH,EAAIW,MAAM7I,KAAMwI,KAIlBxI,KAAKuI,KAQd9H,EAAAqI,SAAA,SAA4BC,EAAeC,EAA8BC,GACxE,OAAOnB,EAAgB,CAACI,EAAI/G,KAC3B,MAAM+H,eAAwB/H,IACxBgI,sBAAgChI,IAEtC,OAAO,YAAwBqH,GACzBxI,KAAKmJ,KACTnJ,KAAKmJ,GAAaF,EAAuBA,SAAyBG,GAGnEC,aAAarJ,KAAKkJ;AAEdF,IACHhJ,KAAKmJ,GAAaH,EAAQhJ,KAAKmJ,MAAeX,GAC9CA,GAAQxI,KAAKmJ,KAGdnJ,KAAKkJ,GAAYI,WAAW,KAC3BpB,EAAGW,MAAM7I,KAAMwI,GACfxI,KAAKmJ,GAAaF,EAAuBA,SAAyBG,GAChEL,yDCsDN,SAAgBQ,EAAuBC,GACtC,OAAOA,aAAiB3I,OAAS2I,EAAMC,OAASC,GAAgBF,EAAM5I,UAAY8I,yDA/HtEC,EAIZhK,cAECK,KAAK4J,aAEL5J,KAAK6J,uBAAyB,SAAU7K,GACvCsK,WAAW,KACV,GAAItK,EAAE8K,MACL,MAAM,IAAIjJ,MAAM7B,EAAE4B,QAAU,OAAS5B,EAAE8K,OAGxC,MAAM9K,GACJ,IAIEW,YAAYoK,GAGlB,OAFA/J,KAAK4J,UAAU/J,KAAKkK,GAEb,KACN/J,KAAKgK,gBAAgBD,IAIfpK,KAAKX,GACZgB,KAAK4J,UAAUpI,QAASuI,IACvBA,EAAS/K,KAIHW,gBAAgBoK,GACvB/J,KAAK4J,UAAUK,OAAOjK,KAAK4J,UAAUM,QAAQH,GAAW,GAGlDpK,0BAA0BwK,GAChCnK,KAAK6J,uBAAyBM,EAGxBxK,4BACN,OAAOK,KAAK6J,uBAGNlK,kBAAkBX,GACxBgB,KAAK6J,uBAAuB7K,GAC5BgB,KAAKoK,KAAKpL,GAIJW,0BAA0BX,GAChCgB,KAAK6J,uBAAuB7K,IApD9ByB,EAAAkJ,aAAAA,EAwDalJ,EAAA4J,aAAe,IAAIV,EAEhClJ,EAAA6J,0BAAA,SAA0CH,GACzC1J,EAAA4J,aAAaC,0BAA0BH;AAGxC1J,EAAA8J,kBAAA,SAAkCvL,GAE5BuK,EAAuBvK,IAC3ByB,EAAA4J,aAAaE,kBAAkBvL,IAKjCyB,EAAA+J,0BAAA,SAA0CxL,GAEpCuK,EAAuBvK,IAC3ByB,EAAA4J,aAAaG,0BAA0BxL,IAczCyB,EAAAgK,+BAAA,SAA+CjB,GAC9C,GAAIA,aAAiB3I,MAAO,CAC3B,IAAI4I,KAAEA,EAAI7I,QAAEA,GAAY4I,EAExB,OACCkB,UAAU,EACVjB,KAAAA,EACA7I,QAAAA,EACAkJ,MAL2BN,EAAOmB,YAAoBnB,EAAOM,OAU/D,OAAON,GAqBR,MAAME,EAAe,WAKrBjJ,EAAA8I,uBAAAA,EAOA9I,EAAAmK,SAAA,WACC,MAAMpB,EAAQ,IAAI3I,MAAM6I,GAExB,OADAF,EAAMC,KAAOD,EAAM5I,QACZ4I,GAGR/I,EAAAoK,gBAAA,SAAgCpB,GAC/B,OAAIA,EACI,IAAI5I,2BAA2B4I,KAE/B,IAAI5I,MAAM,qBAInBJ,EAAAqK,aAAA,SAA6BrB,GAC5B,OAAIA,EACI,IAAI5I,wBAAwB4I,KAE5B,IAAI5I,MAAM,kBAInBJ,EAAAsK,SAAA,SAAyBtB,GACxB,OAAOA,EACJ,IAAI5I,4BAA4B4I,wBAChC,IAAI5I,MAAM,wCAGdJ,EAAAuK,SAAA,SAAyBC,GACxB,MAAM9M,EAAS,IAAI0C,SAASoK,uBAE5B,OADA9M,EAAOsL,KAAO,WACPtL,GAGRsC,EAAAyK,gBAAA,SAAgCC,GAC/B,OAAKA,EAIDA,EAAIvK,QACAuK,EAAIvK,QAGRuK,EAAIrB,MACAqB,EAAIrB,MAAMsB,MAAM,MAAM,GAGvBC,OAAOF,GAXN;qVChHT,SAAgBG,EAAqBC,EAAyBjI,GAC7D,IAAIkI,EAAM,EAAGC,EAAOF,EAAMjN,OAC1B,GAAa,IAATmN,EACH,OAAO,EAER,KAAOD,EAAMC,GAAM,CAClB,MAAMC,EAAMpJ,KAAKqJ,OAAOH,EAAMC,GAAQ,GAClCnI,EAAEiI,EAAMG,IACXD,EAAOC,EAEPF,EAAME,EAAM,EAGd,OAAOF,EASR,SAAgBI,EAAajK,EAAWkK,GAEvC,OADAC,EAAMnK,EAAMkK,EAAS,EAAGlK,EAAKrD,OAAS,MAC/BqD,EAyBR,SAASmK,EAASjJ,EAAQgJ,EAAqBE,EAAYC,EAAYC,GACtE,GAAID,GAAMD,EACT,OAED,MAAML,EAAMK,GAAOC,EAAKD,GAAM,EAAK,EACnCD,EAAMjJ,EAAGgJ,EAASE,EAAIL,EAAKO,GAC3BH,EAAMjJ,EAAGgJ,EAASH,EAAM,EAAGM,EAAIC,GAC3BJ,EAAQhJ,EAAE6I,GAAM7I,EAAE6I,EAAM,KAAO,GA7BpC,SAAmB7I,EAAQgJ,EAAqBE,EAAYL,EAAaM,EAAYC,GACpF,IAAIC,EAAUH,EAAII,EAAWT,EAAM,EACnC,IAAK,IAAItN,EAAI2N,EAAI3N,GAAK4N,EAAI5N,IACzB6N,EAAI7N,GAAKyE,EAAEzE,GAEZ,IAAK,IAAIA,EAAI2N,EAAI3N,GAAK4N,EAAI5N,IACrB8N,EAAUR,EAEb7I,EAAEzE,GAAK6N,EAAIE,KACDA,EAAWH,EAErBnJ,EAAEzE,GAAK6N,EAAIC,KACDL,EAAQI,EAAIE,GAAWF,EAAIC,IAAY,EAEjDrJ,EAAEzE,GAAK6N,EAAIE,KAGXtJ,EAAEzE,GAAK6N,EAAIC,KAkBbE,CAAOvJ,EAAGgJ,EAASE,EAAIL,EAAKM,EAAIC,GAyBjC,SAAgBI,EAAcC,EAA0BC,EAAyBV,GAGhF,SAASW,EAAWC,EAAeC,EAAqBC,GACvD,GAAoB,IAAhBD,GAAyC,IAApBC,EAASrO,OACjC,OAGD,MAAMsO,EAASzO,EAAOA,EAAOG,OAAS,GAElCsO,GAAUA,EAAOH,MAAQG,EAAOF,cAAgBD,GACnDG,EAAOF,aAAeA,EACtBE,EAAOD,SAAS9M,QAAQ8M,IAExBxO,EAAO0B,MAAO4M,MAAAA,EAAOC,YAAAA,EAAaC,SAAAA,IAbpC,MAAMxO,KAiBN,IAAI0O,EAAY,EACZC,EAAW,EAEf,OAAa;AACZ,GAAID,IAAcP,EAAOhO,OAAQ,CAChCkO,EAAWK,EAAW,EAAGN,EAAMxM,MAAM+M,IACrC,MAED,GAAIA,IAAaP,EAAMjO,OAAQ,CAC9BkO,EAAWK,EAAWP,EAAOhO,OAASuO,MACtC,MAGD,MAAME,EAAgBT,EAAOO,GACvBG,EAAeT,EAAMO,GACrB9F,EAAI6E,EAAQkB,EAAeC,GACvB,IAANhG,GAEH6F,GAAa,EACbC,GAAY,GACF9F,EAAI,GAEdwF,EAAWK,EAAW,MACtBA,GAAa,GACH7F,EAAI,IAEdwF,EAAWK,EAAW,GAAIG,IAC1BF,GAAY,GAId,OAAO3O,EA4ER,SAAS8O,EAAW1B,EAAyBM,EAAiC1N,EAAaC,EAAW2F,GACrG,IAAK,MAAMiD,EAAI7I,EAAOG,OAAQF,EAAI2F,EAAG3F,IAAK,CACzC,MAAM0D,EAAUyJ,EAAMnN,GACtB,GAAIyN,EAAQ/J,EAAS3D,EAAO6I,EAAI,IAAM,EAAG,CACxC7I,EAAO+O,MACP,MAAMC,EAAI7B,EAAkBnN,EAAQa,GAAK6M,EAAQ/J,EAAS9C,GAAK,GAC/Db,EAAO8L,OAAOkD,EAAG,EAAGrL,KA4FvB,SAAgBsL,EAAc7B,EAAyBrD,GACtD,IAAK,IAAI9J,EAAI,EAAGA,EAAImN,EAAMjN,OAAQF,IAAK,CAGtC,GAAI8J,EAFYqD,EAAMnN,IAGrB,OAAOA,EAIT,OAAQ,mDAxXTqC,EAAA4M,KAAA,SAAwB9B,EAAqBvE,EAAY,GACxD,OAAOuE,EAAMA,EAAMjN,QAAU,EAAI0I,KAGlCvG,EAAA6M,MAAA,SAAyBC,GACxB,GAAmB,IAAfA,EAAIjP,OACP,MAAM,IAAIuC,MAAM,qBAGjB,OAAQ0M,EAAIxN,MAAM,EAAGwN,EAAIjP,OAAS,GAAIiP,EAAIA,EAAIjP,OAAS,KAGxDmC,EAAAuE,OAAA,SAA0BwI,EAAmCzI,EAAqC0I,EAAsC,EAAC5K,EAAGD,IAAMC,IAAMD,IACvJ,GAAI4K,IAAQzI,EACX,OAAO,EAGR,IAAKyI,IAAQzI,EACZ,OAAO,EAGR,GAAIyI,EAAIlP,SAAWyG,EAAMzG,OACxB,OAAO,EAGR,IAAK,IAAIF,EAAI,EAAGC,EAAMmP,EAAIlP,OAAQF,EAAIC,EAAKD,IAC1C,IAAKqP,EAAWD,EAAIpP,GAAI2G,EAAM3G,IAC7B,OAAO,EAIT,OAAO,GAGRqC,EAAAiN,aAAA,SAAgCnC,EAAyBpK,EAAQwM,GAChE,IAAInC,EAAM,EACTC,EAAOF,EAAMjN,OAAS,EAEvB,KAAOkN,GAAOC,GAAM,CACnB,MAAMC,GAAQF,EAAMC,GAAQ,EAAK,EAC3BmC,EAAOD,EAAWpC,EAAMG,GAAMvK,GACpC,GAAIyM,EAAO,EACVpC,EAAME,EAAM,MACN,CAAA,KAAIkC,EAAO,GAGjB,OAAOlC,EAFPD,EAAOC,EAAM,GAKf,QAASF,EAAM,IAQhB/K,EAAA6K,kBAAAA,EAsBA7K,EAAAmL,UAAAA,EA4CAnL,EAAAiB,QAAA,SAA2BC,EAAwBkK,GAClD,MAAM1N,KACN,IAAI0P,OAAgCzE;CACpC,IAAK,MAAMtH,KAAW8J,EAAUjK,EAAK5B,MAAM,GAAI8L,GACzCgC,GAAsD,IAAtChC,EAAQgC,EAAa,GAAI/L,GAI7C+L,EAAahO,KAAKiC,IAHlB+L,GAAgB/L,GAChB3D,EAAO0B,KAAKgO,IAKd,OAAO1P,GAURsC,EAAA4L,WAAAA,EAwDA5L,EAAAqD,MAAA,SAAyBwI,EAA0BC,EAAyBV,GAC3E,MAAMiC,EAAUzB,EAAWC,EAAQC,EAAOV,GACpCkC,KACAC,KAEN,IAAK,MAAM/D,KAAU6D,EACpBC,EAAQlO,QAAQyM,EAAOvM,MAAMkK,EAAOwC,MAAOxC,EAAOwC,MAAQxC,EAAOyC,cACjEsB,EAAMnO,QAAQoK,EAAO0C,UAGtB,OAASoB,QAAAA,EAASC,MAAAA,IAanBvN,EAAAN,IAAA,SAAuBoL,EAAyBM,EAAiC7E,GAChF,GAAU,IAANA,EACH,SAED,MAAM7I,EAASoN,EAAMxL,MAAM,EAAGiH,GAAGiH,KAAKpC,GAEtC,OADAoB,EAAQ1B,EAAOM,EAAS1N,EAAQ6I,EAAGuE,EAAMjN,QAClCH,GAgBRsC,EAAAyN,SAAA,SAA4B3C,EAAYM,EAAiC7E,EAAWmH,EAAeC,GAClG,OAAU,IAANpH,EACIqH,QAAQC,YAGT,IAAID,QAAQ,CAACC,EAASC,KAC5B,KAAYC,EAAAxO,UAAA,OAAA,EAAA,YACX,MAAMyO,EAAIlD,EAAMjN,OACVH,EAASoN,EAAMxL,MAAM,EAAGiH,GAAGiH,KAAKpC,GACtC,IAAK,IAAIzN,EAAI4I,EAAGjD,EAAIzB,KAAKQ,IAAIkE,EAAImH,EAAOM,GAAIrQ,EAAIqQ,EAAGrQ,EAAI2F,EAAGA,EAAIzB,KAAKQ,IAAIiB,EAAIoK,EAAOM,GAAI,CAIrF,GAHIrQ,EAAI4I,UACD,IAAIqH,QAAQC,GAAWhF,WAAWgF,KAErCF,GAASA,EAAMM,wBAClB,MAAMC,EAAA/D,WAEPqC,EAAQ1B,EAAOM,EAAS1N,EAAQC,EAAG2F,GAEpC,OAAO5F,IAZR,GAcEyQ,KAAKN,EAASC,MAkBlB9N,EAAAoO,SAAA,SAA4BtD,GAC3B,OAAKA,EAGOA,EAAMuD,OAAO9P,KAAOA,GAFxBuM,GAQT9K,EAAAsO,gBAAA,SAAmCxD,GAClC,IAAKA,EACJ,OAED,IAAIyD,EAAK,EACT,IAAK,IAAI5Q,EAAI,EAAGA,EAAImN,EAAMjN,OAAQF,IAC3BmN,EAAMnN,KACXmN,EAAMyD,GAAMzD,EAAMnN,GAClB4Q,GAAM,GAGRzD,EAAMjN,OAAS0Q,GAMhBvO,EAAAwO,KAAA,SAAqB1D,EAAcrK,EAAc8N,GAChDzD,EAAMtB,OAAO+E,EAAI,EAAGzD,EAAMtB,OAAO/I,EAAM,GAAG,KAM3CT,EAAAyO,eAAA,SAA+BC,GAC9B,OAAQC,MAAMC,QAAQF,IAAuB,IAAfA,EAAI7Q;AAMnCmC,EAAA6O,gBAAA,SAAmCH,GAClC,OAAOC,MAAMC,QAAQF,IAAQA,EAAI7Q,OAAS,GAO3CmC,EAAA8O,SAAA,SAA4BhE,EAAyBiE,GACpD,IAAKA,EACJ,OAAOjE,EAAMuD,OAAO,CAAChN,EAAS2N,IACtBlE,EAAMrB,QAAQpI,KAAa2N,GAIpC,MAAMC,EAAoC3O,OAAOc,OAAO,MACxD,OAAO0J,EAAMuD,OAAQa,IACpB,MAAMxO,EAAMqO,EAAMG,GAClB,OAAID,EAAKvO,KAITuO,EAAKvO,IAAO,GAEL,MAITV,EAAAmP,aAAA,SAAgCJ,GAC/B,MAAME,EAAoC3O,OAAOc,OAAO,MAExD,OAAOC,IACN,MAAMX,EAAMqO,EAAM1N,GAElB,OAAI4N,EAAKvO,KAITuO,EAAKvO,IAAO,GACL,KAITV,EAAA2M,WAAAA,EAeA3M,EAAAc,MAAA,SAAyBgK,EAAyBrD,EAA0B2H,EAA0B,MACrG,MAAMC,EAAQ1C,EAAW7B,EAAOrD,GAChC,OAAO4H,EAAQ,EAAID,EAAgBtE,EAAMuE,IAG1CrP,EAAAsP,mBAAA,SAAsCvC,EAAuBzI,EAAyBC,EAAkC,EAACnC,EAAGD,IAAMC,IAAMD,IACvI,IAAIzE,EAAS,EAEb,IAAK,IAAIC,EAAI,EAAGC,EAAMiE,KAAKQ,IAAI0K,EAAIlP,OAAQyG,EAAMzG,QAASF,EAAIC,GAAO2G,EAAOwI,EAAIpP,GAAI2G,EAAM3G,IAAKA,IAC9FD,IAGD,OAAOA,GAGRsC,EAAAuP,QAAA,SAA2BzC,GAC1B,SAAiB0C,UAAU1C,IAK5B9M,EAAAyP,MAAA,SAAsB7L,EAAa2K,GAClC,IAAI9N,EAAqB,iBAAP8N,EAAkB3K,EAAM,EAExB,iBAAP2K,EACV9N,EAAOmD,GAEPnD,EAAO,EACP8N,EAAK3K,GAGN,MAAMlG,KAEN,GAAI+C,GAAQ8N,EACX,IAAK,IAAI5Q,EAAI8C,EAAM9C,EAAI4Q,EAAI5Q,IAC1BD,EAAO0B,KAAKzB,QAGb,IAAK,IAAIA,EAAI8C,EAAM9C,EAAI4Q,EAAI5Q,IAC1BD,EAAO0B,KAAKzB,GAId,OAAOD,GAGRsC,EAAA0P,KAAA,SAAwBC,EAAazP,EAAU4M,MAC9C,IAAK,IAAInP,EAAI,EAAGA,EAAIgS,EAAKhS,IACxBmP,EAAInP,GAAKuC,EAGV,OAAO4M,GAKR9M,EAAAqP,MAAA,SAA4BvE,EAAyB8E,EAA2BC,EAA4B9M,CAAAA,GAAKA,IAChH,OAAO+H,EAAMgF,OAAO,CAAC7N,EAAGc,KACvB,MAAMrC,EAAMkP,EAAQ7M,GAEpB,OADAd,EAAEvB,GAAOmP,EAAO9M,EAAGd,EAAEvB,IACduB,GACL3B,OAAOc,OAAO,QAOlBpB,EAAA+P,OAAA,SAA0BjF,EAAYzJ,GAGrC,OAFAyJ,EAAM1L,KAAKiC,GAEJ,KACN,MAAMgO,EAAQvE,EAAMrB,QAAQpI;CACxBgO,GAAS,GACZvE,EAAMtB,OAAO6F,EAAO,KASvBrP,EAAAgQ,YAAA,SAA+B1O,EAAa2O,EAAqBC,GAChE,MAAMrE,EAASvK,EAAOhC,MAAM,EAAG2Q,GACzBnE,EAAQxK,EAAOhC,MAAM2Q,GAC3B,OAAOpE,EAAO2D,OAAOU,EAAWpE,IAMjC9L,EAAAmQ,QAAA,SAA2BrF,EAAYsF,GACtC,IAAIC,EAEJ,GAAqB,iBAAVD,EAAoB,CAC9B,IAAIE,EAAOF,EAGXC,EAAO,MACN,MAAM5M,EAAuB,UAAnB5B,KAAK0O,IAAID,KACnB,OAAO7M,EAAI5B,KAAKqJ,MAAMzH,UAGvB4M,EAAOxO,KAAK2O,OAGb,IAAK,IAAI7S,EAAImN,EAAMjN,OAAS,EAAGF,EAAI,EAAGA,GAAK,EAAG,CAC7C,MAAM+O,EAAI7K,KAAKqJ,MAAMmF,KAAU1S,EAAI,IAC7B8S,EAAO3F,EAAMnN,GACnBmN,EAAMnN,GAAKmN,EAAM4B,GACjB5B,EAAM4B,GAAK+D,IAObzQ,EAAA0Q,YAAA,SAA+B5D,EAAU5M,GACxC,MAAMmP,EAAQvC,EAAIrD,QAAQvJ,GAEtBmP,GAAS,IACZvC,EAAItD,OAAO6F,EAAO,GAClBvC,EAAI6D,QAAQzQ,KAOdF,EAAA4Q,UAAA,SAA6B9D,EAAU5M,GACtC,MAAMmP,EAAQvC,EAAIrD,QAAQvJ,GAEtBmP,GAAS,IACZvC,EAAItD,OAAO6F,EAAO,GAClBvC,EAAI1N,KAAKc,KAIXF,EAAA6Q,KAAA,SAAwB/D,EAAmBgE,GAC1C,IAAK,IAAInT,EAAI,EAAGA,EAAImP,EAAIjP,OAAQF,IAAK,CACpC,MAAM0D,EAAUyL,EAAInP,GACpB,GAAImT,EAAUzP,EAAS1D,EAAGmP,GACzB,OAAOzL,IAOVrB,EAAA+Q,cAAA,SAAoCC,EAAgBvJ,GACnD,OAAOkH,MAAMC,QAAQoC,GACpBA,EAAMC,IAAIxJ,GACVA,EAAGuJ,wGChiBLhR,EAAAkR,KAAA,SAAoDzJ,GACnD,MAAM0J,EAAQ5R,KACd,IACI7B,EADA0T,GAAU,EAGd,OAAO,WACN,OAAIA,EACI1T,GAGR0T,GAAU,EACV1T,EAAS+J,EAAGW,MAAM+I,EAAOE,kHCHdrR,EAAAsR,KAAiCC,MAAM,EAAMrR,WAAOyI,GAOjE,IAAc6I,GAAd,SAAcA;AA8Db,SAAgBzQ,EAAW0Q,EAAuBhK,GACjD,IAAK,IAAIiK,EAAOD,EAASC,QAASA,EAAKH,KAAMG,EAAOD,EAASC,OAC5DjK,EAAGiK,EAAKxR,OA/DV,MAAMyR,GACLD,KAAI,IACI1R,EAAAsR,KAIOE,EAAAI,MAAhB,WACC,OAAOD,GAGQH,EAAAK,UAAhB,SAA6B/G,EAAYuE,EAAQ,EAAGxR,EAASiN,EAAMjN,QAClE,OACC6T,KAAI,IACCrC,GAASxR,EACLmC,EAAAsR,KAGCC,MAAM,EAAOrR,MAAO4K,EAAMuE,QAKtBmC,EAAA/Q,KAAhB,SAAwBqR,GACvB,OAAKA,EAEMnD,MAAMC,QAAQkD,GACjBN,EAASK,UAAUC,GAEnBA,EAJAN,EAASI,SAQFJ,EAAAP,IAAhB,SAA0BQ,EAAuBhK,GAChD,OACCvI,OACC,MAAMmC,EAAUoQ,EAASC,OACzB,OAAIrQ,EAAQkQ,KACJvR,EAAAsR,KAEEC,MAAM,EAAOrR,MAAOuH,EAAGpG,EAAQnB,WAM5BsR,EAAAnD,OAAhB,SAA0BoD,EAAuBhK,GAChD,OACCvI,OACC,OAAa,CACZ,MAAMmC,EAAUoQ,EAASC,OACzB,GAAIrQ,EAAQkQ,KACX,OAAOvR,EAAAsR,IAER,GAAI7J,EAAGpG,EAAQnB,OACd,OAASqR,MAAM,EAAOrR,MAAOmB,EAAQnB,WAO1BsR,EAAAzQ,QAAOA,EAMPyQ,EAAAO,QAAhB,SAA2BN,GAC1B,MAAM/T,KAEN,OADAqD,EAAQ0Q,EAAUvR,GAASxC,EAAO0B,KAAKc,IAChCxC,GAvET,CAAc8T,EAAAxR,EAAAwR,WAAAxR,EAAAwR,cA6EdxR,EAAAgS,oBAAA,SAAuCpO,GACtC,OAAI+K,MAAMC,QAAQhL,GACV4N,EAASK,UAAUjO,GAEnBA,SAQIqO,EAOZ/S,YAAY8R,EAAYhF,EAAgB,EAAGkG,EAAclB,EAAMnT,OAAQwR,EAAQrD,EAAQ,GACtFzM,KAAKyR,MAAQA,EACbzR,KAAKyM,MAAQA,EACbzM,KAAK2S,IAAMA,EACX3S,KAAK8P,MAAQA,EAGPnQ,QAEN,OADAK,KAAK8P,MAAQ9P,KAAKyM,MACXzM,KAAK4S,UAGNjT,OAEN,OADAK,KAAK8P,MAAQxN,KAAKQ,IAAI9C,KAAK8P,MAAQ,EAAG9P,KAAK2S,KACpC3S,KAAK4S,UAGHjT,UACT,OAAIK,KAAK8P,QAAU9P,KAAKyM,MAAQ,GAAKzM,KAAK8P,QAAU9P,KAAK2S,IACjD,KAGD3S,KAAKyR,MAAMzR,KAAK8P;AA7BzBrP,EAAAiS,cAAAA,QAiCaG,UAA0BH,EAEtC/S,YAAY8R,EAAYhF,EAAgB,EAAGkG,EAAclB,EAAMnT,OAAQwR,EAAQrD,EAAQ,GACtFqG,MAAMrB,EAAOhF,EAAOkG,EAAK7C,GAGnBnQ,UACN,OAAOmT,MAAMF,UAGPjT,WAEN,OADAK,KAAK8P,MAAQxN,KAAKS,IAAI/C,KAAK8P,MAAQ,EAAG9P,KAAKyM,MAAQ,GAC5CzM,KAAK4S,UAGNjT,QAEN,OADAK,KAAK8P,MAAQ9P,KAAKyM,MACXzM,KAAK4S,UAGNjT,OAEN,OADAK,KAAK8P,MAAQ9P,KAAK2S,IAAM,EACjB3S,KAAK4S,UAGNjT,SACN,OAAO,MA1BTc,EAAAoS,eAAAA,QA8BaE,EAEZpT,YAAsBuS,EAAsChK,GAAtClI,KAAAkS,SAAAA,EAAsClS,KAAAkI,GAAAA,EAI5DvI,OAAS,OAAOK,KAAKkI,GAAGlI,KAAKkS,SAASC,SANvC1R,EAAAsS,eAAAA,QAkBaC,UAA8BD,EAE1CpT,YAAsBsT,EAA0B/K,GAC/C4K,MAAMG,EAAW/K,GADIlI,KAAAiT,UAAAA,EAItBtT,UAAY,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAUL,WAC1CjT,WAAa,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAUC,YAC3CvT,SAAW,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAUxU,UACzCkB,QAAU,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAU1R,SACxC5B,OAAS,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAUE,QACvCxT,OAAS,OAAOK,KAAKkI,GAAGlI,KAAKiT,UAAUd,SAXxC1R,EAAAuS,gBAAAA,qDCQA,SAAgBI,EAAcC,EAAcC,GAAwB,GASnE,SAASC,EAAcjS,GACtB,IAAIkS,EAAS,EACT7S,EAAQ,EACZ,KAAO6S,EAASlS,GAAO,CACtB,MAAMmS,EAAKJ,EAAKxL,WAAW6L;CAC3B,GAAID,GAAE,IAAyBA,GAAE,GAChC9S,EAAgB,GAARA,EAAa8S,EAAE,QAEnB,GAAIA,GAAE,IAAwBA,GAAE,GACpC9S,EAAgB,GAARA,EAAa8S,EAAE,GAAsB,OAEzC,CAAA,KAAIA,GAAE,IAAwBA,GAAE,KAIpC,MAHA9S,EAAgB,GAARA,EAAa8S,EAAE,GAAsB,GAK9CC,IACAF,IAKD,OAHIA,EAASlS,IACZX,GAAS,GAEHA,EAmIR,SAASgT,IAOR,GALAhT,EAAQ,GACRiT,EAAS,EAETC,EAAcH,EAEVA,GAAOrV,EAGV,OADAwV,EAAcxV,EACP+P,EAAK,GAGb,IAAI0F,EAAOT,EAAKxL,WAAW6L,GAE3B,GAAIK,EAAaD,GAAO,CACvB,GACCJ,IACA/S,GAAS0K,OAAO2I,aAAaF,GAC7BA,EAAOT,EAAKxL,WAAW6L,SACfK,EAAaD,IAEtB,OAAO1F,EAAK,GAIb,GAAI6F,EAAYH,GAOf,OANAJ,IACA/S,GAAS0K,OAAO2I,aAAaF,GACrB,KAAJA,GAA8D,KAApBT,EAAKxL,WAAW6L,KAC7DA,IACA/S,GAAS,MAEHyN,EAAK,GAGb,OAAQ0F,GAEP,KAAA,IAEC,OADAJ,IACOtF,EAAK,EACb,KAAA,IAEC,OADAsF,IACOtF,EAAK,EACb,KAAA,GAEC,OADAsF,IACOtF,EAAK,EACb,KAAA,GAEC,OADAsF,IACOtF,EAAK,EACb,KAAA,GAEC,OADAsF,IACOtF,EAAK,EACb,KAAA,GAEC,OADAsF,IACOtF,EAAK,EAGb,KAAA,GAGC,OAFAsF,IACA/S,EA3IH,WAEC,IAAIxC,EAAS,GACZsO,EAAQiH,EAET,OAAa,CACZ,GAAIA,GAAOrV,EAAK,CACfF,GAAUkV,EAAKa,UAAUzH,EAAOiH,GAChCE,EAAS,EACT,MAED,IAAIH,EAAKJ,EAAKxL,WAAW6L,GACzB,GAAM,KAAFD,EAAmC,CACtCtV,GAAUkV,EAAKa,UAAUzH,EAAOiH,GAChCA,IACA,MAED,GAAM,KAAFD,EAAJ,CA+CA,GAAIA,GAAM,GAAKA,GAAM,GAAM,CAC1B,GAAIQ,EAAYR,GAAK,CACpBtV,GAAUkV,EAAKa,UAAUzH,EAAOiH,GAChCE,EAAS,EACT,MAEAA,EAAS,EAIXF,QAzDA,CAGC,GAFAvV,GAAUkV,EAAKa,UAAUzH,EAAOiH,KAChCA,GACWrV,EAAK,CACfuV,EAAS,EACT,MAGD,OADAH,EAAKJ,EAAKxL,WAAW6L,MAEpB,KAAA,GACCvV,GAAU,IACV,MACD,KAAA,GACCA,GAAU,KACV,MACD,KAAA,GACCA,GAAU,IACV,MACD,KAAA,GACCA,GAAU,KACV,MACD,KAAA,IACCA,GAAU,KACV,MACD,KAAA,IACCA,GAAU,KACV,MACD,KAAA,IACCA,GAAU,KACV,MACD,KAAA,IACCA,GAAU,KACV;CACD,KAAA,IACC,MAAMsV,EAAKF,EAAc,GACrBE,GAAM,EACTtV,GAAUkN,OAAO2I,aAAaP,GAE9BG,EAAS,EAEV,MACD,QACCA,EAAS,EAEXnH,EAAQiH,GAeV,OAAOvV,EA+DGgW,GACD/F,EAAK,GAGb,KAAA,GACC,MAAM3B,EAAQiH,EAAM,EAEpB,GAA4B,KAAxBL,EAAKxL,WAAW6L,EAAM,GAA6B,CAGtD,IAFAA,GAAO,EAEAA,EAAMrV,IACR4V,EAAYZ,EAAKxL,WAAW6L,KAGhCA,IAID,OADA/S,EAAQ0S,EAAKa,UAAUzH,EAAOiH,GACvBtF,EAAK,GAIb,GAA4B,KAAxBiF,EAAKxL,WAAW6L,EAAM,GAAgC,CACzDA,GAAO,EAEP,MAAMU,EAAa/V,EAAM,EACzB,IAAIgW,GAAgB,EACpB,KAAOX,EAAMU,GAAY,CAGxB,GAAM,KAFKf,EAAKxL,WAAW6L,IAEmC,KAAxBL,EAAKxL,WAAW6L,EAAM,GAA6B,CACxFA,GAAO,EACPW,GAAgB,EAChB,MAEDX,IASD,OANKW,IACJX,IACAE,EAAS,GAGVjT,EAAQ0S,EAAKa,UAAUzH,EAAOiH,GACvBtF,EAAK,GAKb,OAFAzN,GAAS0K,OAAO2I,aAAaF,GAC7BJ,IACOtF,EAAK,GAGb,KAAA,GAGC,GAFAzN,GAAS0K,OAAO2I,aAAaF,KAC7BJ,IACYrV,IAAQiW,EAAQjB,EAAKxL,WAAW6L,IAC3C,OAAOtF,EAAK,GAKd,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GAEC,OADAzN,GA3PH,WACC,MAAM8L,EAAQiH,EACd,GAAwB,KAApBL,EAAKxL,WAAW6L,GACnBA,SAGA,IADAA,IACOA,EAAML,EAAK/U,QAAUgW,EAAQjB,EAAKxL,WAAW6L,KACnDA,IAGF,GAAIA,EAAML,EAAK/U,QAA8B,KAApB+U,EAAKxL,WAAW6L,GAA6B,CAErE,OADAA,EACUL,EAAK/U,QAAUgW,EAAQjB,EAAKxL,WAAW6L,KAOhD,OADAE,EAAS,EACFP,EAAKa,UAAUzH,EAAOiH,GAL7B,IADAA,IACOA,EAAML,EAAK/U,QAAUgW,EAAQjB,EAAKxL,WAAW6L,KACnDA,IAOH,IAAIf,EAAMe,EACV,GAAIA,EAAML,EAAK/U,SAA+B,KAApB+U,EAAKxL,WAAW6L,IAAiD,MAApBL,EAAKxL,WAAW6L,IAKtF,MAJAA,EACUL,EAAK/U,QAA8B,KAApB+U,EAAKxL,WAAW6L,IAAoD,KAApBL,EAAKxL,WAAW6L,KACxFA,IAEGA,EAAML,EAAK/U,QAAUgW,EAAQjB,EAAKxL,WAAW6L,IAAO;AAEvD,IADAA,IACOA,EAAML,EAAK/U,QAAUgW,EAAQjB,EAAKxL,WAAW6L,KACnDA,IAEDf,EAAMe,OAENE,EAAS,EAGX,OAAOP,EAAKa,UAAUzH,EAAOkG,GAqNlB4B,GACFnG,EAAK,GAEb,QAEC,KAAOsF,EAAMrV,GAqBhB,SAAmCyV,GAClC,GAAIC,EAAaD,IAASG,EAAYH,GACrC,OAAO,EAER,OAAQA,GACP,KAAA,IACA,KAAA,GACA,KAAA,IACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACA,KAAA,GACC,OAAO,EAET,OAAO,EApCeU,CAA0BV,IAC7CJ,IACAI,EAAOT,EAAKxL,WAAW6L,GAExB,GAAIG,IAAgBH,EAAK,CAGxB,OAFA/S,EAAQ0S,EAAKa,UAAUL,EAAaH,IAGnC,IAAK,OAAQ,OAAOtF,EAAK,EACzB,IAAK,QAAS,OAAOA,EAAK,EAC1B,IAAK,OAAQ,OAAOA,EAAK,EAE1B,OAAOA,EAAK,GAKb,OAFAzN,GAAS0K,OAAO2I,aAAaF,GAC7BJ,IACOtF,EAAK,IA1Tf,IAAIsF,EAAM,EACTrV,EAAMgV,EAAK/U,OACXqC,EAAgB,GAChBkT,EAAc,EACdzF,EAAK,GACLwF,EAAS,EAoVV,OACCa,YAzTD,SAAqBC,GACpBhB,EAAMgB,EACN/T,EAAQ,GACRkT,EAAc,EACdzF,EAAK,GACLwF,EAAS,GAqTTe,YAAa,IAAMjB,EACnBkB,KAAMtB,EAXP,WACC,IAAInV,EACJ,GACCA,EAASwV,UACDxV,GAAM,IAAoCA,GAAM,IACzD,OAAOA,GAMkCwV,EACzCkB,SAAU,IAAMzG,EAChB0G,cAAe,IAAMnU,EACrBoU,eAAgB,IAAMlB,EACtBmB,eAAgB,IAAMtB,EAAMG,EAC5BoB,cAAe,IAAMrB,GAIvB,SAASG,EAAaN,GACrB,OAAS,KAAFA,GAAiC,IAAFA,GAA+B,KAAFA,GAAuC,KAAFA,GACrG,MAAFA,GAA4C,OAAFA,GAA+BA,GAAE,MAA6BA,GAAE,MACxG,OAAFA,GAA8C,OAAFA,GAA6C,QAAFA,GAA4C,QAAFA,EAGnI,SAASQ,EAAYR,GACpB,OAAS,KAAFA,GAAoC,KAAFA,GAA0C,OAAFA,GAAyC,OAAFA,EAGzH,SAASa,EAAQb,GAChB,OAAOA,GAAE,IAAyBA,GAAE,GAwarC,SAAgByB,EAAYC,GAC3B,IAAKA,EAAK1W,SAAW0W,EAAK1W,OAAO2W,SAChC,SAED,MAAMC,EAAOH,EAAYC,EAAK1W,QAC9B,GAAyB,aAArB0W,EAAK1W,OAAO6W,KAAqB;AACpC,MAAMnU,EAAMgU,EAAK1W,OAAO2W,SAAS,GAAGzU,MACpC0U,EAAKxV,KAAKsB,QACJ,GAAyB,UAArBgU,EAAK1W,OAAO6W,KAAkB,CACxC,MAAMxF,EAAQqF,EAAK1W,OAAO2W,SAASlL,QAAQiL,IAC5B,IAAXrF,GACHuF,EAAKxV,KAAKiQ,GAGZ,OAAOuF,EAMR,SAAgBE,EAAaJ,GAC5B,OAAQA,EAAKG,MACZ,IAAK,QACJ,OAAOH,EAAKC,SAAU1D,IAAI6D,GAC3B,IAAK,SACJ,MAAMpG,EAAMpO,OAAOc,OAAO,MAC1B,IAAK,IAAI2T,KAAQL,EAAKC,SAAW,CAChC,MAAMK,EAAYD,EAAKJ,SAAU,GAC7BK,IACHtG,EAAIqG,EAAKJ,SAAU,GAAGzU,OAAS4U,EAAaE,IAG9C,OAAOtG,EACR,IAAK,OACL,IAAK,SACL,IAAK,SACL,IAAK,UACJ,OAAOgG,EAAKxU,MACb,QACC,QAKH,SAAgB+U,EAASP,EAAYQ,EAAgBC,GAAoB,GACxE,OAAQD,GAAUR,EAAKQ,QAAUA,EAAUR,EAAKQ,OAASR,EAAK7W,QAAYsX,GAAsBD,IAAYR,EAAKQ,OAASR,EAAK7W,OAMhI,SAAgBuX,EAAiBV,EAAYQ,EAAgBC,GAAoB,GAChF,GAAIF,EAASP,EAAMQ,EAAQC,GAAoB,CAC9C,MAAMR,EAAWD,EAAKC,SACtB,GAAIhG,MAAMC,QAAQ+F,GACjB,IAAK,IAAIhX,EAAI,EAAGA,EAAIgX,EAAS9W,QAAU8W,EAAShX,GAAGuX,QAAUA,EAAQvX,IAAK,CACzE,MAAM0X,EAAOD,EAAiBT,EAAShX,GAAIuX,EAAQC,GACnD,GAAIE,EACH,OAAOA,EAKV,OAAOX,GAST,SAAgBY,EAAM1C,EAAc2C,EAAsBC,EAAwBC,EAAaC,SAI9F,SAASC,EAAaC,GACrB,OAAOA,EAAgB,IAAMA,EAAcC,EAASvB,iBAAkBuB,EAAStB,kBAAoB,KAAM,EAE1G,SAASuB,EAAiBF,GACzB,OAAOA,EAAiBhS,GAAWgS,EAAchS,EAAKiS,EAASvB,iBAAkBuB,EAAStB,kBAAoB,KAAM,EAerH,SAASrB,IACR,OAAa,CACZ,MAAMvF,EAAQkI,EAAS1B,OACvB,OAAQ0B,EAASrB,iBAChB,KAAA,EACCuB,EAAW,IACX,MACD,KAAA,EACCA,EAAW,IACX,MACD,KAAA,EACCA,EAAW,IACX,MACD,KAAA,EACMC,GACJD,EAAW,IAEZ,MACD,KAAA,EACCA,EAAW,IACX,MACD,KAAA,EACCA,EAAW;AAGb,OAAQpI,GACP,KAAA,GACA,KAAA,GACKqI,EACHD,EAAW,IAEXE,IAED,MACD,KAAA,GACCF,EAAW,GACX,MACD,KAAA,GACA,KAAA,GACC,MACD,QACC,OAAOpI,IAKX,SAASoI,EAAYhN,EAAuBmN,KAAmCC,MAE9E,GADAC,EAAQrN,GACJmN,EAAerY,OAASsY,EAAUtY,OAAS,EAAG,CACjD,IAAI8P,EAAQkI,EAASzB,WACrB,KAAY,KAALzG,GAA0B,CAChC,IAAuC,IAAnCuI,EAAezM,QAAQkE,GAAe,CACzCuF,IACA,MACM,IAAkC,IAA9BiD,EAAU1M,QAAQkE,GAC5B,MAEDA,EAAQuF,MAKX,SAASmD,EAAYC,GACpB,MAAMpW,EAAQ2V,EAASxB,gBAOvB,OANIiC,EACHC,EAAerW,GAEfsW,EAAiBtW,GAElBgT,KACO,EAkCR,SAASuD,IACR,OAAuB,KAAnBZ,EAASzB,YACZ2B,EAAW,MAA0C,EAAA,KAC9C,IAERM,GAAY,GACW,IAAnBR,EAASzB,YACZsC,EAAY,KACZxD,IAEKyD,KACJZ,EAAW,MAAmC,EAAA,KAG/CA,EAAW,MAAmC,EAAA,KAExC,GAmER,SAASY,IACR,OAAQd,EAASzB,YAChB,KAAA,EACC,OAnCH,WACCwC,IACA1D,IAEA,IAAI2D,GAAa,EACjB,KAA0B,IAAnBhB,EAASzB,YAAkE,KAAnByB,EAASzB,YAA+B,CACtG,GAAuB,IAAnByB,EAASzB,YAMZ,GALKyC,GACJd,EAAW,SAEZW,EAAY,KACZxD,IACuB,IAAnB2C,EAASzB,YAA+C0C,EAC3D,WAESD,GACVd,EAAW,SAEPY,KACJZ,EAAW,MAAmC,EAAA,IAE/Cc,GAAa,EAQd,OANAE,IACuB,IAAnBlB,EAASzB,WACZ2B,EAAW,GAAsC,OAEjD7C,KAEM,EAME8D,GACR,KAAA,EACC,OArEH,WACCC,IACA/D,IAEA,IAAI2D,GAAa,EACjB,KAA0B,IAAnBhB,EAASzB,YAAgE,KAAnByB,EAASzB,YAA+B,CACpG,GAAuB,IAAnByB,EAASzB,YAMZ,GALKyC,GACJd,EAAW,SAEZW,EAAY,KACZxD,IACuB,IAAnB2C,EAASzB,YAA6C0C,EACzD,WAESD,GACVd,EAAW,SAEPU,KACJV,EAAW,MAAmC,EAAA,IAE/Cc,GAAa,EAQd,OANAK,IACuB,IAAnBrB,EAASzB,WACZ2B,EAAW,GAAoC,OAE/C7C,KAEM,EAwCEiE,GACR,KAAA,GACC,OAAOd,GAAY,GACpB;AACC,OA3HH,WACC,OAAQR,EAASzB,YAChB,KAAA,GACC,IAAIlU,EAAQ,EACZ,IAEsB,iBADrBA,EAAQkX,KAAKC,MAAMxB,EAASxB,oBAE3B0B,EAAW,GACX7V,EAAQ,GAER,MAAO3B,GACRwX,EAAW,GAEZQ,EAAerW,GACf,MACD,KAAA,EACCqW,EAAe,MACf,MACD,KAAA,EACCA,GAAe,GACf,MACD,KAAA,EACCA,GAAe,GACf,MACD,QACC,OAAO,EAGT,OADArD,KACO,EA+FEoE,IAzNV,MAAMzB,EAAWlD,EAAcC,GAAM,GAS/BqE,EAAgBtB,EAAaJ,EAAQ0B,eAC1CT,EAAmBV,EAAcP,EAAQiB,kBACzCU,EAAcvB,EAAaJ,EAAQ2B,aACnCN,EAAejB,EAAaJ,EAAQqB,cACpCG,EAAapB,EAAaJ,EAAQwB,YAClCR,EAAiBT,EAAcP,EAAQgB,gBACvCG,EAAcZ,EAAcP,EAAQmB,aACpCT,EAAYN,EAAaJ,EAAQU,WACjCG,EAAUN,EAAcP,EAAQa,SAE3BJ,EAAmBR,GAAWA,EAAQQ,iBACtCc,EAAqBtB,GAAWA,EAAQsB,mBA0M9C,OADA5D,IACuB,KAAnB2C,EAASzB,aAGRuC,KAIkB,KAAnBd,EAASzB,YACZ2B,EAAW,UAEL,IANNA,EAAW,UACJ,IA0CT,SAASwB,EAAmBrX,GAC3B,cAAeA,GACd,IAAK,UAAW,MAAO,UACvB,IAAK,SAAU,MAAO,SACtB,IAAK,SAAU,MAAO,SACtB,QAAS,MAAO,0DAvzClB,SAAkBsX,GACjBA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,uBAAA,GAAA,yBACAA,EAAAA,EAAA,sBAAA,GAAA,wBACAA,EAAAA,EAAA,sBAAA,GAAA,wBACAA,EAAAA,EAAA,eAAA,GAAA;AACAA,EAAAA,EAAA,uBAAA,GAAA,yBACAA,EAAAA,EAAA,iBAAA,GAAA,mBAPD,CAAkBxX,EAAAwX,YAAAxX,EAAAwX,gBAUlB,SAAkBC,GACjBA,EAAAA,EAAA,eAAA,GAAA,iBACAA,EAAAA,EAAA,gBAAA,GAAA,kBACAA,EAAAA,EAAA,iBAAA,GAAA,mBACAA,EAAAA,EAAA,kBAAA,GAAA,oBACAA,EAAAA,EAAA,WAAA,GAAA,aACAA,EAAAA,EAAA,WAAA,GAAA,aACAA,EAAAA,EAAA,YAAA,GAAA,cACAA,EAAAA,EAAA,YAAA,GAAA,cACAA,EAAAA,EAAA,aAAA,GAAA,eACAA,EAAAA,EAAA,cAAA,IAAA,gBACAA,EAAAA,EAAA,eAAA,IAAA,iBACAA,EAAAA,EAAA,kBAAA,IAAA,oBACAA,EAAAA,EAAA,mBAAA,IAAA,qBACAA,EAAAA,EAAA,gBAAA,IAAA,kBACAA,EAAAA,EAAA,OAAA,IAAA,SACAA,EAAAA,EAAA,QAAA,IAAA,UACAA,EAAAA,EAAA,IAAA,IAAA,MAjBD,CAAkBzX,EAAAyX,aAAAzX,EAAAyX,iBAiElB,SAAkBC,GACjBA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,oBAAA,GAAA,sBACAA,EAAAA,EAAA,qBAAA,GAAA,uBACAA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,cAAA,GAAA;AACAA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,mBAAA,GAAA,qBACAA,EAAAA,EAAA,qBAAA,GAAA,uBACAA,EAAAA,EAAA,kBAAA,GAAA,oBACAA,EAAAA,EAAA,oBAAA,IAAA,sBACAA,EAAAA,EAAA,uBAAA,IAAA,yBACAA,EAAAA,EAAA,sBAAA,IAAA,wBACAA,EAAAA,EAAA,sBAAA,IAAA,wBACAA,EAAAA,EAAA,eAAA,IAAA,iBACAA,EAAAA,EAAA,uBAAA,IAAA,yBACAA,EAAAA,EAAA,iBAAA,IAAA,mBAhBD,CAAkB1X,EAAA0X,iBAAA1X,EAAA0X,oBA6DlB,IAAiBjC,GAAjB,SAAiBA,GACHA,EAAAC,SACZoB,oBAAoB,GAFtB,CAAiBrB,EAAAzV,EAAAyV,eAAAzV,EAAAyV,kBAyDjBzV,EAAA2S,cAAAA,EAqXA,IAAWgF,GAAX,SAAWA,GACVA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,kBAAA,KAAA,oBAEAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,eAAA,IAAA,iBACAA,EAAAA,EAAA,cAAA,MAAA,gBACAA,EAAAA,EAAA,mBAAA,MAAA,qBAIAA,EAAAA,EAAA,SAAA,KAAA,WAGAA,EAAAA,EAAA,MAAA,IAAA;AACAA,EAAAA,EAAA,iBAAA,KAAA,mBACAA,EAAAA,EAAA,OAAA,MAAA,SACAA,EAAAA,EAAA,OAAA,MAAA,SACAA,EAAAA,EAAA,QAAA,MAAA,UACAA,EAAAA,EAAA,QAAA,MAAA,UACAA,EAAAA,EAAA,gBAAA,MAAA,kBACAA,EAAAA,EAAA,eAAA,MAAA,iBACAA,EAAAA,EAAA,cAAA,MAAA,gBACAA,EAAAA,EAAA,YAAA,MAAA,cACAA,EAAAA,EAAA,iBAAA,MAAA,mBACAA,EAAAA,EAAA,UAAA,MAAA,YACAA,EAAAA,EAAA,UAAA,MAAA,YACAA,EAAAA,EAAA,eAAA,MAAA,iBACAA,EAAAA,EAAA,mBAAA,MAAA,qBACAA,EAAAA,EAAA,iBAAA,OAAA,mBACAA,EAAAA,EAAA,kBAAA,MAAA,oBACAA,EAAAA,EAAA,MAAA,MAAA,QAEAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IAEAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KAEAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA;AACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IACAA,EAAAA,EAAA,EAAA,KAAA,IAEAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IACAA,EAAAA,EAAA,EAAA,IAAA,IAEAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,IAAA,KAAA,MACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,WAAA,KAAA,aACAA,EAAAA,EAAA,aAAA,IAAA,eACAA,EAAAA,EAAA,WAAA,IAAA,aACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,OAAA,IAAA,SACAA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,SAAA,IAAA;AACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,UAAA,KAAA,YACAA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,QAAA,IAAA,UACAA,EAAAA,EAAA,KAAA,IAAA,OACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,KAAA,QAEAA,EAAAA,EAAA,UAAA,GAAA,YACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,cAAA,OAAA,gBACAA,EAAAA,EAAA,IAAA,GAAA,MACAA,EAAAA,EAAA,YAAA,IAAA,cAtID,CAAWA,IAAAA,OAsJX3X,EAAA4X,YAAA,SAA4BhF,EAAc5D,GAYzC,SAAS6I,EAAgB3X,EAAegV,EAAgBrX,EAAgBgX,GACvEiD,EAAiB5X,MAAQA,EACzB4X,EAAiB5C,OAASA,EAC1B4C,EAAiBja,OAASA,EAC1Bia,EAAiBjD,KAAOA,EACxBiD,EAAiBC,iBAAcpP,EAC/BqP,EAAeF,EAjBhB,MAAMG,KACAC,EAAuB,IAAI5X,OACjC,IAAI0X,OAAqCrP,EACzC,MAAMmP,GACL5X,SACAgV,OAAQ,EACRrX,OAAQ,EACRgX,KAAM,SACN7W,YAAQ2K,GAET,IAAIwP,GAAkB,EAStB,IAEC7C,EAAM1C,GACLqE,cAAe,CAAC/B,EAAgBrX,KAC/B,GAAImR,GAAYkG,EACf,MAAMgD,EAEPF,OAAerP,EACfwP,EAAkBnJ,EAAWkG,EAC7B+C,EAAS7Y,KAAK,KAEfoX,iBAAkB,CAACxN,EAAckM,EAAgBrX,KAChD,GAAImR,EAAWkG,EACd,MAAMgD,EAIP,GAFAL,EAAgB7O,EAAMkM,EAAQrX,EAAQ,YACtCoa,EAASA,EAASpa,OAAS,GAAKmL,EAC5BgG,GAAYkG,EAASrX,EACxB,MAAMqa,GAGRhB,YAAa,CAAChC,EAAgBrX,KAC7B,GAAImR,GAAYkG,EACf,MAAMgD,EAEPF,OAAerP,EACfsP,EAASxL,OAEVmK,aAAc,CAAC1B,EAAgBrX,KAC9B,GAAImR,GAAYkG,EACf,MAAMgD,EAEPF,OAAerP,EACfsP,EAAS7Y,KAAK,IAEf2X,WAAY,CAAC7B,EAAgBrX,KAC5B,GAAImR,GAAYkG,EACf,MAAMgD,EAEPF,OAAerP,EACfsP,EAASxL;AAEV8J,eAAgB,CAACrW,EAAYgV,EAAgBrX,KAC5C,GAAImR,EAAWkG,EACd,MAAMgD,EAIP,GAFAL,EAAgB3X,EAAOgV,EAAQrX,EAAQ0Z,EAAmBrX,IAEtD8O,GAAYkG,EAASrX,EACxB,MAAMqa,GAGRxB,YAAa,CAAC0B,EAAalD,EAAgBrX,KAC1C,GAAImR,GAAYkG,EACf,MAAMgD,EAEP,GAAY,MAARE,GAAeJ,GAAsC,aAAtBA,EAAanD,KAC/CmD,EAAaD,YAAc7C,EAC3BiD,GAAkB,EAClBH,OAAerP,OACT,GAAY,MAARyP,EAAa,CACvB,MAAM1F,EAAOuF,EAASA,EAASpa,OAAS,GACpB,iBAAT6U,EACVuF,EAASA,EAASpa,OAAS,GAAK6U,EAAO,GAEvCyF,GAAkB,EAClBF,EAASA,EAASpa,OAAS,GAAK,IAEjCma,OAAerP,MAIjB,MAAOpK,GACR,GAAIA,IAAM2Z,EACT,MAAM3Z,EAIR,OACCqW,KAAMqD,EACND,aAAAA,EACAG,gBAAAA,EACAE,QAAUC,IACT,IAAIC,EAAI,EACR,IAAK,IAAI5a,EAAI,EAAG4a,EAAID,EAAQza,QAAUF,EAAIsa,EAASpa,OAAQF,IAC1D,GAAI2a,EAAQC,KAAON,EAASta,IAAqB,MAAf2a,EAAQC,GACzCA,SACM,GAAmB,OAAfD,EAAQC,GAClB,OAAO,EAGT,OAAOA,IAAMD,EAAQza,UAUxBmC,EAAAqX,MAAA,SAAsBzE,EAAc4F,KAA2BhD,EAAwBC,EAAaC,SAKnG,SAAS+C,EAAQvY,GACZyO,MAAMC,QAAQ8J,GACTA,EAAetZ,KAAKc,GAClByY,IACVD,EAAcC,GAAmBzY,GARnC,IAAIyY,EAAiC,KACjCD,KACJ,MAAME,KAwCN,OADAtD,EAAM1C,GA5BLqE,cAAe,KACd,MAAM4B,KACNJ,EAAQI,GACRD,EAAgBxZ,KAAKsZ,GACrBA,EAAgBG,EAChBF,EAAkB,MAEnBnC,iBAAmBxN,IAClB2P,EAAkB3P,GAEnBkO,YAAa,KACZwB,EAAgBE,EAAgBnM,OAEjCmK,aAAc,KACb,MAAM9L,KACN2N,EAAQ3N,GACR8N,EAAgBxZ,KAAKsZ,GACrBA,EAAgB5N,EAChB6N,EAAkB,MAEnB5B,WAAY,KACX2B,EAAgBE,EAAgBnM,OAEjC8J,eAAgBkC,EAChBrC,QAAS,CAACrN,EAAuBmM,EAAgBrX,KAChD2a,EAAOpZ,MAAO2J,MAAAA,EAAOmM,OAAAA,EAAQrX,OAAAA,MAGV2X,GACdkD,EAAc,IAOtB1Y,EAAA8Y,UAAA,SAA0BlG,EAAc4F,KAA2BhD,EAAwBC,EAAaC,SAGvG,SAASqD,EAAuBC,GACJ,aAAvBN,EAAc7D,OACjB6D,EAAc7a,OAASmb,EAAYN,EAAcxD,OACjDwD,EAAgBA,EAAc1a;AAIhC,SAASya,EAAQzD,GAEhB,OADA0D,EAAc/D,SAAUvV,KAAK4V,GACtBA,EAXR,IAAI0D,GAA4B7D,KAAM,QAASK,QAAS,EAAGrX,QAAS,EAAG8W,YAAc3W,YAAQ2K,GAoD7F2M,EAAM1C,GArCLqE,cAAgB/B,IACfwD,EAAgBD,GAAU5D,KAAM,SAAUK,OAAAA,EAAQrX,QAAS,EAAGG,OAAQ0a,EAAe/D,eAEtF6B,iBAAkB,CAACxN,EAAckM,EAAgBrX,MAChD6a,EAAgBD,GAAU5D,KAAM,WAAYK,OAAAA,EAAQrX,QAAS,EAAGG,OAAQ0a,EAAe/D,eACzEA,SAAUvV,MAAOyV,KAAM,SAAU3U,MAAO8I,EAAMkM,OAAAA,EAAQrX,OAAAA,EAAQG,OAAQ0a,KAErFxB,YAAa,CAAChC,EAAgBrX,KAC7B6a,EAAc7a,OAASqX,EAASrX,EAAS6a,EAAcxD,OACvDwD,EAAgBA,EAAc1a,OAC9B+a,EAAuB7D,EAASrX,IAEjC+Y,aAAc,CAAC1B,EAAgBrX,KAC9B6a,EAAgBD,GAAU5D,KAAM,QAASK,OAAAA,EAAQrX,QAAS,EAAGG,OAAQ0a,EAAe/D,eAErFoC,WAAY,CAAC7B,EAAgBrX,KAC5B6a,EAAc7a,OAASqX,EAASrX,EAAS6a,EAAcxD,OACvDwD,EAAgBA,EAAc1a,OAC9B+a,EAAuB7D,EAASrX,IAEjC0Y,eAAgB,CAACrW,EAAYgV,EAAgBrX,KAC5C4a,GAAU5D,KAAM0C,EAAmBrX,GAAQgV,OAAAA,EAAQrX,OAAAA,EAAQG,OAAQ0a,EAAexY,MAAAA,IAClF6Y,EAAuB7D,EAASrX,IAEjC6Y,YAAa,CAAC0B,EAAalD,EAAgBrX,KACf,aAAvB6a,EAAc7D,OACL,MAARuD,EACHM,EAAcX,YAAc7C,EACV,MAARkD,GACVW,EAAuB7D,KAI1BkB,QAAS,CAACrN,EAAuBmM,EAAgBrX,KAChD2a,EAAOpZ,MAAO2J,MAAAA,EAAOmM,OAAAA,EAAQrX,OAAAA,MAGV2X,GAErB,MAAM9X,EAASgb,EAAc/D,SAAU,GAIvC,OAHIjX,UACIA,EAAOM,OAERN,GAMRsC,EAAAiZ,mBAAA,SAAmCC,EAAYtE,GAC9C,IAAKsE,EACJ,OAED,IAAIxE,EAAOwE,EACX,IAAK,IAAIC,KAAWvE,EACnB,GAAuB,iBAAZuE,EAAsB,CAChC,GAAkB,WAAdzE,EAAKG,OAAsBlG,MAAMC,QAAQ8F,EAAKC,UACjD,OAED,IAAIyE,GAAQ;CACZ,IAAK,MAAMC,KAAgB3E,EAAKC,SAC/B,GAAIhG,MAAMC,QAAQyK,EAAa1E,WAAa0E,EAAa1E,SAAS,GAAGzU,QAAUiZ,EAAS,CACvFzE,EAAO2E,EAAa1E,SAAS,GAC7ByE,GAAQ,EACR,MAGF,IAAKA,EACJ,WAEK,CACN,MAAM/J,EAAgB8J,EACtB,GAAkB,UAAdzE,EAAKG,MAAoBxF,EAAQ,IAAMV,MAAMC,QAAQ8F,EAAKC,WAAatF,GAASqF,EAAKC,SAAS9W,OACjG,OAED6W,EAAOA,EAAKC,SAAStF,GAGvB,OAAOqF,GAMR1U,EAAAyU,YAAAA,EAoBAzU,EAAA8U,aAAAA,EAwBA9U,EAAAiV,SAAAA,EAOAjV,EAAAoV,iBAAAA,EAqBApV,EAAAsV,MAAAA,EAkPAtV,EAAAsZ,cAAA,SAA8B1G,EAAc2G,GAE3C,IAECC,EAEAvG,EAJG4C,EAAWlD,EAAcC,GAC5B6G,KAEAvE,EAAS,EAGV,GAGC,OAFAjC,EAAM4C,EAAS3B,cACfsF,EAAO3D,EAAS1B,QAEf,KAAA,GACA,KAAA,GACA,KAAA,GACKe,IAAWjC,GACdwG,EAAMra,KAAKwT,EAAKa,UAAUyB,EAAQjC,SAEjBtK,IAAd4Q,GACHE,EAAMra,KAAKyW,EAASxB,gBAAgBqF,QAAQ,WAAYH,IAEzDrE,EAASW,EAAS3B,qBAGR,KAAJsF,GAET,OAAOC,EAAME,KAAK,6DC7vCnB,SAAgBlU,EAAOmU,EAAsBnK,EAA0B+F,GAyCtE,SAASqE,IACR,OAAOC,EAAMC,EAAOC,EAAaC,EAAqBC,GAEvD,SAAShH,IACR,IAAIvF,EAAQwM,EAAQhG,OAEpB,IADAiG,GAAY,EACA,KAALzM,GAAoC,KAALA,GACrCyM,EAAYA,GAAmB,KAALzM,EAC1BA,EAAQwM,EAAQhG,OAGjB,OADAkG,EAAgB,KAAL1M,GAAuD,IAAvBwM,EAAQ3F,gBAC5C7G,EAGR,SAAS2M,EAAQ1H,EAAc2H,EAAqBvB,IAC9CqB,GAAYE,EAAcC,GAAYxB,EAAYyB,GAAcb,EAAanG,UAAU8G,EAAavB,KAAepG,GACvH8H,EAAetb,MAAO8V,OAAQqF,EAAa1c,OAAQmb,EAAYuB,EAAaI,QAAS/H,IAxDvF,IAAIqH,EACAW,EACAC,EACAJ,EACAD,EACJ,GAAI/K,EAAO,CAKV,IAJAgL,EAAahL,EAAMyF,OACnBsF,EAAWC,EAAahL,EAAM5R,OAE9Bgd,EAAkBJ,EACXI,EAAkB,IAAMC,EAAMlB,EAAciB,EAAkB,IACpEA,IAED,IAAI7B,EAAYwB,EAChB,KAAOxB,EAAYY,EAAa/b,SAAWid,EAAMlB,EAAcZ,IAC9DA;CAED4B,EAAahB,EAAanG,UAAUoH,EAAiB7B,GACrDiB,EA0IF,SAA4BU,EAAiBnF,GAC5C,IAAI7X,EAAI,EACJod,EAAS,EACb,MAAMC,EAAUxF,EAAQwF,SAAW,EACnC,KAAOrd,EAAIgd,EAAQ9c,QAAQ,CAC1B,MAAMmV,EAAK2H,EAAQM,OAAOtd,GAC1B,GAAW,MAAPqV,EACH+H,QACM,CAAA,GAAW,OAAP/H,EAGV,MAFA+H,GAAUC,EAIXrd,IAED,OAAOkE,KAAKqJ,MAAM6P,EAASC,GAzJLE,CAAmBN,EAAYpF,QAEpDoF,EAAahB,EACbK,EAAqB,EACrBY,EAAkB,EAClBJ,EAAa,EACbD,EAAWZ,EAAa/b,OAEzB,MAAMic,EAoJP,SAAgBtE,EAA4B5C,GAC3C,IAAK,IAAIjV,EAAI,EAAGA,EAAIiV,EAAK/U,OAAQF,IAAK,CACrC,MAAMqV,EAAKJ,EAAKqI,OAAOtd,GACvB,GAAW,OAAPqV,EACH,OAAIrV,EAAI,EAAIiV,EAAK/U,QAAiC,OAAvB+U,EAAKqI,OAAOtd,EAAI,GACnC,OAED,KACD,GAAW,OAAPqV,EACV,MAAO,KAGT,OAAQwC,GAAWA,EAAQsE,KAAQ,KAhKvBqB,CAAO3F,EAASoE,GAE5B,IAEII,EAFAI,GAAY,EACZF,EAAc,EAGjBF,EADGxE,EAAQ4F,aACGrB,EAAO,IAAKvE,EAAQwF,SAAW,GAE/B,KAGf,MAAMb,EAAUkB,EAAA1I,cAAciI,GAAY,GAC1C,IAAIP,GAAW,EAef,MAAMK,KAON,IAAIY,EAAapI,IAEjB,GAAc,KAAVoI,EAA+B,CAClC,MAAMC,EAAkBpB,EAAQ7F,iBAAmBuG,EAEnDP,EADsBP,EAAOC,EAAaC,GACnBY,EAAiBU,GAGzC,KAAiB,KAAVD,GAA+B,CACrC,IAAIE,EAAgBrB,EAAQ7F,iBAAmB6F,EAAQ5F,iBAAmBsG,EACtEY,EAAcvI,IAEdwI,EAAiB,GACrB,MAAQtB,IAAyB,KAAXqB,GAA2D,KAAXA,IAAgD,CAGrHnB,EAAQ,IAAKkB,EADarB,EAAQ7F,iBAAmBuG,GAErDW,EAAgBrB,EAAQ7F,iBAAmB6F,EAAQ5F,iBAAmBsG,EACtEa,EAA4B,KAAXD,EAA+C5B,IAAqB,GACrF4B,EAAcvI,IAGf,GAAe,IAAXuI,EACW,IAAVH,IACHpB,IACAwB,EAAiB7B,UAEZ,GAAe,IAAX4B,EACI,IAAVH,IACHpB,IACAwB,EAAiB7B,SAEZ,CACN,OAAQyB,GACP,KAAA,EACA,KAAA,EACCpB,IACAwB,EAAiB7B,IACjB,MACD,KAAA,EACA,KAAA,GACC6B,EAAiB7B,IACjB,MACD,KAAA,GAEE6B,EADGtB,EACcP,IAGA,IAElB,MACD,KAAA,EACC6B,EAAiB,IACjB,MACD,KAAA,GACC,GAAe,IAAXD,EAAuC,CAC1CC,EAAiB,GACjB,MAGF,KAAA,EACA,KAAA,EACA,KAAA,EACA,KAAA,GACA,KAAA,EACA,KAAA;AACgB,KAAXD,GAA2D,KAAXA,EACnDC,EAAiB,IACI,IAAXD,GAAoD,KAAXA,IACnDpB,GAAW,GAEZ,MACD,KAAA,GACCA,GAAW,GAGTD,GAAyB,KAAXqB,GAA2D,KAAXA,IACjEC,EAAiB7B,KAKnBS,EAAQoB,EAAgBF,EADCrB,EAAQ7F,iBAAmBuG,GAEpDS,EAAaG,EAEd,OAAOf,EAGR,SAASX,EAAOtX,EAAW5B,GAC1B,IAAInD,EAAS,GACb,IAAK,IAAIC,EAAI,EAAGA,EAAIkD,EAAOlD,IAC1BD,GAAU+E,EAEX,OAAO/E,EAoCR,SAAgBod,EAAMlI,EAAcsC,GACnC,OAAgD,IAAzC,OAAOzL,QAAQmJ,EAAKqI,OAAO/F,qDA/LnClV,EAAAyF,OAAAA,EA8LAzF,EAAA8a,MAAAA,+DCxOA,SAAgBa,EAAY/I,EAAcgJ,EAAwB1b,EAAY2b,EAAsCC,GACnH,MAAMlH,EAAOgH,EAAatc,QAEpB4Z,EAAOmC,EAAAvC,UAAUlG,MACvB,IAAI5U,OAA2B2K,EAE3BoT,OAAmCpT,EACvC,KAAOiM,EAAK/W,OAAS,IACpBke,EAAcnH,EAAKnI,WAEJ9D,KADf3K,EAASqd,EAAApC,mBAAmBC,EAAMtE,UACIjM,IAAVzI,IAE1BA,EAD0B,iBAAhB6b,GACA7c,CAAC6c,GAAc7b,IAEhBA,GAOZ,GAAKlC,EAME,CAAA,GAAoB,WAAhBA,EAAO6W,MAA4C,iBAAhBkH,GAA4BpN,MAAMC,QAAQ5Q,EAAO2W,UAAW,CACzG,MAAMqH,EAAWX,EAAApC,mBAAmBjb,GAAS+d,IAC7C,QAAiBpT,IAAbqT,EAAwB,CAC3B,QAAcrT,IAAVzI,EAAqB,CACxB,IAAK8b,EAAShe,OACb,MAAM,IAAIoC,MAAM,iBAEjB,MAAM6b,EAAgBje,EAAO2W,SAASlL,QAAQuS,EAAShe,QACvD,IAAIke,EACAC,EAAYH,EAAShe,OAAOkX,OAAS8G,EAAShe,OAAOH,OACzD,GAAIoe,EAAgB,EAAG,CAEtB,MAAMxJ,EAAWzU,EAAO2W,SAASsH,EAAgB,GACjDC,EAAczJ,EAASyC,OAASzC,EAAS5U,YAGzC,GADAqe,EAAcle,EAAOkX,OAAS,EAC1BlX,EAAO2W,SAAS9W,OAAS,EAAG,CAG/Bse,EADane,EAAO2W,SAAS,GACZO,OAGnB,OAAOkH,EAAexJ,GAAQsC,OAAQgH,EAAare,OAAQse,EAAYD,EAAavB,QAAS,IAAMkB,GAGnG,OAAOO,EAAexJ;AAAQsC,OAAQ8G,EAAS9G,OAAQrX,OAAQme,EAASne,OAAQ8c,QAASvD,KAAKiF,UAAUnc,IAAU2b,GAE7G,CACN,QAAclT,IAAVzI,EACH,SAED,MAAMoc,KAAiBlF,KAAKiF,UAAUN,OAAiB3E,KAAKiF,UAAUnc,KAChEmP,EAAQyM,EAAoBA,EAAkB9d,EAAO2W,SAAS1D,IAAIpO,GAAKA,EAAE8R,SAAU,GAAGzU,QAAUlC,EAAO2W,SAAS9W,OACtH,IAAI0e,EACJ,GAAIlN,EAAQ,EAAG,CACd,MAAMoD,EAAWzU,EAAO2W,SAAStF,EAAQ,GACzCkN,GAASrH,OAAQzC,EAASyC,OAASzC,EAAS5U,OAAQA,OAAQ,EAAG8c,QAAS,IAAM2B,QAE9EC,EADqC,IAA3Bve,EAAO2W,SAAS9W,QACjBqX,OAAQlX,EAAOkX,OAAS,EAAGrX,OAAQ,EAAG8c,QAAS2B,IAE/CpH,OAAQlX,EAAOkX,OAAS,EAAGrX,OAAQ,EAAG8c,QAAS2B,EAAc,KAEvE,OAAOF,EAAexJ,EAAM2J,EAAMV,IAE7B,GAAoB,UAAhB7d,EAAO6W,MAA2C,iBAAhBkH,GAA4BpN,MAAMC,QAAQ5Q,EAAO2W,UAAW,CAExG,IAAqB,IADDoH,EACI,CAEvB,MAAMO,KAAiBlF,KAAKiF,UAAUnc,KACtC,IAAIqc,EACJ,GAA+B,IAA3Bve,EAAO2W,SAAS9W,OACnB0e,GAASrH,OAAQlX,EAAOkX,OAAS,EAAGrX,OAAQ,EAAG8c,QAAS2B,OAClD,CACN,MAAM7J,EAAWzU,EAAO2W,SAAS3W,EAAO2W,SAAS9W,OAAS,GAC1D0e,GAASrH,OAAQzC,EAASyC,OAASzC,EAAS5U,OAAQA,OAAQ,EAAG8c,QAAS,IAAM2B,GAE/E,OAAOF,EAAexJ,EAAM2J,EAAMV,GAElC,QAAclT,IAAVzI,GAAuBlC,EAAO2W,SAAS9W,QAAU,EAAG,CAEvD,MAAM2e,EAAeT,EACfU,EAAWze,EAAO2W,SAAS6H,GACjC,IAAID,EACJ,GAA+B,IAA3Bve,EAAO2W,SAAS9W,OAEnB0e,GAASrH,OAAQlX,EAAOkX,OAAS,EAAGrX,OAAQG,EAAOH,OAAS,EAAG8c,QAAS,SAClE,GAAI3c,EAAO2W,SAAS9W,OAAS,IAAM2e,EAAc,CAEvD,MAAM/J,EAAWzU,EAAO2W,SAAS6H,EAAe,GAC1CtH,EAASzC,EAASyC,OAASzC,EAAS5U,OAE1C0e,GAASrH,OAAAA,EAAQrX,OADOG,EAAOkX,OAASlX,EAAOH,OACJ,EAAIqX,EAAQyF,QAAS,SAEhE4B,GAASrH,OAAQuH,EAASvH;AAAQrX,OAAQG,EAAO2W,SAAS6H,EAAe,GAAGtH,OAASuH,EAASvH,OAAQyF,QAAS,IAEhH,OAAOyB,EAAexJ,EAAM2J,EAAMV,GAElC,MAAM,IAAIzb,MAAM,wCAIlB,MAAM,IAAIA,qBAA4C,iBAAhB2b,EAA2B,QAAU,gCAAgC/d,EAAO6W,QArFlH,QAAclM,IAAVzI,EACH,MAAM,IAAIE,MAAM,oCAEjB,OAAOgc,EAAexJ,GAAQsC,OAAQgE,EAAOA,EAAKhE,OAAS,EAAGrX,OAAQqb,EAAOA,EAAKrb,OAAS,EAAG8c,QAASvD,KAAKiF,UAAUnc,IAAU2b,GAsFlI,SAASO,EAAexJ,EAAc2J,EAAYV,GAEjD,IAAIa,EAAUC,EAAU/J,EAAM2J,GAG1BK,EAAQL,EAAKrH,OACbhD,EAAMqK,EAAKrH,OAASqH,EAAK5B,QAAQ9c,OACrC,GAAoB,IAAhB0e,EAAK1e,QAAwC,IAAxB0e,EAAK5B,QAAQ9c,OAAc,CACnD,KAAO+e,EAAQ,IAAMC,EAAA/B,MAAM4B,EAASE,EAAQ,IAC3CA,IAED,KAAO1K,EAAMwK,EAAQ7e,SAAWgf,EAAA/B,MAAM4B,EAASxK,IAC9CA,IAIF,MAAM4K,EAAQD,EAAApX,OAAOiX,GAAWxH,OAAQ0H,EAAO/e,OAAQqU,EAAM0K,GAASf,GAGtE,IAAK,IAAIle,EAAImf,EAAMjf,OAAS,EAAGF,GAAK,EAAGA,IAAK,CAC3C,MAAM4e,EAAOO,EAAMnf,GACnB+e,EAAUC,EAAUD,EAASH,GAC7BK,EAAQ/a,KAAKQ,IAAIua,EAAOL,EAAKrH,QAC7BhD,EAAMrQ,KAAKS,IAAI4P,EAAKqK,EAAKrH,OAASqH,EAAK1e,QACvCqU,GAAOqK,EAAK5B,QAAQ9c,OAAS0e,EAAK1e,OAInC,QAAUqX,OAAQ0H,EAAO/e,OADN+U,EAAK/U,QAAU6e,EAAQ7e,OAASqU,GAAO0K,EACbjC,QAAS+B,EAAQjJ,UAAUmJ,EAAO1K,KAGhF,SAAgByK,EAAU/J,EAAc2J,GACvC,OAAO3J,EAAKa,UAAU,EAAG8I,EAAKrH,QAAUqH,EAAK5B,QAAU/H,EAAKa,UAAU8I,EAAKrH,OAASqH,EAAK1e,yDApJ1FmC,EAAA+c,eAAA,SAA+BnK,EAAcgC,EAAgBiH,GAC5D,OAAOF,EAAY/I,EAAMgC,OAAMjM,EAAWkT,IAG3C7b,EAAA2b,YAAAA;AA+IA3b,EAAA2c,UAAAA,EAIA3c,EAAAgd,KAAA,SAAqBpK,EAAcsC,GAClC,OAAmD,IAA5C,UAAUzL,QAAQmJ,EAAKqI,OAAO/F,4DC2QtC,SAAgB+H,EAAuBC,EAAoBC,GAE1D,MAAMC,KAAqB,KAAVF,GACXG,KAAqB,IAAVH,GAQjB,OAAO,IAAII,EANQ,IAAFH,EAAmCE,EAAUD,KAClC,KAAVF,MACQ,IAAVA,GACG,IAAFC,EAAmCC,EAAUC,EACnC,IAAVH,qDAxalB,SAAkBK,GAIjBA,EAAAA,EAAA,QAAA,GAAA,UAEAA,EAAAA,EAAA,UAAA,GAAA,YACAA,EAAAA,EAAA,IAAA,GAAA,MACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,IAAA,GAAA,MACAA,EAAAA,EAAA,WAAA,GAAA,aACAA,EAAAA,EAAA,SAAA,GAAA,WACAA,EAAAA,EAAA,OAAA,GAAA,SACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,OAAA,IAAA,SACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,KAAA,IAAA,OACAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,QAAA,IAAA,UACAA,EAAAA,EAAA,WAAA,IAAA,aACAA,EAAAA,EAAA,UAAA,IAAA,YACAA,EAAAA,EAAA,OAAA,IAAA,SACAA,EAAAA,EAAA,OAAA,IAAA,SAEAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA;AACAA,EAAAA,EAAA,MAAA,IAAA,QAEAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QACAA,EAAAA,EAAA,MAAA,IAAA,QAEAA,EAAAA,EAAA,KAAA,IAAA,OACAA,EAAAA,EAAA,YAAA,IAAA,cAEAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,GAAA,IAAA,KACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MACAA,EAAAA,EAAA,IAAA,IAAA,MAEAA,EAAAA,EAAA,QAAA,IAAA;AACAA,EAAAA,EAAA,WAAA,IAAA,aAMAA,EAAAA,EAAA,aAAA,IAAA,eAKAA,EAAAA,EAAA,SAAA,IAAA,WAKAA,EAAAA,EAAA,SAAA,IAAA,WAKAA,EAAAA,EAAA,SAAA,IAAA,WAKAA,EAAAA,EAAA,OAAA,IAAA,SAKAA,EAAAA,EAAA,SAAA,IAAA,WAKAA,EAAAA,EAAA,YAAA,IAAA,cAKAA,EAAAA,EAAA,uBAAA,IAAA,yBAKAA,EAAAA,EAAA,aAAA,IAAA,eAKAA,EAAAA,EAAA,wBAAA,IAAA,0BAKAA,EAAAA,EAAA,SAAA,IAAA,WAIAA,EAAAA,EAAA,MAAA,IAAA,QAIAA,EAAAA,EAAA,QAAA,IAAA,UAEAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,SAAA,KAAA,WACAA,EAAAA,EAAA,SAAA,KAAA,WACAA,EAAAA,EAAA,SAAA,KAAA,WAEAA,EAAAA,EAAA,gBAAA,KAAA,kBACAA,EAAAA,EAAA,WAAA,KAAA,aACAA,EAAAA,EAAA,iBAAA,KAAA,mBACAA,EAAAA,EAAA,gBAAA,KAAA,kBACAA,EAAAA,EAAA,eAAA,KAAA,iBACAA,EAAAA,EAAA,cAAA,KAAA;AAKAA,EAAAA,EAAA,mBAAA,KAAA,qBAEAA,EAAAA,EAAA,QAAA,KAAA,UACAA,EAAAA,EAAA,QAAA,KAAA,UAMAA,EAAAA,EAAA,UAAA,KAAA,YAzLD,CAAkBvd,EAAAud,UAAAvd,EAAAud,mBA4LZC,EAKLte,cACCK,KAAKke,iBACLle,KAAKme,cAAgBpd,OAAOc,OAAO,MAGpClC,OAAOye,EAAkBC,GACxBre,KAAKke,cAAcE,GAAWC,EAC9Bre,KAAKme,cAAcE,EAAIC,eAAiBF,EAGzCze,aAAaye,GACZ,OAAOpe,KAAKke,cAAcE,GAG3Bze,aAAa0e,GACZ,OAAOre,KAAKme,cAAcE,EAAIC,gBAAc,GAI9C,MAAMC,EAAQ,IAAIN,EACZO,EAAoB,IAAIP,EACxBQ,EAAyB,IAAIR,GAEnC,WAEC,SAASS,EAAON,EAAkBO,EAAiBC,EAA8BD,EAASE,EAAmCD,GAC5HL,EAAMG,OAAON,EAASO,GACtBH,EAAkBE,OAAON,EAASQ,GAClCH,EAAuBC,OAAON,EAASS,GAGxCH,EAAM,EAAkB,WAExBA,EAAM,EAAoB,aAC1BA,EAAM,EAAc,OACpBA,EAAM,EAAgB,SACtBA,EAAM,EAAgB,SACtBA,EAAM,EAAe,QACrBA,EAAM,EAAc,OACpBA,EAAM,EAAqB,cAC3BA,EAAM,EAAmB,YACzBA,EAAM,EAAiB,UACvBA,EAAM,GAAgB,SACtBA,EAAM,GAAiB,UACvBA,EAAM,GAAmB,YACzBA,EAAM,GAAc,OACpBA,EAAM,GAAe,QAErBA,EAAM,GAAoB,YAAa,QACvCA,EAAM,GAAkB,UAAW,MACnCA,EAAM,GAAqB,aAAc,SACzCA,EAAM,GAAoB,YAAa,QACvCA,EAAM,GAAiB,UACvBA,EAAM,GAAiB,UAEvBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KAEtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB;AACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KACtBA,EAAM,GAAgB,KAEtBA,EAAM,GAAe,QACrBA,EAAM,GAAsB,eAE5BA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAa,MACnBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OACpBA,EAAM,GAAc,OAEpBA,EAAM,GAAkB,WACxBA,EAAM,GAAqB,cAE3BA,EAAM,GAAuB,IAAK,IAAK,SACvCA,EAAM,GAAmB,IAAK,IAAK,YACnCA,EAAM,GAAmB,IAAK,IAAK,aACnCA,EAAM,GAAmB,IAAK,IAAK,aACnCA,EAAM,GAAiB,IAAK,IAAK,cACjCA,EAAM,GAAmB,IAAK,IAAK,SACnCA,EAAM,GAAsB,IAAK,IAAK,SACtCA,EAAM,IAAkB,WACxBA,EAAM,IAAkB,WACxBA,EAAM,GAAiC,IAAK,IAAK,SACjDA,EAAM,GAAuB,KAAM,KAAM,SACzCA,EAAM,GAAkC,IAAK,IAAK,SAClDA,EAAM,GAAmB,IAAM,IAAM,SACrCA,EAAM,GAAgB,SACtBA,EAAM,GAAkB,WAExBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,GAAmB,WACzBA,EAAM,IAAmB,WACzBA,EAAM,IAAmB,WACzBA,EAAM,IAAmB,WAEzBA,EAAM,IAA0B;AAChCA,EAAM,IAAqB,cAC3BA,EAAM,IAA2B,oBACjCA,EAAM,IAA0B,mBAChCA,EAAM,IAAyB,kBAC/BA,EAAM,IAAwB,iBAhI/B,IAoIA,SAAiBI,GACAA,EAAA7X,SAAhB,SAAyBmX,GACxB,OAAOG,EAAMQ,aAAaX,IAEXU,EAAAE,WAAhB,SAA2B7d,GAC1B,OAAOod,EAAMU,aAAa9d,IAGX2d,EAAAI,iBAAhB,SAAiCd,GAChC,OAAOI,EAAkBO,aAAaX,IAEvBU,EAAAK,sBAAhB,SAAsCf,GACrC,OAAOK,EAAuBM,aAAaX,IAE5BU,EAAAM,iBAAhB,SAAiCje,GAChC,OAAOqd,EAAkBS,aAAa9d,IAAQsd,EAAuBQ,aAAa9d,IAfpF,CAAiBV,EAAAqe,eAAAre,EAAAqe,kBAgCjB,IAAWO,GAAX,SAAWA,GACVA,EAAAA,EAAA,QAAA,MAAA,UACAA,EAAAA,EAAA,MAAA,MAAA,QACAA,EAAAA,EAAA,IAAA,KAAA,MACAA,EAAAA,EAAA,QAAA,KAAA,UACAA,EAAAA,EAAA,QAAA,KAAA,UALD,CAAWA,IAAAA,QAQX,SAAkBC,GACjBA,EAAAA,EAAA,QAAA,MAAA,UACAA,EAAAA,EAAA,MAAA,MAAA,QACAA,EAAAA,EAAA,IAAA,KAAA,MACAA,EAAAA,EAAA,QAAA,KAAA,UAJD,CAAkB7e,EAAA6e,SAAA7e,EAAA6e,YAOlB7e,EAAA8e,SAAA,SAAyBC,EAAmBC,GAE3C,OAAQD,GADyB,MAAbC,IAA4B,KAAQ,KACrB,GAGpChf,EAAAif,iBAAA,SAAiC/B,EAAoBC,GACpD,GAAmB,IAAfD,EACH,OAAO,KAER,MAAM6B,GAA0B,MAAb7B,KAA6B,EAC1CgC,GAA0B,WAAbhC,KAA6B,GAChD,OACQ,IAAIiC,EADM,IAAdD,GAEFjC,EAAuB8B,EAAW5B,GAClCF,EAAuBiC,EAAW/B,KAGRF,EAAuB8B,EAAW5B,MAG/Dnd,EAAAid,uBAAAA,QAcaK,EAOZpe,YAAYkgB,EAAkBC,EAAmBC,EAAiBC,EAAkB5B;AACnFpe,KAAK6f,QAAUA,EACf7f,KAAK8f,SAAWA,EAChB9f,KAAK+f,OAASA,EACd/f,KAAKggB,QAAUA,EACfhgB,KAAKoe,QAAUA,EAGTze,OAAOoF,GACb,OACC/E,KAAK6f,UAAY9a,EAAM8a,SACpB7f,KAAK8f,WAAa/a,EAAM+a,UACxB9f,KAAK+f,SAAWhb,EAAMgb,QACtB/f,KAAKggB,UAAYjb,EAAMib,SACvBhgB,KAAKoe,UAAYrZ,EAAMqZ,QAIrBze,cAKN,SAJaK,KAAK6f,QAAU,IAAM,MACpB7f,KAAK8f,SAAW,IAAM,MACxB9f,KAAK+f,OAAS,IAAM,MACnB/f,KAAKggB,QAAU,IAAM,MACIhgB,KAAKoe,UAGrCze,gBACN,OACa,IAAZK,KAAKoe,SACU,IAAZpe,KAAKoe,SACO,KAAZpe,KAAKoe,SACO,IAAZpe,KAAKoe,SACO,IAAZpe,KAAKoe,QAIHze,UACN,OAAO,IAAIigB,GAAiB5f,OAMtBL,0BACN,OACEK,KAAK6f,SAAuB,IAAZ7f,KAAKoe,SAClBpe,KAAK8f,UAAwB,IAAZ9f,KAAKoe,SACtBpe,KAAK+f,QAAsB,IAAZ/f,KAAKoe,SACpBpe,KAAKggB,SAAuB,KAAZhgB,KAAKoe,SAvD5B3d,EAAAsd,iBAAAA,QA4Da6B,EAGZjgB,YAAYua,GACX,GAAqB,IAAjBA,EAAM5b,OACT,MAAMqQ,EAAA9D,gBAAgB,SAEvB7K,KAAKka,MAAQA,EAGPva,cACN,IAAIxB,EAAS,GACb,IAAK,IAAIC,EAAI,EAAGC,EAAM2B,KAAKka,MAAM5b,OAAQF,EAAIC,EAAKD,IACvC,IAANA,IACHD,GAAU,KAEXA,GAAU6B,KAAKka,MAAM9b,GAAG6hB,cAEzB,OAAO9hB,EAGDwB,OAAOoF,GACb,GAAc,OAAVA,EACH,OAAO,EAER,GAAI/E,KAAKka,MAAM5b,SAAWyG,EAAMmV,MAAM5b,OACrC,OAAO;CAER,IAAK,IAAIF,EAAI,EAAGA,EAAI4B,KAAKka,MAAM5b,OAAQF,IACtC,IAAK4B,KAAKka,MAAM9b,GAAG4G,OAAOD,EAAMmV,MAAM9b,IACrC,OAAO,EAGT,OAAO,GAjCTqC,EAAAmf,gBAAAA,QAuCaM,EASZvgB,YAAYkgB,EAAkBC,EAAmBC,EAAiBC,EAAkBG,EAAwBC,GAC3GpgB,KAAK6f,QAAUA,EACf7f,KAAK8f,SAAWA,EAChB9f,KAAK+f,OAASA,EACd/f,KAAKggB,QAAUA,EACfhgB,KAAKqgB,SAAWF,EAChBngB,KAAKsgB,aAAeF,GAftB3f,EAAAyf,uBAAAA,QAsBsBK,GAAtB9f,EAAA8f,mBAAAA,yDChiBA,SAAgBC,EAA+Bjf,KAAmBkf,GACjE,GAAIrR,MAAMC,QAAQ9N,GAEjB,OADAA,EAAMC,QAAQkf,GAAKA,GAAKA,EAAEF,cAEpB,GAAoB,IAAhBC,EAAKniB,OASf,OAFAkiB,EAAQjf,GACRif,EAAQC,MAPR,GAAIlf,EAEH,OADAA,EAAMif,UACCjf,mDAfVd,EAAAkgB,aAAA,SAA+CC,GAC9C,MAAoD,mBAAnBA,EAAOJ,SACS,IAA1BI,EAAOJ,QAAQliB,QAMvCmC,EAAA+f,QAAAA,EAiBA/f,EAAAogB,mBAAA,SAAmCC,GAClC,OAASN,QAAS,IAAMA,EAAQM,KAGjCrgB,EAAAsgB,aAAA,SAA6B7Y,GAC5B,OAASvI,UAAYuI,aAGA8Y,EAAtBrhB,cAIWK,KAAAihB,cAGFjhB,KAAAkhB,kCAAmC,EAF3CC,gBAA2C,OAAOnhB,KAAKihB,WAIhDthB,UACNK,KAAKkhB,kCAAmC,EACxClhB,KAAKihB,WAAaT,EAAQxgB,KAAKihB,YAGtBthB,UAAiC6D;AAQ1C,OAPIxD,KAAKkhB,kCACR7Y,QAAQC,KAAK,oEACb9E,EAAEgd,WAEFxgB,KAAKihB,WAAWphB,KAAK2D,GAGfA,GApBDwd,EAAAI,KAAOrgB,OAAOsgB,QAAsB1hB,cAF5Cc,EAAAugB,WAAAA,QA8BsBM,EAIrB3hB,cAFQK,KAAAuhB,WAA0ExgB,OAAOc,OAAO,MAIhGlC,QAAQwB,GACP,IAAIqgB,EAAYxhB,KAAKuhB,WAAWpgB,GAE3BqgB,IACJA,EAAYxhB,KAAKuhB,WAAWpgB,IAASsgB,QAAS,EAAGnI,OAAQtZ,KAAK0hB,uBAAuBvgB,KAGtF,MAAMmY,OAAEA,GAAWkI,EACbhB,EAAUmB,EAAAhQ,KAAK,KACQ,KAAtB6P,EAAUC,UACfzhB,KAAK4hB,wBAAwBzgB,EAAKqgB,EAAUlI,eACrCtZ,KAAKuhB,WAAWpgB,MAMzB,OAFAqgB,EAAUC,WAEDnI,OAAAA,EAAQkH,QAAAA,IAvBnB/f,EAAA6gB,oBAAAA,QA8BaO,EACZliB,YAAmB2Z,GAAAtZ,KAAAsZ,OAAAA,EACnB3Z,YAFDc,EAAAohB,kBAAAA,iHCjGMC,EAKLniB,YAAYmC,GACX9B,KAAK8B,QAAUA,SAIJigB,EAAbpiB,cAISK,KAAAgiB,MAAgB,EAExB3gB,WACC,OAAOrB,KAAKgiB,MAGbriB,UACC,OAAQK,KAAKiiB,OAGdtiB,QACCK,KAAKiiB,YAAS7Y,EACdpJ,KAAKkiB,WAAQ9Y,EACbpJ,KAAKgiB,MAAQ,EAGdriB,QAAQmC,GACP,OAAO9B,KAAKmiB,QAAQrgB,GAAS,GAG9BnC,KAAKmC,GACJ,OAAO9B,KAAKmiB,QAAQrgB,GAAS,GAGtBnC,QAAQmC,EAAYsgB;AAC3B,MAAMC,EAAU,IAAIP,EAAKhgB,GACzB,GAAK9B,KAAKiiB,OAIH,GAAIG,EAAU,CAEpB,MAAME,EAAUtiB,KAAKkiB,MACrBliB,KAAKkiB,MAAQG,EACbA,EAAQE,KAAOD,EACfA,EAAQnQ,KAAOkQ,MAET,CAEN,MAAMG,EAAWxiB,KAAKiiB,OACtBjiB,KAAKiiB,OAASI,EACdA,EAAQlQ,KAAOqQ,EACfA,EAASD,KAAOF,OAfhBriB,KAAKiiB,OAASI,EACdriB,KAAKkiB,MAAQG,EAiBd,OADAriB,KAAKgiB,OAAS,EACPhiB,KAAKyiB,QAAQC,KAAK1iB,KAAMqiB,GAIhC1iB,QACC,GAAKK,KAAKiiB,OAEH,CACN,MAAMU,EAAM3iB,KAAKiiB,OAAOngB,QAExB,OADA9B,KAAKyiB,QAAQziB,KAAKiiB,QACXU,GAIThjB,MACC,GAAKK,KAAKkiB,MAEH,CACN,MAAMS,EAAM3iB,KAAKkiB,MAAMpgB,QAEvB,OADA9B,KAAKyiB,QAAQziB,KAAKkiB,OACXS,GAIDhjB,QAAQwV,GACf,IAAIyN,EAAiC5iB,KAAKiiB,OAC1C,KAAOW,aAAqBd,GAAM,CACjC,GAAIc,IAAczN,EAAlB,CAIA,GAAIyN,EAAUL,MAAQK,EAAUzQ,KAAM,CAErC,MAAM0Q,EAASD,EAAUL,KACzBM,EAAO1Q,KAAOyQ,EAAUzQ,KACxByQ,EAAUzQ,KAAKoQ,KAAOM,OAEXD,EAAUL,MAASK,EAAUzQ,KAK7ByQ,EAAUzQ,KAKVyQ,EAAUL,OAErBviB,KAAKiiB,OAASjiB,KAAKiiB,OAAQ9P,KAC3BnS,KAAKiiB,OAAOM,UAAOnZ,IANnBpJ,KAAKkiB,MAAQliB,KAAKkiB,MAAOK,KACzBviB,KAAKkiB,MAAM/P,UAAO/I,IANlBpJ,KAAKiiB,YAAS7Y,EACdpJ,KAAKkiB,WAAQ9Y,GAcdpJ,KAAKgiB,OAAS,EACd,MA3BCY,EAAYA,EAAUzQ,MA+BzBxS,WACC,IAAImC,EACAqT,EAAOnV,KAAKiiB,OAChB,OACC9P,KAAI,IACEgD,GAIArT,EAGJA,EAAQnB,MAAQwU,EAAKrT,QAFrBA,GAAYkQ,MAAM,EAAOrR,MAAOwU,EAAKrT,SAItCqT,EAAOA,EAAKhD,KACLrQ,GATCghB,EAAA/Q,KAcXpS,UACC,MAAMxB,KACN,IAAK,IAAIgX,EAAOnV,KAAKiiB,OAAQ9M,aAAgB2M,EAAM3M,EAAOA,EAAKhD,KAC9DhU,EAAO0B,KAAKsV,EAAKrT,SAElB,OAAO3D,GArITsC,EAAAshB,WAAAA;kDCCA,IAAiBgB,GAAjB,SAAiBA,GAOhB,SAAgBpR,EAAQqR,GACvB,MAAO,CAACjZ,EAAUkZ,EAAW,KAAMnC,KAElC,IACI3iB,EADA+kB,GAAU,EAkBd,OAhBA/kB,EAAS6kB,EAAMhkB,IACd,IAAIkkB,EAQJ,OANW/kB,EACVA,EAAOqiB,UAEP0C,GAAU,EAGJnZ,EAAS3I,KAAK6hB,EAAUjkB,IAC7B,KAAM8hB,GAELoC,GACH/kB,EAAOqiB,UAGDriB,GAQT,SAAgBuT,EAAUsR,EAAiBtR,GAC1C,OAAOyR,EAAS,CAACpZ,EAAUkZ,EAAW,KAAMnC,IAAiBkC,EAAM5kB,GAAK2L,EAAS3I,KAAK6hB,EAAUvR,EAAItT,IAAK,KAAM0iB,IAOhH,SAAgBtf,EAAWwhB,EAAiBI,GAC3C,OAAOD,EAAS,CAACpZ,EAAUkZ,EAAW,KAAMnC,IAAiBkC,EAAM5kB,IAAOglB,EAAKhlB,GAAI2L,EAAS3I,KAAK6hB,EAAU7kB,IAAO,KAAM0iB,IASzH,SAAgBhS,EAAUkU,EAAiBlU,GAC1C,OAAOqU,EAAS,CAACpZ,EAAUkZ,EAAW,KAAMnC,IAAiBkC,EAAMhkB,GAAK8P,EAAO9P,IAAM+K,EAAS3I,KAAK6hB,EAAUjkB,GAAI,KAAM8hB,IAsBxH,SAAgBvQ,EAAayS,EAAiBK,EAA6CC,GAC1F,IAAIC,EAAwBD,EAE5B,OAAO5R,EAAUsR,EAAOhkB,GACvBukB,EAASF,EAAME,EAAQvkB,IAUzB,SAAgBmkB,EAAYH,GAC3B,IAAIjZ,EACJ,MAAMyZ,EAAU,IAAIC,GACnB9jB,qBACCoK,EAAWiZ,EAAMQ,EAAQE,KAAMF,IAEhC7jB,uBACCoK,EAASyW,aAIX,OAAOgD,EAAQR,MAmEhB,SAAgBW,EAASX,GACxB,IACIY,EADAC,GAAY,EAGhB,OAAO/U,EAAOkU,EAAOriB,IACpB,MAAMmjB,EAAaD,GAAaljB,IAAUijB,EAG1C,OAFAC,GAAY,EACZD,EAAQjjB,EACDmjB,IAhLT,MAAMC,GAAgBpkB,aACTojB,EAAA3B,KAAmB,WAAc,OAAO2C,GAKrChB,EAAApR,KAAIA,EA6BJoR,EAAArR,IAAGA,EAQHqR,EAAAvhB,QAAOA,EAUPuhB,EAAAjU,OAAMA,EAONiU,EAAAiB,OAAhB,SAA0BhB,GACzB,OAAOA,GAOQD,EAAAkB,IAAhB,YAA0BC,GACzB,MAAO,CAACna,EAAUkZ,EAAW,KAAMnC,IAAiBqD,EAAAtD,mBAAmBqD,EAAOxS,IAAIsR,GAASA,EAAMhkB,GAAK+K,EAAS3I,KAAK6hB,EAAUjkB,GAAI,KAAM8hB,MAOzHiC,EAAAxS,OAAMA,EAcNwS,EAAAI,SAAQA,EAyBRJ,EAAAja,SAAhB,SAA+Bka,EAAiBK,EAA6Cta,EAAgB,IAAKqb,GAAU,EAAOC,GAElI,IAAIC,EACAf,OAAwBna,EACxBmb,OAAcnb,EACdob,EAAoB,EAExB,MAAMhB,EAAU,IAAIC,GACnBY,qBAAAA;AACA1kB,qBACC2kB,EAAetB,EAAMyB,IACpBD,IACAjB,EAASF,EAAME,EAAQkB,GAEnBL,IAAYG,GACff,EAAQE,KAAKH,GAGdla,aAAakb,GACbA,EAASjb,WAAW,KACnB,MAAMob,EAAUnB,EAChBA,OAASna,EACTmb,OAASnb,IACJgb,GAAWI,EAAoB,IACnChB,EAAQE,KAAKgB,GAGdF,EAAoB,GAClBzb,MAGLpJ,uBACC2kB,EAAa9D,aAIf,OAAOgD,EAAQR,OAQAD,EAAA4B,UAAhB,SAA6B3B,GAC5B,MAAMvW,GAAQ,IAAImY,MAAOC,UACzB,OAAOnT,EAAIC,EAAKqR,GAAQ8B,IAAK,IAAIF,MAAOC,UAAYpY,IAOrCsW,EAAAY,MAAKA,EAkCLZ,EAAAgC,OAAhB,SAA0B/B,EAAiBgC,GAAW,EAAOC,MAC5D,IAAIF,EAAqBE,EAAQllB,QAE7BgK,EAA+BiZ,EAAMhkB,IACpC+lB,EACHA,EAAOllB,KAAKb,GAEZwkB,EAAQE,KAAK1kB,KAIf,MAAMkmB,EAAQ,KACTH,GACHA,EAAOvjB,QAAQxC,GAAKwkB,EAAQE,KAAK1kB,IAElC+lB,EAAS,MAGJvB,EAAU,IAAIC,GACnB9jB,qBACMoK,IACJA,EAAWiZ,EAAMhkB,GAAKwkB,EAAQE,KAAK1kB,MAIrCW,wBACKolB,IACCC,EACH1b,WAAW4b,GAEXA,MAKHvlB,uBACKoK,GACHA,EAASyW,UAEVzW,EAAW,QAIb,OAAOyZ,EAAQR,OAOAD,EAAAoC,KAAhB,SAAwBnC,EAAiBgC,GAAW,EAAOD,MAC1DA,EAASA,EAAOhlB,QAEhBijB,EAAMhkB,IACL+lB,EAAOllB,KAAKb,GACZwkB,EAAQE,KAAK1kB,KAGd,MAAMkmB,EAAQ,CAACnb,EAAyBkZ,IAAmB8B,EAAOvjB,QAAQxC,GAAK+K,EAAS3I,KAAK6hB,EAAUjkB,IAEjGwkB,EAAU,IAAIC,GACnB9jB,iBAAiB6jB,EAAqBzZ,EAAyBkZ,GAC1D+B,EACH1b,WAAW,IAAM4b,EAAMnb,EAAUkZ,IAEjCiC,EAAMnb,EAAUkZ,MAKnB,OAAOO,EAAQR,aAcVoC,EAELzlB,YAAqBqjB,GAAAhjB,KAAAgjB,MAAAA,EAErBrjB,IAAOuI,GACN,OAAO,IAAIkd,EAAe1T,EAAI1R,KAAKgjB,MAAO9a,IAG3CvI,QAAQuI,GACP,OAAO,IAAIkd,EAAe5jB,EAAQxB,KAAKgjB,MAAO9a,IAG/CvI,OAAOuI,GACN,OAAO,IAAIkd,EAAetW,EAAO9O,KAAKgjB,MAAO9a,IAG9CvI,OAAU0jB,EAA6CC,GACtD,OAAO,IAAI8B,EAAe7U,EAAOvQ,KAAKgjB,MAAOK,EAAOC,IAGrD3jB;AACC,OAAO,IAAIylB,EAAezB,EAAM3jB,KAAKgjB,QAGtCrjB,GAAGoK,EAAyBkZ,EAAenC,GAC1C,OAAO9gB,KAAKgjB,MAAMjZ,EAAUkZ,EAAUnC,GAGvCnhB,KAAKoK,EAAyBkZ,EAAenC,GAC5C,OAAOnP,EAAK3R,KAAKgjB,MAAVrR,CAAiB5H,EAAUkZ,EAAUnC,IAI9BiC,EAAAsC,MAAhB,SAAyBrC,GACxB,OAAO,IAAIoC,EAAepC,IAQXD,EAAAuC,qBAAhB,SAAwC9B,EAA2B+B,EAAmB7T,EAA6B8T,CAAAA,GAAMA,IACxH,MAAMtd,EAAK,IAAIM,IAAgBrK,EAAOulB,KAAKhS,KAAOlJ,IAG5CrK,EAAS,IAAIslB,GAAagC,mBAFL,IAAMjC,EAAQkC,GAAGH,EAAWrd,GAEHyd,qBADvB,IAAMnC,EAAQoC,eAAeL,EAAWrd,KAGrE,OAAO/J,EAAO6kB,OAGCD,EAAA8C,YAAhB,SAAqCC,GACpC,MAAMtC,EAAU,IAAIC,EACpB,IAAIK,GAAa,EAajB,OAXAgC,EACElX,UAAKxF,EAAW,IAAM,MACtBwF,KAAK,KACAkV,EAGJN,EAAQE,UAAKta,GAFbE,WAAW,IAAMka,EAAQE,UAAKta,GAAY,KAM7C0a,GAAa,EACNN,EAAQR,OAGAD,EAAAgD,UAAhB,SAA6B/C,GAC5B,OAAO,IAAI3U,QAAQpK,GAAK0N,EAAKqR,EAALrR,CAAY1N,KArWtC,CAAiB8e,EAAAtiB,EAAAsiB,QAAAtiB,EAAAsiB,WAmXjB,IAAIiD,GAA+B,EACnCvlB,EAAAwlB,8BAAA,SAA8Cjf,GAC7C,MAAMkf,EAAWF,EAEjB,OADAA,EAA8Bhf,GAE7BrH,UACCqmB,EAA8BE,WAK3BC,EAKLxmB,YACUymB,EACA3c,EAAenH,KAAK2O,SAAShK,SAAS,IAAIlH,MAAM,EAAG,IADnDC,KAAAomB,gBAAAA,EACApmB,KAAAyJ,KAAAA,EAJFzJ,KAAAqmB,eAAyB,EAOjC1mB,UACKK,KAAKsmB,SACRtmB,KAAKsmB,QAAQC,QAIf5mB,MAAM6mB,GAEL,IAAIC,EAAYT,EAKhB,GAJoC,iBAAzBhmB,KAAKomB,kBACfK,EAAYzmB,KAAKomB,iBAGdK,GAAa,GAAKD,EAAgBC,EACrC,OAGIzmB,KAAKsmB,UACTtmB,KAAKsmB,QAAU,IAAII;CAEpB,MAAM5c,GAAQ,IAAIjJ,OAAQiJ,MAAOsB,MAAM,MAAMrL,MAAM,GAAGqa,KAAK,MACrD9Y,EAAStB,KAAKsmB,QAAQne,IAAI2B,IAAU,EAI1C,GAHA9J,KAAKsmB,QAAQK,IAAI7c,EAAOxI,EAAQ,GAChCtB,KAAKqmB,gBAAkB,EAEnBrmB,KAAKqmB,gBAAkB,EAAG,CAG7BrmB,KAAKqmB,eAA6B,GAAZI,EAGtB,IAAIG,EACAC,EAAmB,EACvB7mB,KAAKsmB,QAAQ9kB,QAAQ,CAACF,EAAOwI,OACvB8c,GAAYC,EAAWvlB,KAC3BslB,EAAW9c,EACX+c,EAAWvlB,KAIb+G,QAAQC,SAAStI,KAAKyJ,kDAAkD+c,gDAA4DK,OACpIxe,QAAQC,KAAKse,GAGd,MAAO,KACN,MAAMtlB,EAAStB,KAAKsmB,QAASne,IAAI2B,IAAU,EAC3C9J,KAAKsmB,QAASK,IAAI7c,EAAOxI,EAAQ,WA0BvBmiB,EAWZ9jB,YAAYsW,GALJjW,KAAA8mB,WAAqB,EAM5B9mB,KAAK+mB,SAAW9Q,EAChBjW,KAAKgnB,YAAchB,EAA8B,EAC9C,IAAIG,EAAenmB,KAAK+mB,UAAY/mB,KAAK+mB,SAAS1C,2BAClDjb,EAOJ4Z,YAsDC,OArDKhjB,KAAKinB,SACTjnB,KAAKinB,OAAS,EAACld,EAAyBkZ,EAAgBnC,KAClD9gB,KAAKknB,aACTlnB,KAAKknB,WAAa,IAAIC,EAAApF,YAGvB,MAAMqF,EAAgBpnB,KAAKknB,WAAWG,UAElCD,GAAiBpnB,KAAK+mB,UAAY/mB,KAAK+mB,SAAStB,oBACnDzlB,KAAK+mB,SAAStB,mBAAmBzlB,MAGlC,MAAMsnB,EAAStnB,KAAKknB,WAAWrnB,KAAMojB,GAAuBlZ,EAAUkZ,GAAtBlZ,GAE5Cqd,GAAiBpnB,KAAK+mB,UAAY/mB,KAAK+mB,SAASQ,uBACnDvnB,KAAK+mB,SAASQ,sBAAsBvnB;AAGjCA,KAAK+mB,UAAY/mB,KAAK+mB,SAASS,kBAClCxnB,KAAK+mB,SAASS,iBAAiBxnB,KAAM+J,EAAUkZ,GAIhD,IAAIwE,EACAznB,KAAKgnB,cACRS,EAAgBznB,KAAKgnB,YAAYU,MAAM1nB,KAAKknB,WAAW7lB,OAGxD,IAAIlD,EAsBJ,OArBAA,GACCqiB,QAAS,KAKR,GAJIiH,GACHA,IAEDtpB,EAAOqiB,QAAUiD,EAAQkE,OACpB3nB,KAAK8mB,YACTQ,IACItnB,KAAK+mB,UAAY/mB,KAAK+mB,SAASpB,sBAAsB,CAClC3lB,KAAKknB,aAAelnB,KAAKknB,WAAWG,WAEzDrnB,KAAK+mB,SAASpB,qBAAqB3lB,SAMpCoP,MAAMC,QAAQyR,IACjBA,EAAYjhB,KAAK1B,GAGXA,KAGF6B,KAAKinB,OAObtnB,KAAKqjB,GACJ,GAAIhjB,KAAKknB,WAAY,CAKflnB,KAAK4nB,iBACT5nB,KAAK4nB,mBAGN,IAAK,IAAIC,EAAO7nB,KAAKknB,WAAWhV,WAAYlT,EAAI6oB,EAAK1V,QAASnT,EAAEgT,KAAMhT,EAAI6oB,EAAK1V,OAC9EnS,KAAK4nB,eAAe/nB,MAAMb,EAAE2B,MAAOqiB,IAGpC,KAAOhjB,KAAK4nB,eAAetpB,OAAS,GAAG,CACtC,MAAOyL,EAAUiZ,GAAShjB,KAAK4nB,eAAeE,QAC9C,IACyB,mBAAb/d,EACVA,EAAS3I,UAAKgI,EAAW4Z,GAEzBjZ,EAAS,GAAG3I,KAAK2I,EAAS,GAAIiZ,GAE9B,MAAOhkB,GACR2P,EAAApE,kBAAkBvL,MAMtBW,UACKK,KAAKknB,aACRlnB,KAAKknB,gBAAa9d,GAEfpJ,KAAK4nB,iBACR5nB,KAAK4nB,eAAetpB,OAAS,GAE1B0B,KAAKgnB,aACRhnB,KAAKgnB,YAAYxG,UAElBxgB,KAAK8mB,WAAY,GAxHMrD,EAAAkE,MAAQ,aAFjClnB,EAAAgjB,QAAAA,QAkIasE,UAA2CtE,EAIjD9jB,UAAUqoB;wCACf,GAAKhoB,KAAKknB,WAAV,CAOKlnB,KAAKioB,sBACTjoB,KAAKioB,wBAGN,IAAK,IAAIJ,EAAO7nB,KAAKknB,WAAWhV,WAAYlT,EAAI6oB,EAAK1V,QAASnT,EAAEgT,KAAMhT,EAAI6oB,EAAK1V,OAAQ,CACtF,MAAM+V,KACNloB,KAAKioB,oBAAoBpoB,MAAMb,EAAE2B,MAAOqnB,EAAQE,EAA8B,mBAAZlpB,EAAE2B,MAAuB3B,EAAE2B,MAAQ3B,EAAE2B,MAAM,IAAKunB,IAGnH,KAAOloB,KAAKioB,oBAAoB3pB,OAAS,GAAG,CAC3C,MAAOyL,EAAUiZ,EAAOkF,GAAaloB,KAAKioB,oBAAoBH,QAC9D,IACyB,mBAAb/d,EACVA,EAAS3I,UAAKgI,EAAW4Z,GAEzBjZ,EAAS,GAAG3I,KAAK2I,EAAS,GAAIiZ,GAE9B,MAAOhkB,GACR2P,EAAApE,kBAAkBvL,GAClB,SAKD+B,OAAOsgB,OAAO6G,SACR7Z,QAAQ8Z,IAAID,QArCrBznB,EAAAsnB,aAAAA,QA0CaK,EAMZzoB,cAHQK,KAAAqoB,cAAe,EACfroB,KAAAkkB,UAGPlkB,KAAKwjB,QAAU,IAAIC,GAClBgC,mBAAoB,IAAMzlB,KAAKylB,qBAC/BE,qBAAsB,IAAM3lB,KAAK2lB,yBAInC3C,YACC,OAAOhjB,KAAKwjB,QAAQR,MAGrBrjB,IAAIqjB,GACH,MAAMhkB,GAAMgkB,MAAOA,EAAOjZ,SAAU,MACpC/J,KAAKkkB,OAAOrkB,KAAKb,GAEbgB,KAAKqoB,cACRroB,KAAKsoB,KAAKtpB,GAYX,OAAOmlB,EAAApD,aAAaY,EAAAhQ,KATJ,KACX3R,KAAKqoB,cACRroB,KAAKuoB,OAAOvpB,GAGb,MAAMwpB,EAAMxoB,KAAKkkB,OAAOha,QAAQlL,GAChCgB,KAAKkkB,OAAOja,OAAOue,EAAK,MAMlB7oB,qBACPK,KAAKqoB,cAAe;AACpBroB,KAAKkkB,OAAO1iB,QAAQxC,GAAKgB,KAAKsoB,KAAKtpB,IAG5BW,uBACPK,KAAKqoB,cAAe,EACpBroB,KAAKkkB,OAAO1iB,QAAQxC,GAAKgB,KAAKuoB,OAAOvpB,IAG9BW,KAAKX,GACZA,EAAE+K,SAAW/K,EAAEgkB,MAAMtgB,GAAK1C,KAAKwjB,QAAQE,KAAKhhB,IAGrC/C,OAAOX,GACVA,EAAE+K,UACL/K,EAAE+K,SAASyW,UAEZxhB,EAAE+K,SAAW,KAGdpK,UACCK,KAAKwjB,QAAQhD,WA3Df/f,EAAA2nB,iBAAAA,QAmFaK,EAAb9oB,cAESK,KAAA0oB,WAER/oB,UAAaqjB,GACZ,MAAO,CAACjZ,EAAUkZ,EAAWnC,IACrBkC,EAAM5kB,IACZ,MAAM2mB,EAAS/kB,KAAK0oB,QAAQ1oB,KAAK0oB,QAAQpqB,OAAS,GAE9CymB,EACHA,EAAOllB,KAAK,IAAMkK,EAAS3I,KAAK6hB,EAAU7kB,IAE1C2L,EAAS3I,KAAK6hB,EAAU7kB,SAEvBgL,EAAW0X,GAIhBnhB,aAAuBuI,GACtB,MAAM6c,KACN/kB,KAAK0oB,QAAQ7oB,KAAKklB,GAClB,MAAMriB,EAAIwF,IAGV,OAFAlI,KAAK0oB,QAAQxb,MACb6X,EAAOvjB,QAAQ0jB,GAASA,KACjBxiB,GAxBTjC,EAAAgoB,cAAAA,QAkCaE,EAAbhpB,cAESK,KAAA4oB,WAAY,EACZ5oB,KAAA6oB,WAAuB9F,EAAM3B,KAC7BphB,KAAA8oB,mBAAkC3E,EAAAnD,WAAWI,KAE7CphB,KAAAwjB,QAAU,IAAIC,GACrB8D,sBAAuB,KACtBvnB,KAAK4oB,WAAY,EACjB5oB,KAAK8oB,mBAAqB9oB,KAAK6oB,WAAW7oB,KAAKwjB,QAAQE,KAAM1jB,KAAKwjB,UAEnEmC,qBAAsB,KACrB3lB,KAAK4oB,WAAY,EACjB5oB,KAAK8oB,mBAAmBtI,aAIjBxgB,KAAAgjB,MAAkBhjB,KAAKwjB,QAAQR,MAExC+F,UAAU/F,GACThjB,KAAK6oB,WAAa7F,EAEdhjB,KAAK4oB,YACR5oB,KAAK8oB,mBAAmBtI;AACxBxgB,KAAK8oB,mBAAqB9F,EAAMhjB,KAAKwjB,QAAQE,KAAM1jB,KAAKwjB,UAI1D7jB,UACCK,KAAK8oB,mBAAmBtI,UACxBxgB,KAAKwjB,QAAQhD,WA9Bf/f,EAAAkoB,MAAAA,gHC3vBMK,EAANrpB,cAKSK,KAAAipB,WAAqB,EACrBjpB,KAAAkpB,yBAAmC,EAC1BlpB,KAAAmpB,sBAAwB,IAAIC,EAAA3F,QAE7BzjB,KAAAqpB,qBAAsCrpB,KAAKmpB,sBAAsBnG,MAmBzEhjB,KAAAspB,YAAsB,EAuBbtpB,KAAAupB,uBAAyB,IAAIH,EAAA3F,QAE9BzjB,KAAAwpB,sBAAqCxpB,KAAKupB,uBAAuBvG,MA3C1ErjB,eACN,OAAOK,KAAKipB,WAENtpB,mCACN,OAAOilB,KAAK6E,MAAQzpB,KAAKkpB,yBAEnBvpB,aAAa+pB,EAAmBC,GAClC3pB,KAAKipB,aAAeS,IAIxB1pB,KAAKipB,WAAaS,EAElB1pB,KAAKkpB,yBAA2BS,EAAY,EAAI/E,KAAK6E,MACrDzpB,KAAKmpB,sBAAsBzF,KAAK1jB,KAAKipB,aAM/BtpB,gBACN,OAAOK,KAAKspB,YAEN3pB,cAAciqB,GACpB5pB,KAAKspB,YAAcM,EAIbjqB,gBACN,IAAIkqB,EAAMvqB,SAASwqB,cAAc,UAAUC,WAAW;CAOtD,OANUnqB,OAAOoqB,kBAAoB,IACrBH,EAAKI,8BACdJ,EAAKK,2BACLL,EAAKM,0BACLN,EAAKO,yBACLP,EAAKQ,wBAA0B,GAShC1qB,cAAc2qB,GAChBtqB,KAAKuqB,cAAgBD,IAIzBtqB,KAAKuqB,YAAcD,EACnBtqB,KAAKupB,uBAAuB7F,QAEtB/jB,eACN,OAAOK,KAAKuqB,aA7DUvB,EAAAwB,SAAW,IAAIxB,EAkEvCvoB,EAAAgqB,aAAA,SAA6Bf,EAAmBC,GAC/CX,EAAcwB,SAASC,aAAaf,EAAWC,IAEhDlpB,EAAAiqB,aAAA,WACC,OAAO1B,EAAcwB,SAASE,gBAG/BjqB,EAAAkqB,iCAAA,WACC,OAAO3B,EAAcwB,SAASG,oCAE/BlqB,EAAA4oB,qBAAA,SAAqC5nB,GACpC,OAAOunB,EAAcwB,SAASnB,qBAAqB5nB,IAIpDhB,EAAAmqB,cAAA,WACC,OAAO5B,EAAcwB,SAASI,iBAE/BnqB,EAAAoqB,cAAA,SAA8BjB,GAC7BZ,EAAcwB,SAASK,cAAcjB,IAGtCnpB,EAAAqqB,cAAA,WACC,OAAO9B,EAAcwB,SAASM,iBAG/BrqB,EAAAsqB,cAAA,SAA8BT,GAC7BtB,EAAcwB,SAASO,cAAcT,IAEtC7pB,EAAAuqB,aAAA,WACC,OAAOhC,EAAcwB,SAASQ,gBAElBvqB,EAAA+oB,sBAAwBR,EAAcwB,SAAShB,sBAE5D,MAAMyB,EAAYhY,UAAUgY;CAEfxqB,EAAAyqB,KAAQD,EAAU/gB,QAAQ,YAAc,EACxCzJ,EAAA0qB,OAAUF,EAAU/gB,QAAQ,UAAY,EACxCzJ,EAAA2qB,WAAa3qB,EAAAyqB,MAAQzqB,EAAA0qB,OAErB1qB,EAAA4qB,QAAWJ,EAAU/gB,QAAQ,UAAY,EACzCzJ,EAAA6qB,UAAaL,EAAU/gB,QAAQ,YAAc,EAC7CzJ,EAAA8qB,SAAYN,EAAU/gB,QAAQ,gBAAkB,EAChDzJ,EAAA+qB,SAAYP,EAAU/gB,QAAQ,WAAa,EAC3CzJ,EAAAgrB,UAAahrB,EAAA+qB,UAAaP,EAAU/gB,QAAQ,WAAa,EACzDzJ,EAAAirB,iBAAoBjrB,EAAA+qB,WAAa/qB,EAAAgrB,UAAYhrB,EAAA8qB,SAC7C9qB,EAAAkrB,OAAUV,EAAU/gB,QAAQ,SAAW,EACvCzJ,EAAAmrB,cAAgBnrB,EAAA0qB,QAAWF,EAAU/gB,QAAQ,aAAe,EAEzEzJ,EAAAorB,oBAAA,WACC,GAAIprB,EAAAyqB,KACH,OAAO,EAGR,GAAIzqB,EAAA0qB,OAAQ,CACX,IAAIrb,EAAQmb,EAAU/gB,QAAQ,SAC1B4hB,EAAUC,SAASd,EAAU/W,UAAUpE,EAAQ,EAAGmb,EAAU/gB,QAAQ,IAAK4F,IAAS,IAEtF,IAAKgc,GAAYA,GAAW,IAAMA,GAAW,GAC5C,OAAO,EAIT,OAAO,2GC7HKrrB,EAAAurB,SAAsB,EAAClqB,EAAuBwT,EAAc2W,KACxE,MAAM/jB,EAAKlJ,GAAKwkB,EAAQE,KAAK1kB,GACvBwkB,EAAU,IAAI4F,EAAA3F,SACnBgC,mBAAoB,KACnB3jB,EAAQoqB,iBAAiB5W,EAAMpN,EAAI+jB,IAEpCtG,qBAAsB,KACrB7jB,EAAQqqB,oBAAoB7W,EAAMpN,EAAI+jB,MAIxC,OAAOzI,EAAQR,QAQhBviB,EAAA2rB,KAAA,SAAiDpJ,GAChD,OAAOoG,EAAArG,MAAMrR,IAAIsR,EAAOhkB,IACvBA,EAAEqtB,iBACFrtB,EAAEstB,kBACKttB;8DCpBT,MAAMutB,EAAgBxrB,OAAOsgB,OAAO,SAAU5f,EAAU+qB,GACvD,MAAMjI,EAASjb,WAAW7H,EAASihB,KAAK8J,GAAU,GAClD,OAAS7sB,UAAY0J,aAAakb,OAGnC,IAAiBkI,GAAjB,SAAiBA,GAEAA,EAAAC,oBAAhB,SAAoC9L,GACnC,OAAIA,IAAU6L,EAAkBrL,MAAQR,IAAU6L,EAAkBE,WAGhE/L,aAAiBgM,MAGhBhM,GAA0B,iBAAVA,IAGkD,kBAAxDA,EAA4BlS,yBACyB,mBAAxDkS,EAA4BiM,yBAI5BJ,EAAArL,KAA0BrgB,OAAOsgB,QAC7C3S,yBAAyB,EACzBme,wBAAyBzD,EAAArG,MAAM3B,OAGnBqL,EAAAE,UAA+B5rB,OAAOsgB,QAClD3S,yBAAyB,EACzBme,wBAAyBN,IAxB3B,CAAiBE,EAAAhsB,EAAAgsB,oBAAAhsB,EAAAgsB,6BA4BXG,EAANjtB,cAESK,KAAA8sB,cAAwB,EACxB9sB,KAAA+sB,SAAgC,KAEjCptB,SACDK,KAAK8sB,eACT9sB,KAAK8sB,cAAe,EAChB9sB,KAAK+sB,WACR/sB,KAAK+sB,SAASrJ,UAAKta,GACnBpJ,KAAKwgB,YAKR9R,8BACC,OAAO1O,KAAK8sB,aAGbD,8BACC,OAAI7sB,KAAK8sB,aACDP,GAEHvsB,KAAK+sB,WACT/sB,KAAK+sB,SAAW,IAAI3D,EAAA3F,SAEdzjB,KAAK+sB,SAAS/J,OAGfrjB,UACFK,KAAK+sB,WACR/sB,KAAK+sB,SAASvM;AACdxgB,KAAK+sB,SAAW,aAKNC,EAIZ5e,YAMC,OALKpO,KAAKitB,SAGTjtB,KAAKitB,OAAS,IAAIL,GAEZ5sB,KAAKitB,OAGbttB,SACMK,KAAKitB,OAMCjtB,KAAKitB,kBAAkBL,GAEjC5sB,KAAKitB,OAAOC,SAJZltB,KAAKitB,OAASR,EAAkBE,UAQlChtB,UACMK,KAAKitB,OAICjtB,KAAKitB,kBAAkBL,GAEjC5sB,KAAKitB,OAAOzM,UAJZxgB,KAAKitB,OAASR,EAAkBrL,MA7BnC3gB,EAAAusB,wBAAAA,sEC5EA,SAAgBG,EAAche,GAC7B,OAAOA,GAA2C,mBAAdA,EAAKP,KAO1C,SAAgBwe,EAA2B3rB,GAC1C,MAAM4rB,EAAS,IAAIC,EAAAN,wBAEbO,EAAW9rB,EAAS4rB,EAAOjf,OAC3B0X,EAAU,IAAIzX,QAAW,CAACC,EAASC,KACxC8e,EAAOjf,MAAMye,wBAAwB,KACpCte,EAAO0K,EAAOrO,cAEfyD,QAAQC,QAAQif,GAAU3e,KAAKjO,IAC9B0sB,EAAO7M,UACPlS,EAAQ3N,IACNwK,IACFkiB,EAAO7M,UACPjS,EAAOpD,OAIT,OAAO,UACNxL,SACC0tB,EAAOH,SAERvtB,KAAqC2O,EAA2EC,GAC/G,OAAOuX,EAAQlX,KAAKN,EAASC,GAE9B5O,MAAuB4O,GACtB,OAAOvO,KAAK4O,UAAKxF,EAAWmF,GAE7B5O,QAAQ6tB,GACP,OAAO1H,EAAQ2H,QAAQD,KAsQ1B,SAAgBE,EAAQC,EAAgBvf,GACvC,OAAKA,EAIE,IAAIC,QAAQ,CAACC,EAASC,KAC5B,MAAMgW,EAASjb,WAAWgF,EAASqf,GACnCvf,EAAMye,wBAAwB,KAC7BxjB,aAAakb,GACbhW,EAAO0K,EAAOrO,gBAPRwiB,EAAwBhf,GAASsf,EAAQC,EAAQvf,IA0B1D,SAAgBwf,EAAYC,GAS3B,SAASC,EAAY3vB,QACLiL,IAAXjL,GAAmC,OAAXA,GAC3B4vB,EAAQluB,KAAK1B,GAGd,MAAM6I,EARC8I,EAAQzR,EAAMwvB,EAAiB/d,OAAa;CASnD,OAAI9I,EACIA,EAAE4H,KAAKkf,GAGRzf,QAAQC,QAAQyf,GAlBxB,MAAMA,KACN,IAAIje,EAAQ,EACZ,MAAMzR,EAAMwvB,EAAiBvvB,OAmB7B,OAAO+P,QAAQC,QAAQ,MAAMM,KAAKkf,oDA5VnCrtB,EAAA0sB,WAAAA,EAQA1sB,EAAA2sB,wBAAAA,EAiCA3sB,EAAAutB,UAAA,SAA6BvsB,GAC5B,OAAO,IAAI4M,QAAW,CAACC,EAASC,KAC/B,MAAMuH,EAAOrU,IACT0rB,EAAcrX,GACjBA,EAAKlH,KAAKN,EAASC,GAEnBD,EAAQwH,YAmCEmY,EAMZtuB,cACCK,KAAKkuB,cAAgB,KACrBluB,KAAKmuB,cAAgB,KACrBnuB,KAAKouB,qBAAuB,KAG7BzuB,MAAS0uB,GACR,GAAIruB,KAAKkuB,cAAe,CAGvB,GAFAluB,KAAKouB,qBAAuBC,GAEvBruB,KAAKmuB,cAAe,CACxB,MAAMG,EAAa,KAClBtuB,KAAKmuB,cAAgB,KAErB,MAAMhwB,EAAS6B,KAAKuuB,MAAMvuB,KAAKouB,sBAG/B,OAFApuB,KAAKouB,qBAAuB,KAErBjwB,GAGR6B,KAAKmuB,cAAgB,IAAI9f,QAAQpK,IAChCjE,KAAKkuB,cAAetf,KAAK0f,EAAYA,GAAY1f,KAAK3K,KAIxD,OAAO,IAAIoK,QAAQ,CAACpK,EAAGjF,KACtBgB,KAAKmuB,cAAevf,KAAK3K,EAAGjF,KAM9B,OAFAgB,KAAKkuB,cAAgBG,IAEd,IAAIhgB,QAAQ,CAACpK,EAAGjF,KACtBgB,KAAKkuB,cAAetf,KAAMzQ,IACzB6B,KAAKkuB,cAAgB,KACrBjqB,EAAE9F,IACCgN,IACHnL,KAAKkuB,cAAgB,KACrBlvB,EAAEmM,QA5CN1K,EAAAwtB,UAAAA,QAkDaO,EAAb7uB,cAESK,KAAA4S,QAAwBvE,QAAQC,QAAQ,MAEhD3O,MAAS8uB,GACR,OAAOzuB,KAAK4S,QAAU5S,KAAK4S,QAAQhE,KAAK,IAAM6f,MALhDhuB,EAAA+tB,UAAAA;OAgCaE,EAQZ/uB,YAAmBgvB,GAAA3uB,KAAA2uB,aAAAA,EAClB3uB,KAAK0tB,QAAU,KACf1tB,KAAK4uB,kBAAoB,KACzB5uB,KAAK6uB,UAAY,KACjB7uB,KAAK8uB,KAAO,KAGbnvB,QAAQmvB,EAA6B/lB,EAAgB/I,KAAK2uB,cAuBzD,OAtBA3uB,KAAK8uB,KAAOA,EACZ9uB,KAAK+uB,gBAEA/uB,KAAK4uB,oBACT5uB,KAAK4uB,kBAAoB,IAAIvgB,QAAQ,CAACpK,EAAGjF,KACxCgB,KAAK6uB,UAAY5qB,EACjBjE,KAAKgvB,SAAWhwB,IACd4P,KAAK,KACP5O,KAAK4uB,kBAAoB,KACzB5uB,KAAK6uB,UAAY,KACjB,MAAMC,EAAO9uB,KAAK8uB,KAGlB,OAFA9uB,KAAK8uB,KAAO,KAELA,OAIT9uB,KAAK0tB,QAAUpkB,WAAW,KACzBtJ,KAAK0tB,QAAU,KACf1tB,KAAK6uB,UAAW,OACd9lB,GAEI/I,KAAK4uB,kBAGbjvB,cACC,OAAwB,OAAjBK,KAAK0tB,QAGb/tB,SACCK,KAAK+uB,gBAED/uB,KAAK4uB,oBACR5uB,KAAKgvB,SAAS/V,EAAOrO,YACrB5K,KAAK4uB,kBAAoB,MAInBjvB,gBACc,OAAjBK,KAAK0tB,UACRrkB,aAAarJ,KAAK0tB,SAClB1tB,KAAK0tB,QAAU,MAIjB/tB,UACCK,KAAK+uB,iBA9DPtuB,EAAAiuB,QAAAA,QA2EaO,EAKZtvB,YAAYgvB,GACX3uB,KAAKkvB,QAAU,IAAIR,EAAQC,GAC3B3uB,KAAKmvB,UAAY,IAAIlB,EAGtBtuB,QAAQ0uB,EAAmCtlB,GAC1C,OAAO/I,KAAKkvB,QAAQE,QAAQ,IAAMpvB,KAAKmvB,UAAUZ,MAAMF,GAAiBtlB,GAGzEpJ,cACC,OAAOK,KAAKkvB,QAAQG,cAGrB1vB,SACCK,KAAKkvB,QAAQhC,SAGdvtB;AACCK,KAAKkvB,QAAQ1O,WAvBf/f,EAAAwuB,iBAAAA,QA8BaK,EAMZ3vB,cACCK,KAAKuvB,SAAU,EACfvvB,KAAKwvB,SAAW,IAAInhB,QAAiB,CAACpK,EAAGjF,KACxCgB,KAAKyvB,iBAAmBxrB,IAI1BtE,SACC,OAAOK,KAAKuvB,QAGb5vB,OACCK,KAAKuvB,SAAU,EACfvvB,KAAKyvB,kBAAiB,GAGvB9vB,OACC,OAAOK,KAAKwvB,UAvBd/uB,EAAA6uB,QAAAA,EA6BA7uB,EAAAitB,QAAAA,EAcAjtB,EAAAivB,kBAAA,SAAkCC,EAAqBjC,EAAU,GAChE,MAAMkC,EAAQtmB,WAAWqmB,EAASjC,GAClC,OAAOvJ,EAAApD,aAAa,IAAM1X,aAAaumB,KAGxCnvB,EAAAovB,aAAA,SAAgC/J,GAC/B,OAAOA,EAAQlX,UAAKxF,EAAW0b,QAAK1b,IAQrC3I,EAAAmtB,SAAAA,EAyBAntB,EAAAc,MAAA,SAAyBssB,EAAuCiC,EAAgCtsB,CAAAA,KAAOA,GAAGusB,EAAyB,MAClI,IAAIjgB,EAAQ,EACZ,MAAMzR,EAAMwvB,EAAiBvvB,OAEvB0xB,EAAgC,KACrC,GAAIlgB,GAASzR,EACZ,OAAOgQ,QAAQC,QAAQyhB,GAGxB,MAAME,EAAUpC,EAAiB/d,KAGjC,OAFgBzB,QAAQC,QAAQ2hB,KAEjBrhB,KAAKzQ,GACf2xB,EAAW3xB,GACPkQ,QAAQC,QAAQnQ,GAGjB6xB,MAIT,OAAOA,WAaKE,EAQZvwB,YAAYwwB,GANJnwB,KAAAgiB,MAAQ,EAOfhiB,KAAKmwB,uBAAyBA,EAC9BnwB,KAAKowB,uBACLpwB,KAAKqwB,gBAAkB,EACvBrwB,KAAKswB,YAAc,IAAIlH,EAAA3F,QAGxB8M,iBACC,OAAOvwB,KAAKswB,YAAYtN,MAGzB3hB,WACC,OAAOrB,KAAKgiB,MAIbriB,MAAMswB,GAGL,OAFAjwB,KAAKgiB,QAEE,IAAI3T,QAAW,CAACpK,EAAGjF,KACzBgB,KAAKowB,oBAAoBvwB,MAAOowB,QAAAA,EAAShsB,EAAAA,EAAGjF,EAAAA,IAC5CgB,KAAKwwB,YAIC7wB;AACP,KAAOK,KAAKowB,oBAAoB9xB,QAAU0B,KAAKqwB,gBAAkBrwB,KAAKmwB,wBAAwB,CAC7F,MAAMM,EAAezwB,KAAKowB,oBAAoBtI,QAC9C9nB,KAAKqwB,kBAEL,MAAMvK,EAAU2K,EAAaR,UAC7BnK,EAAQlX,KAAK6hB,EAAaxsB,EAAGwsB,EAAazxB,GAC1C8mB,EAAQlX,KAAK,IAAM5O,KAAK0wB,WAAY,IAAM1wB,KAAK0wB,aAIzC/wB,WACPK,KAAKgiB,QACLhiB,KAAKqwB,kBAEDrwB,KAAKowB,oBAAoB9xB,OAAS,EACrC0B,KAAKwwB,UAELxwB,KAAKswB,YAAY5M,OAIZ/jB,UACNK,KAAKswB,YAAY9P,WAxDnB/f,EAAAyvB,QAAAA,QA+DaS,UAAiBT,EAE7BvwB,cACCmT,MAAM,IAHRrS,EAAAkwB,MAAAA,QAWaC,EAGZjxB,cACCK,KAAK6wB,OAAS9vB,OAAOc,OAAO,MAGtBlC,SAASmxB,GACf,MAAM3vB,EAAM2vB,EAAS7pB,WACrB,IAAKjH,KAAK6wB,OAAO1vB,GAAM,CACtB,MAAMotB,EAAQ,IAAIoC,EAClBpC,EAAMgC,WAAW,KAChBhC,EAAM/N,iBACCxgB,KAAK6wB,OAAO1vB,KAGpBnB,KAAK6wB,OAAO1vB,GAAOotB,EAGpB,OAAOvuB,KAAK6wB,OAAO1vB,IAnBrBV,EAAAmwB,cAAAA,QAuBaG,UAAqB5M,EAAAnD,WAKjCrhB,YAAYqxB,EAAqBtD,GAChC5a,QACA9S,KAAKitB,QAAU,EAEO,mBAAX+D,GAA4C,iBAAZtD,GAC1C1tB,KAAKixB,YAAYD,EAAQtD,GAI3B/tB,UACCK,KAAKktB,SACLpa,MAAM0N,UAGP7gB,UACsB,IAAjBK,KAAKitB,SACR5jB,aAAarJ,KAAKitB,QAClBjtB,KAAKitB,QAAU,GAIjBttB,aAAaqxB,EAAoBtD,GAChC1tB,KAAKktB,SACLltB,KAAKitB,OAAS3jB,WAAW,KACxBtJ,KAAKitB,QAAU,EACf+D,KACEtD;AAGJ/tB,YAAYqxB,EAAoBtD,IACV,IAAjB1tB,KAAKitB,SAITjtB,KAAKitB,OAAS3jB,WAAW,KACxBtJ,KAAKitB,QAAU,EACf+D,KACEtD,KA1CLjtB,EAAAswB,aAAAA,QA8CaG,UAAsB/M,EAAAnD,WAIlCrhB,cACCmT,QACA9S,KAAKitB,QAAU,EAGhBttB,UACCK,KAAKktB,SACLpa,MAAM0N,UAGP7gB,UACsB,IAAjBK,KAAKitB,SACRkE,cAAcnxB,KAAKitB,QACnBjtB,KAAKitB,QAAU,GAIjBttB,aAAaqxB,EAAoBI,GAChCpxB,KAAKktB,SACLltB,KAAKitB,OAASoE,YAAY,KACzBL,KACEI,IAzBL3wB,EAAAywB,cAAAA,QA6BaI,EAQZ3xB,YAAYqxB,EAAkCtD,GAC7C1tB,KAAKuxB,cAAgB,EACrBvxB,KAAKgxB,OAASA,EACdhxB,KAAK0tB,QAAUA,EACf1tB,KAAKwxB,eAAiBxxB,KAAKyxB,UAAU/O,KAAK1iB,MAM3CL,UACCK,KAAKktB,SACLltB,KAAKgxB,OAAS,KAMfrxB,SACKK,KAAK0xB,gBACRroB,aAAarJ,KAAKuxB,cAClBvxB,KAAKuxB,cAAgB,GAOvB5xB,SAASoJ,EAAQ/I,KAAK0tB,SACrB1tB,KAAKktB,SACLltB,KAAKuxB,aAAejoB,WAAWtJ,KAAKwxB,eAAgBzoB,GAMrDpJ,cACC,OAA8B,IAAvBK,KAAKuxB,aAGL5xB,YACPK,KAAKuxB,cAAgB,EACjBvxB,KAAKgxB,QACRhxB,KAAK2xB,QAIGhyB,QACLK,KAAKgxB,QACRhxB,KAAKgxB,UAzDRvwB,EAAA6wB,iBAAAA,QA8DaM,UAAyBN,EAGrC3xB,YAAYqxB,EAA8BtD,GACzC5a,MAAMke,EAAQtD,GAHP1tB,KAAA6xB,SAMRlyB,KAAKmyB,GACJ9xB,KAAK6xB,MAAMhyB,KAAKiyB,GAEX9xB,KAAK0xB,eACT1xB,KAAK+xB,WAIGpyB,QACT,MAAMkyB,EAAQ7xB,KAAK6xB;CACnB7xB,KAAK6xB,SAED7xB,KAAKgxB,QACRhxB,KAAKgxB,OAAOa,GAIdlyB,UACCK,KAAK6xB,SAEL/e,MAAM0N,WA3BR/f,EAAAmxB,cAAAA,EAiCAnxB,EAAAuxB,OAAA,SAAuB9pB,KAAiBM,GACvC,OAAO,IAAI6F,QAAQ,CAACpK,EAAGjF,IAAMkJ,KAAMM,EAAM,CAAC2C,EAAUhN,IAAgBgN,EAAMnM,EAAEmM,GAAOlH,EAAE9F,MAKtFsC,EAAAwxB,QAAA,SAAwBC,EAAchqB,KAAiBM,GACtD,OAAO,IAAI6F,QAAQ,CAACC,EAASC,IAAWrG,EAAG9G,KAAK8wB,KAAY1pB,EAAM,CAAC2C,EAAUhN,IAAgBgN,EAAMoD,EAAOpD,GAAOmD,EAAQnQ,MAkB1H,WACC,GAAmC,mBAAxBg0B,qBAAoE,mBAAvBC,mBAAmC,CAC1F,MAAMC,EAA0BtxB,OAAOsgB,QACtCiR,YAAY,EACZC,cAAa,IAAY,KAE1B9xB,EAAA+xB,YAAc,CAACxB,IACd,MAAMzM,EAASjb,WAAW,IAAM0nB,EAAOqB,IACvC,IAAIrnB,GAAW,EACf,OACCrL,UACKqL,IAGJA,GAAW,EACX3B,aAAakb,aAKhB9jB,EAAA+xB,YAAc,EAACxB,EAAQtD,KACtB,MAAMnJ,EAAiB4N,oBAAoBnB,EAA2B,iBAAZtD,GAAyBA,QAAAA,QAAYtkB,GAC/F,IAAI4B,GAAW,EACf,OACCrL,UACKqL,IAGJA,GAAW,EACXonB,mBAAmB7N,QA7BxB,SAwCakO,EASZ9yB,YAAY+yB,GACX1yB,KAAK2yB,UAAY,MAChB,IACC3yB,KAAK4yB,OAASF,IACb,MAAOvnB,GACRnL,KAAK6yB,OAAS1nB,UAEdnL,KAAK8yB,SAAU,KAGjB9yB,KAAK+yB,QAAUtyB,EAAA+xB,YAAY,IAAMxyB,KAAK2yB,aAGvChzB,UACCK,KAAK+yB,QAAQvS,UAGd7gB,WAKC,GAJKK,KAAK8yB,UACT9yB,KAAK+yB,QAAQvS,UACbxgB,KAAK2yB,aAEF3yB,KAAK6yB,OACR,MAAM7yB,KAAK6yB,OAEZ,OAAO7yB,KAAK4yB,QAlCdnyB,EAAAgyB,UAAAA;sGCntBA,SAAiBO,GAMHA,EAAAC,SAAmB,WAKnBD,EAAAE,OAAiB,SAKjBF,EAAAG,SAAmB,UAKnBH,EAAAI,YAAsB,cAKtBJ,EAAAK,mBAA6B,qBAE7BL,EAAAM,KAAe,OAEfN,EAAAO,MAAgB,QAEhBP,EAAAQ,KAAe,OAEfR,EAAAS,OAAiB,SAEjBT,EAAAU,SAAmB,WAEnBV,EAAArxB,KAAe,OAEfqxB,EAAAW,QAAkB,UAxChC,CAAiBlzB,EAAAuyB,UAAAvyB,EAAAuyB,gHCAJvyB,EAAAmzB,iBAAmB,KAEhC,IAAIC,GAAa,EACbC,GAAe,EAEfC,GAAY,EAEZC,OAA8B5qB,EAC9B6qB,EAAoBxzB,EAAAmzB,iBACpBM,OAA8C9qB,EAgClD,MAAM+qB,EAAyC,oBAAZC,cAAuD,IAArBA,QAAQC,eAAiE,IAA9BD,QAAQC,SAASC,UAA6C,aAAjBF,QAAQ9e,KAGrK,GAAyB,iBAAdrC,WAA2BkhB,GAQ/B,GAAuB,iBAAZC,QAAsB,CACvCP,EAAmC,UAArBO,QAAQG,SACtBT,EAAqC,WAArBM,QAAQG,SAExBP,EAAUvzB,EAAAmzB,iBACVK,EAAYxzB,EAAAmzB,iBACZ,MAAMY,EAAeJ,QAAQK,IAAuB,kBACpD,GAAID,EACH,IACC,MAAME,EAAuB7c,KAAKC,MAAM0c,GAClCG,EAAWD,EAAUE,mBAAmB,KAC9CZ,EAAUU,EAAUG,OAEpBZ,EAAYU,GAAsBl0B,EAAAmzB,iBAClCM,EAA0BQ,EAAUR;CACnC,MAAOl1B,IAGV+0B,GAAY,OA1B6C,CACzD,MAAM9I,EAAYhY,UAAUgY,UAC5B4I,EAAa5I,EAAU/gB,QAAQ,YAAc,EAC7C4pB,EAAe7I,EAAU/gB,QAAQ,cAAgB,EAIjD+pB,EADAD,EAAU/gB,UAAU6hB,UAuBrB,SAAkBC,GACjBA,EAAAA,EAAA,IAAA,GAAA,MACAA,EAAAA,EAAA,IAAA,GAAA,MACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,QAAA,GAAA,UAJD,CAAkBt0B,EAAAs0B,WAAAt0B,EAAAs0B,cAMlBt0B,EAAAu0B,iBAAA,SAAiCT,GAChC,OAAQA,GACP,KAAA,EAAmB,MAAO,MAC1B,KAAA,EAAmB,MAAO,MAC1B,KAAA,EAAqB,MAAO,QAC5B,KAAA,EAAuB,MAAO,YAenB9zB,EAAAw0B,cAAgBpB,EAChBpzB,EAAAy0B,WAAY,EACZz0B,EAAA00B,aAAc,EACd10B,EAAA20B,SAAU,EACV30B,EAAA40B,UAAW,EACX50B,EAAA60B,OAAQ,EACR70B,EAAA8zB,SAAW,EAExB9zB,EAAA80B,WAAA,WACC,OAAOxB,IAAcF,GAAoC,IAArBO,QAAQoB,UAQhC/0B,EAAAq0B,SAAWb,EAOXxzB,EAAAo0B,OAASb,EAKTvzB,EAAAg1B,uBAAyBvB,EAEtC,MAAMwB,EAA4B,iBAATC,KAAoBA,KAAyB,iBAAXC,OAAsBA,UACpEn1B,EAAAo1B,QAAeH,EAE5B,IAAII,EAAyE,KAC7Er1B,EAAAs1B,aAAA,SAA6Bt0B,GAU5B,OATsB,OAAlBq0B,IAEFA,EADGr1B,EAAAo1B,QAAQE,aACKt1B,EAAAo1B,QAAQE,aAAarT,KAAKjiB,EAAAo1B,SACb,oBAAZzB,SAAuD,mBAArBA,QAAQpP,SAC3CoP,QAAQpP,SAAStC,KAAK0R,SAEtB3zB,EAAAo1B,QAAQvsB,WAAWoZ,KAAKjiB,EAAAo1B,UAGnCC,EAAer0B,KAGvB,SAAkBu0B,GACjBA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,UAAA,GAAA,YACAA,EAAAA,EAAA,MAAA,GAAA;CAHD,CAAkBv1B,EAAAu1B,kBAAAv1B,EAAAu1B,qBAKLv1B,EAAAmd,GAAMkW,EAAc,EAA8BD,EAAY,EAA0B,oHCpJrG,IAAIoC,EAA+C,IAAI7mB,MAAM,KACzD8mB,EAAkC,IAAI9mB,MAAK,MAE/C,WAKC,SAASsP,EAAO5K,EAAcsK,GAC7B6X,EAAaniB,GAAQsK,EACrB8X,EAAqB9X,GAAWtK,EANjC,IAAK,IAAI1V,EAAI,EAAGA,EAAI83B,EAAqB53B,OAAQF,IAChD83B,EAAqB93B,IAAM,EAQ5BsgB,EAAO,EAAC,GACRA,EAAO,EAAC,GACRA,EAAO,EAAC,GACRA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,GACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IAETA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IAETA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IAETA,EAAO,GAAE,IAETA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,GAAE,IACTA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KAEVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG;AACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IAEVA,EAAO,IAAG,IACVA,EAAO,IAAG,IAEVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,KACVA,EAAO,IAAG,KACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IACVA,EAAO,IAAG,IAEVA,EAAO,IAAG,IAMVA,EAAO,IAAG,KAENyX,EAAQjL,KACXxM,EAAO,GAAE,IACCyX,EAAQ7K,WAClB5M,EAAO,GAAE,IACTA,EAAO,IAAG,IACVA,EAAO,IAAG,IACN6V,EAASY,aACZzW,EAAO,IAAG,KAEDyX,EAAQ5K,WAClB7M,EAAO,GAAE,IACL6V,EAASY,YAEZzW,EAAO,GAAE,IAETA,EAAO,GAAE,KAtJZ,GAoKAje,EAAA21B,kBAAA,SAAkChY,GACjC,OAAO8X,EAAqB9X,IA2B7B,MAAMiY,EAAc9B,EAASY,YAAa,IAAiB,KAGrDmB,EAAc/B,EAASY,YAAa,KAAiB,UAE9CoB,EAiBZ52B,YAAY0tB,GAfHrtB,KAAAw2B,6BAA8B,EAgBtC,IAAIx3B,EAAIquB,EAERrtB,KAAKy2B,aAAez3B,EACpBgB,KAAK+B,OAAsB/C,EAAE+C,OAE7B/B,KAAK6f,QAAU7gB,EAAE6gB,QACjB7f,KAAK8f,SAAW9gB,EAAE8gB,SAClB9f,KAAK+f,OAAS/gB,EAAE+gB,OAChB/f,KAAKggB,QAAUhhB,EAAEghB,QACjBhgB,KAAKoe,QArEP,SAAwBpf,GACvB,GAAIA,EAAEmI,SAAU,CAEf,IAAIuvB,EAAOrrB,OAAO2I,aAAahV,EAAEmI,UAAUwvB,cAC3C,OAAOC,EAAA9X,aAAaE,WAAW0X,GAEhC,OAAOT,EAAaj3B,EAAEof,UAAQ,EA+DdyY,CAAe73B,GAC9BgB,KAAK8T,KAAO9U,EAAE8U,KAId9T,KAAK6f,QAAU7f,KAAK6f,SAAuB,IAAZ7f,KAAKoe,QACpCpe,KAAK+f,OAAS/f,KAAK+f,QAAsB,IAAZ/f,KAAKoe;AAClCpe,KAAK8f,SAAW9f,KAAK8f,UAAwB,IAAZ9f,KAAKoe,QACtCpe,KAAKggB,QAAUhgB,KAAKggB,SAAuB,KAAZhgB,KAAKoe,QAEpCpe,KAAK82B,cAAgB92B,KAAK+2B,qBAC1B/2B,KAAKg3B,qBAAuBh3B,KAAKi3B,4BAK3Bt3B,iBACFK,KAAKy2B,cAAgBz2B,KAAKy2B,aAAapK,gBAC1CrsB,KAAKy2B,aAAapK,iBAIb1sB,kBACFK,KAAKy2B,cAAgBz2B,KAAKy2B,aAAanK,iBAC1CtsB,KAAKy2B,aAAanK,kBAIb3sB,eACN,OAAOK,KAAKg3B,qBAGNr3B,OAAOoF,GACb,OAAO/E,KAAK82B,gBAAkB/xB,EAGvBpF,qBACP,IAAIwB,EAAG,EACS,IAAZnB,KAAKoe,SAAwC,IAAZpe,KAAKoe,SAAyC,IAAZpe,KAAKoe,SAAuC,KAAZpe,KAAKoe,UAC3Gjd,EAAMnB,KAAKoe,SAGZ,IAAIjgB,EAAS,EAeb,OAdI6B,KAAK6f,UACR1hB,GAAUk4B,GAEPr2B,KAAK+f,SACR5hB,GA9EY,KAgFT6B,KAAK8f,WACR3hB,GAhFc,MAkFX6B,KAAKggB,UACR7hB,GAAUm4B,GAEXn4B,GAAUgD,EAKHxB,4BACP,IAAIwB,EAAG,EAIP,OAHgB,IAAZnB,KAAKoe,SAAwC,IAAZpe,KAAKoe,SAAyC,IAAZpe,KAAKoe,SAAuC,KAAZpe,KAAKoe,UAC3Gjd,EAAMnB,KAAKoe,SAEL,IAAIwY,EAAA7Y,iBAAiB/d,KAAK6f,QAAS7f,KAAK8f,SAAU9f,KAAK+f,OAAQ/f,KAAKggB,QAAS7e,IA5FtFV,EAAA81B,sBAAAA;oECrLaW,EAiBZv3B,YAAYX,GACXgB,KAAKm3B,UAAYvS,KAAK6E,MACtBzpB,KAAKy2B,aAAez3B,EACpBgB,KAAKo3B,WAA0B,IAAbp4B,EAAEq4B,OACpBr3B,KAAKs3B,aAA4B,IAAbt4B,EAAEq4B,OACtBr3B,KAAKu3B,YAA2B,IAAbv4B,EAAEq4B,OAErBr3B,KAAK+B,OAAsB/C,EAAE+C,OAE7B/B,KAAKw3B,OAASx4B,EAAEw4B,QAAU,EACX,aAAXx4B,EAAEsW,OACLtV,KAAKw3B,OAAS,GAEfx3B,KAAK6f,QAAU7gB,EAAE6gB,QACjB7f,KAAK8f,SAAW9gB,EAAE8gB,SAClB9f,KAAK+f,OAAS/gB,EAAE+gB,OAChB/f,KAAKggB,QAAUhhB,EAAEghB,QAEM,iBAAZhhB,EAAEy4B,OACZz3B,KAAK03B,KAAO14B,EAAEy4B,MACdz3B,KAAK23B,KAAO34B,EAAE44B,QAGd53B,KAAK03B,KAAO14B,EAAE64B,QAAUv4B,SAASw4B,KAAKC,WAAaz4B,SAAS04B,gBAAiBD,WAC7E/3B,KAAK23B,KAAO34B,EAAEi5B,QAAU34B,SAASw4B,KAAKI,UAAY54B,SAAS04B,gBAAiBE,WAI7E,IAAIC,EAAgBC,EAAA14B,YAAY24B,iDAAiD1C,KAAM32B,EAAEs5B,MACzFt4B,KAAK03B,MAAQS,EAAc/3B,KAC3BJ,KAAK23B,MAAQQ,EAAch4B,IAGrBR,iBACFK,KAAKy2B,aAAapK,gBACrBrsB,KAAKy2B,aAAapK,iBAIb1sB,kBACFK,KAAKy2B,aAAanK,iBACrBtsB,KAAKy2B,aAAanK,mBA1DrB7rB,EAAAy2B,mBAAAA,QA4EaqB,UAAuBrB,EAInCv3B,YAAYX,GACX8T,MAAM9T,GACNgB,KAAKw4B,aAAqBx5B,EAAGw5B;AAN/B/3B,EAAA83B,eAAAA,QA2BaE,EAOZ94B,YAAYX,EAA4B05B,EAAiB,EAAGC,EAAiB,GAQ5E,GANA34B,KAAKy2B,aAAez3B,GAAK,KACzBgB,KAAK+B,OAAS/C,EAAKA,EAAE+C,QAAgB/C,EAAG45B,YAAc55B,EAAE65B,WAAc,KAEtE74B,KAAK24B,OAASA,EACd34B,KAAK04B,OAASA,EAEV15B,EAAG,CACN,IAAI85B,EAAkC95B,EAClC+5B,EAAiC/5B,OAGP,IAAnB85B,EAAGE,YACbh5B,KAAK24B,OAASG,EAAGE,YAAc,SACO,IAArBD,EAAGE,eAAiCF,EAAGG,OAASH,EAAGE,gBACpEj5B,KAAK24B,QAAUI,EAAGvB,OAAS,QAIE,IAAnBsB,EAAGK,YACThD,EAAQ1K,UAAY8I,EAASW,UAChCl1B,KAAK04B,QAAYI,EAAGK,YAAc,IAElCn5B,KAAK04B,OAASI,EAAGK,YAAc,SAEQ,IAAvBJ,EAAGK,iBAAmCL,EAAGG,OAASH,EAAGK,kBACtEp5B,KAAK04B,QAAU15B,EAAEw4B,OAAS,GAIP,IAAhBx3B,KAAK24B,QAAgC,IAAhB34B,KAAK04B,QAAgB15B,EAAEq6B,aAC/Cr5B,KAAK24B,OAAS35B,EAAEq6B,WAAa,MAKzB15B,iBACFK,KAAKy2B,cACJz2B,KAAKy2B,aAAapK,gBACrBrsB,KAAKy2B,aAAapK,iBAKd1sB,kBACFK,KAAKy2B,cACJz2B,KAAKy2B,aAAanK,iBACrBtsB,KAAKy2B,aAAanK,mBAvDtB7rB,EAAAg4B,mBAAAA,mGCoGA,SAAgBa,EAAsBnkB,EAAmCG,EAAcqa,EAA+B1D,GACrH,OAAO,IAAIsN,EAAYpkB,EAAMG,EAAMqa,EAAS1D,GAyO7C,SAAgBuN,EAAiBC,GAChC,OAAOn6B,SAASo6B,YAAaF,iBAAiBC,EAAI;AAWnD,SAASE,EAAa73B,EAAsB83B,EAAyBC,GACpE,IAAIC,EAAqCN,EAAiB13B,GACtDnB,EAAQ,IASZ,OARIm5B,IAEFn5B,EADGm5B,EAAcC,iBACTD,EAAcC,iBAAiBH,GAGzBE,EAAeE,aAAaH,IAGrCI,EAAgBn4B,EAASnB,GA8FjC,SAAgBu5B,EAAiBp4B,GAIhC,IAAIq4B,EAAer4B,EAAQq4B,aAAch6B,EAAM2B,EAAQs4B,UAAWh6B,EAAO0B,EAAQu4B,WAEjF,KAAuD,QAA/Cv4B,EAAuBA,EAAQw4B,aAAwBx4B,IAAYxC,SAASw4B,MAAQh2B,IAAYxC,SAAS04B,iBAAiB,CACjI73B,GAAO2B,EAAQo2B,UACf,IAAIj0B,EAAIu1B,EAAiB13B,GACrBmC,IACH7D,GAAwB,QAAhB6D,EAAEs2B,UAAsBz4B,EAAQi2B,YAAcj2B,EAAQi2B,YAG3Dj2B,IAAYq4B,IACf/5B,GAAQo6B,EAAUC,mBAAmB34B,GACrC3B,GAAOq6B,EAAUE,kBAAkB54B,GACnC3B,GAAO2B,EAAQs4B,UACfh6B,GAAQ0B,EAAQu4B,WAChBF,EAAer4B,EAAQq4B,cAIzB,OACC/5B,KAAMA,EACND,IAAKA,GAiFP,SAAgBw6B,EAAc74B,GAC7B,IAAI84B,EAASJ,EAAUK,cAAc/4B,GAAW04B,EAAUM,eAAeh5B,GACzE,OAAOA,EAAQi5B,YAAcH,EAS9B,SAAgBI,EAAoBl5B,GACnC,IAAI84B,EAASJ,EAAUK,cAAc/4B,GAAW04B,EAAUM,eAAeh5B,GACzE,OAAOA,EAAQm5B,YAAcL,EA6B9B,SAAgBM,EAAqBz8B,EAAqB2W,GACzD,IAAI+lB,EAAc/lB,EAAS1D,IAAK0pB,GACxB94B,KAAKS,IAAIi4B,EAAoBI,GAAQT,EAAcS,IAZ5D,SAAyBt5B,EAAsBrD,GAC9C,GAAgB,OAAZqD,EACH,OAAO,EAGR,IAAIu5B,EAAkBnB,EAAiBp4B,GACnCw5B,EAAiBpB,EAAiBz7B,GACtC,OAAO48B,EAAgBj7B,KAAOk7B,EAAel7B,KAKwBm7B,CAAgBH,EAAO38B,IAAW,GAGvG,OADe6D,KAAKS,OAAOo4B,GAM5B,SAAgBK,EAAWC,EAAwBC,GAClD,KAAOD,GAAW,CACjB,GAAIA,IAAcC,EACjB,OAAO,EAERD,EAAYA,EAAUnB,WAGvB,OAAO,EA2BR,SAAgBqB,EAAiBC,EAAyBt8B,SAASC,qBAAqB,QAAQ,IAC/F,IAAIs8B,EAAQv8B,SAASwqB,cAAc,SAInC,OAHA+R,EAAMvmB,KAAO,WACbumB,EAAMC,MAAQ,SACdF,EAAUG,YAAYF,GACfA;AAIR,SAASG,IAIR,OAHKC,IACJA,EAAoBN,KAEdM,EAySR,SAAgBC,EAA6B/mB,GAC5C,GAAKA,GAASA,EAAKgnB,aAAa,YAAhC,CAQA,GAAI78B,SAAS88B,gBAAkBjnB,EAAM,CACpC,IAAIknB,EAtBN,SAAiClnB,EAAmBmnB,GACnD,KAAOnnB,GAAM,CACZ,GAAIA,aAAgBonB,aAAepnB,EAAKgnB,aAAaG,GACpD,OAAOnnB,EAGRA,EAAOA,EAAKmlB,WAGb,OAAO,KAagBkC,CAAwBrnB,EAAKsnB,cAAe,YAC9DJ,GACHA,EAAgBK,QAIlBvnB,EAAKwnB,gBAAgB,8DA3jCtBl8B,EAAAm8B,UAAA,SAA0BznB,GACzB,KAAOA,EAAK0nB,YACX1nB,EAAK2nB,YAAY3nB,EAAK0nB,aAIxBp8B,EAAAs8B,WAAA,SAA2B5nB,GACtBA,EAAKmlB,YACRnlB,EAAKmlB,WAAWwC,YAAY3nB,IAI9B1U,EAAAu8B,QAAA,SAAwB7nB,GACvB,KAAOA,GAAM,CACZ,GAAIA,IAAS7V,SAASw4B,KACrB,OAAO,EAER3iB,EAAOA,EAAKmlB,WAEb,OAAO,GAYR,MAAM2C,EAAmB,UAKhBt9B,eAAewV,EAAmB+nB,GAEzC,IAAIC,EAAUhoB,EAAK+nB,UACnB,IAAKC,EAEJ,YADAn9B,KAAKo9B,YAAc,GAIpBF,EAAYA,EAAUG,OAEtB,IAAIC,EAAaH,EAAQ7+B,OACxBi/B,EAAWL,EAAU5+B,OAEtB,GAAiB,IAAbi/B,EAEH,YADAv9B,KAAKo9B,YAAc,GAIpB,GAAIE,EAAaC,EAEhB,YADAv9B,KAAKo9B,YAAc,GAIpB,GAAID,IAAYD,EAGf,OAFAl9B,KAAKo9B,WAAa,OAClBp9B,KAAKw9B,SAAWF,GAIjB,IACCG,EADGjV,GAAO,EAGX,MAAQA,EAAM2U,EAAQjzB,QAAQgzB,EAAW1U,EAAM,KAAO,GAAG,CAKxD,GAHAiV,EAASjV,EAAM+U,GAGF,IAAR/U,GAAwC,KAA3B2U,EAAQt1B,WAAW2gB,EAAM,KAAoD,KAA1B2U,EAAQt1B,WAAW41B,GAGvF,OAFAz9B,KAAKo9B,WAAa5U,OAClBxoB,KAAKw9B,SAAWC,EAAS;CAK1B,GAAIjV,EAAM,GAAgC,KAA3B2U,EAAQt1B,WAAW2gB,EAAM,IAAyBiV,IAAWH,EAG3E,OAFAt9B,KAAKo9B,WAAa5U,EAAM,OACxBxoB,KAAKw9B,SAAWC,GAKjB,GAAY,IAARjV,GAAaiV,IAAWH,EAG3B,OAFAt9B,KAAKo9B,WAAa,OAClBp9B,KAAKw9B,SAAWC,GAKlBz9B,KAAKo9B,YAAc,EAGpBz9B,SAASwV,EAAmB+nB,GAE3B,OADAl9B,KAAK09B,eAAevoB,EAAM+nB,IACE,IAArBl9B,KAAKo9B,WAGbz9B,WAAWwV,KAAsBwoB,GAChCA,EAAWn8B,QAAQo8B,GAAaA,EAAUxyB,MAAM,KAAK5J,QAAQiI,GAAQzJ,KAAK69B,SAAS1oB,EAAM1L,KAG1F9J,SAASwV,EAAmB+nB,GACtB/nB,EAAK+nB,WAGTl9B,KAAK09B,eAAevoB,EAAM+nB,IACD,IAArBl9B,KAAKo9B,aACRjoB,EAAK+nB,UAAY/nB,EAAK+nB,UAAY,IAAMA,IAJzC/nB,EAAK+nB,UAAYA,EASnBv9B,YAAYwV,EAAmB+nB,GAC9Bl9B,KAAK09B,eAAevoB,EAAM+nB,IACD,IAArBl9B,KAAKo9B,aAGRjoB,EAAK+nB,UAAY/nB,EAAK+nB,UAAUhpB,UAAU,EAAGlU,KAAKo9B,YAAcjoB,EAAK+nB,UAAUhpB,UAAUlU,KAAKw9B,WAIhG79B,cAAcwV,KAAsBwoB,GACnCA,EAAWn8B,QAAQo8B,GAAaA,EAAUxyB,MAAM,KAAK5J,QAAQiI,GAAQzJ,KAAK89B,YAAY3oB,EAAM1L,KAG7F9J,YAAYwV,EAAmB+nB,EAAmBa,GACjD/9B,KAAK09B,eAAevoB,EAAM+nB,IACD,IAArBl9B,KAAKo9B,iBAAuCh0B,IAAjB20B,GAA+BA,GAC7D/9B,KAAK89B,YAAY3oB,EAAM+nB,IAEC,IAArBl9B,KAAKo9B,iBAAuCh0B,IAAjB20B,IAA8BA,GAC5D/9B,KAAK69B,SAAS1oB,EAAM+nB,KAKjBc,EAAmB,UACxBr+B,SAASwV,EAAmB+nB,GAC3B,OAAOe,QAAQf,IAAc/nB,EAAK+oB,WAAa/oB,EAAK+oB,UAAUxoB,SAASwnB,GAGxEv9B,WAAWwV,KAAsBwoB,GAChCA,EAAWn8B,QAAQo8B,GAAaA,EAAUxyB,MAAM,KAAK5J,QAAQiI,GAAQzJ,KAAK69B,SAAS1oB,EAAM1L,KAG1F9J,SAASwV,EAAmB+nB;AACvBA,GAAa/nB,EAAK+oB,WACrB/oB,EAAK+oB,UAAUC,IAAIjB,GAIrBv9B,YAAYwV,EAAmB+nB,GAC1BA,GAAa/nB,EAAK+oB,WACrB/oB,EAAK+oB,UAAU5W,OAAO4V,GAIxBv9B,cAAcwV,KAAsBwoB,GACnCA,EAAWn8B,QAAQo8B,GAAaA,EAAUxyB,MAAM,KAAK5J,QAAQiI,GAAQzJ,KAAK89B,YAAY3oB,EAAM1L,KAG7F9J,YAAYwV,EAAmB+nB,EAAmBa,GAC7C5oB,EAAK+oB,WACR/oB,EAAK+oB,UAAUE,OAAOlB,EAAWa,KAO9BM,EAA4BlI,EAAQjL,KAAO+R,EAAmBe,EACvDv9B,EAAA69B,SAA8DD,EAAWC,SAAS5b,KAAK2b,GACvF59B,EAAAo9B,SAA2DQ,EAAWR,SAASnb,KAAK2b,GACpF59B,EAAA89B,WAAmEF,EAAWE,WAAW7b,KAAK2b,GAC9F59B,EAAAq9B,YAA8DO,EAAWP,YAAYpb,KAAK2b,GAC1F59B,EAAA+9B,cAAsEH,EAAWG,cAAc9b,KAAK2b,GACpG59B,EAAAg+B,YAAsFJ,EAAWI,YAAY/b,KAAK2b,SAEzH9E,EAOL55B,YAAYwV,EAAmCG,EAAcqa,EAA2B1D,GACvFjsB,KAAK0+B,MAAQvpB,EACbnV,KAAK2+B,MAAQrpB,EACbtV,KAAK4+B,SAAWjP,EAChB3vB,KAAK6+B,YAAe5S,IAAc,EAClCjsB,KAAK0+B,MAAMxS,iBAAiBlsB,KAAK2+B,MAAO3+B,KAAK4+B,SAAU5+B,KAAK6+B,aAGtDl/B,UACDK,KAAK4+B,WAKV5+B,KAAK0+B,MAAMvS,oBAAoBnsB,KAAK2+B,MAAO3+B,KAAK4+B,SAAU5+B,KAAK6+B,aAG/D7+B,KAAK0+B,MAAQ,KACb1+B,KAAK4+B,SAAW,OAMlBn+B,EAAA64B,sBAAAA,EAsBW74B,EAAAq+B,8BAAyE,SAAuC3pB,EAAmBG,EAAcqa,EAA+B1D,GAC1L,IAAI8S,EAAcpP,EAQlB,MANa,UAATra,GAA6B,cAATA,EACvBypB,EAdF,SAAmCpP,GAClC,OAAO,SAAU3wB,GAChB,OAAO2wB,EAAQ,IAAIqP,EAAA9H,mBAAmBl4B,KAYxBigC,CAA0BtP,GACrB,YAATra,GAA+B,aAATA,GAAgC,UAATA,IACvDypB,EAXF,SAAsCpP;AACrC,OAAO,SAAU3wB,GAChB,OAAO2wB,EAAQ,IAAIuP,EAAA3I,sBAAsBv3B,KAS3BmgC,CAA6BxP,IAGrC2J,EAAsBnkB,EAAMG,EAAMypB,EAAa9S,IAGvDxrB,EAAA2+B,yCAAA,SAAyDjqB,EAAewa,GACvE,OAAO2J,EAAsBnkB,EAAM,WAAanW,IAE/C,IAAIqgC,EAAgCrgC,EAAEsgC,eAAiBtgC,EAAE+C,OACzD,KAAOs9B,GAAaA,IAAclqB,GACjCkqB,EAAYA,EAAU/E,WAEnB+E,IAAclqB,GAIlBwa,EAAQ3wB,MAOV,IAAIugC,EAAiD,WAiC/CC,EAML7/B,YAAYqxB,EAAoByO,EAAmB,GAClDz/B,KAAK0/B,QAAU1O,EACfhxB,KAAKy/B,SAAWA,EAChBz/B,KAAK2/B,WAAY,EAGXhgC,UACNK,KAAK2/B,WAAY,EAGXhgC,UACN,IAAIK,KAAK2/B,UAIT,IACC3/B,KAAK0/B,UACJ,MAAO1gC,GACR2P,EAAApE,kBAAkBvL,IAKbW,YAAYkD,EAA4BD,GAC9C,OAAOA,EAAE68B,SAAW58B,EAAE48B,WAIxB,WAIC,IAAIG,KAIAC,EAAkD,KAIlDC,GAAqB,EAIrBC,GAAyB,EAiB7Bt/B,EAAAu/B,6BAA+B,EAAChP,EAAoByO,EAAmB,KACtE,IAAI3pB,EAAO,IAAI0pB,EAAwBxO,EAAQyO,GAQ/C,OAPAG,EAAW//B,KAAKiW,GAEXgqB,IACJA,GAAqB,EAxGxB,SAAiCr+B,GAC3B89B,IAIJA,EACC5J,KAAKsK,uBACItK,KAAMuK,yBACNvK,KAAMwK,6BACNxK,KAAMyK,0BACNzK,KAAM0K,wBARsB,CAAC5+B,GAC/B6H,WAAW,IAAM7H,GAAS,IAAImjB,MAAOC,WAAY,KAWnD0a,EAAgBn+B,KAAKu0B,KAAMl0B,GA2FhC6+B,CArByB,KAO1B,IANAR,GAAqB,EAErBD,EAAgBD,EAChBA,KAEAG,GAAyB,EAClBF,EAAcvhC,OAAS,GAC7BuhC,EAAc5xB,KAAKuxB,EAAwBvxB,MACjC4xB,EAAc/X,QACpByY,UAELR,GAAyB,KAYlBjqB,IAGRrV,EAAA+/B,wCAA0C,EAACxP,EAAoByO,KAC9D,GAAIM,EAAwB,CAC3B,IAAIjqB,EAAO,IAAI0pB,EAAwBxO,EAAQyO,GAE/C,OADAI,EAAehgC,KAAKiW,GACbA;AAEP,OAAOrV,EAAAu/B,6BAA6BhP,EAAQyO,KAnD/C,GAwDAh/B,EAAAggC,QAAA,SAAwBh/B,GACvB,OAAOhB,EAAAu/B,6BAA6Bv+B,EAAU,MAG/ChB,EAAAigC,OAAA,SAAuBj/B,GACtB,OAAOhB,EAAAu/B,6BAA6Bv+B,GAAW,YAoB1Ck/B,UAA2Dxc,EAAAnD,WAEhErhB,YAAYwV,EAAWG,EAAcqa,EAA6BiR,EANJ,SAAUC,EAAqBC,GAC7F,OAAOA,GAKwHC,EAPxG,IAQtBjuB,QAEA,IAAI+tB,EAAsB,KACtBG,EAAkB,EAClBtT,EAAU1tB,KAAKihC,UAAU,IAAIC,EAAAnQ,cAE7BoQ,EAAgB,KACnBH,GAAkB,IAAKpc,MAAQC,UAC/B8K,EAAWkR,GACXA,EAAY,MAGb7gC,KAAKihC,UAAU3H,EAAsBnkB,EAAMG,EAAOtW,IAEjD6hC,EAAYD,EAAYC,EAAW7hC,GACnC,IAAIoiC,GAAc,IAAKxc,MAAQC,UAAYmc,EAEvCI,GAAeL,GAClBrT,EAAQR,SACRiU,KAEAzT,EAAQuD,YAAYkQ,EAAeJ,EAAgBK,OAMvD3gC,EAAA4gC,+BAAA,SAAiFlsB,EAAWG,EAAcqa,EAA6BiR,EAAkCG,GACxK,OAAO,IAAIJ,EAAkCxrB,EAAMG,EAAMqa,EAASiR,EAAaG,IAGhFtgC,EAAA+4B,iBAAAA,EAMA,MAAMS,EACE,SAAUn4B,EAAsBnB,GACtC,OAAO2gC,WAAW3gC,IAAU,GAkB9BF,EAAA8gC,cAAA,SAA8Bz/B,GAG7B,GAAIA,IAAYxC,SAASw4B,KACxB,OAAO,IAAI0J,EAAU1/B,EAAQ2/B,YAAa3/B,EAAQ4/B,cAInD,GAAI9hC,OAAO+hC,YAAc/hC,OAAOgiC,YAC/B,OAAO,IAAIJ,EAAU5hC,OAAO+hC,WAAY/hC,OAAOgiC,aAIhD,GAAItiC,SAASw4B,MAAQx4B,SAASw4B,KAAK2J,aAAeniC,SAASw4B,KAAK4J,aAC/D,OAAO,IAAIF,EAAUliC,SAASw4B,KAAK2J,YAAaniC,SAASw4B,KAAK4J;CAI/D,GAAIpiC,SAAS04B,iBAAmB14B,SAAS04B,gBAAgByJ,aAAeniC,SAAS04B,gBAAgB0J,aAChG,OAAO,IAAIF,EAAUliC,SAAS04B,gBAAgByJ,YAAaniC,SAAS04B,gBAAgB0J,cAGrF,MAAM,IAAI7gC,MAAM,kDAGjB,MAAM25B,GAELC,mBAAoB,SAAU34B,GAC7B,OAAO63B,EAAa73B,EAAS,oBAAqB,oBAEnD+/B,oBAAqB,SAAU//B,GAC9B,OAAO63B,EAAa73B,EAAS,qBAAsB,qBAEpD44B,kBAAmB,SAAU54B,GAC5B,OAAO63B,EAAa73B,EAAS,mBAAoB,mBAElDggC,qBAAsB,SAAUhgC,GAC/B,OAAO63B,EAAa73B,EAAS,sBAAuB,sBAGrDigC,eAAgB,SAAUjgC,GACzB,OAAO63B,EAAa73B,EAAS,eAAgB,gBAE9CkgC,gBAAiB,SAAUlgC,GAC1B,OAAO63B,EAAa73B,EAAS,gBAAiB,iBAE/CmgC,cAAe,SAAUngC,GACxB,OAAO63B,EAAa73B,EAAS,cAAe,eAE7CogC,iBAAkB,SAAUpgC,GAC3B,OAAO63B,EAAa73B,EAAS,iBAAkB,kBAGhD+4B,cAAe,SAAU/4B,GACxB,OAAO63B,EAAa73B,EAAS,cAAe,eAE7CqgC,aAAc,SAAUrgC,GACvB,OAAO63B,EAAa73B,EAAS,aAAc;AAE5Cg5B,eAAgB,SAAUh5B,GACzB,OAAO63B,EAAa73B,EAAS,eAAgB,gBAE9CsgC,gBAAiB,SAAUtgC,GAC1B,OAAO63B,EAAa73B,EAAS,gBAAiB,iBAE/CugC,iBAAiB,SAMLb,EAIZ7hC,YAAY2iC,EAAeC,GAC1BviC,KAAKsiC,MAAQA,EACbtiC,KAAKuiC,OAASA,EAGf5iC,cAAckD,EAA0BD,GACvC,OAAIC,IAAMD,MAGLC,IAAMD,KAGJC,EAAEy/B,QAAU1/B,EAAE0/B,OAASz/B,EAAE0/B,SAAW3/B,EAAE2/B,SAhB/C9hC,EAAA+gC,UAAAA,EAoBA/gC,EAAAy5B,iBAAAA,EAmCAz5B,EAAAY,KAAA,SAAqBS,EAAsBwgC,EAAsBC,GAC3C,iBAAVD,IACVxgC,EAAQ+5B,MAAMyG,SAAWA,OAGJ,iBAAXC,IACVzgC,EAAQ+5B,MAAM0G,UAAYA,QAI5B9hC,EAAAgP,SAAA,SAAyB3N,EAAsB3B,EAAaqiC,EAAgBC,EAAiBriC,EAAeqP,EAAmB,YAC3G,iBAARtP,IACV2B,EAAQ+5B,MAAM17B,OAASA,OAGH,iBAAVqiC,IACV1gC,EAAQ+5B,MAAM2G,SAAWA,OAGJ,iBAAXC,IACV3gC,EAAQ+5B,MAAM4G,UAAYA,OAGP,iBAATriC,IACV0B,EAAQ+5B,MAAMz7B,QAAUA,OAGzB0B,EAAQ+5B,MAAMpsB,SAAWA,GAM1BhP,EAAAiiC,uBAAA,SAAuCC,GACtC,IAAIC,EAAKD,EAAQniC,wBACjB,OACCJ,KAAMwiC,EAAGxiC,KAAOK,EAAAoiC,eAAeC,QAC/B3iC,IAAKyiC,EAAGziC,IAAMM,EAAAoiC,eAAeE,QAC7BT,MAAOM,EAAGN,MACVC,OAAQK,EAAGL,SASA9hC,EAAAoiC,eAAkC,UAC9CC;AACC,MAA8B,iBAAnBljC,OAAOkjC,QAEVljC,OAAOkjC,QAEPxjC,SAASw4B,KAAKC,WAAaz4B,SAAS04B,gBAAiBD,WAI9DgL,cACC,MAA8B,iBAAnBnjC,OAAOmjC,QAEVnjC,OAAOmjC,QAEPzjC,SAASw4B,KAAKI,UAAY54B,SAAS04B,gBAAiBE,YAO9Dz3B,EAAAk6B,cAAAA,EAKAl6B,EAAAuiC,gBAAA,SAAgClhC,GAC/B,IAAImhC,EAASzI,EAAUC,mBAAmB34B,GAAW04B,EAAUqH,oBAAoB//B,GAC/EohC,EAAU1I,EAAUuH,eAAejgC,GAAW04B,EAAUwH,gBAAgBlgC,GAC5E,OAAOA,EAAQi5B,YAAckI,EAASC,GAGvCziC,EAAAu6B,oBAAAA,EAOAv6B,EAAA0iC,iBAAA,SAAiCrhC,GAChC,IAAImhC,EAASzI,EAAUE,kBAAkB54B,GAAW04B,EAAUsH,qBAAqBhgC,GAC/EohC,EAAU1I,EAAUyH,cAAcngC,GAAW04B,EAAU0H,iBAAiBpgC,GAC5E,OAAOA,EAAQshC,aAAeH,EAASC,GAKxCziC,EAAA4iC,eAAA,SAA+BvhC,GAC9B,IAAI84B,EAASJ,EAAU2H,aAAargC,GAAW04B,EAAU4H,gBAAgBtgC,GACzE,OAAOA,EAAQshC,aAAexI,GAc/Bn6B,EAAAy6B,qBAAAA,EAUAz6B,EAAA+6B,WAAAA,EAWA/6B,EAAA6iC,oBAAA,SAAoCnuB,EAAmBouB,EAAeC,GACrE,KAAOruB,GAAM,CACZ,GAAI1U,EAAA69B,SAASnpB,EAAMouB,GAClB,OAAOpuB,EAGR,GAAIquB,EACH,GAAiC,iBAAtBA,GACV,GAAI/iC,EAAA69B,SAASnpB,EAAMquB,GAClB,OAAO,UAGR,GAAIruB,IAASquB,EACZ,OAAO,KAKVruB,EAAoBA,EAAKmlB,WAG1B,OAAO,MAGR75B,EAAAk7B,iBAAAA,EAQA,IAAIM,EAA6C,KAoBjDx7B,EAAAgjC,cAAA,SAA8BC,EAAkBC,EAAiB9H,EAA0BG;AACrFH,GAAU8H,GAIC9H,EAAM+H,MAAOC,WAAWH,EAAW,IAAMC,EAAU,IAAK,IAGzEljC,EAAAqjC,iCAAA,SAAiDC,EAAkBlI,EAA0BG,KAC5F,IAAKH,EACJ,OAGD,IAAImI,EAzBL,SAAmCnI,GAClC,OAAIA,GAASA,EAAM+H,OAAS/H,EAAM+H,MAAMI,MAEhCnI,EAAM+H,MAAMI,MAEhBnI,GAASA,EAAM+H,OAAS/H,EAAM+H,MAAMK,SAEhCpI,EAAM+H,MAAMK,YAkBRC,CAA0BrI,GAClCsI,KACJ,IAAK,IAAI/lC,EAAI,EAAGA,EAAI4lC,EAAM1lC,OAAQF,KAEY,IADlC4lC,EAAM5lC,GACRgmC,aAAal6B,QAAQ65B,IAC7BI,EAAStkC,KAAKzB,GAIhB,IAAK,IAAIA,EAAI+lC,EAAS7lC,OAAS,EAAGF,GAAK,EAAGA,IACnCy9B,EAAM+H,MAAOS,WAAWF,EAAS/lC,KAIzCqC,EAAA6jC,cAAA,SAA8B71B,GAC7B,MAA2B,iBAAhB8tB,YACH9tB,aAAa8tB,YAEd9tB,GAAkB,iBAANA,GAAiC,IAAfA,EAAE81B,UAAwC,iBAAf91B,EAAE+1B,UAGtD/jC,EAAAgkC,WAEZC,MAAO,QACPC,SAAU,WACVC,SAAU,UACVC,WAAY,YACZC,WAAY,YACZC,WAAY,YACZC,UAAW,WACXC,YAAa,aACbC,YAAa,aACbC,aAAc,cACdC,MAAO,QAEPC,SAAU,UACVC,UAAW,WACXC,OAAQ,QAERC,KAAM,OACNC,OAAQ,SACRC,MAAO,QACPC,MAAO,QACPC,OAAQ,SACRC,OAAQ,SAERC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,MAAO,QACPC,MAAO,QACPC,SAAU,UACVC,UAAW;AACXC,KAAM,OACNC,MAAO,QAEPC,QAAS,UAETC,WAAY,YACZC,KAAM,OACNC,WAAY,YACZC,WAAY,YACZC,UAAW,WACXC,KAAM,OACNC,SAAU,UAEVC,gBAAiB5Q,EAAQ5K,SAAW,uBAAyB,iBAC7Dyb,cAAe7Q,EAAQ5K,SAAW,qBAAuB,eACzD0b,oBAAqB9Q,EAAQ5K,SAAW,2BAA6B,sBAQzD9qB,EAAAymC,aACZ9a,KAAM,SAAUptB,EAAcmoC,GACzBnoC,EAAEqtB,eACLrtB,EAAEqtB,iBAGIrtB,EAAGooC,aAAc,EAGpBD,IACCnoC,EAAEstB,gBACLttB,EAAEstB,kBAGIttB,EAAGmoC,cAAe,KAY5B1mC,EAAA4mC,qBAAA,SAAqClyB,GACpC,IAAIzS,KACJ,IAAK,IAAItE,EAAI,EAAG+W,GAAQA,EAAKovB,WAAapvB,EAAKmyB,aAAclpC,IAC5DsE,EAAEtE,GAAK+W,EAAK+iB,UACZ/iB,EAAgBA,EAAKmlB,WAEtB,OAAO53B,GAGRjC,EAAA8mC,wBAAA,SAAwCpyB,EAAeqyB,GACtD,IAAK,IAAIppC,EAAI,EAAG+W,GAAQA,EAAKovB,WAAapvB,EAAKmyB,aAAclpC,IACxD+W,EAAK+iB,YAAcsP,EAAMppC,KAC5B+W,EAAK+iB,UAAYsP,EAAMppC,IAExB+W,EAAgBA,EAAKmlB,kBAIjBmN,EAUL9nC,YAAYmC,GARJ9B,KAAA0nC,YAAc,IAAIC,EAAAlkB,QACjBzjB,KAAA4nC,WAA0B5nC,KAAK0nC,YAAY1kB,MAE5ChjB,KAAA6nC,WAAa,IAAIF,EAAAlkB,QAChBzjB,KAAA8nC,UAAyB9nC,KAAK6nC,WAAW7kB,MAE1ChjB,KAAA8gB;CAGP,IAAIinB,EAAWvM,EAAWl8B,SAAS88B,cAA4Bt6B,GAC3DkmC,GAAe,EAuBnB5e,EAAA4C,SAASlqB,EAASrB,EAAAgkC,UAAUyB,OAAO,EAAnC9c,CArBc,KACb4e,GAAe,EACVD,IACJA,GAAW,EACX/nC,KAAK0nC,YAAYhkB,SAiB+B,KAAM1jB,KAAK8gB,aAC7DsI,EAAA4C,SAASlqB,EAASrB,EAAAgkC,UAAU4B,MAAM,EAAlCjd,CAda,KACR2e,IACHC,GAAe,EACfpoC,OAAO0J,WAAW,KACb0+B,IACHA,GAAe,EACfD,GAAW,EACX/nC,KAAK6nC,WAAWnkB,SAEf,KAK2C,KAAM1jB,KAAK8gB,aAG5DnhB,UACCK,KAAK8gB,YAAcqD,EAAA3D,QAAQxgB,KAAK8gB,aAChC9gB,KAAK0nC,YAAYlnB,UACjBxgB,KAAK6nC,WAAWrnB,WAIlB/f,EAAAwnC,WAAA,SAA2BnmC,GAC1B,OAAO,IAAI2lC,EAAa3lC,IAGzBrB,EAAAynC,OAAA,SAAuCzpC,KAAwB2W,GAE9D,OADAA,EAAS5T,QAAQ45B,GAAS38B,EAAOs9B,YAAYX,IACtChmB,EAASA,EAAS9W,OAAS,IAGnCmC,EAAA0nC,QAAA,SAAwC1pC,EAAqB28B,GAE5D,OADA38B,EAAO2pC,aAAahN,EAAO38B,EAAOo+B,YAC3BzB,GAGR,MAAMiN,EAAiB,yCAEvB5nC,EAAA6nC,EAAA,SAAyCC,EAAqBC,KAAoCpzB,GACjG,IAAIqzB,EAAQJ,EAAeK,KAAKH,GAEhC,IAAKE,EACJ,MAAM,IAAI5nC,MAAM,oBAGjB,IAAI1C,EAASmB,SAASwqB,cAAc2e,EAAM,IAAM,OAiChD,OA/BIA,EAAM,KACTtqC,EAAOqnB,GAAKijB,EAAM,IAEfA,EAAM,KACTtqC,EAAO++B,UAAYuL,EAAM,GAAGtuB,QAAQ,MAAO,KAAKkjB,QAGjDmL,EAAQA,MACRznC,OAAO4nC,KAAKH,GAAOhnC,QAAQiI,IAC1B,MAAM9I,EAAQ6nC,EAAO/+B,GACjB,UAAUm/B,KAAKn/B,GACZtL,EAAQsL,GAAQ9I,EACH,aAAT8I,EACN9I,GACHxC,EAAO0qC,aAAap/B,EAAM,QAI3BtL,EAAO0qC,aAAap/B,EAAM9I,KAI5BmoC,EAAAj6B,SAASuG,GACP5T,QAAQ45B;AACJA,aAAiBtZ,KACpB3jB,EAAO49B,YAAYX,GAEnBj9B,EAAO49B,YAAYz8B,SAASypC,eAAe3N,MAIvCj9B,GAGRsC,EAAA2Z,KAAA,SAAqB4uB,EAAeC,GACnC,MAAM9qC,KAcN,OAZA6qC,EAAMxnC,QAAQ,CAAC2T,EAAMrF,KAChBA,EAAQ,IACPm5B,aAAqBnnB,KACxB3jB,EAAO0B,KAAKopC,EAAUC,aAEtB/qC,EAAO0B,KAAKP,SAASypC,eAAeE,KAItC9qC,EAAO0B,KAAKsV,KAGNhX,GAGRsC,EAAA0oC,KAAA,YAAwB52B,GACvB,IAAK,IAAIzQ,KAAWyQ,EACnBzQ,EAAQ+5B,MAAMuN,QAAU,GACxBtnC,EAAQ66B,gBAAgB,gBAI1Bl8B,EAAA4oC,KAAA,YAAwB92B,GACvB,IAAK,IAAIzQ,KAAWyQ,EACnBzQ,EAAQ+5B,MAAMuN,QAAU,OACxBtnC,EAAQ+mC,aAAa,cAAe,SAgBtCpoC,EAAAy7B,6BAAAA,EAmBAz7B,EAAAlB,qBAAA,SAAqC+pC,GACpC,OAAOl6B,MAAMpO,UAAUjB,MAAMqB,KAAK9B,SAASC,qBAAqB+pC,GAAM,IAGvE7oC,EAAA8oC,aAAA,SAAiDrhC,GAChD,OAAOlJ,IACNA,EAAEqtB,iBACFrtB,EAAEstB,kBACFpkB,EAAGlJ,KAILyB,EAAA+oC,iBAAA,WACC,OAAO,IAAIn7B,QAAaC,IAEJ,aADAhP,SAASmqC,YACMnqC,UAA8B,OAAlBA,SAASw4B,KACtDvD,EAASwB,aAAaznB,GAEtB1O,OAAOssB,iBAAiB,mBAAoB5d,GAAS,MAaxD7N,EAAAipC,uBAAA,SAAuCC,GACtC,MAAMC,EAAWhqC,OAAOoqB,iBAAmB2f,EAC3C,OAAOrnC,KAAKS,IAAI,EAAGT,KAAKqJ,MAAMi+B,IAAahqC,OAAOoqB,kBAUnDvpB,EAAAopC,mBAAA,SAAmCC;AAClC,GAAIvV,EAASc,UAAYc,EAAQvK,cAGhChsB,OAAOmqC,KAAKD,OACN,CACN,IAAIE,EAASpqC,OAAOmqC,OAChBC,IACFA,EAAeC,OAAS,KACzBD,EAAOtrC,SAASwrC,KAAOJ,KAK1BrpC,EAAA0pC,QAAA,SAAwBjiC,GACvB,MAAMkiC,EAAO,KACZliC,IACAmiC,EAAiB5pC,EAAAu/B,6BAA6BoK,IAG/C,IAAIC,EAAiB5pC,EAAAu/B,6BAA6BoK,GAClD,OAAOjmB,EAAApD,aAAa,IAAMspB,EAAe7pB,oeCroC1C,IAAiBikB,GAAjB,SAAiBA,GACHA,EAAA6F,IAAM,qBACN7F,EAAA8F,OAAS,wBACT9F,EAAA+F,MAAQ,uBACR/F,EAAAgG,IAAM,sBACNhG,EAAAiG,YAAc,6BAL5B,CAAiBjG,EAAAhkC,EAAAgkC,YAAAhkC,EAAAgkC,qBAuDJkG,UAAgBxmB,EAAAnD,WAY5BrhB,cACCmT;AAEA9S,KAAK4qC,iBACL5qC,KAAKukB,OAAS,KACdvkB,KAAK6qC,WACL7qC,KAAKihC,UAAU6J,EAASxR,sBAAsBh6B,SAAU,aAAeN,GAAkBgB,KAAK+qC,aAAa/rC,KAC3GgB,KAAKihC,UAAU6J,EAASxR,sBAAsBh6B,SAAU,WAAaN,GAAkBgB,KAAKgrC,WAAWhsC,KACvGgB,KAAKihC,UAAU6J,EAASxR,sBAAsBh6B,SAAU,YAAcN,GAAkBgB,KAAKirC,YAAYjsC,KAGnGW,iBAAiBmC,GAClB6oC,EAAQO,kBAGRP,EAAQngB,WACZmgB,EAAQngB,SAAW,IAAImgB,GAGxBA,EAAQngB,SAASqgB,QAAQhrC,KAAKiC,IAIvBnC,uBACP,MAAO,iBAAkBC,QAAiBqT,UAAUk4B,eAAiB,GAAKvrC,OAAOqT,UAAUm4B,iBAAmB,EAGxGzrC,UACFK,KAAKukB,SACRvkB,KAAKukB,OAAO/D,UACZxgB,KAAKukB,OAAS,MAGfzR,MAAM0N,UAGC7gB,aAAaX,GACpB,IAAIm4B,EAAYvS,KAAK6E,MAEjBzpB,KAAKukB,SACRvkB,KAAKukB,OAAO/D,UACZxgB,KAAKukB,OAAS,MAGf,IAAK,IAAInmB,EAAI,EAAGC,EAAMW,EAAEqsC,cAAc/sC,OAAQF,EAAIC,EAAKD,IAAK,CAC3D,IAAIktC,EAAQtsC,EAAEqsC,cAAcv1B,KAAK1X,GAEjC4B,KAAK4qC,cAAcU,EAAMC,aACxB/lB,GAAI8lB,EAAMC,WACVC,cAAeF,EAAMvpC,OACrB0pC,iBAAkBtU,EAClBuU,aAAcJ,EAAM7T,MACpBkU,aAAcL,EAAM1T,MACpBgU,mBAAoBzU,GACpB0U,cAAeP,EAAM7T,OACrBqU,cAAeR,EAAM1T,QAGtB,IAAImU,EAAM/rC,KAAKgsC,gBAAgBvH,EAAU+F,MAAOc,EAAMvpC;CACtDgqC,EAAItU,MAAQ6T,EAAM7T,MAClBsU,EAAInU,MAAQ0T,EAAM1T,MAClB53B,KAAKisC,cAAcF,GAGhB/rC,KAAKksC,aACRltC,EAAEqtB,iBACFrtB,EAAEstB,kBACFtsB,KAAKksC,YAAa,GAIZvsC,WAAWX,GAClB,IAAIm4B,EAAYvS,KAAK6E,MAEjB0iB,EAAmBprC,OAAO4nC,KAAK3oC,KAAK4qC,eAAetsC,OAEvD,IAAK,IAAIF,EAAI,EAAGC,EAAMW,EAAEotC,eAAe9tC,OAAQF,EAAIC,EAAKD,IAAK,CAE5D,IAAIktC,EAAQtsC,EAAEotC,eAAet2B,KAAK1X,GAElC,IAAK4B,KAAK4qC,cAAc9pC,eAAeuK,OAAOigC,EAAMC,aAAc,CACjEljC,QAAQC,KAAK,2BAA4BgjC,GACzC,SAGD,IAAI3pC,EAAO3B,KAAK4qC,cAAcU,EAAMC,YACnCc,EAAWznB,KAAK6E,MAAQ9nB,EAAK8pC,iBAE9B,GAAIY,EAAW1B,EAAQ2B,YACnBhqC,KAAK6B,IAAIxC,EAAK+pC,aAAea,EAAOl/B,KAAK1L,EAAKkqC,eAAiB,IAC/DvpC,KAAK6B,IAAIxC,EAAKgqC,aAAeY,EAAOl/B,KAAK1L,EAAKmqC,eAAiB,GAAI,CAEtE,IAAIC,EAAM/rC,KAAKgsC,gBAAgBvH,EAAU6F,IAAK3oC,EAAK6pC,eACnDO,EAAItU,MAAQ8U,EAAOl/B,KAAK1L,EAAKkqC,cAC7BE,EAAInU,MAAQ2U,EAAOl/B,KAAK1L,EAAKmqC,cAC7B9rC,KAAKisC,cAAcF,QAEb,GAAIM,GAAY1B,EAAQ2B,YAC3BhqC,KAAK6B,IAAIxC,EAAK+pC,aAAea,EAAOl/B,KAAK1L,EAAKkqC,eAAiB,IAC/DvpC,KAAK6B,IAAIxC,EAAKgqC,aAAeY,EAAOl/B,KAAK1L,EAAKmqC,eAAiB,GAAI,CAEtE,IAAIC,EAAM/rC,KAAKgsC,gBAAgBvH,EAAUiG,YAAa/oC,EAAK6pC,eAC3DO,EAAItU,MAAQ8U,EAAOl/B,KAAK1L,EAAKkqC,cAC7BE,EAAInU,MAAQ2U,EAAOl/B,KAAK1L,EAAKmqC,cAC7B9rC,KAAKisC,cAAcF,QAEb,GAAyB,IAArBI,EAAwB;AAClC,IAAIK,EAASD,EAAOl/B,KAAK1L,EAAKkqC,cAC1BY,EAASF,EAAOl/B,KAAK1L,EAAKmqC,cAE1BY,EAASH,EAAOl/B,KAAK1L,EAAKiqC,mBAAqBjqC,EAAKiqC,kBAAkB,GACtElT,EAAS8T,EAAS7qC,EAAKkqC,aAAa,GACpClT,EAAS8T,EAAS9qC,EAAKmqC,aAAa,GAGxC,MAAMa,EAAa3sC,KAAK6qC,QAAQ/7B,OAAOtL,GAAK7B,EAAK6pC,yBAAyB1pB,MAAQte,EAAEkS,SAAS/T,EAAK6pC,gBAClGxrC,KAAK4sC,QAAQD,EAAYxV,EACxB70B,KAAK6B,IAAIu0B,GAAUgU,EACnBhU,EAAS,EAAI,GAAK,EAClB8T,EACAlqC,KAAK6B,IAAIw0B,GAAU+T,EACnB/T,EAAS,EAAI,GAAK,EAClB8T,GAKFzsC,KAAKisC,cAAcjsC,KAAKgsC,gBAAgBvH,EAAUgG,IAAK9oC,EAAK6pC,uBAErDxrC,KAAK4qC,cAAcU,EAAMC,YAG7BvrC,KAAKksC,aACRltC,EAAEqtB,iBACFrtB,EAAEstB,kBACFtsB,KAAKksC,YAAa,GAIZvsC,gBAAgB2V,EAAcu3B,GACrC,IAAI7pB,EAA4B1jB,SAASwtC,YAAY,eAGrD,OAFA9pB,EAAM+pB,UAAUz3B,GAAM,GAAO,GAC7B0N,EAAMwoB,cAAgBqB,EACf7pB,EAGArjB,cAAcqjB,GACrBhjB,KAAK6qC,QAAQrpC,QAAQO,IAChBihB,EAAMwoB,yBAAyB1pB,MAAQ/f,EAAO2T,SAASsN,EAAMwoB,iBAChEzpC,EAAOkqC,cAAcjpB,GACrBhjB,KAAKksC,YAAa,KAKbvsC,QAAQgtC,EAA2BK,EAAYC,EAAYC,EAAchpC,EAAWipC,EAAYC,EAAcC,GACrHrtC,KAAKukB,OAASumB,EAAS9K,6BAA6B,KACnD,IAAIvW,EAAM7E,KAAK6E,MAGXijB,EAASjjB,EAAMujB,EAClBM,EAAc,EAAGC,EAAc,EAC/BC,GAAU,EAEXP,GAAMtC,EAAQ8C,gBAAkBf,EAChCS,GAAMxC,EAAQ8C,gBAAkBf,EAE5BO,EAAK,IACRO,GAAU,EACVF,EAAcJ,EAAOD,EAAKP,GAGvBS,EAAK,IACRK,GAAU,EACVD,EAAcH,EAAOD,EAAKT,GAI3B,IAAIX,EAAM/rC,KAAKgsC,gBAAgBvH,EAAU8F,QACzCwB,EAAI2B,aAAeJ,EACnBvB,EAAI4B,aAAeJ;AACnBZ,EAAWnrC,QAAQkf,GAAKA,EAAEurB,cAAcF,IAEnCyB,GACJxtC,KAAK4sC,QAAQD,EAAYljB,EAAKwjB,EAAIC,EAAMhpC,EAAIopC,EAAaH,EAAIC,EAAMC,EAAIE,KAKlE5tC,YAAYX,GACnB,IAAIm4B,EAAYvS,KAAK6E,MAErB,IAAK,IAAIrrB,EAAI,EAAGC,EAAMW,EAAEotC,eAAe9tC,OAAQF,EAAIC,EAAKD,IAAK,CAE5D,IAAIktC,EAAQtsC,EAAEotC,eAAet2B,KAAK1X,GAElC,IAAK4B,KAAK4qC,cAAc9pC,eAAeuK,OAAOigC,EAAMC,aAAc,CACjEljC,QAAQC,KAAK,0BAA2BgjC,GACxC,SAGD,IAAI3pC,EAAO3B,KAAK4qC,cAAcU,EAAMC,YAEhCQ,EAAM/rC,KAAKgsC,gBAAgBvH,EAAU8F,OAAQ5oC,EAAK6pC,eACtDO,EAAI2B,aAAepC,EAAM7T,MAAQ8U,EAAOl/B,KAAK1L,EAAKkqC,cAClDE,EAAI4B,aAAerC,EAAM1T,MAAQ2U,EAAOl/B,KAAK1L,EAAKmqC,cAClDC,EAAItU,MAAQ6T,EAAM7T,MAClBsU,EAAInU,MAAQ0T,EAAM1T,MAClB53B,KAAKisC,cAAcF,GAGfpqC,EAAKkqC,aAAavtC,OAAS,IAC9BqD,EAAKkqC,aAAa/jB,QAClBnmB,EAAKmqC,aAAahkB,QAClBnmB,EAAKiqC,kBAAkB9jB,SAGxBnmB,EAAKkqC,aAAahsC,KAAKyrC,EAAM7T,OAC7B91B,EAAKmqC,aAAajsC,KAAKyrC,EAAM1T,OAC7Bj2B,EAAKiqC,kBAAkB/rC,KAAKs3B,GAGzBn3B,KAAKksC,aACRltC,EAAEqtB,iBACFrtB,EAAEstB,kBACFtsB,KAAKksC,YAAa,IA3OIvB,EAAA8C,iBAAmB,KAE5B9C,EAAA2B,WAAa,IA+B5BsB,GADCC,EAAAzlC,iCAlCF3H,EAAAkqC,QAAAA;CCjDA,MAAMmD,EAA4C,oBAAZ1Z,SACrC2Z,IAAG,IAAoB,IACvBtZ,IAAK1zB,OAAOc,OAAO,MACnB0yB,eAAyB,OAAOyZ,EAAA9Y,UAAY,QAAU8Y,EAAA7Y,YAAc,SAAW,SAC/EnQ,SAASvjB,GAAqDusC,EAAAjY,aAAat0B,IACxE2yB,QAES3zB,EAAAstC,IAAMD,EAAYC,IAClBttC,EAAAg0B,IAAMqZ,EAAYrZ,IAClBh0B,EAAA8zB,SAAWuZ,EAAYvZ,SACvB9zB,EAAAukB,SAAW8oB,EAAY9oB,gECsCpC,SAASipB,EAAettC,EAAe8I,GACtC,GAAqB,iBAAV9I,EACV,MAAM,IAAIutC,EAAoBzkC,EAAM,SAAU9I,GAIhD,SAASwtC,EAAgBr6B,GACxB,OAAOA,IAASs6B,GAAsBt6B,IAASu6B,EAGhD,SAASC,EAAqBx6B,GAC7B,OAAOA,IAASs6B,EAGjB,SAASG,EAAoBz6B,GAC5B,OAAOA,GAAQ06B,GAAoB16B,GAAQ26B,GAC1C36B,GAAQ46B,GAAoB56B,GAAQ66B,EAItC,SAASC,EAAgBv5B,EAAMw5B,EAAgB5F,EAAWkF,GACzD,IAIIr6B,EAJA6O,EAAM,GACNmsB,EAAoB,EACpBC,GAAa,EACbC,EAAO,EAEX,IAAK,IAAI5wC,EAAI,EAAGA,GAAKiX,EAAK/W,SAAUF,EAAG,CACtC,GAAIA,EAAIiX,EAAK/W,OACZwV,EAAOuB,EAAKxN,WAAWzJ,OAEnB,CAAA,GAAI+vC,EAAgBr6B,GACxB,MAGAA,EAAOs6B,EAGR,GAAID,EAAgBr6B,GAAO,CAC1B,GAAIi7B,IAAc3wC,EAAI,GAAc,IAAT4wC,QAEpB,GAAID,IAAc3wC,EAAI,GAAc,IAAT4wC,EAAY,CAC7C,GAAIrsB,EAAIrkB,OAAS,GAA2B,IAAtBwwC,GACrBnsB,EAAI9a,WAAW8a,EAAIrkB,OAAS,KAAO2wC,GACnCtsB,EAAI9a,WAAW8a,EAAIrkB,OAAS,KAAO2wC,EAAU,CAC7C,GAAItsB,EAAIrkB,OAAS,EAAG,CACnB,MAAM4wC,EAAiBvsB,EAAIwsB,YAAYlG,IACf,IAApBiG,GACHvsB,EAAM,GACNmsB,EAAoB,GAGpBA,GADAnsB,EAAMA,EAAI5iB,MAAM,EAAGmvC,IACK5wC,OAAS,EAAIqkB,EAAIwsB,YAAYlG,GAEtD8F,EAAY3wC,EACZ4wC,EAAO,EACP,SACM,GAAmB,IAAfrsB,EAAIrkB,QAA+B,IAAfqkB,EAAIrkB,OAAc,CAChDqkB,EAAM,GACNmsB,EAAoB,EACpBC,EAAY3wC,EACZ4wC,EAAO,EACP,UAGEH,IACClsB,EAAIrkB,OAAS,EAChBqkB,MAAUsmB,MAGVtmB,EAAM,KAEPmsB,EAAoB,QAGjBnsB,EAAIrkB,OAAS,EAChBqkB,GAAOsmB,EAAY5zB,EAAKtV,MAAMgvC,EAAY,EAAG3wC,GAG7CukB,EAAMtN,EAAKtV,MAAMgvC,EAAY,EAAG3wC,GAEjC0wC,EAAoB1wC,EAAI2wC,EAAY,EAErCA,EAAY3wC;AACZ4wC,EAAO,OACGl7B,IAASm7B,IAAsB,IAAVD,IAC7BA,EAEFA,GAAQ,EAGV,OAAOrsB,EAGR,SAASysB,EAAQv2B,EAAKw2B,GACrB,MAAMC,EAAMD,EAAWC,KAAOD,EAAW11B,KACnC41B,EAAOF,EAAWE,OACrBF,EAAW5lC,MAAQ,KAAO4lC,EAAWG,KAAO,IAC/C,OAAKF,EAGDA,IAAQD,EAAW11B,KACf21B,EAAMC,EAEPD,EAAMz2B,EAAM02B,EALXA,mDAjIT,MAAMf,EAAmB,GACnBE,EAAmB,GACnBD,EAAmB,GACnBE,EAAmB,IACnBM,EAAW,GACXb,EAAqB,GACrBC,EAAsB,SAItBH,UAA4BrtC,MAEjClB,YAAY8J,EAAcgmC,EAAkBC,GAE3C,IAAIC,EACoB,iBAAbF,GAAsD,IAA7BA,EAASvlC,QAAQ,SACpDylC,EAAa,cACbF,EAAWA,EAASt1B,QAAQ,QAAS,KAErCw1B,EAAa,UAGd,IAAIC,EAEJA,UAAcnmC,OADsB,IAAvBA,EAAKS,QAAQ,KAAc,WAAa,cACtBylC,aAAsBF,IAGrD38B,MADA88B,6BAAiCF,MAyItBjvC,EAAAovC,OAEZlwC,WAAWmwC,GACV,IAAIC,EAAiB,GACjBC,EAAe,GACfC,GAAmB,EAEvB,IAAK,IAAI7xC,EAAI0xC,EAAaxxC,OAAS,EAAGF,IAAM,EAAGA,IAAK,CACnD,IAAIiX,EAyBJ,GAxBIjX,GAAK,EACRiX,EAAOy6B,EAAa1xC,GACT2xC,OAYE3mC,KAJbiM,EAAO+e,EAAQK,IAAI,IAAMsb,IAAmB3b,EAAQ2Z,QAKnD14B,EAAKtV,MAAM,EAAG,GAAGue,gBACjByxB,EAAezxB,cAAgB,OAC/BjJ,EAAO06B,EAAiB,MAdzB16B,EAAO+e,EAAQ2Z,MAkBhBE,EAAe54B,EAAM,QAGD,IAAhBA,EAAK/W,OACR,SAGD,MAAMD,EAAMgX,EAAK/W,OACjB,IAAI4xC,EAAU,EACVC,EAAS,GACTC,GAAa,EACjB,MAAMt8B,EAAOuB,EAAKxN,WAAW,GAG7B,GAAIxJ,EAAM,EACT,GAAI8vC,EAAgBr6B,GAOnB,GAFAs8B,GAAa,EAETjC,EAAgB94B,EAAKxN,WAAW,IAAK,CAExC,IAAIsF,EAAI,EACJgG,EAAOhG,EAEX,KAAOA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAC1B,MAAMqM,EAAYnK,EAAKtV,MAAMoT,EAAMhG,GAInC,IAFAgG,EAAOhG,EAEAA,EAAI9O,GACL8vC,EAAgB94B,EAAKxN,WAAWsF,MADpBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA;AAKdA,IAAM9O,GAGT8xC,EAAS,OAAS3wB,EAAY,KAAOnK,EAAKtV,MAAMoT,GAChD+8B,EAAU/iC,GACAA,IAAMgG,IAGhBg9B,EAAS,OAAS3wB,EAAY,KAAOnK,EAAKtV,MAAMoT,EAAMhG,GACtD+iC,EAAU/iC,UAKb+iC,EAAU,OAED3B,EAAoBz6B,IA7PhB,KAgQVuB,EAAKxN,WAAW,KACnBsoC,EAAS96B,EAAKtV,MAAM,EAAG,GACvBmwC,EAAU,EACN7xC,EAAM,GACL8vC,EAAgB94B,EAAKxN,WAAW,MAGnCuoC,GAAa,EACbF,EAAU,SAKJ/B,EAAgBr6B,KAE1Bo8B,EAAU,EACVE,GAAa,GAGd,KAAID,EAAO7xC,OAAS,GACnByxC,EAAezxC,OAAS,GACxB6xC,EAAO7xB,gBAAkByxB,EAAezxB,iBAKX,IAA1ByxB,EAAezxC,QAAgB6xC,EAAO7xC,OAAS,IAClDyxC,EAAiBI,GAEbF,IACJD,EAAe36B,EAAKtV,MAAMmwC,GAAW,KAAOF,EAC5CC,EAAmBG,GAGhBL,EAAezxC,OAAS,GAAK2xC,GAChC,MAYF,OAHAD,EAAepB,EAAgBoB,GAAeC,EAAkB,KAC/D9B,GAEO4B,GAAkBE,EAAmB,KAAO,IAAMD,GACzD,KAGFrwC,UAAU0V,GACT44B,EAAe54B,EAAM,QACrB,MAAMhX,EAAMgX,EAAK/W,OACjB,GAAY,IAARD,EACH,MAAO,IAER,IACI8xC,EADAD,EAAU,EAEVE,GAAa,EACjB,MAAMt8B,EAAOuB,EAAKxN,WAAW,GAG7B,GAAIxJ,EAAM,EACT,GAAI8vC,EAAgBr6B,GAOnB,GAFAs8B,GAAa,EAETjC,EAAgB94B,EAAKxN,WAAW,IAAK,CAExC,IAAIsF,EAAI,EACJgG,EAAOhG,EAEX,KAAOA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAC1B,MAAMqM,EAAYnK,EAAKtV,MAAMoT,EAAMhG,GAInC,IAFAgG,EAAOhG,EAEAA,EAAI9O,GACL8vC,EAAgB94B,EAAKxN,WAAWsF,MADpBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,IAAM9O,EAKT,MAAO,OAASmhB,EAAY,KAAOnK,EAAKtV,MAAMoT,GAAQ,KAC5ChG,IAAMgG,IAGhBg9B,EAAS,OAAS3wB,EAAY,KAAOnK,EAAKtV,MAAMoT,EAAMhG,GACtD+iC,EAAU/iC,UAKb+iC,EAAU,OAED3B,EAAoBz6B,IArXf,KAwXXuB,EAAKxN,WAAW,KACnBsoC,EAAS96B,EAAKtV,MAAM,EAAG,GACvBmwC,EAAU,EACN7xC,EAAM,GACL8vC,EAAgB94B,EAAKxN,WAAW,MAGnCuoC,GAAa,EACbF,EAAU,SAKR,GAAI/B,EAAgBr6B,GAG1B,MAAO,KAGR,IAAIzG,EAaJ,OANoB,KALnBA,EADG6iC,EAAU7xC,EACNuwC,EAAgBv5B,EAAKtV,MAAMmwC,IAAWE,EAAY,KACxDjC,GAEM,IAEC7vC,QAAiB8xC,IACzB/iC,EAAO;AAEJA,EAAK/O,OAAS,GAAK6vC,EAAgB94B,EAAKxN,WAAWxJ,EAAM,MAC5DgP,GAAQ,WAEMjE,IAAX+mC,EACCC,EACC/iC,EAAK/O,OAAS,EACV,KAAO+O,EAGP,KAEEA,EAAK/O,OAAS,EACjB+O,EAEA,GAEE+iC,EACN/iC,EAAK/O,OAAS,EACV6xC,EAAS,KAAO9iC,EAGhB8iC,EAAS,KAEP9iC,EAAK/O,OAAS,EACjB6xC,EAAS9iC,EAET8iC,GAITxwC,WAAW0V,GACV44B,EAAe54B,EAAM,QACrB,MAAMhX,EAAMgX,EAAK/W,OACjB,GAAY,IAARD,EACH,OAAO,EAGR,MAAMyV,EAAOuB,EAAKxN,WAAW,GAC7B,QAAIsmC,EAAgBr6B,OAETy6B,EAAoBz6B,IAG1BzV,EAAM,GAhcM,KAgcDgX,EAAKxN,WAAW,IAC1BsmC,EAAgB94B,EAAKxN,WAAW,MAQvClI,QAAQ0wC,GACP,GAAqB,IAAjBA,EAAM/xC,OACT,MAAO,IAGR,IAAIgyC,EACA9wB,EACJ,IAAK,IAAIphB,EAAI,EAAGA,EAAIiyC,EAAM/xC,SAAUF,EAAG,CACtC,MAAMiG,EAAMgsC,EAAMjyC,GAClB6vC,EAAe5pC,EAAK,QAChBA,EAAI/F,OAAS,SACD8K,IAAXknC,EACHA,EAAS9wB,EAAYnb,EAGrBisC,GAAU,KAAOjsC,GAKpB,QAAe+E,IAAXknC,EACH,MAAO,IAgBR,IAAIC,GAAe,EACfC,EAAa,EACjB,GAAIrC,EAAgB3uB,EAAU3X,WAAW,IAAK,GAC3C2oC,EACF,MAAMC,EAAWjxB,EAAUlhB,OACvBmyC,EAAW,GACVtC,EAAgB3uB,EAAU3X,WAAW,QACtC2oC,EACEC,EAAW,IACVtC,EAAgB3uB,EAAU3X,WAAW,MACtC2oC,EAIFD,GAAe,IAMpB,GAAIA,EAAc,CAEjB,KAAOC,EAAaF,EAAOhyC,QACrB6vC,EAAgBmC,EAAOzoC,WAAW2oC,MADHA,GAOjCA,GAAc,IACjBF,EAAS,KAAOA,EAAOvwC,MAAMywC,IAI/B,OAAO/vC,EAAAovC,MAAMa,UAAUJ,IAQxB3wC,SAASuB,EAAc8N,GAItB,GAHAi/B,EAAe/sC,EAAM,QACrB+sC,EAAej/B,EAAI,MAEf9N,IAAS8N,EACZ,MAAO,GAGR,MAAM2hC,EAAWlwC,EAAAovC,MAAMvhC,QAAQpN,GACzB0vC,EAASnwC,EAAAovC,MAAMvhC,QAAQU,GAE7B,GAAI2hC,IAAaC,EAChB,MAAO,GAMR,GAHA1vC,EAAOyvC,EAASryB,cAChBtP,EAAK4hC,EAAOtyB,cAERpd,IAAS8N,EACZ,MAAO,GAIR,IAAI6hC,EAAY,EAChB,KAAOA,EAAY3vC,EAAK5C,QACnB4C,EAAK2G,WAAWgpC,KAAexC,IADFwC,GAMlC,IAAIC,EAAU5vC,EAAK5C,OACnB,KAAOwyC,EAAU,EAAID,GAChB3vC,EAAK2G,WAAWipC,EAAU,KAAOzC,IADJyC,GAKlC,MAAMC,EAAWD,EAAUD,EAG3B,IAAIG,EAAU;CACd,KAAOA,EAAUhiC,EAAG1Q,QACf0Q,EAAGnH,WAAWmpC,KAAa3C,IADF2C,GAM9B,IAAIC,EAAQjiC,EAAG1Q,OACf,KAAO2yC,EAAQ,EAAID,GACdhiC,EAAGnH,WAAWopC,EAAQ,KAAO5C,IADJ4C,GAK9B,MAAMC,EAASD,EAAQD,EAGjB1yC,EAAUyyC,EAAUG,EAAQH,EAAUG,EAC5C,IAAIC,GAAiB,EACjB/yC,EAAI,EACR,KAAOA,GAAKE,IAAUF,EAAG,CACxB,GAAIA,IAAME,EAAQ,CACjB,GAAI4yC,EAAQ5yC,EAAQ,CACnB,GAAI0Q,EAAGnH,WAAWmpC,EAAU5yC,KAAOiwC,EAGlC,OAAOuC,EAAO7wC,MAAMixC,EAAU5yC,EAAI,GAC5B,GAAU,IAANA,EAGV,OAAOwyC,EAAO7wC,MAAMixC,EAAU5yC,GAG5B2yC,EAAUzyC,IACT4C,EAAK2G,WAAWgpC,EAAYzyC,KAAOiwC,EAGtC8C,EAAgB/yC,EACA,IAANA,IAGV+yC,EAAgB,IAGlB,MAED,MAAMC,EAAWlwC,EAAK2G,WAAWgpC,EAAYzyC,GAE7C,GAAIgzC,IADWpiC,EAAGnH,WAAWmpC,EAAU5yC,GAEtC,MAEQgzC,IAAa/C,IACrB8C,EAAgB/yC,GAMlB,GAAIA,IAAME,IAA6B,IAAnB6yC,EACnB,OAAOP,EAGR,IAAIS,EAAM,GAMV,KALuB,IAAnBF,IACHA,EAAgB,GAIZ/yC,EAAIyyC,EAAYM,EAAgB,EAAG/yC,GAAK0yC,IAAW1yC,EACnDA,IAAM0yC,GAAW5vC,EAAK2G,WAAWzJ,KAAOiwC,IACxB,IAAfgD,EAAI/yC,OACP+yC,GAAO,KAGPA,GAAO,QAOV,OAAIA,EAAI/yC,OAAS,EACT+yC,EAAMT,EAAO7wC,MAAMixC,EAAUG,EAAeF,IAGnDD,GAAWG,EACPP,EAAO/oC,WAAWmpC,KAAa3C,KAChC2C,EAEIJ,EAAO7wC,MAAMixC,EAASC,KAI/BtxC,iBAAiB0V,GAEhB,GAAoB,iBAATA,EACV,OAAOA,EAGR,GAAoB,IAAhBA,EAAK/W,OACR,MAAO,GAGR,MAAMgzC,EAAe7wC,EAAAovC,MAAMvhC,QAAQ+G,GAEnC,GAAIi8B,EAAahzC,QAAU,EAC1B,GAAIgzC,EAAazpC,WAAW,KAAOwmC,GAGlC,GAAIiD,EAAazpC,WAAW,KAAOwmC,EAAqB,CACvD,MAAMv6B,EAAOw9B,EAAazpC,WAAW,GACrC,GA5qBsB,KA4qBlBiM,GAA+BA,IAASm7B,EAE3C,MAAO,eAAiBqC,EAAavxC,MAAM,SAGvC,GAAIwuC,EAAoB+C,EAAazpC,WAAW,KAlrBvC,KAqrBXypC,EAAazpC,WAAW,IAC3BypC,EAAazpC,WAAW,KAAOwmC,EAE/B,MAAO,UAAYiD,EAKtB,OAAOj8B,GAGR1V,QAAQ0V,GACP44B,EAAe54B,EAAM,QACrB,MAAMhX,EAAMgX,EAAK/W,OACjB,GAAY,IAARD,EACH,MAAO,IAER,IAAI6xC,GAAW,EACXv9B,GAAO,EACP4+B,GAAe,EACf57B,EAAS,EACb,MAAM7B,EAAOuB,EAAKxN,WAAW;CAG7B,GAAIxJ,EAAM,EACT,GAAI8vC,EAAgBr6B,IAKnB,GAFAo8B,EAAUv6B,EAAS,EAEfw4B,EAAgB94B,EAAKxN,WAAW,IAAK,CAExC,IAAIsF,EAAI,EACJgG,EAAOhG,EAEX,KAAOA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,GACL8vC,EAAgB94B,EAAKxN,WAAWsF,MADpBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,IAAM9O,EAET,OAAOgX,EAEJlI,IAAMgG,IAKT+8B,EAAUv6B,EAASxI,EAAI,WAKjBohC,EAAoBz6B,IA7vBf,KAgwBXuB,EAAKxN,WAAW,KACnBqoC,EAAUv6B,EAAS,EACftX,EAAM,GACL8vC,EAAgB94B,EAAKxN,WAAW,MACnCqoC,EAAUv6B,EAAS,SAKjB,GAAIw4B,EAAgBr6B,GAG1B,OAAOuB,EAGR,IAAK,IAAIjX,EAAIC,EAAM,EAAGD,GAAKuX,IAAUvX,EACpC,GAAI+vC,EAAgB94B,EAAKxN,WAAWzJ,KACnC,IAAKmzC,EAAc,CAClB5+B,EAAMvU,EACN,YAIDmzC,GAAe,EAIjB,IAAa,IAAT5+B,EAAY,CACf,IAAiB,IAAbu9B,EACH,MAAO,IAGPv9B,EAAMu9B,EAGR,OAAO76B,EAAKtV,MAAM,EAAG4S,IAGtBhT,SAAS0V,EAAcm6B,QACVpmC,IAARomC,GACHvB,EAAeuB,EAAK,OAErBvB,EAAe54B,EAAM,QACrB,IAGIjX,EAHAqO,EAAQ,EACRkG,GAAO,EACP4+B,GAAe,EAMnB,GAAIl8B,EAAK/W,QAAU,EAAG,CAEjBiwC,EADUl5B,EAAKxN,WAAW,KApzBd,KAszBXwN,EAAKxN,WAAW,KACnB4E,EAAQ,GAKX,QAAYrD,IAARomC,GAAqBA,EAAIlxC,OAAS,GAAKkxC,EAAIlxC,QAAU+W,EAAK/W,OAAQ,CACrE,GAAIkxC,EAAIlxC,SAAW+W,EAAK/W,QAAUkxC,IAAQn6B,EACzC,MAAO,GAER,IAAIm8B,EAAShC,EAAIlxC,OAAS,EACtBmzC,GAAoB,EACxB,IAAKrzC,EAAIiX,EAAK/W,OAAS,EAAGF,GAAKqO,IAASrO,EAAG,CAC1C,MAAM0V,EAAOuB,EAAKxN,WAAWzJ,GAC7B,GAAI+vC,EAAgBr6B,IAGnB,IAAKy9B,EAAc,CAClB9kC,EAAQrO,EAAI,EACZ,YAGyB,IAAtBqzC,IAGHF,GAAe,EACfE,EAAmBrzC,EAAI,GAEpBozC,GAAU,IAET19B,IAAS07B,EAAI3nC,WAAW2pC,IACT,KAAZA,IAGL7+B,EAAMvU,IAKPozC,GAAU,EACV7+B,EAAM8+B,IAYV,OANIhlC,IAAUkG,EACbA,EAAM8+B,GAEW,IAAT9+B,IACRA,EAAM0C,EAAK/W,QAEL+W,EAAKtV,MAAM0M,EAAOkG,GAEzB,IAAKvU,EAAIiX,EAAK/W,OAAS,EAAGF,GAAKqO,IAASrO,EACvC,GAAI+vC,EAAgB94B,EAAKxN,WAAWzJ,KAGnC,IAAKmzC,EAAc,CAClB9kC,EAAQrO,EAAI,EACZ,YAEkB,IAATuU,IAGV4+B,GAAe,EACf5+B,EAAMvU,EAAI;CAIZ,OAAa,IAATuU,EACI,GAED0C,EAAKtV,MAAM0M,EAAOkG,IAI3BhT,QAAQ0V,GACP44B,EAAe54B,EAAM,QACrB,IAAI5I,EAAQ,EACRilC,GAAY,EACZC,EAAY,EACZh/B,GAAO,EACP4+B,GAAe,EAGfK,EAAc,EAMdv8B,EAAK/W,QAAU,GAl5BF,KAm5BhB+W,EAAKxN,WAAW,IAChB0mC,EAAoBl5B,EAAKxN,WAAW,MACpC4E,EAAQklC,EAAY,GAGrB,IAAK,IAAIvzC,EAAIiX,EAAK/W,OAAS,EAAGF,GAAKqO,IAASrO,EAAG,CAC9C,MAAM0V,EAAOuB,EAAKxN,WAAWzJ,GAC7B,GAAI+vC,EAAgBr6B,IAGnB,IAAKy9B,EAAc,CAClBI,EAAYvzC,EAAI,EAChB,YAIW,IAATuU,IAGH4+B,GAAe,EACf5+B,EAAMvU,EAAI,GAEP0V,IAASm7B,GAEM,IAAdyC,EACHA,EAAWtzC,EAEa,IAAhBwzC,IACRA,EAAc,IAES,IAAdF,IAGVE,GAAe,GAIjB,OAAkB,IAAdF,IACM,IAAT/+B,GAEgB,IAAhBi/B,GAEiB,IAAhBA,GACAF,IAAa/+B,EAAM,GACnB++B,IAAaC,EAAY,EACnB,GAEDt8B,EAAKtV,MAAM2xC,EAAU/+B,IAG7BhT,OAAO0vC,GACN,GAAmB,OAAfA,GAA6C,iBAAfA,EACjC,MAAM,IAAInB,EAAoB,aAAc,SAAUmB,GAGvD,OAAOD,EAAQ,KAAMC,IAItB1vC,MAAM0V,GACL44B,EAAe54B,EAAM,QAErB,MAAMw8B,GAAQl4B,KAAM,GAAI21B,IAAK,GAAIC,KAAM,GAAIC,IAAK,GAAI/lC,KAAM,IAC1D,GAAoB,IAAhB4L,EAAK/W,OACR,OAAOuzC,EAGR,MAAMxzC,EAAMgX,EAAK/W,OACjB,IAAI4xC,EAAU,EACVp8B,EAAOuB,EAAKxN,WAAW,GAG3B,GAAIxJ,EAAM,GACT,GAAI8vC,EAAgBr6B,IAInB,GADAo8B,EAAU,EACN/B,EAAgB94B,EAAKxN,WAAW,IAAK,CAExC,IAAIsF,EAAI,EACJgG,EAAOhG,EAEX,KAAOA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,GACL8vC,EAAgB94B,EAAKxN,WAAWsF,MADpBA,GAKlB,GAAIA,EAAI9O,GAAO8O,IAAMgG,EAAM,CAI1B,IAFAA,EAAOhG,EAEAA,EAAI9O,IACN8vC,EAAgB94B,EAAKxN,WAAWsF,MADnBA,GAKdA,IAAM9O,EAGT6xC,EAAU/iC,EACAA,IAAMgG,IAGhB+8B,EAAU/iC,EAAI,WAKZ,GAAIohC,EAAoBz6B,IAxgCf,KA2gCXuB,EAAKxN,WAAW,GAAmB,CAEtC,GADAqoC,EAAU,IACN7xC,EAAM,GAcT,OADAwzC,EAAIl4B,KAAOk4B,EAAIvC,IAAMj6B,EACdw8B,EAbP,GAAI1D,EAAgB94B,EAAKxN,WAAW,IAAK,CACxC,GAAY,IAARxJ,EAIH,OADAwzC,EAAIl4B,KAAOk4B,EAAIvC,IAAMj6B,EACdw8B,EAER3B,EAAU,SAUR,GAAI/B,EAAgBr6B,GAI1B,OADA+9B,EAAIl4B,KAAOk4B,EAAIvC,IAAMj6B,EACdw8B;CAGJ3B,EAAU,IACb2B,EAAIl4B,KAAOtE,EAAKtV,MAAM,EAAGmwC,IAG1B,IAAIwB,GAAY,EACZC,EAAYzB,EACZv9B,GAAO,EACP4+B,GAAe,EACfnzC,EAAIiX,EAAK/W,OAAS,EAIlBszC,EAAc,EAGlB,KAAOxzC,GAAK8xC,IAAW9xC,EAEtB,GADA0V,EAAOuB,EAAKxN,WAAWzJ,GACnB+vC,EAAgBr6B,IAGnB,IAAKy9B,EAAc,CAClBI,EAAYvzC,EAAI,EAChB,YAIW,IAATuU,IAGH4+B,GAAe,EACf5+B,EAAMvU,EAAI,GAEP0V,IAASm7B,GAEM,IAAdyC,EACHA,EAAWtzC,EAEa,IAAhBwzC,IACRA,EAAc,IAES,IAAdF,IAGVE,GAAe,GA+BjB,OA3BkB,IAAdF,IACM,IAAT/+B,GAEgB,IAAhBi/B,GAEiB,IAAhBA,GACAF,IAAa/+B,EAAM,GACnB++B,IAAaC,EAAY,GACb,IAATh/B,IACHk/B,EAAItC,KAAOsC,EAAIpoC,KAAO4L,EAAKtV,MAAM4xC,EAAWh/B,KAG7Ck/B,EAAIpoC,KAAO4L,EAAKtV,MAAM4xC,EAAWD,GACjCG,EAAItC,KAAOl6B,EAAKtV,MAAM4xC,EAAWh/B,GACjCk/B,EAAIrC,IAAMn6B,EAAKtV,MAAM2xC,EAAU/+B,IAO/Bk/B,EAAIvC,IADDqC,EAAY,GAAKA,IAAczB,EACxB76B,EAAKtV,MAAM,EAAG4xC,EAAY,GAG1BE,EAAIl4B,KAGRk4B,GAGRh5B,IAAK,KACLi5B,UAAW,IACXjC,MAAO,KACPkC,MAAO,MAGKtxC,EAAAsxC,OAEZpyC,WAAWmwC,GACV,IAAIwB,EAAe,GACfrB,GAAmB,EAEvB,IAAK,IAAI7xC,EAAI0xC,EAAaxxC,OAAS,EAAGF,IAAM,IAAM6xC,EAAkB7xC,IAAK,CACxE,IAAIiX,EAQJ44B,EANC54B,EADGjX,GAAK,EACD0xC,EAAa1xC,GAGbg2B,EAAQ2Z,MAGK,QAGD,IAAhB14B,EAAK/W,SAITgzC,EAAej8B,EAAO,IAAMi8B,EAC5BrB,EAAmB56B,EAAKxN,WAAW,KAAOumC,GAU3C,OAHAkD,EAAe1C,EAAgB0C,GAAerB,EAAkB,IAC/D3B,GAEG2B,EACCqB,EAAahzC,OAAS,EAClB,IAAMgzC,EAGN,IAEEA,EAAahzC,OAAS,EACzBgzC,EAEA,KAIT3xC,UAAU0V,GAGT,GAFA44B,EAAe54B,EAAM,QAED,IAAhBA,EAAK/W,OACR,MAAO,IAGR,MAAM8xC,EAAa/6B,EAAKxN,WAAW,KAAOumC,EACpC4D,EACL38B,EAAKxN,WAAWwN,EAAK/W,OAAS,KAAO8vC,EAYtC,OAPoB,KAFpB/4B,EAAOu5B,EAAgBv5B,GAAO+6B,EAAY,IAAK9B,IAEtChwC,QAAiB8xC,IACzB/6B,EAAO,KAEJA,EAAK/W,OAAS,GAAK0zC,IACtB38B,GAAQ,KAGL+6B,EACI,IAAM/6B,EAEPA,GAGR+6B,WAAW/6B,IACV44B,EAAe54B,EAAM,QACdA,EAAK/W,OAAS,GAAK+W,EAAKxN,WAAW,KAAOumC,GAGlDzuC,QAAQ0wC,GACP,GAAqB,IAAjBA,EAAM/xC,OACT,MAAO,IAER,IAAIgyC,EACJ,IAAK,IAAIlyC,EAAI,EAAGA,EAAIiyC,EAAM/xC,SAAUF,EAAG,CACtC,MAAMiG,EAAMyN,UAAU1T,GACtB6vC,EAAe5pC,EAAK;AAChBA,EAAI/F,OAAS,SACD8K,IAAXknC,EACHA,EAASjsC,EAGTisC,GAAU,IAAMjsC,GAInB,YAAe+E,IAAXknC,EACI,IAED7vC,EAAAsxC,MAAMrB,UAAUJ,IAGxB3wC,SAASuB,EAAc8N,GAItB,GAHAi/B,EAAe/sC,EAAM,QACrB+sC,EAAej/B,EAAI,MAEf9N,IAAS8N,EACZ,MAAO,GAMR,GAHA9N,EAAOT,EAAAsxC,MAAMzjC,QAAQpN,GACrB8N,EAAKvO,EAAAsxC,MAAMzjC,QAAQU,GAEf9N,IAAS8N,EACZ,MAAO,GAIR,IAAI6hC,EAAY,EAChB,KAAOA,EAAY3vC,EAAK5C,QACnB4C,EAAK2G,WAAWgpC,KAAezC,IADFyC,GAKlC,MAAMC,EAAU5vC,EAAK5C,OACfyyC,EAAWD,EAAUD,EAG3B,IAAIG,EAAU,EACd,KAAOA,EAAUhiC,EAAG1Q,QACf0Q,EAAGnH,WAAWmpC,KAAa5C,IADF4C,GAK9B,MACME,EADQliC,EAAG1Q,OACM0yC,EAGjB1yC,EAAUyyC,EAAUG,EAAQH,EAAUG,EAC5C,IAAIC,GAAiB,EACjB/yC,EAAI,EACR,KAAOA,GAAKE,IAAUF,EAAG,CACxB,GAAIA,IAAME,EAAQ,CACjB,GAAI4yC,EAAQ5yC,EAAQ,CACnB,GAAI0Q,EAAGnH,WAAWmpC,EAAU5yC,KAAOgwC,EAGlC,OAAOp/B,EAAGjP,MAAMixC,EAAU5yC,EAAI,GACxB,GAAU,IAANA,EAGV,OAAO4Q,EAAGjP,MAAMixC,EAAU5yC,QAEjB2yC,EAAUzyC,IAChB4C,EAAK2G,WAAWgpC,EAAYzyC,KAAOgwC,EAGtC+C,EAAgB/yC,EACA,IAANA,IAGV+yC,EAAgB,IAGlB,MAED,MAAMC,EAAWlwC,EAAK2G,WAAWgpC,EAAYzyC,GAE7C,GAAIgzC,IADWpiC,EAAGnH,WAAWmpC,EAAU5yC,GAEtC,MAEQgzC,IAAahD,IACrB+C,EAAgB/yC,GAIlB,IAAIizC,EAAM,GAGV,IAAKjzC,EAAIyyC,EAAYM,EAAgB,EAAG/yC,GAAK0yC,IAAW1yC,EACnDA,IAAM0yC,GAAW5vC,EAAK2G,WAAWzJ,KAAOgwC,IACxB,IAAfiD,EAAI/yC,OACP+yC,GAAO,KAGPA,GAAO,OAOV,OAAIA,EAAI/yC,OAAS,EACT+yC,EAAMriC,EAAGjP,MAAMixC,EAAUG,IAGhCH,GAAWG,EACPniC,EAAGnH,WAAWmpC,KAAa5C,KAC5B4C,EAEIhiC,EAAGjP,MAAMixC,KAIlBiB,iBAAiB58B,GAETA,EAGR1V,QAAQ0V,GAEP,GADA44B,EAAe54B,EAAM,QACD,IAAhBA,EAAK/W,OACR,MAAO,IAER,MAAM4zC,EAAU78B,EAAKxN,WAAW,KAAOumC,EACvC,IAAIz7B,GAAO,EACP4+B,GAAe,EACnB,IAAK,IAAInzC,EAAIiX,EAAK/W,OAAS,EAAGF,GAAK,IAAKA,EACvC,GAAIiX,EAAKxN,WAAWzJ,KAAOgwC,GAC1B,IAAKmD,EAAc,CAClB5+B,EAAMvU,EACN,YAIDmzC,GAAe,EAIjB,OAAa,IAAT5+B,EACIu/B,EAAU,IAAM,IAEpBA,GAAmB,IAARv/B,EACP,KAED0C,EAAKtV,MAAM,EAAG4S,IAGtBhT,SAAS0V,EAAcm6B;KACVpmC,IAARomC,GACHvB,EAAeuB,EAAK,OAErBvB,EAAe54B,EAAM,QAErB,IAGIjX,EAHAqO,EAAQ,EACRkG,GAAO,EACP4+B,GAAe,EAGnB,QAAYnoC,IAARomC,GAAqBA,EAAIlxC,OAAS,GAAKkxC,EAAIlxC,QAAU+W,EAAK/W,OAAQ,CACrE,GAAIkxC,EAAIlxC,SAAW+W,EAAK/W,QAAUkxC,IAAQn6B,EACzC,MAAO,GAER,IAAIm8B,EAAShC,EAAIlxC,OAAS,EACtBmzC,GAAoB,EACxB,IAAKrzC,EAAIiX,EAAK/W,OAAS,EAAGF,GAAK,IAAKA,EAAG,CACtC,MAAM0V,EAAOuB,EAAKxN,WAAWzJ,GAC7B,GAAI0V,IAASs6B,GAGZ,IAAKmD,EAAc,CAClB9kC,EAAQrO,EAAI,EACZ,YAGyB,IAAtBqzC,IAGHF,GAAe,EACfE,EAAmBrzC,EAAI,GAEpBozC,GAAU,IAET19B,IAAS07B,EAAI3nC,WAAW2pC,IACT,KAAZA,IAGL7+B,EAAMvU,IAKPozC,GAAU,EACV7+B,EAAM8+B,IAYV,OANIhlC,IAAUkG,EACbA,EAAM8+B,GAEW,IAAT9+B,IACRA,EAAM0C,EAAK/W,QAEL+W,EAAKtV,MAAM0M,EAAOkG,GAEzB,IAAKvU,EAAIiX,EAAK/W,OAAS,EAAGF,GAAK,IAAKA,EACnC,GAAIiX,EAAKxN,WAAWzJ,KAAOgwC,GAG1B,IAAKmD,EAAc,CAClB9kC,EAAQrO,EAAI,EACZ,YAEkB,IAATuU,IAGV4+B,GAAe,EACf5+B,EAAMvU,EAAI,GAIZ,OAAa,IAATuU,EACI,GAED0C,EAAKtV,MAAM0M,EAAOkG,IAI3BhT,QAAQ0V,GACP44B,EAAe54B,EAAM,QACrB,IAAIq8B,GAAY,EACZC,EAAY,EACZh/B,GAAO,EACP4+B,GAAe,EAGfK,EAAc,EAClB,IAAK,IAAIxzC,EAAIiX,EAAK/W,OAAS,EAAGF,GAAK,IAAKA,EAAG,CAC1C,MAAM0V,EAAOuB,EAAKxN,WAAWzJ,GAC7B,GAAI0V,IAASs6B,GASA,IAATz7B,IAGH4+B,GAAe,EACf5+B,EAAMvU,EAAI,GAEP0V,IAASm7B,GAEM,IAAdyC,EACHA,EAAWtzC,EAEa,IAAhBwzC,IACRA,EAAc,IAES,IAAdF,IAGVE,GAAe,QAvBf,IAAKL,EAAc,CAClBI,EAAYvzC,EAAI,EAChB,OAyBH,OAAkB,IAAdszC,IACM,IAAT/+B,GAEgB,IAAhBi/B,GAEiB,IAAhBA,GACAF,IAAa/+B,EAAM,GACnB++B,IAAaC,EAAY,EACnB,GAEDt8B,EAAKtV,MAAM2xC,EAAU/+B,IAG7BhT,OAAO0vC,GACN,GAAmB,OAAfA,GAA6C,iBAAfA,EACjC,MAAM,IAAInB,EAAoB,aAAc,SAAUmB,GAGvD,OAAOD,EAAQ,IAAKC,IAGrB1vC,MAAM0V,GACL44B,EAAe54B,EAAM,QAErB,MAAMw8B,GAAQl4B,KAAM,GAAI21B,IAAK,GAAIC,KAAM,GAAIC,IAAK,GAAI/lC,KAAM,IAC1D,GAAoB,IAAhB4L,EAAK/W,OACR,OAAOuzC,EAER,MAAMzB,EAAa/6B,EAAKxN,WAAW,KAAOumC,EAC1C,IAAI3hC,EACA2jC,GACHyB,EAAIl4B,KAAO,IACXlN,EAAQ,GAERA,EAAQ;CAET,IAAIilC,GAAY,EACZC,EAAY,EACZh/B,GAAO,EACP4+B,GAAe,EACfnzC,EAAIiX,EAAK/W,OAAS,EAIlBszC,EAAc,EAGlB,KAAOxzC,GAAKqO,IAASrO,EAAG,CACvB,MAAM0V,EAAOuB,EAAKxN,WAAWzJ,GAC7B,GAAI0V,IAASs6B,GASA,IAATz7B,IAGH4+B,GAAe,EACf5+B,EAAMvU,EAAI,GAEP0V,IAASm7B,GAEM,IAAdyC,EACHA,EAAWtzC,EAEa,IAAhBwzC,IACRA,EAAc,IAES,IAAdF,IAGVE,GAAe,QAvBf,IAAKL,EAAc,CAClBI,EAAYvzC,EAAI,EAChB,OA2DH,OAlCkB,IAAdszC,IACM,IAAT/+B,GAEgB,IAAhBi/B,GAEiB,IAAhBA,GACAF,IAAa/+B,EAAM,GACnB++B,IAAaC,EAAY,GACb,IAATh/B,IAEFk/B,EAAItC,KAAOsC,EAAIpoC,KADE,IAAdkoC,GAAmBvB,EACA/6B,EAAKtV,MAAM,EAAG4S,GAGd0C,EAAKtV,MAAM4xC,EAAWh/B,KAI5B,IAAdg/B,GAAmBvB,GACtByB,EAAIpoC,KAAO4L,EAAKtV,MAAM,EAAG2xC,GACzBG,EAAItC,KAAOl6B,EAAKtV,MAAM,EAAG4S,KAEzBk/B,EAAIpoC,KAAO4L,EAAKtV,MAAM4xC,EAAWD,GACjCG,EAAItC,KAAOl6B,EAAKtV,MAAM4xC,EAAWh/B,IAElCk/B,EAAIrC,IAAMn6B,EAAKtV,MAAM2xC,EAAU/+B,IAG5Bg/B,EAAY,EACfE,EAAIvC,IAAMj6B,EAAKtV,MAAM,EAAG4xC,EAAY,GAE5BvB,IACRyB,EAAIvC,IAAM,KAGJuC,GAGRh5B,IAAK,IACLi5B,UAAW,IACXjC,MAAO,KACPkC,MAAO,MAGRtxC,EAAAsxC,MAAMlC,MAAQpvC,EAAAovC,MAAMA,MAAQpvC,EAAAovC,MAC5BpvC,EAAAsxC,MAAMA,MAAQtxC,EAAAovC,MAAMkC,MAAQtxC,EAAAsxC,MAEftxC,EAAAiwC,UAAkC,UAArBtc,EAAQG,SAAuB9zB,EAAAovC,MAAMa,UAAYjwC,EAAAsxC,MAAMrB,UACpEjwC,EAAA2vC,WAAmC,UAArBhc,EAAQG,SAAuB9zB,EAAAovC,MAAMO,WAAa3vC,EAAAsxC,MAAM3B,WACtE3vC,EAAA2Z,KAA6B,UAArBga,EAAQG,SAAuB9zB,EAAAovC,MAAMz1B,KAAO3Z,EAAAsxC,MAAM33B,KAC1D3Z,EAAA6N,QAAgC,UAArB8lB,EAAQG,SAAuB9zB,EAAAovC,MAAMvhC,QAAU7N,EAAAsxC,MAAMzjC,QAChE7N,EAAA2F,SAAiC,UAArBguB,EAAQG,SAAuB9zB,EAAAovC,MAAMzpC,SAAW3F,EAAAsxC,MAAM3rC,SAClE3F,EAAA0xC,QAAgC,UAArB/d,EAAQG,SAAuB9zB,EAAAovC,MAAMsC,QAAU1xC,EAAAsxC,MAAMI,QAChE1xC,EAAA2xC,SAAiC,UAArBhe,EAAQG,SAAuB9zB,EAAAovC,MAAMuC,SAAW3xC,EAAAsxC,MAAMK;AAClE3xC,EAAA4xC,QAAgC,UAArBje,EAAQG,SAAuB9zB,EAAAovC,MAAMwC,QAAU5xC,EAAAsxC,MAAMM,QAChE5xC,EAAAyF,OAA+B,UAArBkuB,EAAQG,SAAuB9zB,EAAAovC,MAAM3pC,OAASzF,EAAAsxC,MAAM7rC,OAC9DzF,EAAAqX,MAA8B,UAArBsc,EAAQG,SAAuB9zB,EAAAovC,MAAM/3B,MAAQrX,EAAAsxC,MAAMj6B,MAC5DrX,EAAAwxC,iBAAyC,UAArB7d,EAAQG,SAAuB9zB,EAAAovC,MAAMoC,iBAAmBxxC,EAAAsxC,MAAME,iBAClFxxC,EAAAoY,IAA4B,UAArBub,EAAQG,SAAuB9zB,EAAAovC,MAAMh3B,IAAMpY,EAAAsxC,MAAMl5B,IACxDpY,EAAAqxC,UAAkC,UAArB1d,EAAQG,SAAuB9zB,EAAAovC,MAAMiC,UAAYrxC,EAAAsxC,MAAMD,4DC5kDjF,SAAgBQ,EAAuB3xC,GACtC,OAAOA,EAAMwZ,QAAQ,sCAAuC,QAkB7D,SAAgBo4B,EAAMC,EAAkBC,GACvC,IAAKD,IAAaC,EACjB,OAAOD,EAGR,MAAME,EAAYD,EAAOn0C,OACzB,GAAkB,IAAdo0C,GAAuC,IAApBF,EAASl0C,OAC/B,OAAOk0C,EAGR,IAAI78B,EAAS,EAEb,KAAO68B,EAAStoC,QAAQuoC,EAAQ98B,KAAYA,GAC3CA,GAAkB+8B,EAEnB,OAAOF,EAASt+B,UAAUyB,GAQ3B,SAAgBg9B,EAAMH,EAAkBC,GACvC,IAAKD,IAAaC,EACjB,OAAOD,EAGR,MAAME,EAAYD,EAAOn0C,OACxBs0C,EAAcJ,EAASl0C,OAExB,GAAkB,IAAdo0C,GAAmC,IAAhBE,EACtB,OAAOJ,EAGR,IAAI78B,EAASi9B,EACZpqB,GAAO,EAER,OAAa,CAEZ,IAAa,KADbA,EAAMgqB,EAASrD,YAAYsD,EAAQ98B,EAAS,KAC1B6S,EAAMkqB,IAAc/8B,EACrC,MAED,GAAY,IAAR6S,EACH,MAAO,GAER7S,EAAS6S,EAGV,OAAOgqB,EAASt+B,UAAU,EAAGyB,GAwJ9B,SAAgB9J,EAAQhJ,EAAWD,GAClC,OAAIC,EAAID,GACC,EACEC,EAAID,EACP,EAEA,EA+CT,SAAgBiwC,EAAmB/+B,GAClC,OAAOA,GAAI,IAAkBA,GAAI,IAGlC,SAAgBg/B,EAAmBh/B,GAClC,OAAOA,GAAI,IAAkBA,GAAI,GAGlC,SAASi/B,EAAcj/B,GACtB,OAAO++B,EAAmB/+B,IAASg/B,EAAmBh/B;AAcvD,SAASk/B,EAAmBnwC,EAAWD,EAAWqwC,EAASpwC,EAAEvE,QAC5D,GAAiB,iBAANuE,GAA+B,iBAAND,EACnC,OAAO,EAGR,IAAK,IAAIxE,EAAI,EAAGA,EAAI60C,EAAQ70C,IAAK,CAChC,MAAM80C,EAAQrwC,EAAEgF,WAAWzJ,GACrB+0C,EAAQvwC,EAAEiF,WAAWzJ,GAE3B,GAAI80C,IAAUC,EAKd,GAAIJ,EAAcG,IAAUH,EAAcI,GAAQ,CACjD,MAAMC,EAAO9wC,KAAK6B,IAAI+uC,EAAQC,GAC9B,GAAa,IAATC,GAAuB,KAATA,EACjB,OAAO,OAMR,GAAI/nC,OAAO2I,aAAak/B,GAAO50B,gBAAkBjT,OAAO2I,aAAam/B,GAAO70B,cAC3E,OAAO,EAKV,OAAO,EAiDR,SAAS+0B,EAAaxwC,EAAWywC,EAAgBC,EAAc3wC,EAAW4wC,EAAgBC,GACzF,KAAOH,EAASC,GAAQC,EAASC,GAAM,CACtC,GAAI5wC,EAAEywC,KAAY1wC,EAAE4wC,GACnB,OAAO,EAERF,GAAU,EACVE,GAAU,EAEX,OAAO,EA0FR,SAAgBE,EAAqBvsC,GAwCpC,OADAA,GAAYA,IAEE,OAAUA,GAAY,OAC/BA,GAAY,OAAUA,GAAY,OAClCA,GAAY,OAAUA,GAAY,MA8DxC,SAAgBwsC,EAAkBt1B,GACjC,SAAUA,GAAOA,EAAI/f,OAAS,GAAsB,QAAjB+f,EAAIxW,WAAW,qDA/nBtCpH,EAAA4R,MAAQ,GAErB5R,EAAAmzC,oBAAA,SAAoCv1B,GACnC,OAAKA,GAAsB,iBAARA,GAGU,IAAtBA,EAAIgf,OAAO/+B,QAMnBmC,EAAAozC,IAAA,SAAoB7sC,EAAW7D,EAAWuzB,EAAe,KACxD,MAAMrY,EAAM,GAAKrX,EACXtE,GAAK2b,GAEX,IAAK,IAAIjgB,EAAIigB,EAAI/f,OAAQF,EAAI+E,EAAG/E,IAC/BsE,EAAE7C,KAAK62B,GAGR,OAAOh0B,EAAEoxC,UAAU15B,KAAK,KAGzB,MAAM25B,EAAgB,WAQtBtzC,EAAAyF,OAAA,SAAuBvF,KAAkB6H,GACxC,OAAoB,IAAhBA,EAAKlK,OACDqC,EAEDA,EAAMwZ,QAAQ45B,EAAe,SAAUtL,EAAOuL,GACpD,MAAMxrB,EAAMuD,SAASioB,EAAO,IAC5B,OAAOC,MAAMzrB,IAAQA,EAAM,GAAKA,GAAOhgB,EAAKlK,OAC3CmqC,EACAjgC,EAAKggB,MAQR/nB,EAAAyzC,OAAA,SAAuBC,GACtB,OAAOA,EAAKh6B,QAAQ,SAAU,SAAUsuB;AACvC,OAAQA,GACP,IAAK,IAAK,MAAO,OACjB,IAAK,IAAK,MAAO,OACjB,IAAK,IAAK,MAAO,QACjB,QAAS,OAAOA,MAQnBhoC,EAAA6xC,uBAAAA,EASA7xC,EAAA48B,KAAA,SAAqBmV,EAAkBC,EAAiB,KAEvD,OAAOE,EADSJ,EAAMC,EAAUC,GACVA,IAQvBhyC,EAAA8xC,MAAAA,EAuBA9xC,EAAAkyC,MAAAA,EA6BAlyC,EAAA2zC,4BAAA,SAA4Cr7B,GAC3C,OAAOA,EAAQoB,QAAQ,wCAAyC,QAAQA,QAAQ,QAAS,OAG1F1Z,EAAA4zC,eAAA,SAA+Bt7B,GAC9B,OAAOA,EAAQoB,QAAQ,MAAO,KAM/B1Z,EAAA6zC,WAAA,SAA2B9B,EAAkBC,GAC5C,GAAID,EAASl0C,OAASm0C,EAAOn0C,OAC5B,OAAO,EAGR,GAAIk0C,IAAaC,EAChB,OAAO,EAGR,IAAK,IAAIr0C,EAAI,EAAGA,EAAIq0C,EAAOn0C,OAAQF,IAClC,GAAIo0C,EAASp0C,KAAOq0C,EAAOr0C,GAC1B,OAAO,EAIT,OAAO,GAMRqC,EAAA8zC,SAAA,SAAyB/B,EAAkBC,GAC1C,MAAMW,EAAOZ,EAASl0C,OAASm0C,EAAOn0C,OACtC,OAAI80C,EAAO,EACHZ,EAAStoC,QAAQuoC,EAAQW,KAAUA,EACvB,IAATA,GACHZ,IAAaC,GActBhyC,EAAA+zC,aAAA,SAA6BC,EAAsBC,EAAkBz+B,MACpE,IAAKw+B,EACJ,MAAM,IAAI5zC,MAAM,yCAEZ6zC,IACJD,EAAenC,EAAuBmC,IAEnCx+B,EAAQ0+B,YACN,KAAK/L,KAAK6L,EAAa/4B,OAAO,MAClC+4B,EAAe,MAAQA,GAEnB,KAAK7L,KAAK6L,EAAa/4B,OAAO+4B,EAAan2C,OAAS,MACxDm2C,GAA8B,QAGhC,IAAIG,EAAY,GAchB,OAbI3+B,EAAQ2f,SACXgf,GAAa,KAET3+B,EAAQ4+B,YACZD,GAAa,KAEV3+B,EAAQ6+B,YACXF,GAAa,KAEV3+B,EAAQ8+B,UACXH,GAAa,KAGP,IAAII,OAAOP,EAAcG,IAGjCn0C,EAAAw0C,yBAAA,SAAyCC;AAGxC,MAAsB,MAAlBA,EAAO7nB,QAAoC,OAAlB6nB,EAAO7nB,QAAqC,MAAlB6nB,EAAO7nB,QAAoC,WAAlB6nB,EAAO7nB,WAMzE6nB,EAAOxM,KAAK,KACmB,IAArBwM,EAAOC,YAGhC10C,EAAA20C,4BAAA,SAA4CC,GAC3C,QAASA,EAAY5M,MAAM,0BAG5BhoC,EAAA60C,YAAA,SAA4BJ,GAC3B,OAAQA,EAAOtf,OAAS,IAAM,KAC1Bsf,EAAOK,WAAa,IAAM,KAC1BL,EAAOJ,UAAY,IAAM,KACxBI,EAAeH,QAAU,IAAM,KAOrCt0C,EAAA+0C,wBAAA,SAAwCn3B,GACvC,IAAK,IAAIjgB,EAAI,EAAGC,EAAMggB,EAAI/f,OAAQF,EAAIC,EAAKD,IAAK,CAC/C,MAAMq3C,EAASp3B,EAAIxW,WAAWzJ,GAC9B,GAAU,KAANq3C,GAAmC,IAANA,EAChC,OAAOr3C,EAGT,OAAQ,GAOTqC,EAAAi1C,qBAAA,SAAqCr3B,EAAa5R,EAAgB,EAAGkG,EAAc0L,EAAI/f,QACtF,IAAK,IAAIF,EAAIqO,EAAOrO,EAAIuU,EAAKvU,IAAK,CACjC,MAAMq3C,EAASp3B,EAAIxW,WAAWzJ,GAC9B,GAAU,KAANq3C,GAAmC,IAANA,EAChC,OAAOp3B,EAAInK,UAAUzH,EAAOrO,GAG9B,OAAOigB,EAAInK,UAAUzH,EAAOkG,IAO7BlS,EAAAk1C,uBAAA,SAAuCt3B,EAAau3B,EAAqBv3B,EAAI/f,OAAS,GACrF,IAAK,IAAIF,EAAIw3C,EAAYx3C,GAAK,EAAGA,IAAK,CACrC,MAAMq3C,EAASp3B,EAAIxW,WAAWzJ,GAC9B,GAAU,KAANq3C,GAAmC,IAANA,EAChC,OAAOr3C,EAGT,OAAQ,GAGTqC,EAAAoL,QAAAA,EAUApL,EAAAo1C,kBAAA,SAAkChzC,EAAWD,GAC5C,MAAMvE,EAAMiE,KAAKQ,IAAID,EAAEvE,OAAQsE,EAAEtE,QACjC,IAAK,IAAIF,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC7B,IAAI80C,EAAQrwC,EAAEgF,WAAWzJ,GACrB+0C,EAAQvwC,EAAEiF,WAAWzJ,GAEzB,GAAI80C,IAAUC,EAEb,SAGGL,EAAmBI,KACtBA,GAAS,IAGNJ,EAAmBK,KACtBA,GAAS,IAGV,MAAMC,EAAOF,EAAQC,EAErB,GAAa,IAATC,EAIG,OAAIP,EAAmBK,IAAUL,EAAmBM,GAEnDC,EAGAvnC,EAAQhJ,EAAEyb,cAAe1b,EAAE0b;AAIpC,OAAIzb,EAAEvE,OAASsE,EAAEtE,QACR,EACEuE,EAAEvE,OAASsE,EAAEtE,OAChB,EAEA,GAITmC,EAAAoyC,mBAAAA,EAIApyC,EAAAqyC,mBAAAA,EAQAryC,EAAAq1C,iBAAA,SAAiCjzC,EAAWD,GAI3C,OAHaC,EAAIA,EAAEvE,OAAS,MACfsE,EAAIA,EAAEtE,OAAS,IAMrB00C,EAAmBnwC,EAAGD,IAmC9BnC,EAAAs1C,qBAAA,SAAqC13B,EAAauE,GACjD,MAAMozB,EAAkBpzB,EAAUtkB,OAClC,QAAIskB,EAAUtkB,OAAS+f,EAAI/f,SAIpB00C,EAAmB30B,EAAKuE,EAAWozB,IAM3Cv1C,EAAAsP,mBAAA,SAAmClN,EAAWD,GAE7C,IAAIxE,EACHC,EAAMiE,KAAKQ,IAAID,EAAEvE,OAAQsE,EAAEtE,QAE5B,IAAKF,EAAI,EAAGA,EAAIC,EAAKD,IACpB,GAAIyE,EAAEgF,WAAWzJ,KAAOwE,EAAEiF,WAAWzJ,GACpC,OAAOA,EAIT,OAAOC,GAMRoC,EAAAw1C,mBAAA,SAAmCpzC,EAAWD,GAE7C,IAAIxE,EACHC,EAAMiE,KAAKQ,IAAID,EAAEvE,OAAQsE,EAAEtE,QAE5B,MAAM43C,EAAarzC,EAAEvE,OAAS,EACxB63C,EAAavzC,EAAEtE,OAAS,EAE9B,IAAKF,EAAI,EAAGA,EAAIC,EAAKD,IACpB,GAAIyE,EAAEgF,WAAWquC,EAAa93C,KAAOwE,EAAEiF,WAAWsuC,EAAa/3C,GAC9D,OAAOA,EAIT,OAAOC,GAkBRoC,EAAA21C,QAAA,SAAwBvzC,EAAWD,GAClC,MAAM2wC,EAAO1wC,EAAEvE,OACf,IAAIm1C,EAAO7wC,EAAEtE,OACTg1C,EAASC,EAAOE,EAEpB,GAAe,IAAXH,EACH,OAAOzwC,IAAMD,EAAI2wC,EAAO,EAMzB,IALWD,EAAS,IACnBG,GAAQH,EACRA,EAAS,GAGHA,EAASC,GAAQE,EAAO,GAAG,CACjC,GAAIJ,EAAaxwC,EAAGywC,EAAQC,EAAM3wC,EAAG,EAAG6wC,GACvC,OAAOA,EAERA,GAAQ,EACRH,GAAU,EAEX,OAAO,GAkBR7yC,EAAA41C,gBAAA,SAAgClvC,GAC/B,OAAQ,OAAUA,GAAYA,GAAY,OAG3C1G,EAAA61C,eAAA,SAA+BnvC,GAC9B,OAAQ,OAAUA,GAAYA,GAAY;CAM3C,MAAMovC,EAAe,2eAKrB91C,EAAA+1C,YAAA,SAA4Bn4B,GAC3B,OAAOk4B,EAAa3N,KAAKvqB,IAM1B,MAAMo4B,EAAiB,sJAEvBh2C,EAAAi2C,cAAA,SAA8Br4B,GAC7B,OAAOo4B,EAAe7N,KAAKvqB,IAG5B,MAAMs4B,EAAiB,uBAIvBl2C,EAAAm2C,aAAA,SAA6Bv4B,GAC5B,OAAOs4B,EAAe/N,KAAKvqB,IAG5B5d,EAAAo2C,2BAAA,SAA2Cx4B,GAC1C,IAAK,IAAIjgB,EAAI,EAAGC,EAAMggB,EAAI/f,OAAQF,EAAIC,EAAKD,IAC1C,GAAIs1C,EAAqBr1B,EAAIxW,WAAWzJ,IACvC,OAAO,EAGT,OAAO,GAGRqC,EAAAizC,qBAAAA,EAmDAjzC,EAAAq2C,KAAA,SAAqBzjC,EAAcrM,GAClC,GAAIqM,EAAK/U,OAAS0I,EACjB,OAAOqM,EAGR,MAAM0jC,EAAK;CACX,IAAI34C,EAAI,EACR,KAAO24C,EAAGnO,KAAKv1B,MACVA,EAAK/U,OAASy4C,EAAG5B,UAAYnuC,IAIjC5I,EAAI24C,EAAG5B,UACP4B,EAAG5B,WAAa,EAGjB,OAAO9hC,EAAKa,UAAU9V,GAAG+b,QAAQ,MAAO1Z,EAAA4R,QAKzC,MAAM2kC,EAAK,kBACLC,EAAc,cACdC,EAAY,aAElBz2C,EAAA02C,sBAAA,SAAsC94B,GAOrC,OANIA,IAGHA,GADAA,GADAA,EAAMA,EAAIlE,QAAQ68B,EAAI,KACZ78B,QAAQ88B,EAAa,KACrB98B,QAAQ+8B,EAAW,KAGvB74B,GAGK5d,EAAA22C,cAAyC,WACrD,GAAmD,mBAAvC/rC,OAAOrK,UAAkB0vC,UAEpC,OAAO,SAAUryB,GAAe,OAAOA,GACjC,CAGN,MAAMg5B,EAAQ,mBACd,OAAO,SAAUh5B,GAChB,OAAQA,EAAYqyB,UAAU,OAAOv2B,QAAQk9B,EAAO52C,EAAA4R,SATD,GAiBzC5R,EAAA62C,mBAAqBjsC,OAAO2I,aAAY,OAErDvT,EAAAkzC,kBAAAA,EAIAlzC,EAAA82C,aAAA,SAA6Bl5B,GAC5B,OAAOs1B,EAAkBt1B,GAAOA,EAAIm5B,OAAO,GAAKn5B,GAGjD5d,EAAAg3C,SAAA,SAAyBp5B,GACxB,OAAOq5B,KAAKC,mBAAmBt5B,KAGhC5d,EAAA+Z,OAAA,SAAuBtX,EAAW5B,GACjC,IAAInD,EAAS,GACb,IAAK,IAAIC,EAAI,EAAGA,EAAIkD,EAAOlD,IAC1BD,GAAU+E,EAEX,OAAO/E,GAORsC,EAAAm3C,cAAA,SAA8B71C,EAAgB81C,GAC7C,IAAK91C,IAAW81C,EACf,OAAO,EAGR,GAAI91C,EAAOzD,OAASu5C,EAAMv5C,OACzB,OAAO,EAGR,MAAMw5C,EAAWD,EAAMv5C,OACjBy5C,EAAch2C,EAAOuc,cAE3B,IAAIxO,EAAQ,EACRq/B,GAAe,EACnB,KAAOr/B,EAAQgoC,GAAU,CACxB,MAAM5tC,EAAU6tC,EAAY7tC,QAAQ2tC,EAAM/nC,GAAQq/B,EAAc,GAChE,GAAIjlC,EAAU,EACb,OAAO,EAGRilC,EAAcjlC,EAEd4F,IAGD,OAAO,GAGRrP,EAAAu3C,2BAAA,SAA2Cj2C,EAAgBk2C,GAAqB;AAC/E,QAAKl2C,IAIDk2C,IACHl2C,EAASA,EAAOoY,QAAQ,OAAQ,KAG1BpY,EAAOuc,gBAAkBvc,IAGjCtB,EAAAy3C,qBAAA,SAAqC75B,GACpC,OAAOA,EAAI3C,OAAO,GAAGib,cAAgBtY,EAAIte,MAAM,IAGhDU,EAAA03C,UAAA,SAA0B95B,EAAarX,EAAI,GAC1C,GAAU,IAANA,EACH,MAAO,GAGR,IAAIwhB,GAAO,EACX,GACCA,EAAMnK,EAAInU,QAAQ,KAAMse,EAAM,GAC9BxhB,UACQA,EAAI,GAAKwhB,GAAO,GAEzB,OAAOA,GAAO,EACbnK,EAAIm5B,OAAO,EAAGhvB,GACdnK,2GCltBF5d,EAAA23C,iBAAA,SAAiCC,GAChC,OAAOA,EAAKC,cACX,IAAMC,EAAA1E,IAAIwE,EAAKG,WAAa,EAAG,GAC/B,IAAMD,EAAA1E,IAAIwE,EAAKI,UAAW,GAC1B,IAAMF,EAAA1E,IAAIwE,EAAKK,WAAY,GAC3B,IAAMH,EAAA1E,IAAIwE,EAAKM,aAAc,GAC7B,IAAMJ,EAAA1E,IAAIwE,EAAKO,aAAc,GAC7B,KAAOP,EAAKQ,kBAAoB,KAAMvxC,QAAQ,GAAGvH,MAAM,EAAG,GAC1D,oECLF,SAASouC,EAAgBr6B,GACxB,OAAW,KAAJA,GAA+B,KAAJA,EAwNnC,SAAgBglC,EAAqBC,GACpC,OAAOA,GAAK,IAAkBA,GAAK,IAAkBA,GAAK,IAAkBA,GAAK,qDAjNlFt4C,EAAAu4C,UAAA,SAA0BC,GACzB,OAAOA,EAAO9+B,QAAQ,SAAU++B,EAAAnH,MAAMl5B,MAQvCpY,EAAA04C,QAAA,SAAwB9jC,EAAcwD,EAAcqgC,EAAAnH,MAAMl5B,KAEzD,IAAKxD,EACJ,MAAO,GAGR,MAAMhX,EAAMgX,EAAK/W,OACX86C,EAAc/jC,EAAKxN,WAAW,GACpC,GAAIsmC,EAAgBiL,GAAc,CACjC,GAAIjL,EAAgB94B,EAAKxN,WAAW,MAG9BsmC,EAAgB94B,EAAKxN,WAAW,IAAK;AACzC,IAAI6L,EAAM,EACV,MAAMjH,EAAQiH,EACd,KAAOA,EAAMrV,IACR8vC,EAAgB94B,EAAKxN,WAAW6L,IADnBA,KAKlB,GAAIjH,IAAUiH,IAAQy6B,EAAgB94B,EAAKxN,WAAW6L,EAAM,IAE3D,IADAA,GAAO,EACAA,EAAMrV,EAAKqV,IACjB,GAAIy6B,EAAgB94B,EAAKxN,WAAW6L,IACnC,OAAO2B,EAAKtV,MAAM,EAAG2T,EAAM,GACzByG,QAAQ,SAAUtB,GASzB,OAAOA,EAED,GAAIigC,EAAqBM,IAGT,KAAlB/jC,EAAKxN,WAAW,GACnB,OAAIsmC,EAAgB94B,EAAKxN,WAAW,IAG5BwN,EAAKtV,MAAM,EAAG,GAAK8Y,EAInBxD,EAAKtV,MAAM,EAAG,GAQxB,IAAI2T,EAAM2B,EAAKnL,QAAQ,OACvB,IAAa,IAATwJ,EAEH,IADAA,GAAO,EACAA,EAAMrV,EAAKqV,IACjB,GAAIy6B,EAAgB94B,EAAKxN,WAAW6L,IACnC,OAAO2B,EAAKtV,MAAM,EAAG2T,EAAM,GAK9B,MAAO,IAURjT,EAAA44C,MAAA,SAAsBhkC,GACrB,IAAK24B,EAAA9Y,UAEJ,OAAO,EAGR,IAAK7f,GAAQA,EAAK/W,OAAS,EAE1B,OAAO,EAGR,IAAIwV,EAAOuB,EAAKxN,WAAW,GAC3B,GAAQ,KAAJiM,EACH,OAAO,EAGR,GAAQ,MADRA,EAAOuB,EAAKxN,WAAW,IAEtB,OAAO,EAER,IAAI6L,EAAM,EACV,MAAMjH,EAAQiH,EACd,KAAOA,EAAM2B,EAAK/W,QAET,MADRwV,EAAOuB,EAAKxN,WAAW6L,IADEA,KAM1B,OAAIjH,IAAUiH,IAGdI,EAAOuB,EAAKxN,WAAW6L,EAAM,IACzBugC,MAAMngC,IAAa,KAAJA,IAOpB,MAAMwlC,EAAqBtL,EAAA9Y,UAAY,mBAAqB,SACtDqkB,EAA0B,iDAChC94C,EAAA+4C,gBAAA,SAAgC/vC,GAC/B,SAAKA,GAAwB,IAAhBA,EAAKnL,QAAgB,QAAQsqC,KAAKn/B,KAI/C6vC,EAAmBnE,UAAY,EAC3BmE,EAAmB1Q,KAAKn/B,IAIxBukC,EAAA9Y,WAAaqkB,EAAwB3Q,KAAKn/B,IAIjC,MAATA,GAAyB,OAATA,GAIhBukC,EAAA9Y,WAAuC,MAA1BzrB,EAAKA,EAAKnL,OAAS,IAIhC0vC,EAAA9Y,WAAazrB,EAAKnL,SAAWmL,EAAK4zB,OAAO/+B,QAIzCmL,EAAKnL,OAAS,OAOnBmC,EAAAg5C,QAAA,SAAwBC,EAAeC,EAAepE,GACrD,MAAMqE,EAAkBF,IAAUC;CAClC,OAAKpE,GAAcqE,EACXA,KAGHF,IAAUC,IAIRpB,EAAAzC,iBAAiB4D,EAAOC,IAGhCl5C,EAAAo5C,gBAAA,SAAgCxkC,EAAcuN,EAAmB2yB,EAAsBtM,EAAYiQ,EAAArgC,KAClG,GAAIxD,IAASuN,EACZ,OAAO,EAGR,IAAKvN,IAASuN,EACb,OAAO,EAGR,GAAIA,EAAUtkB,OAAS+W,EAAK/W,OAC3B,OAAO,EAGR,GAAIi3C,EAAY,CAEf,IADmBgD,EAAAxC,qBAAqB1gC,EAAMuN,GAE7C,OAAO,EAGR,GAAIA,EAAUtkB,SAAW+W,EAAK/W,OAC7B,OAAO,EAGR,IAAIw7C,EAAYl3B,EAAUtkB,OAK1B,OAJIskB,EAAUlH,OAAOkH,EAAUtkB,OAAS,KAAO2qC,GAC9C6Q,IAGMzkC,EAAKqG,OAAOo+B,KAAe7Q,EAOnC,OAJIrmB,EAAUlH,OAAOkH,EAAUtkB,OAAS,KAAO2qC,IAC9CrmB,GAAaqmB,GAGqB,IAA5B5zB,EAAKnL,QAAQ0Y,IAGrBniB,EAAAq4C,qBAAAA,qDCnNA,SAAgBzpC,EAAQ9D,GACvB,OAAI6D,MAAMC,QACFD,MAAMC,QAAQ9D,MAGlBA,UAAiBA,EAAa,SAAKwuC,EAAQ53C,QAAUoJ,EAAMyuC,cAAgB5qC,OAUhF,SAAgB6qC,EAAS57B,GACxB,cAAW,IAAU07B,EAAQG,QAAU77B,aAAehT,OAmBvD,SAAgB8uC,EAAShrC,GAIxB,eAAcA,IAAQ4qC,EAAQzgC,QAClB,OAARnK,GACCC,MAAMC,QAAQF,IACbA,aAAe6lC,QACf7lC,aAAeyV,MAyBtB,SAAgBw1B,EAAYjrC,GAC3B,cAAc,IAAU4qC,EAAQ3wC,UAMjC,SAAgBixC,EAAkBlrC,GACjC,OAAOirC,EAAYjrC,IAAgB,OAARA,EA0B5B,SAAgBmrC,EAAWnrC,GAC1B,cAAcA,IAAQ4qC,EAAQQ,SAmB/B,SAAgBC,EAAmBn2C,EAAUo2C,GAE5C,GAAIR,EAASQ,IACZ,UAAWp2C,IAAQo2C,EAClB,MAAM,IAAI55C,oDAAoD45C,UAEzD,GAAIH,EAAWG,GAAa,CAClC,IACC,GAAIp2C,aAAeo2C,EAClB,OAEA,MAAAC;AAGF,IAAKL,EAAkBh2C,IAAQA,EAAI21C,cAAgBS,EAClD,OAED,GAA0B,IAAtBA,EAAWn8C,SAAoD,IAApCm8C,EAAWr5C,UAAKgI,EAAW/E,GACzD,OAED,MAAM,IAAIxD,MAAM,+LAzJlB,MAAMk5C,GACL53C,OAAQ,SACR+3C,OAAQ,SACR9wC,UAAW,YACXkQ,OAAQ,SACRihC,SAAU,YAMX95C,EAAA4O,QAAAA,EAeA5O,EAAAw5C,SAAAA,EAWAx5C,EAAAk6C,cAAA,SAA8Bh6C,GAC7B,OAAO0O,EAAQ1O,IAAkBA,EAAOi6C,MAAMjrC,GAAQsqC,EAAStqC,KAQhElP,EAAA05C,SAAAA,EAeA15C,EAAAo6C,SAAA,SAAyB1rC,GACxB,cAAY,IAAU4qC,EAAQ53C,QAAUgN,aAAe2rC,UAAY7G,MAAM9kC,IAU1E1O,EAAAs6C,UAAA,SAA0B5rC,GACzB,OAAe,IAARA,IAAwB,IAARA,GAMxB1O,EAAA25C,YAAAA,EAOA35C,EAAA45C,kBAAAA,EAKA,MAAMv5C,EAAiBC,OAAOC,UAAUF,eAKxCL,EAAAu6C,cAAA,SAA8B7rC,GAC7B,IAAKgrC,EAAShrC,GACb,OAAO,EAGR,IAAK,IAAIhO,KAAOgO,EACf,GAAIrO,EAAeM,KAAK+N,EAAKhO,GAC5B,OAAO,EAIT,OAAO,GAMRV,EAAA65C,WAAAA,EAOA75C,EAAAw6C,aAAA,YAAgCC,GAC/B,OAAOA,EAAQ58C,OAAS,GAAK48C,EAAQN,MAAMN,IAK5C75C,EAAA06C,oBAAA,SAAoC3yC,EAAa4yC,GAChD,MAAM/8C,EAAMiE,KAAKQ,IAAI0F,EAAKlK,OAAQ88C,EAAY98C,QAC9C,IAAK,IAAIF,EAAI,EAAGA,EAAIC,EAAKD,IACxBo8C,EAAmBhyC,EAAKpK,GAAIg9C,EAAYh9C,KAI1CqC,EAAA+5C,mBAAAA,EA4BA/5C,EAAAoB,OAAA,SAAuBw5C,KAAmB7yC;AACzC,GAUD,SAAuBoY,GACtB,MAAwB,mBAAVA,GACVA,EAAM9f,eAAe,eACpB8f,EAAM9f,eAAe,aAbtBw6C,CAAcD,GACjB,OAAO,IAAKA,KAAgB7yC,GACtB,CACN,MAAM2G,EAAMpO,OAAOc,OAAOw5C,EAAKr6C,WAE/B,OADAq6C,EAAKxyC,MAAMsG,EAAK3G,GACT2G,IAWT1O,EAAA86C,oBAAA,SAAoCpsC,GACnC,IAAIwT,KACA64B,EAAQz6C,OAAO06C,eAAetsC,GAClC,KAAOpO,OAAOC,YAAcw6C,GAC3B74B,EAAMA,EAAI1S,OAAOlP,OAAO26C,oBAAoBF,IAC5CA,EAAQz6C,OAAO06C,eAAeD,GAE/B,OAAO74B,GAMRliB,EAAAk7C,oBAAA,SAAuCz3C,GACtC,OAAa,OAANA,OAAakF,EAAYlF,GAMjCzD,EAAAm7C,oBAAA,SAAuC13C,GACtC,YAAoB,IAANA,EAAoB,KAAOA,2DCrM1C,SAAgB23C,EAAa1sC,GAC5B,IAAKA,GAAsB,iBAARA,EAClB,OAAOA,EAER,GAAIA,aAAe6lC,OAElB,OAAO7lC,EAER,MAAMhR,EAAciR,MAAMC,QAAQF,SAQlC,OAPApO,OAAO4nC,KAAKx5B,GAAK3N,QAASL,IACrBgO,EAAIhO,IAA4B,iBAAbgO,EAAIhO,GAC1BhD,EAAOgD,GAAO06C,EAAU1sC,EAAIhO,IAE5BhD,EAAOgD,GAAOgO,EAAIhO,KAGbhD,EA6BR,SAAS29C,EAAgB3sC,EAAU4sC,EAA6BrsC,GAC/D,GAAIssC,EAAA3B,kBAAkBlrC,GACrB,OAAOA,EAGR,MAAM8sC,EAAUF,EAAQ5sC,GACxB,QAAuB,IAAZ8sC,EACV,OAAOA,EAGR,GAAID,EAAA3sC,QAAQF,GAAM,CACjB,MAAM+sC,KACN,IAAK,MAAMl9C,KAAKmQ,EACf+sC,EAAGr8C,KAAKi8C,EAAgB98C,EAAG+8C,EAASrsC,IAErC,OAAOwsC,EAGR,GAAIF,EAAA7B,SAAShrC,GAAM,CAClB,GAAIO,EAAKysC,IAAIhtC,GACZ,MAAM,IAAItO,MAAM,yCAEjB6O,EAAKyuB,IAAIhvB,GACT,MAAMitC;CACN,IAAK,IAAIC,KAAMltC,EACVmtC,EAAgBl7C,KAAK+N,EAAKktC,KAC5BD,EAAWC,GAAMP,EAAgB3sC,EAAIktC,GAAKN,EAASrsC,IAItD,OADAA,EAAK6sC,OAAOptC,GACLitC,EAGR,OAAOjtC,EAOR,SAAgBqtC,EAAMC,EAAkBpvB,EAAaqvB,GAAqB,GACzE,OAAKV,EAAA7B,SAASsC,IAIVT,EAAA7B,SAAS9sB,IACZtsB,OAAO4nC,KAAKtb,GAAQ7rB,QAAQL,IACvBA,KAAOs7C,EACNC,IACCV,EAAA7B,SAASsC,EAAYt7C,KAAS66C,EAAA7B,SAAS9sB,EAAOlsB,IACjDq7C,EAAMC,EAAYt7C,GAAMksB,EAAOlsB,GAAMu7C,GAErCD,EAAYt7C,GAAOksB,EAAOlsB,IAI5Bs7C,EAAYt7C,GAAOksB,EAAOlsB,KAItBs7C,GAlBCpvB,EA8BT,SAAgBroB,EAAOwI,EAAUzI,GAChC,GAAIyI,IAAQzI,EACX,OAAO,EAER,GAAY,OAARyI,QAAwBpE,IAARoE,GAA+B,OAAVzI,QAA4BqE,IAAVrE,EAC1D,OAAO,EAER,UAAWyI,UAAezI,EACzB,OAAO,EAER,GAAmB,iBAARyI,EACV,OAAO,EAER,GAAK4B,MAAMC,QAAQ7B,KAAW4B,MAAMC,QAAQtK,GAC3C,OAAO,EAGR,IAAI3G,EACA+C,EAEJ,GAAIiO,MAAMC,QAAQ7B,GAAM,CACvB,GAAIA,EAAIlP,SAAWyG,EAAMzG,OACxB,OAAO,EAER,IAAKF,EAAI,EAAGA,EAAIoP,EAAIlP,OAAQF,IAC3B,IAAK4G,EAAOwI,EAAIpP,GAAI2G,EAAM3G,IACzB,OAAO,MAGH,CACN,MAAMu+C,KAEN,IAAKx7C,KAAOqM,EACXmvC,EAAQ98C,KAAKsB,GAEdw7C,EAAQ1uC,OACR,MAAM2uC,KACN,IAAKz7C,KAAO4D,EACX63C,EAAU/8C,KAAKsB,GAGhB,GADAy7C,EAAU3uC,QACLjJ,EAAO23C,EAASC,GACpB,OAAO,EAER,IAAKx+C,EAAI,EAAGA,EAAIu+C,EAAQr+C,OAAQF,IAC/B,IAAK4G,EAAOwI,EAAImvC,EAAQv+C,IAAK2G,EAAM43C,EAAQv+C,KAC1C,OAAO,EAIV,OAAO,mDAvKRqC,EAAAo7C,UAAAA,EAmBAp7C,EAAAo8C,WAAA,SAA8B1tC,GAC7B,IAAKA,GAAsB,iBAARA,EAClB,OAAOA,EAER,MAAMrF,GAAgBqF,GACtB,KAAOrF,EAAMxL,OAAS,GAAG,CACxB,MAAM6Q,EAAMrF,EAAMge,QAClB/mB,OAAOsgB,OAAOlS,GACd,IAAK,MAAMhO,KAAOgO,EACjB,GAAImtC,EAAgBl7C,KAAK+N,EAAKhO,GAAM,CACnC,MAAMqU,EAAOrG,EAAIhO,GACG,iBAATqU,GAAsBzU,OAAO+7C,SAAStnC,IAChD1L,EAAMjK,KAAK2V;AAKf,OAAOrG,GAGR,MAAMmtC,EAAkBv7C,OAAOC,UAAUF,eAEzCL,EAAAs8C,eAAA,SAA+B5tC,EAAU4sC,GACxC,OAAOD,EAAgB3sC,EAAK4sC,EAAS,IAAIiB,MA2C1Cv8C,EAAA+7C,MAAAA,EA2BA/7C,EAAAw8C,OAAA,SAAuBR,KAAqBS,GAE3C,OADAA,EAAQ17C,QAAQ6rB,GAAUtsB,OAAO4nC,KAAKtb,GAAQ7rB,QAAQL,GAAOs7C,EAAYt7C,GAAOksB,EAAOlsB,KAChFs7C,GAGRh8C,EAAAuE,OAAAA,EAiEAvE,EAAA08C,qBAAA,SAAqC5vC,EAAe6vC,GAA2B,GAC1EA,IACH7vC,EAAMA,EAAImE,IAAI,SAAUxN,GAAK,OAAOA,EAAEoa,iBAEvC,MAAM++B,EAhBP,SAAqB9xC,GACpB,MAAMpN,KACN,IAAK,MAAMa,KAAKuM,EACfpN,EAAOa,IAAK,EAEb,OAAOb,EAWMm/C,CAAY/vC,GACzB,OAAI6vC,EACI,SAAUG,GAChB,YAAoCn0C,IAA7Bi0C,EAAKE,EAAKj/B,gBAAgC++B,EAAKv8C,eAAey8C,EAAKj/B,gBAGpE,SAAUi/B,GAChB,YAAsBn0C,IAAfi0C,EAAKE,IAAuBF,EAAKv8C,eAAey8C,KAU1D98C,EAAA+8C,cAAA,SAA8BruC,GAC7B,MAAMO,KACN,OAAOmI,KAAKiF,UAAU3N,EAAK,CAAChO,EAAKR,KAChC,GAAIq7C,EAAA7B,SAASx5C,IAAUyO,MAAMC,QAAQ1O,GAAQ,CAC5C,IAA6B,IAAzB+O,EAAKxF,QAAQvJ,GAChB,MAAO,aAEP+O,EAAK7P,KAAKc,GAGZ,OAAOA,KAITF,EAAAg9C,aAAA,SAAmCtuC,EAAQjH,EAA+B6nB,GACzE,MAAM5xB,EAAS+J,EAAGiH,GAClB,YAAyB,IAAXhR,EAAyB4xB,EAAe5xB,GAcvDsC,EAAA8O,SAAA,SAAyBggC,EAAWxtC,GACnC,MAAM5D,EAAS4C,OAAOc,OAAO,MAE7B,OAAK0tC,GAASxtC,GAIKhB,OAAO4nC,KAAK5mC,GACpBP,QAAQwX,IAClB,MAAM0kC,EAAYnO,EAAKv2B,GACjB2kC,EAAc57C,EAAOiX,GAEtBhU,EAAO04C,EAAWC,KACtBx/C,EAAO6a,GAAK2kC,KAIPx/C,GAbCA,yDCiPT,SAASy/C,EAAuBC,EAAsBC,GACrD,IAAIn7B,OAA0BvZ,EAC1B20C,GAAmB,EAEvB,IAAK,IAAIrqC,EAAM,EAAGA,EAAMmqC,EAAav/C,OAAQoV,IAAO;AACnD,MAAMI,EAAO+pC,EAAah2C,WAAW6L,GAGrC,GACEI,GAAI,IAAkBA,GAAI,KACvBA,GAAI,IAAkBA,GAAI,IAC1BA,GAAI,IAAuBA,GAAI,IAC5B,KAAJA,GACI,KAAJA,GACI,KAAJA,GACI,MAAJA,GACCgqC,GAAkB,KAAJhqC,GAGO,IAArBiqC,IACHp7B,GAAOg1B,mBAAmBkG,EAAa3pC,UAAU6pC,EAAiBrqC,IAClEqqC,GAAmB,QAGR30C,IAARuZ,IACHA,GAAOk7B,EAAaniC,OAAOhI,QAGtB,MAEMtK,IAARuZ,IACHA,EAAMk7B,EAAarG,OAAO,EAAG9jC,IAI9B,MAAMsqC,EAAUC,EAAYnqC,QACZ1K,IAAZ40C,IAGsB,IAArBD,IACHp7B,GAAOg1B,mBAAmBkG,EAAa3pC,UAAU6pC,EAAiBrqC,IAClEqqC,GAAmB,GAIpBp7B,GAAOq7B,IAEwB,IAArBD,IAEVA,EAAkBrqC,IASrB,OAJyB,IAArBqqC,IACHp7B,GAAOg1B,mBAAmBkG,EAAa3pC,UAAU6pC,UAGnC30C,IAARuZ,EAAoBA,EAAMk7B,EAwBlC,SAASK,EAAYC,GAEpB,IAAIx9C,EAkBJ,OAfCA,EAFGw9C,EAAIC,WAAaD,EAAI9oC,KAAK/W,OAAS,GAAoB,SAAf6/C,EAAIE,YAElCF,EAAIC,YAAYD,EAAI9oC,OAEX,KAAtB8oC,EAAI9oC,KAAKxN,WAAW,KAChBs2C,EAAI9oC,KAAKxN,WAAW,IAAE,IAAkBs2C,EAAI9oC,KAAKxN,WAAW,IAAE,IAAkBs2C,EAAI9oC,KAAKxN,WAAW,IAAE,IAAkBs2C,EAAI9oC,KAAKxN,WAAW,IAAE,MACzH,KAAtBs2C,EAAI9oC,KAAKxN,WAAW,GAGfs2C,EAAI9oC,KAAK,GAAGiJ,cAAgB6/B,EAAI9oC,KAAKmiC,OAAO,GAG5C2G,EAAI9oC,KAET24B,EAAA9Y,YACHv0B,EAAQA,EAAMwZ,QAAQ,MAAO,OAEvBxZ,EAMR,SAAS29C,EAAaH,EAAUI,GAE/B,MAAMC,EAAWD,EAjDlB,SAAmClpC,GAClC,IAAIsN,OAA0BvZ,EAC9B,IAAK,IAAIsK,EAAM,EAAGA,EAAM2B,EAAK/W,OAAQoV,IAAO,CAC3C,MAAMI,EAAOuB,EAAKxN,WAAW6L,GACrB,KAAJI,GAA8B,KAAJA,QACjB1K,IAARuZ,IACHA,EAAMtN,EAAKmiC,OAAO,EAAG9jC,IAEtBiP,GAAOs7B,EAAYnqC,SAEP1K,IAARuZ,IACHA,GAAOtN,EAAK3B,IAIf,YAAetK,IAARuZ,EAAoBA,EAAMtN,GAmC9BuoC,EAGH,IAAIj7B,EAAM,IACN07B,OAAEA,EAAMD,UAAEA,EAAS/oC,KAAEA,EAAIwiC,MAAEA,EAAK4G,SAAEA,GAAaN;CASnD,GARIE,IACH17B,GAAO07B,EACP17B,GAAO,MAEJy7B,GAAwB,SAAXC,KAChB17B,GAAO+7B,EACP/7B,GAAO+7B,GAEJN,EAAW,CACd,IAAI51B,EAAM41B,EAAUl0C,QAAQ,KAC5B,IAAa,IAATse,EAAY,CAEf,MAAMm2B,EAAWP,EAAU5G,OAAO,EAAGhvB,GACrC41B,EAAYA,EAAU5G,OAAOhvB,EAAM,IAEtB,KADbA,EAAMm2B,EAASz0C,QAAQ,MAEtByY,GAAO67B,EAAQG,GAAU,IAGzBh8B,GAAO67B,EAAQG,EAASnH,OAAO,EAAGhvB,IAAM,GACxC7F,GAAO,IACPA,GAAO67B,EAAQG,EAASnH,OAAOhvB,EAAM,IAAI,IAE1C7F,GAAO,KAIK,KADb6F,GADA41B,EAAYA,EAAU9/B,eACNpU,QAAQ,MAEvByY,GAAO67B,EAAQJ,GAAW,IAG1Bz7B,GAAO67B,EAAQJ,EAAU5G,OAAO,EAAGhvB,IAAM,GACzC7F,GAAOy7B,EAAU5G,OAAOhvB,IAG1B,GAAInT,EAAM,CAET,GAAIA,EAAK/W,QAAU,GAAuB,KAAlB+W,EAAKxN,WAAW,IAA2C,KAAlBwN,EAAKxN,WAAW,GAAuB,CACvG,MAAMiM,EAAOuB,EAAKxN,WAAW,GACzBiM,GAAI,IAAkBA,GAAI,KAC7BuB,MAAWhK,OAAO2I,aAAaF,EAAO,OAAOuB,EAAKmiC,OAAO,WAEpD,GAAIniC,EAAK/W,QAAU,GAAuB,KAAlB+W,EAAKxN,WAAW,GAAuB,CACrE,MAAMiM,EAAOuB,EAAKxN,WAAW,GACzBiM,GAAI,IAAkBA,GAAI,KAC7BuB,KAAUhK,OAAO2I,aAAaF,EAAO,OAAOuB,EAAKmiC,OAAO,MAI1D70B,GAAO67B,EAAQnpC,GAAM,GAUtB,OARIwiC,IACHl1B,GAAO,IACPA,GAAO67B,EAAQ3G,GAAO,IAEnB4G,IACH97B,GAAO,IACPA,GAAQ47B,EAAyDE,EAA1Cb,EAAuBa,GAAU,IAElD97B,mDA5oBR,MAAMi8B,EAAiB,iBACjBC,EAAoB,MACpBC,EAAoB,QAE1B,IAAIC,GAAiC,EAKrCt+C,EAAAu+C,2BAAA,SAA2Cr+C,GAC1C,MAAMs+C,EAAMF,EAEZ,OADAA,EAAwBp+C,EACjBs+C,GA0ER,MAAM7sC,EAAS,GACTssC,EAAS,IACTQ,EAAU,qEAgBHC,EAEZx/C,aAAaihB;AACZ,OAAIA,aAAiBu+B,KAGhBv+B,IAGoC,iBAArBA,EAAOw9B,WACU,iBAApBx9B,EAAO69B,UACS,iBAAhB79B,EAAOvL,MACU,iBAAjBuL,EAAOi3B,OACW,iBAAlBj3B,EAAOy9B,QACW,mBAAlBz9B,EAAOw+B,QACS,mBAAhBx+B,EAAOy+B,MACa,mBAApBz+B,EAAO3Z,UA2CzBtH,YAAsB2/C,EAAsClB,EAAoB/oC,EAAewiC,EAAgB4G,EAAmBc,GAAmB,GAExH,iBAAjBD,GACVt/C,KAAKq+C,OAASiB,EAAajB,QAAUjsC,EACrCpS,KAAKo+C,UAAYkB,EAAalB,WAAahsC,EAC3CpS,KAAKqV,KAAOiqC,EAAajqC,MAAQjD,EACjCpS,KAAK63C,MAAQyH,EAAazH,OAASzlC,EACnCpS,KAAKy+C,SAAWa,EAAab,UAAYrsC,IAKzCpS,KAAKq+C,OAzHR,SAAoBA,EAAgBkB,GACnC,OAAIA,GAAWR,EACPV,GAAUjsC,GAEbisC,IACJh2C,QAAQm3C,MAAM,sDACdnB,EAAS,QAEHA,GAiHSoB,CAAWH,EAAcC,GACvCv/C,KAAKo+C,UAAYA,GAAahsC,EAC9BpS,KAAKqV,KA/GR,SAA8BgpC,EAAgBhpC,GAM7C,OAAQgpC,GACP,IAAK,QACL,IAAK,OACL,IAAK,OACChpC,EAEMA,EAAK,KAAOqpC,IACtBrpC,EAAOqpC,EAASrpC,GAFhBA,EAAOqpC,EAMV,OAAOrpC,EA8FOqqC,CAAqB1/C,KAAKq+C,OAAQhpC,GAAQjD,GACtDpS,KAAK63C,MAAQA,GAASzlC,EACtBpS,KAAKy+C,SAAWA,GAAYrsC,EApK/B,SAAsBy/B,EAAU0N,GAa/B,GAVK1N,EAAIwM,QACJkB,GAAWR,GAGd12C,QAAQC,gEAAgEupC,EAAIuM,sBAAsBvM,EAAIx8B,kBAAkBw8B,EAAIgG,sBAAsBhG,EAAI4M,cAMpJ5M,EAAIwM,SAAWO,EAAehW,KAAKiJ,EAAIwM,QAC1C,MAAM,IAAIx9C,MAAM;CAQjB,GAAIgxC,EAAIx8B,KACP,GAAIw8B,EAAIuM,WACP,IAAKS,EAAkBjW,KAAKiJ,EAAIx8B,MAC/B,MAAM,IAAIxU,MAAM,iJAGjB,GAAIi+C,EAAkBlW,KAAKiJ,EAAIx8B,MAC9B,MAAM,IAAIxU,MAAM,6HAyIjB8+C,CAAa3/C,KAAMu/C,IA8BrBH,aAIC,OAAOlB,EAAYl+C,MAKbL,KAAKigD,GAEX,IAAKA,EACJ,OAAO5/C,KAGR,IAAIq+C,OAAEA,EAAMD,UAAEA,EAAS/oC,KAAEA,EAAIwiC,MAAEA,EAAK4G,SAAEA,GAAamB,EA2BnD,YA1Bex2C,IAAXi1C,EACHA,EAASr+C,KAAKq+C,OACO,OAAXA,IACVA,EAASjsC,QAEQhJ,IAAdg1C,EACHA,EAAYp+C,KAAKo+C,UACO,OAAdA,IACVA,EAAYhsC,QAEAhJ,IAATiM,EACHA,EAAOrV,KAAKqV,KACO,OAATA,IACVA,EAAOjD,QAEMhJ,IAAVyuC,EACHA,EAAQ73C,KAAK63C,MACO,OAAVA,IACVA,EAAQzlC,QAEQhJ,IAAbq1C,EACHA,EAAWz+C,KAAKy+C,SACO,OAAbA,IACVA,EAAWrsC,GAGRisC,IAAWr+C,KAAKq+C,QAChBD,IAAcp+C,KAAKo+C,WACnB/oC,IAASrV,KAAKqV,MACdwiC,IAAU73C,KAAK63C,OACf4G,IAAaz+C,KAAKy+C,SAEdz+C,KAGD,IAAI6/C,EAAKxB,EAAQD,EAAW/oC,EAAMwiC,EAAO4G,GAW1C9+C,aAAagB,EAAe4+C,GAAmB,GACrD,MAAM9W,EAAQyW,EAAQxW,KAAK/nC,GAC3B,OAAK8nC,EAGE,IAAIoX,EACVpX,EAAM,IAAMr2B,EACZ0tC,mBAAmBrX,EAAM,IAAMr2B,GAC/B0tC,mBAAmBrX,EAAM,IAAMr2B,GAC/B0tC,mBAAmBrX,EAAM,IAAMr2B,GAC/B0tC,mBAAmBrX,EAAM,IAAMr2B,GAC/BmtC,GARO,IAAIM,EAAKztC,EAAQA,EAAQA,EAAQA,EAAQA,GAiC3CzS,YAAY0V,GAElB,IAAI+oC,EAAYhsC;CAWhB,GANI47B,EAAA9Y,YACH7f,EAAOA,EAAK8E,QAAQ,MAAOukC,IAKxBrpC,EAAK,KAAOqpC,GAAUrpC,EAAK,KAAOqpC,EAAQ,CAC7C,MAAMl2B,EAAMnT,EAAKnL,QAAQw0C,EAAQ,IACpB,IAATl2B,GACH41B,EAAY/oC,EAAKnB,UAAU,GAC3BmB,EAAOqpC,IAEPN,EAAY/oC,EAAKnB,UAAU,EAAGsU,GAC9BnT,EAAOA,EAAKnB,UAAUsU,IAAQk2B,GAIhC,OAAO,IAAImB,EAAK,OAAQzB,EAAW/oC,EAAMjD,EAAQA,GAG3CzS,YAAYogD,GAClB,OAAO,IAAIF,EACVE,EAAW1B,OACX0B,EAAW3B,UACX2B,EAAW1qC,KACX0qC,EAAWlI,MACXkI,EAAWtB,UAiBN9+C,SAAS4+C,GAAwB,GACvC,OAAOD,EAAat+C,KAAMu+C,GAGpB5+C,SACN,OAAOK,KAGRL,cAAcgC,GACb,GAAKA,EAEE,CAAA,GAAIA,aAAgBw9C,EAC1B,OAAOx9C,EACD,CACN,MAAMxD,EAAS,IAAI0hD,EAAKl+C,GAGxB,OAFAxD,EAAO6hD,QAAqBr+C,EAAMy9C,OAClCjhD,EAAO8hD,WAAwBt+C,EAAMu+C,SAC9B/hD,GAPP,OAAOwD,GAzQVlB,EAAA0+C,IAAAA,QAqSMU,UAAaV,EAAnBx/C,kCAECK,KAAAigD,WAA4B,KAC5BjgD,KAAAggD,QAAyB,KAEzBZ,aAIC,OAHKp/C,KAAKggD,UACThgD,KAAKggD,QAAU9B,EAAYl+C,OAErBA,KAAKggD,QAGNrgD,SAAS4+C,GAAwB,GACvC,OAAKA,EAOGD,EAAat+C,MAAM,IANrBA,KAAKigD,aACTjgD,KAAKigD,WAAa3B,EAAat+C,MAAM,IAE/BA,KAAKigD,YAOdtgD,SACC,MAAMgjB,GACLw9B,KAAM,GAyBP,OAtBIngD,KAAKggD,UACRr9B,EAAIy8B,OAASp/C,KAAKggD,SAEfhgD,KAAKigD,aACRt9B,EAAIu9B,SAAWlgD,KAAKigD,YAGjBjgD,KAAKqV,OACRsN,EAAItN,KAAOrV,KAAKqV,MAEbrV,KAAKq+C,SACR17B,EAAI07B,OAASr+C,KAAKq+C,QAEfr+C,KAAKo+C,YACRz7B,EAAIy7B,UAAYp+C,KAAKo+C,WAElBp+C,KAAK63C,QACRl1B,EAAIk1B,MAAQ73C,KAAK63C,OAEd73C,KAAKy+C,WACR97B,EAAI87B,SAAWz+C,KAAKy+C,UAEd97B;AAKT,MAAMs7B,GACLmC,GAAkB,MAClBC,GAAkB,MAClBC,GAAyB,MACzBC,GAAiB,MACjBC,GAA8B,MAC9BC,GAA+B,MAC/BC,GAAmB,MAEnBC,GAA4B,MAC5BC,GAAuB,MACvBC,GAAsB,MACtBC,GAAwB,MACxBC,GAAsB,MACtBC,GAAuB,MACvBC,GAAqB,MACrBC,GAAiB,MACjBC,GAAkB,MAClBC,GAAsB,MACtBC,GAAmB,MAEnBC,GAAkB,+GC3dnB7gD,EAAA8gD,qBAAA,SAAqCC,EAA2BC,GAC/D,OAAOC,EAAAvC,IAAIrnC,MAAM0pC,EAAUG,MAAMF,IAAerC,oECGjD,SAAgBn+C,EAAU2gD,GACzB,MAAMzjD,KAEN,OADAyjD,EAAYpgD,QAAQb,GAASxC,EAAO0B,KAAKc,IAClCxC,EAGR,SAAgBwqC,EAAWj3B,GAC1B,MAAMvT,KAGN,OAFAuT,EAAIlQ,QAAQ,CAACb,EAAOQ,IAAQhD,EAAO0B,KAAKsB,IAEjChD,mDAVRsC,EAAAQ,OAAAA,EAMAR,EAAAkoC,KAAAA,EAOAloC,EAAAohD,SAAA,SAA+BnwC,EAAgBvQ,EAAQR,GACtD,IAAIxC,EAASuT,EAAIvJ,IAAIhH,GAMrB,YALeiI,IAAXjL,IACHA,EAASwC,EACT+Q,EAAIiV,IAAIxlB,EAAKhD,IAGPA,GAGRsC,EAAAqhD,YAAA,SAAkCpwC,GACjC,MAAMqwC,KAKN,OAJArwC,EAAIlQ,QAAQ,CAACb,EAAOQ,KACnB4gD,EAAQliD,QAAQsB,QAAUR,cAGb+Q,EAAIrQ,UAAU0gD,EAAQ3nC,KAAK,UAG1C3Z,EAAAuhD,YAAA,SAA+Br7B,GAC9B,MAAMo7B,KAKN,OAJAp7B,EAAInlB,QAAQb,IACXohD,EAAQliD,KAAKc,YAGAgmB,EAAItlB,UAAU0gD,EAAQ3nC,KAAK,UAG1C3Z,EAAAwhD,kBAAA,SAAkCvwC,GACjC,MAAMwwC,KAMN,OAJAxwC,EAAIlQ,QAAQ,CAACb,EAAOQ,KACnB+gD,EAAariD,MAAMsB,EAAKR,MAGlBuhD;AAGRzhD,EAAA0hD,kBAAA,SAAkCD,GACjC,MAAMzwC,EAAQ,IAAIiV,IAElB,IAAK,MAAOvlB,EAAKR,KAAUuhD,EAC1BzwC,EAAMkV,IAAIxlB,EAAKR,GAGhB,OAAO8Q,SAYK2wC,EAAbziD,cAESK,KAAA4yB,OAAiB,GACjB5yB,KAAAqiD,KAAe,EAEvB1iD,MAAMwB,GAGL,OAFAnB,KAAK4yB,OAASzxB,EACdnB,KAAKqiD,KAAO,EACLriD,KAGRL,OAEC,OADAK,KAAKqiD,MAAQ,EACNriD,KAGRL,UACC,OAAOK,KAAKqiD,KAAOriD,KAAK4yB,OAAOt0B,OAAS,EAGzCqB,IAAIkD,GAGH,OAFcA,EAAEgF,WAAW,GACV7H,KAAK4yB,OAAO/qB,WAAW7H,KAAKqiD,MAI9C1iD,QACC,OAAOK,KAAK4yB,OAAO5yB,KAAKqiD,OA3B1B5hD,EAAA2hD,eAAAA,QA+BaE,EAMZ3iD,MAAMwB,GAIL,OAHAnB,KAAK4yB,OAASzxB,EAAIgZ,QAAQ,UAAW,IACrCna,KAAKuiD,MAAQ,EACbviD,KAAKwiD,IAAM,EACJxiD,KAAKmS,OAGbxS,UACC,OAAOK,KAAKwiD,IAAMxiD,KAAK4yB,OAAOt0B,OAG/BqB,OAECK,KAAKuiD,MAAQviD,KAAKwiD,IAClB,IAAIC,GAAW,EACf,KAAOziD,KAAKwiD,IAAMxiD,KAAK4yB,OAAOt0B,OAAQ0B,KAAKwiD,MAAO,CACjD,MAAM/uC,EAAKzT,KAAK4yB,OAAO/qB,WAAW7H,KAAKwiD,KACvC,GAAM,KAAF/uC,GAA2B,KAAFA,EAA2B,CACvD,IAAIgvC,EAGH,MAFAziD,KAAKuiD,aAKNE,GAAW,EAGb,OAAOziD,KAGRL,IAAIkD,GAEH,IAAI6/C,EAAO,EACX,MAAMC,EAAO9/C,EAAEvE,OACf,IAAIskD,EAAU5iD,KAAKuiD,MAEnB,KAAOG,EAAOC,GAAQC,EAAU5iD,KAAKwiD,KAAK,CACzC,MAAMK,EAAMhgD,EAAEgF,WAAW66C,GAAQ1iD,KAAK4yB,OAAO/qB,WAAW+6C,GACxD,GAAY,IAARC,EACH,OAAOA,EAERH,GAAQ,EACRE,GAAW,EAGZ,OAAID,IAAS3iD,KAAKwiD,IAAMxiD,KAAKuiD,MACrB,EACGG,EAAOC,GACT,EAED,EAIThjD,QACC,OAAOK,KAAK4yB,OAAO1e,UAAUlU,KAAKuiD,MAAOviD,KAAKwiD,MA7DhD/hD,EAAA6hD,aAAAA,QAiEMQ,EAQLnjD;AACC,QAAQK,KAAKI,MAASJ,KAAK0L,KAAQ1L,KAAKwiC,OAAUxiC,KAAKW,cAI5CoiD,EAaZpjD,YAAY+Y,GACX1Y,KAAKgjD,MAAQtqC,EAZd/Y,kBACC,OAAO,IAAIojD,EAAqB,IAAIT,GAGrC3iD,oBACC,OAAO,IAAIojD,EAAqB,IAAIX,GAUrCziD,QACCK,KAAKijD,WAAQ75C,EAGdzJ,IAAIwB,EAAaW,GAChB,MAAM+lB,EAAO7nB,KAAKgjD,MAAME,MAAM/hD,GAC9B,IAAIgU,EAQJ,IANKnV,KAAKijD,QACTjjD,KAAKijD,MAAQ,IAAIH,EACjB9iD,KAAKijD,MAAMrpC,QAAUiO,EAAKlnB,SAG3BwU,EAAOnV,KAAKijD,QACC,CACZ,MAAME,EAAMt7B,EAAKg7B,IAAI1tC,EAAKyE,SAC1B,GAAIupC,EAAM,EAEJhuC,EAAK/U,OACT+U,EAAK/U,KAAO,IAAI0iD,EAChB3tC,EAAK/U,KAAKwZ,QAAUiO,EAAKlnB,SAE1BwU,EAAOA,EAAK/U,UAEN,GAAI+iD,EAAM,EAEXhuC,EAAKqtB,QACTrtB,EAAKqtB,MAAQ,IAAIsgB,EACjB3tC,EAAKqtB,MAAM5oB,QAAUiO,EAAKlnB,SAE3BwU,EAAOA,EAAKqtB,UAEN,CAAA,IAAI3a,EAAKu7B,UASf,MAPAv7B,EAAK1V,OACAgD,EAAKzJ,MACTyJ,EAAKzJ,IAAM,IAAIo3C,EACf3tC,EAAKzJ,IAAIkO,QAAUiO,EAAKlnB,SAEzBwU,EAAOA,EAAKzJ,KAKd,MAAM23C,EAAaluC,EAAKxU,MAGxB,OAFAwU,EAAKxU,MAAQmB,EACbqT,EAAKhU,IAAMA,EACJkiD,EAGR1jD,IAAIwB,GACH,MAAM0mB,EAAO7nB,KAAKgjD,MAAME,MAAM/hD,GAC9B,IAAIgU,EAAOnV,KAAKijD,MAChB,KAAO9tC,GAAM,CACZ,MAAMguC,EAAMt7B,EAAKg7B,IAAI1tC,EAAKyE,SAC1B,GAAIupC,EAAM,EAEThuC,EAAOA,EAAK/U,UACN,GAAI+iD,EAAM,EAEhBhuC,EAAOA,EAAKqtB,UACN,CAAA,IAAI3a,EAAKu7B,UAKf,MAHAv7B,EAAK1V,OACLgD,EAAOA,EAAKzJ,KAKd,OAAOyJ,EAAOA,EAAKxU,WAAQyI,EAG5BzJ,OAAOwB,GAEN,MAAM0mB,EAAO7nB,KAAKgjD,MAAME,MAAM/hD,GACxB2I,KACN,IAAIqL,EAAOnV,KAAKijD,MAGhB,KAAO9tC,GAAM,CACZ,MAAMguC,EAAMt7B,EAAKg7B,IAAI1tC,EAAKyE,SAC1B,GAAIupC,EAAM,EAETr5C,EAAMjK,MAAM,EAAGsV,IACfA,EAAOA,EAAK/U,UACN,GAAI+iD,EAAM,EAEhBr5C,EAAMjK,OAAO,EAAGsV,IAChBA,EAAOA,EAAKqtB,UACN,CAAA,IAAI3a,EAAKu7B,UAKT;AAKN,IAHAjuC,EAAKxU,WAAQyI,EAGNU,EAAMxL,OAAS,GAAK6W,EAAKkS,WAAW,CAC1C,IAAKioB,EAAK7wC,GAAUqL,EAAMoD,MAC1B,OAAQoiC,GACP,KAAK,EAAG7wC,EAAO2B,UAAOgJ,EAAW,MACjC,KAAK,EAAG3K,EAAOiN,SAAMtC,EAAW,MAChC,KAAM,EAAG3K,EAAO+jC,WAAQp5B,EAEzB+L,EAAO1W,EAER,MAjBAopB,EAAK1V,OACLrI,EAAMjK,MAAM,EAAGsV,IACfA,EAAOA,EAAKzJ,MAoBf/L,WAAWwB,GACV,MAAM0mB,EAAO7nB,KAAKgjD,MAAME,MAAM/hD,GAC9B,IAAIgU,EAAOnV,KAAKijD,MACZrgC,OAA2BxZ,EAC/B,KAAO+L,GAAM,CACZ,MAAMguC,EAAMt7B,EAAKg7B,IAAI1tC,EAAKyE,SAC1B,GAAIupC,EAAM,EAEThuC,EAAOA,EAAK/U,UACN,GAAI+iD,EAAM,EAEhBhuC,EAAOA,EAAKqtB,UACN,CAAA,IAAI3a,EAAKu7B,UAMf,MAJAv7B,EAAK1V,OACLyQ,EAAYzN,EAAKxU,OAASiiB,EAC1BzN,EAAOA,EAAKzJ,KAKd,OAAOyJ,GAAQA,EAAKxU,OAASiiB,EAG9BjjB,aAAawB,GACZ,MAAM0mB,EAAO7nB,KAAKgjD,MAAME,MAAM/hD,GAC9B,IAAIgU,EAAOnV,KAAKijD,MAChB,KAAO9tC,GAAM,CACZ,MAAMguC,EAAMt7B,EAAKg7B,IAAI1tC,EAAKyE,SAC1B,GAAIupC,EAAM,EAEThuC,EAAOA,EAAK/U,UACN,GAAI+iD,EAAM,EAEhBhuC,EAAOA,EAAKqtB,UACN,CAAA,IAAI3a,EAAKu7B,UAMf,OAAKjuC,EAAKzJ,IAGF1L,KAAKsjD,cAAcnuC,EAAKzJ,UAF/B,EALDmc,EAAK1V,OACLgD,EAAOA,EAAKzJ,MAaP/L,cAAcwV,GACrB,IAAIwN,EACA6F,EACA7mB,EAmBJ,OAASwQ,KAlBI,KACPxQ,IAEJA,KACA6mB,EAAM,EACNxoB,KAAKujD,SAASpuC,EAAMxU,GAASgB,EAAK9B,KAAKc,KAEpC6nB,GAAO7mB,EAAKrD,OACRwkB,EAAA/Q,KAGH4Q,EAGJA,EAAIhiB,MAAQgB,EAAK6mB,KAFjB7F,GAAQ3Q,MAAM,EAAOrR,MAAOgB,EAAK6mB,MAI3B7F,KAKThjB,QAAQ8B,GACPzB,KAAKujD,SAASvjD,KAAKijD,MAAOxhD,GAGnB9B,SAASwV,EAA4C1T,GACxD0T,IAEHnV,KAAKujD,SAASpuC,EAAK/U,KAAMqB,GAGrB0T,EAAKxU,OAERc,EAAS0T,EAAKxU,MAAOwU,EAAKhU,KAG3BnB,KAAKujD,SAASpuC,EAAKzJ,IAAKjK,GAGxBzB,KAAKujD,SAASpuC,EAAKqtB,MAAO/gC,KAhO7BhB,EAAAsiD,kBAAAA,QAqOaS,EAKZ7jD,cACCK,KAAK0R,IAAM,IAAIgV,IACf1mB,KAAKu1C,YAAa;AAGnB51C,IAAImxB,EAAenwB,GAClBX,KAAK0R,IAAIiV,IAAI3mB,KAAKyjD,MAAM3yB,GAAWnwB,GAGpChB,IAAImxB,GACH,OAAO9wB,KAAK0R,IAAIvJ,IAAInI,KAAKyjD,MAAM3yB,IAGhCnxB,IAAImxB,GACH,OAAO9wB,KAAK0R,IAAIyqC,IAAIn8C,KAAKyjD,MAAM3yB,IAGhCzvB,WACC,OAAOrB,KAAK0R,IAAIrQ,KAGjB1B,QACCK,KAAK0R,IAAI6U,QAGV5mB,OAAOmxB,GACN,OAAO9wB,KAAK0R,IAAI6qC,OAAOv8C,KAAKyjD,MAAM3yB,IAGnCnxB,QAAQ+jD,GACP1jD,KAAK0R,IAAIlQ,QAAQkiD,GAGlB/jD,SACC,OAAOsB,EAAOjB,KAAK0R,KAGZ/R,MAAMmxB,GACb,IAAI3vB,EAAM2vB,EAAS7pB,WAKnB,OAJIjH,KAAKu1C,aACRp0C,EAAMA,EAAImd,eAGJnd,EAGRxB,OACC,OAAOgpC,EAAK3oC,KAAK0R,KAAKA,IAAIsH,GAAK0oC,EAAAvC,IAAIrnC,MAAMkB,IAG1CrZ,QACC,MAAMgkD,EAAc,IAAIH,EAIxB,OAFAxjD,KAAK0R,IAAIlQ,QAAQ,CAACb,EAAOQ,IAAQwiD,EAAYjyC,IAAIiV,IAAIxlB,EAAKR,IAEnDgjD,GA5DTljD,EAAA+iD,YAAAA,GAyEA,SAAkBI,GACjBA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,MAAA,GAAA,QAHD,CAAkBnjD,EAAAmjD,QAAAnjD,EAAAmjD,iBAMLC,EAOZlkD,cACCK,KAAK8jD,KAAO,IAAIp9B,IAChB1mB,KAAK+jD,WAAQ36C,EACbpJ,KAAKgkD,WAAQ56C,EACbpJ,KAAKgiB,MAAQ,EAGdriB,QACCK,KAAK8jD,KAAKv9B,QACVvmB,KAAK+jD,WAAQ36C,EACbpJ,KAAKgkD,WAAQ56C,EACbpJ,KAAKgiB,MAAQ,EAGdriB,UACC,OAAQK,KAAK+jD,QAAU/jD,KAAKgkD,MAG7B3iD,WACC,OAAOrB,KAAKgiB,MAGbriB,IAAIwB,GACH,OAAOnB,KAAK8jD,KAAK3H,IAAIh7C,GAGtBxB,IAAIwB,EAAQmqC,EAAA,GACX,MAAMx1B,EAAO9V,KAAK8jD,KAAK37C,IAAIhH,GAC3B,GAAK2U,EAML,OAHS,IAALw1B,GACHtrC,KAAKsrC,MAAMx1B,EAAMw1B,GAEXx1B,EAAKnV,MAGbhB,IAAIwB,EAAQR,EAAU2qC,EAAA,GACrB,IAAIx1B,EAAO9V,KAAK8jD,KAAK37C,IAAIhH,GACzB,GAAI2U,EACHA,EAAKnV,MAAQA,EACJ,IAAL2qC,GACHtrC,KAAKsrC,MAAMx1B,EAAMw1B,OAEZ;AAEN,OADAx1B,GAAS3U,IAAAA,EAAKR,MAAAA,EAAOwR,UAAM/I,EAAW8J,cAAU9J,GACxCkiC,GACP,KAAA,EACCtrC,KAAKikD,YAAYnuC,GACjB,MACD,KAAA,EACC9V,KAAKkkD,aAAapuC,GAClB,MACD,KAAA,EAGA,QACC9V,KAAKikD,YAAYnuC,GAGnB9V,KAAK8jD,KAAKn9B,IAAIxlB,EAAK2U,GACnB9V,KAAKgiB,SAIPriB,OAAOwB,GACN,QAASnB,KAAKsnB,OAAOnmB,GAGtBxB,OAAOwB,GACN,MAAM2U,EAAO9V,KAAK8jD,KAAK37C,IAAIhH,GAC3B,GAAK2U,EAML,OAHA9V,KAAK8jD,KAAKvH,OAAOp7C,GACjBnB,KAAKmkD,WAAWruC,GAChB9V,KAAKgiB,QACElM,EAAKnV,MAGbhB,QACC,IAAKK,KAAK+jD,QAAU/jD,KAAKgkD,MACxB,OAED,IAAKhkD,KAAK+jD,QAAU/jD,KAAKgkD,MACxB,MAAM,IAAInjD,MAAM,gBAEjB,MAAMiV,EAAO9V,KAAK+jD,MAIlB,OAHA/jD,KAAK8jD,KAAKvH,OAAOzmC,EAAK3U,KACtBnB,KAAKmkD,WAAWruC,GAChB9V,KAAKgiB,QACElM,EAAKnV,MAGbhB,QAAQykD,EAA8DlyB,GACrE,IAAItf,EAAU5S,KAAK+jD,MACnB,KAAOnxC,GACFsf,EACHkyB,EAAW1hC,KAAKwP,EAAhBkyB,CAAyBxxC,EAAQjS,MAAOiS,EAAQzR,IAAKnB,MAErDokD,EAAWxxC,EAAQjS,MAAOiS,EAAQzR,IAAKnB,MAExC4S,EAAUA,EAAQT,KAIpBxS,SACC,MAAMxB,KACN,IAAIyU,EAAU5S,KAAK+jD,MACnB,KAAOnxC,GACNzU,EAAO0B,KAAK+S,EAAQjS,OACpBiS,EAAUA,EAAQT,KAEnB,OAAOhU,EAGRwB,OACC,MAAMxB,KACN,IAAIyU,EAAU5S,KAAK+jD,MACnB,KAAOnxC,GACNzU,EAAO0B,KAAK+S,EAAQzR,KACpByR,EAAUA,EAAQT,KAEnB,OAAOhU,EA2CEwB,QAAQ0kD,GACjB,GAAIA,GAAWrkD,KAAKqB,KACnB,OAED,GAAgB,IAAZgjD,EAEH,YADArkD,KAAKumB,QAGN,IAAI3T,EAAU5S,KAAK+jD,MACfO,EAActkD,KAAKqB,KACvB,KAAOuR,GAAW0xC,EAAcD,GAC/BrkD,KAAK8jD,KAAKvH,OAAO3pC,EAAQzR,KACzByR,EAAUA,EAAQT,KAClBmyC,IAEDtkD,KAAK+jD,MAAQnxC,EACb5S,KAAKgiB,MAAQsiC,EACT1xC,IACHA,EAAQM,cAAW9J,GAIbzJ,aAAamW,GAEpB,GAAK9V,KAAK+jD,OAAU/jD,KAAKgkD,MAElB;AAAA,IAAKhkD,KAAK+jD,MAChB,MAAM,IAAIljD,MAAM,gBAEhBiV,EAAK3D,KAAOnS,KAAK+jD,MACjB/jD,KAAK+jD,MAAM7wC,SAAW4C,OALtB9V,KAAKgkD,MAAQluC,EAOd9V,KAAK+jD,MAAQjuC,EAGNnW,YAAYmW,GAEnB,GAAK9V,KAAK+jD,OAAU/jD,KAAKgkD,MAElB,CAAA,IAAKhkD,KAAKgkD,MAChB,MAAM,IAAInjD,MAAM,gBAEhBiV,EAAK5C,SAAWlT,KAAKgkD,MACrBhkD,KAAKgkD,MAAM7xC,KAAO2D,OALlB9V,KAAK+jD,MAAQjuC,EAOd9V,KAAKgkD,MAAQluC,EAGNnW,WAAWmW,GAClB,GAAIA,IAAS9V,KAAK+jD,OAASjuC,IAAS9V,KAAKgkD,MACxChkD,KAAK+jD,WAAQ36C,EACbpJ,KAAKgkD,WAAQ56C,OAET,GAAI0M,IAAS9V,KAAK+jD,MAAO,CAG7B,IAAKjuC,EAAK3D,KACT,MAAM,IAAItR,MAAM,gBAEjBiV,EAAK3D,KAAKe,cAAW9J,EACrBpJ,KAAK+jD,MAAQjuC,EAAK3D,UAEd,GAAI2D,IAAS9V,KAAKgkD,MAAO,CAG7B,IAAKluC,EAAK5C,SACT,MAAM,IAAIrS,MAAM,gBAEjBiV,EAAK5C,SAASf,UAAO/I,EACrBpJ,KAAKgkD,MAAQluC,EAAK5C,aAEd,CACJ,MAAMf,EAAO2D,EAAK3D,KACZe,EAAW4C,EAAK5C,SACtB,IAAKf,IAASe,EACb,MAAM,IAAIrS,MAAM,gBAEjBsR,EAAKe,SAAWA,EAChBA,EAASf,KAAOA,EAEjB2D,EAAK3D,UAAO/I,EACZ0M,EAAK5C,cAAW9J,EAGTzJ,MAAMmW,EAAkBw1B,GAC/B,IAAKtrC,KAAK+jD,QAAU/jD,KAAKgkD,MACxB,MAAM,IAAInjD,MAAM,gBAEjB,GAAU,IAALyqC,GAA8B,IAALA,EAI9B,GAAS,IAALA,EAAuB,CAC1B,GAAIx1B,IAAS9V,KAAK+jD,MACjB,OAGD,MAAM5xC,EAAO2D,EAAK3D,KACZe,EAAW4C,EAAK5C,SAGlB4C,IAAS9V,KAAKgkD,OAGjB9wC,EAAUf,UAAO/I,EACjBpJ,KAAKgkD,MAAQ9wC,IAIbf,EAAMe,SAAWA,EACjBA,EAAUf,KAAOA,GAIlB2D,EAAK5C,cAAW9J,EAChB0M,EAAK3D,KAAOnS,KAAK+jD,MACjB/jD,KAAK+jD,MAAM7wC,SAAW4C,EACtB9V,KAAK+jD,MAAQjuC,OACP,GAAS,IAALw1B,EAAuB;AACjC,GAAIx1B,IAAS9V,KAAKgkD,MACjB,OAGD,MAAM7xC,EAAO2D,EAAK3D,KACZe,EAAW4C,EAAK5C,SAGlB4C,IAAS9V,KAAK+jD,OAGjB5xC,EAAMe,cAAW9J,EACjBpJ,KAAK+jD,MAAQ5xC,IAGbA,EAAMe,SAAWA,EACjBA,EAAUf,KAAOA,GAElB2D,EAAK3D,UAAO/I,EACZ0M,EAAK5C,SAAWlT,KAAKgkD,MACrBhkD,KAAKgkD,MAAM7xC,KAAO2D,EAClB9V,KAAKgkD,MAAQluC,GAIfnW,SACC,MAAMgC,KAMN,OAJA3B,KAAKwB,QAAQ,CAACb,EAAOQ,KACpBQ,EAAK9B,MAAMsB,EAAKR,MAGVgB,EAGRhC,SAASgC,GACR3B,KAAKumB,QAEL,IAAK,MAAOplB,EAAKR,KAAUgB,EAC1B3B,KAAK2mB,IAAIxlB,EAAKR,IA3UjBF,EAAAojD,UAAAA,QAgVaU,UAAuBV,EAKnClkD,YAAY6kD,EAAeC,EAAgB,GAC1C3xC,QACA9S,KAAK0kD,OAASF,EACdxkD,KAAK2kD,OAASriD,KAAKQ,IAAIR,KAAKS,IAAI,EAAG0hD,GAAQ,GAG5CD,YACC,OAAOxkD,KAAK0kD,OAGbF,UAAUA,GACTxkD,KAAK0kD,OAASF,EACdxkD,KAAK4kD,YAGNH,YACC,OAAOzkD,KAAK2kD,OAGbF,UAAUA,GACTzkD,KAAK2kD,OAASriD,KAAKQ,IAAIR,KAAKS,IAAI,EAAG0hD,GAAQ,GAC3CzkD,KAAK4kD,YAGNjlD,IAAIwB,GACH,OAAO2R,MAAM3K,IAAIhH,EAAG,GAGrBxB,KAAKwB,GACJ,OAAO2R,MAAM3K,IAAIhH,EAAG,GAGrBxB,IAAIwB,EAAQR,GACXmS,MAAM6T,IAAIxlB,EAAKR,EAAK,GACpBX,KAAK4kD,YAGEjlD,YACHK,KAAKqB,KAAOrB,KAAK0kD,QACpB1kD,KAAK6kD,QAAQviD,KAAKE,MAAMxC,KAAK0kD,OAAS1kD,KAAK2kD,UA5C9ClkD,EAAA8jD,SAAAA,iFC9xBA,SAASO,EAAcC,GACtB,OAAQA,GACP,KAAK,EACJ,MAAO,GACR,KAAK,EACJ,SAAUC,MACX,QAIC,YAAaC,KAAcD,KAAiBC,KAAcA,IAAaD,SAI1E,SAAgBE,EAAensC,EAAiBosC,GAC/C,IAAKpsC,EACJ;CAGD,MAAML,KAEN,IAAI0sC,GAAW,EACXC,GAAa,EAEbC,EAAS,GACb,IAAK,MAAM5uB,KAAQ3d,EAAS,CAC3B,OAAQ2d,GACP,KAAKyuB,EACJ,IAAKC,IAAaC,EAAY,CAC7B3sC,EAAS7Y,KAAKylD,GACdA,EAAS,GAET,SAED,MACD,IAAK,IACJF,GAAW,EACX,MACD,IAAK,IACJA,GAAW,EACX,MACD,IAAK,IACJC,GAAa,EACb,MACD,IAAK,IACJA,GAAa,EAIfC,GAAU5uB,EAQX,OAJI4uB,GACH5sC,EAAS7Y,KAAKylD,GAGR5sC,EAGR,SAAS6sC,EAAYxsC,GACpB,IAAKA,EACJ,MAAO,GAGR,IAAIysC,EAAQ,GAGZ,MAAM9sC,EAAWwsC,EAAensC,EAAS0sC,GAGzC,GAAI/sC,EAASkiC,MAAM13C,GAAKA,IAAMwiD,GAC7BF,EAAQ,SAIJ,CACJ,IAAIG,GAA6B,EACjCjtC,EAASlX,QAAQ,CAACoY,EAAS9J,KAG1B,GAAI8J,IAAY8rC,EAQf,YALKC,IACJH,GAASV,EAAc,GACvBa,GAA6B,IAO/B,IAAIP,GAAW,EACXQ,EAAW,GAEXP,GAAa,EACbQ,EAAa,GAEjB,IAAK,MAAMnvB,KAAQ9c,EAElB,GAAa,MAAT8c,GAAgB0uB,EACnBQ,GAAYlvB,OAKb,IAAI2uB,GAAwB,MAAT3uB,GAAiBmvB,EA4BpC,OAAQnvB,GACP,IAAK,IACJ0uB,GAAW,EACX,SAED,IAAK,IACJC,GAAa,EACb,SAED,IAAK,IACJ,MAGMS,QAHUZ,EAAeU,EAAU,KAGPl0C,IAAIzN,GAAKshD,EAAYthD,IAAImW,KAAK,QAEhEorC,GAASM,EAETV,GAAW,EACXQ,EAAW,GAEX,MAED,IAAK,IACJJ,GAAU,IAAMK,EAAa,IAE7BR,GAAa,EACbQ,EAAa,GAEb,MAGD,IAAK,IACJL,GAASR,EACT,SAED,IAAK,IACJQ,GAASV,EAAc,GACvB,SAED,QACCU,GAASO,EAAQzT,uBAAuB5b,OApE1C,CACC,IAAI/T,EAuBJkjC,GAnBCljC,EADY,MAAT+T,EACGA,EAIY,MAATA,GAAyB,MAATA,GAAkBmvB,EAMnCnvB,IAAS+uB,EACX,GAKAM,EAAQzT,uBAAuB5b,GAX/B,IAmEL5mB,EAAQ4I,EAASpa,OAAS,IAAMoa,EAAS5I,EAAQ,KAAO41C,GAAY51C,EAAQ,EAAI4I,EAASpa,UAC5FknD,GAASP,GAIVU,GAA6B,IAI/B,OAAOH,EA+CR,SAASQ,EAAaC,EAAiChwC,GACtD,IAAKgwC,EACJ,OAAOC,EAIR,IAAIntC,EAEHA,EADmB,iBAATktC,EACAA,EAAKltC,QAELktC,EAOX,MAAME,KAHNptC,EAAUA,EAAQskB,YAGiBpnB,EAAQmwC,oBAC3C,IAAIC,EAAgBC,EAAMn+C,IAAIg+C,GAC9B,GAAIE,EACH,OAAOE,EAAoBF,EAAeJ,GAI3C,IAAIxd,EACJ,GAAI+d,EAAG5d,KAAK7vB,GAAU;AACrB,MAAMw2B,EAAOx2B,EAAQy+B,OAAO,GAC5B6O,EAAgB,SAAUhxC,EAAM+8B,GAC/B,MAAuB,iBAAT/8B,GAAqB0wC,EAAQxR,SAASl/B,EAAMk6B,GAAQx2B,EAAU,WAG7EstC,GADU5d,EAAQge,EAAG/d,KAAK0d,EAAkBrtC,EAAS9C,KAwCvD,SAAiBs5B,EAAcmX,GAC9B,MAAMC,MAAgBpX,IAChBqX,OAAqBrX,IACrB8W,EAAqC,SAAUhxC,EAAM+8B,GAC1D,MAAoB,iBAAT/8B,EACH,KAEJ+8B,EACIA,IAAa7C,EAAOmX,EAAkB,KAEvCrxC,IAASk6B,GAAQwW,EAAQxR,SAASl/B,EAAMsxC,IAAcZ,EAAQxR,SAASl/B,EAAMuxC,GAAiBF,EAAkB,MAElHG,GAAatX,GAInB,OAHA8W,EAAcQ,UAAYA,EAC1BR,EAAcS,UAAYJ,GAC1BL,EAAcU,aAAeF,EACtBR,EAvDUW,CAAQve,EAAM,GAAI1vB,IACvB9C,EAAQmwC,kBAAoBa,EAAOC,GAAIte,KAAK7vB,GA0DzD,SAAiBA,EAAiB9C,GACjC,MAAMkxC,EAAiBC,EAAyBruC,EAAQhZ,MAAM,GAAI,GAAGqL,MAAM,KACzEsG,IAAIqH,GAAWitC,EAAajtC,EAAS9C,IACrCnH,OAAOiK,GAAWA,IAAYmtC,GAAOntC,GACjC/R,EAAImgD,EAAe7oD,OACzB,IAAK0I,EACJ,OAAOk/C,EAER,GAAU,IAANl/C,EACH,OAA4BmgD,EAAe,GAE5C,MAAMd,EAAqC,SAAUhxC,EAAc+8B,GAClE,IAAK,IAAIh0C,EAAI,EAAG4I,EAAImgD,EAAe7oD,OAAQF,EAAI4I,EAAG5I,IACjD,GAA0B+oD,EAAe/oD,GAAIiX,EAAM+8B,GAClD,OAAOr5B,EAGT,OAAO,MAEFsuC,EAAgB9a,EAAOhrC,MAAM4lD,EAAgBpuC,KAAmCA,EAASguC,cAC3FM,IACHhB,EAAcU,aAAqCM,EAAeN,cAEnE,MAAMO,EAAWH,EAAe52C,OAAO,CAAC4X,EAAKvV,IAAYA,EAAQ00C,SAAWn/B,EAAIlY,OAAO2C,EAAQ00C,UAAYn/B,MACvGm/B,EAAShpD,SACZ+nD,EAAciB,SAAWA,GAE1B,OAAOjB,EApFUkB,CAAQxuC,EAAS9C,IACvBwyB,EAAQ+e,EAAG9e,KAAK0d,EAAkBrtC,EAAS9C,KACrCwxC,EAAYhf,EAAM,GAAG+O,OAAO,GAAIz+B,GAAS,IAC/C0vB,EAAQif,EAAGhf,KAAK0d,EAAkBrtC,EAAS9C,KACrCwxC,EAAYhf,EAAM,GAAI1vB,GAAS,GAgGjD,SAAkBA,GACjB,IACC,MAAM4uC,EAAS,IAAI3S,WAAWuQ,EAAYxsC,OAC1C,OAAO,SAAU1D,EAAc+8B,GAE9B,OADAuV,EAAOxS,UAAY,EACI,iBAAT9/B,GAAqBsyC,EAAO/e,KAAKvzB,GAAQ0D,EAAU,MAEjE,MAAOvP,GACR,OAAO08C,GAnGS0B,CAAS7uC,GAM1B,OAFAutC,EAAM3/B,IAAIw/B,EAAYE,GAEfE,EAAoBF,EAAeJ,GAG3C,SAASM,EAAoBF,EAAoCwB;AAChE,MAAoB,iBAATA,EACHxB,EAGD,SAAUhxC,EAAM+8B,GACtB,OAAK0V,EAAQjO,gBAAgBxkC,EAAMwyC,EAAKtY,MAIjC8W,EAAchW,EAAMjqC,SAASyhD,EAAKtY,KAAMl6B,GAAO+8B,GAH9C,MAOV,SAASgU,EAAkBrtC,EAAiB9C,GAC3C,OAAOA,EAAQmwC,mBAAqBL,EAAQxR,SAASx7B,EAAS,OAASA,EAAQy+B,OAAO,EAAGz+B,EAAQza,OAAS,GAAKya,EAuDhH,SAAS0uC,EAAYpyC,EAAc0D,EAAiBgvC,GACnD,MAAMC,EAAa3X,EAAMx3B,MAAQw3B,EAAM0B,MAAMl5B,IAAMxD,EAAK8E,QAAQ8tC,EAAqB5X,EAAMx3B,KAAOxD,EAC5F6yC,EAAgB7X,EAAMx3B,IAAMmvC,EAC5B3B,EAAqC0B,EAAgB,SAAU1yC,EAAM+8B,GAC1E,MAAuB,iBAAT/8B,GAAsBA,IAAS2yC,IAAcjC,EAAQxR,SAASl/B,EAAM6yC,GAA4B,KAAVnvC,GACjG,SAAU1D,EAAM+8B,GACnB,MAAuB,iBAAT/8B,GAAqBA,IAAS2yC,EAAajvC,EAAU,MAGpE,OADAstC,EAAciB,WAAaS,EAAgB,KAAO,MAAQ1yC,GACnDgxC,EA2CR,SAAgBvuC,EAAMmuC,EAA+ChwC,MACpE,IAAKgwC,EACJ,OAAOkC,EAIR,GAAoB,iBAATlC,GAAqBmC,EAAkBnC,GAAO,CACxD,MAAMI,EAAgBL,EAAaC,EAAmChwC,GACtE,GAAIowC,IAAkBH,EACrB,OAAOiC,EAER,MAAME,EAAgB,SAAUhzC,EAAc+8B,GAC7C,QAASiU,EAAchxC,EAAM+8B,IAQ9B,OANIiU,EAAcU,eACUsB,EAAetB,aAAeV,EAAcU,cAEpEV,EAAciB,WACUe,EAAef,SAAWjB,EAAciB,UAE7De,EAIR,OAkED,SAA0BC,EAAyBryC,GAClD,MAAMkxC,EAAiBC,EAAyBrmD,OAAO26C,oBAAoB4M,GACzE52C,IAAIqH,IA0EP,SAAgCA,EAAiBpY,EAAYsV,GAC5D,IAAc,IAAVtV,EACH,OAAOulD,EAGR,MAAMG,EAAgBL,EAAajtC,EAAS9C,GAC5C,GAAIowC,IAAkBH,EACrB,OAAOA,EAIR,GAAqB,kBAAVvlD,EACV,OAAO0lD,EAIR,GAAI1lD,EAAO,CACV,MAAM4nD,EAAuB5nD,EAAO4nD,KACpC,GAAoB,iBAATA,EAAmB,CAC7B,MAAMpqD,EAAkC,CAACkX,EAAc+8B,EAAkB3oC,EAAc++C,KACtF,IAAKA,IAAenC,EAAchxC,EAAM+8B,GACvC,OAAO,KAGR,MAAMqW,EAAgBF,EAAKpuC,QAAQ,cAAe1Q,GAC5Ci/C,EAAUF,EAAWC,GAC3B,OAAOvnB,EAAA/T,WAAWu7B,GACjBA,EAAQ95C,KAAK7K,GAAKA,EAAIgV,EAAU,MAChC2vC,EAAU3vC,EAAU;CAGtB,OADA5a,EAAOwqD,kBAAmB,EACnBxqD,GAKT,OAAOkoD,GA9GUuC,CAAuB7vC,EAASuvC,EAAWvvC,GAAU9C,IACpEnH,OAAOiK,GAAWA,IAAYmtC,IAE1Bl/C,EAAImgD,EAAe7oD,OACzB,IAAK0I,EACJ,OAAOk/C,EAGR,IAAKiB,EAAe0B,KAAKxC,KAA6CA,EAAesC,kBAAmB,CACvG,GAAU,IAAN3hD,EACH,OAA4BmgD,EAAe,GAG5C,MAAM2B,EAAwC,SAAUzzC,EAAc+8B,GACrE,IAAK,IAAIh0C,EAAI,EAAG4I,EAAImgD,EAAe7oD,OAAQF,EAAI4I,EAAG5I,IAAK,CAEtD,MAAMD,EAA+BgpD,EAAe/oD,GAAIiX,EAAM+8B,GAC9D,GAAIj0C,EACH,OAAOA,EAIT,OAAO,MAGFkpD,EAAgB9a,EAAOhrC,MAAM4lD,EAAgBpuC,KAAmCA,EAASguC,cAC3FM,IACHyB,EAAiB/B,aAAqCM,EAAeN,cAGtE,MAAMO,EAAWH,EAAe52C,OAAO,CAAC4X,EAAKvV,IAAYA,EAAQ00C,SAAWn/B,EAAIlY,OAAO2C,EAAQ00C,UAAYn/B,MAK3G,OAJIm/B,EAAShpD,SACZwqD,EAAiBxB,SAAWA,GAGtBwB,EAGR,MAAMA,EAAwC,SAAUzzC,EAAc+8B,EAAkBoW,GACvF,IAAI/+C,OAA2BL,EAE/B,IAAK,IAAIhL,EAAI,EAAG4I,EAAImgD,EAAe7oD,OAAQF,EAAI4I,EAAG5I,IAAK,CAEtD,MAAMioD,EAA0Cc,EAAe/oD,GAC3DioD,EAAcsC,kBAAoBH,IAChCpW,IACJA,EAAW/B,EAAM+B,SAAS/8B,IAEtB5L,IACJA,EAAO2oC,EAASoF,OAAO,EAAGpF,EAAS9zC,OAAS+xC,EAAMgC,QAAQh9B,GAAM/W,UAGlE,MAAMH,EAASkoD,EAAchxC,EAAM+8B,EAAU3oC,EAAM++C,GACnD,GAAIrqD,EACH,OAAOA,EAIT,OAAO,MAGFkpD,EAAgB9a,EAAOhrC,MAAM4lD,EAAgBpuC,KAAmCA,EAASguC,cAC3FM,IACHyB,EAAiB/B,aAAqCM,EAAeN,cAGtE,MAAMO,EAAWH,EAAe52C,OAAO,CAAC4X,EAAKvV,IAAYA,EAAQ00C,SAAWn/B,EAAIlY,OAAO2C,EAAQ00C,UAAYn/B,MACvGm/B,EAAShpD,SACZwqD,EAAiBxB,SAAWA,GAG7B,OAAOwB,EA3IAC,CAA8B9C,EAAMhwC,GAiC5C,SAAS+yC,EAAUC,GAClB,MAAMv3C,KACN,IAAK,MAAMvQ,KAAO8nD,EACjBv3C,EAAIvQ,IAAO,EAEZ,OAAOuQ,EAGR,SAAgB02C,EAAkBj5C,GACjC,MAAM+5C,EAAK/5C,EAEX,OAAO+5C,GAAyB,iBAAZA,EAAG3Z,MAA2C,iBAAf2Z,EAAGnwC,QAyIvD,SAASquC,EAAyBD,EAAsEhpD,GACvG,MAAMgrD,EAAmBhC,EAAer4C,OAAOu3C,KAAyCA,EAAeQ;CACvG,GAAIsC,EAAiB7qD,OAAS,EAC7B,OAAO6oD,EAGR,MAAMN,EAAYsC,EAAiB54C,OAAiB,CAAC4X,EAAKvV,KACzD,MAAMi0C,EAAkCj0C,EAASi0C,UACjD,OAAOA,EAAY1+B,EAAIlY,OAAO42C,GAAa1+B,OAE5C,IAAI2+B,EACJ,GAAI3oD,EAAQ,CACX2oD,KACA,IAAK,IAAI1oD,EAAI,EAAG4I,EAAI6/C,EAAUvoD,OAAQF,EAAI4I,EAAG5I,IAC5C0oD,EAASjnD,KAAK1B,QAGf2oD,EAAWqC,EAAiB54C,OAAO,CAAC4X,EAAKvV,KACxC,MAAMk0C,EAAiCl0C,EAASk0C,SAChD,OAAOA,EAAW3+B,EAAIlY,OAAO62C,GAAY3+B,OAG3C,MAAMihC,EAAiC,SAAU/zC,EAAM+8B,GACtD,GAAoB,iBAAT/8B,EACV,OAAO,KAER,IAAK+8B,EAAU,CACd,IAAIh0C,EACJ,IAAKA,EAAIiX,EAAK/W,OAAQF,EAAI,EAAGA,IAAK,CACjC,MAAMqV,EAAK4B,EAAKxN,WAAWzJ,EAAI,GAC/B,GAAM,KAAFqV,GAA2B,KAAFA,EAC5B,MAGF2+B,EAAW/8B,EAAKmiC,OAAOp5C,GAExB,MAAM0R,EAAQ+2C,EAAU38C,QAAQkoC,GAChC,OAAkB,IAAXtiC,EAAeg3C,EAASh3C,GAAS,MAEzCs5C,EAAUvC,UAAYA,EACtBuC,EAAUtC,SAAWA,EACrBsC,EAAUrC,aAAeF,EAEzB,MAAMwC,EAAqBlC,EAAer4C,OAAOu3C,IAAwCA,EAAeQ,WAExG,OADAwC,EAAmBxpD,KAAKupD,GACjBC,mDArqBR5oD,EAAA6oD,mBAAA,WACC,OAAOvoD,OAAOc,OAAO,OAOtB,MAAM6jD,EAAW,KACXD,EAAa,IACbR,EAAa,UACbD,EAAgB,WAChBiD,EAAsB,MAgB5BxnD,EAAAykD,eAAAA,EAuLA,MAAMsB,EAAK,uBACLC,EAAK,wBACLS,EAAK,2DACLD,EAAO,6EACPO,EAAK,2BACLE,EAAK,+BA4BLpB,EAAQ,IAAIiD,EAAAhF,SAAsC,KAElD4D,EAAQ,WACb,OAAO,GAGFjC,EAAO;AACZ,OAAO,MA8JRzlD,EAAAgoC,MAAA,SAAsBwd,EAA+C5wC,EAAcmzC,GAClF,SAAKvC,GAAwB,iBAAT5wC,IAIbyC,EAAmBmuC,EAAnBnuC,CAAyBzC,OAAMjM,EAAWo/C,IAalD/nD,EAAAqX,MAAAA,EA2BArX,EAAA+oD,oBAAA,SAAoCC,GACnC,IAAKA,EACJ,OAGD,IAAIC,EACJ,OAAQjgD,IACFigD,IACJA,GAAYD,KAAgBp7C,QAAQC,aAClCM,KAAKq6C,GAAQA,EAAOD,EAAUC,QAE1BS,EAAS96C,KAAK8C,KAASA,EAAIjI,MAIpChJ,EAAAkpD,aAAA,SAA6BF,GAC5B,IAAKA,EACJ,OAGD,IAAIC,EACJ,OAAQjgD,IACP,IAAKigD,EAAU,CACd,MAAMT,EAAOQ,IACbC,EAAWT,EAAOD,EAAUC,MAE7B,QAASS,EAASjgD,KAYpBhJ,EAAA2nD,kBAAAA,EASA3nD,EAAAmpD,aAAA,SAA6BtB,EAAyBryC,GACrD,MAAM8yC,EAAmBjxC,EAAMwwC,EAAYryC,GAC3C,MAAO,CAACZ,EAAc+8B,EAAmBoW,KACxC,MAAMrqD,EAAS4qD,EAAiB1zC,EAAM+8B,EAAUoW,GAChD,OAAOtnB,EAAA/T,WAAWhvB,GAAUA,EAASkQ,QAAQC,QAAQnQ,KAIvDsC,EAAAopD,iBAAA,SAAiCC,GAChC,OAA6BA,EAAqB/C,kBAGnDtmD,EAAAspD,aAAA,SAA6BD,GAC5B,OAA6BA,EAAqBxC,sEC9fnD,SAAS5W,EAAUryB,EAAa2rC,EAAcC,GAC7C,IAAKxpD,EAAAypD,eAAiB7rC,EACrB,OAAOA,EAGR,MAAM8rC,EAASF,EAAgB9hD,IAAIkW,GACnC,GAAI8rC,EACH,OAAOA,EAGR,IAAIxnC,EAUJ,OARCA,EADGynC,EAA0BxhB,KAAKvqB,GACtBA,EAAKqyB,UAAUsZ,GAErB3rC,EAIP4rC,EAAgBtjC,IAAItI,EAAKsE,GAElBA,mDAjCKliB,EAAAypD,aAAgD,kBAAnB,GAAc,UAExD,MAAMG,EAAW,IAAId,EAAAhF,SAAyB,KAC9C9jD,EAAA6pD,aAAA,SAA6BjsC,GAC5B,OAAOqyB,EAAUryB,EAAK,MAAOgsC,IAG9B,MAAME,EAAW,IAAIhB,EAAAhF,SAAyB,KAC9C9jD,EAAA+pD,aAAA,SAA6BnsC;AAC5B,OAAOqyB,EAAUryB,EAAK,MAAOksC,IAG9B,MAAMH,EAA4B,0GCNlC,SAAgBK,EAAgB35B,GAG/B,OAAOA,GAAYA,EAASutB,SAAWqM,EAAA13B,QAAQQ,OAAQwa,EAAA5Y,QAYxD,SAAgBykB,EAAgBtK,EAAWob,EAAsBpV,EAAakV,EAAgBlb,IAC7F,GAAIA,EAAK8O,SAAWsM,EAAgBtM,OAAQ,CAC3C,GAAI9O,EAAK8O,SAAWqM,EAAA13B,QAAQQ,KAC3B,OAAOs0B,EAAQjO,gBAAgB+Q,EAAerb,GAAOqb,EAAeD,GAAkBpV,GAEvF,GAAIsV,EAAiBtb,EAAK6O,UAAWuM,EAAgBvM,WACpD,OAAO0J,EAAQjO,gBAAgBtK,EAAKl6B,KAAMs1C,EAAgBt1C,KAAMkgC,EAAY,KAG9E,OAAO,EAMR,SAAgBsV,EAAiBC,EAAYC,GAC5C,OAAOD,IAAOC,GAAMxS,EAAAzC,iBAAiBgV,EAAIC,GAoB1C,SAAgB3Y,EAASthB,GACxB,OAAOuf,EAAM0B,MAAMK,SAASthB,EAASzb,MA0EtC,SAAgBu1C,EAAezM,GAC9B,IAAIx9C,EACJ,MAAMqqD,EAAU7M,EAAI9oC,KAkBpB,OAfC1U,EAFGw9C,EAAIC,WAAa4M,EAAQ1sD,OAAS,GAAoB,SAAf6/C,EAAIE,YAEjCF,EAAIC,YAAY4M,IAE7Bhd,EAAA9Y,WACwB,KAArB81B,EAAQnjD,WAAW,IACnBigD,EAAQhP,qBAAqBkS,EAAQnjD,WAAW,KAC3B,KAArBmjD,EAAQnjD,WAAW,GAEdmjD,EAAQxT,OAAO,GAGfwT,EAELhd,EAAA9Y,YACHv0B,EAAQA,EAAMwZ,QAAQ,MAAO,OAEvBxZ,EAaR,SAAgBsqD,EAAyBn6B,GACxC,GAAIA,EAASutB,SAAWqM,EAAA13B,QAAQQ,KAAM,CACrC,MAAM03B,EAAMN,EAAe95B,GAC3B,OAAOo6B,EAAI5sD,OAASwpD,EAAQ3O,QAAQ+R,GAAK5sD,QAAU4sD,EAAIA,EAAI5sD,OAAS,KAAO+xC,EAAMx3B,IAC3E,CACN,MAAMvV,EAAIwtB,EAASzb,KACnB,OAAO/R,EAAEhF,OAAS,GAA+B,KAA1BgF,EAAEuE,WAAWvE,EAAEhF,OAAS,IAqBjD,SAAgBmjD,EAAavgD,EAAW8N,GACvC,GAAI9N,EAAKm9C,SAAWrvC,EAAGqvC,QAAWwM,EAAiB3pD,EAAKk9C,UAAWpvC,EAAGovC,WAAtE;AAGA,GAAIl9C,EAAKm9C,SAAWqM,EAAA13B,QAAQQ,KAAM,CACjC,MAAMiuB,EAAepR,EAAMjqC,SAASlF,EAAKmU,KAAMrG,EAAGqG,MAClD,OAAO24B,EAAA9Y,UAAY4yB,EAAQ9O,UAAUyI,GAAgBA,EAEtD,OAAOpR,EAAM0B,MAAM3rC,SAASlF,EAAKmU,MAAQ,IAAKrG,EAAGqG,MAAQ,uDAtM1D5U,EAAA0qD,iBAAA,SAAiCr6B,GAChC,OAAO25B,EAAgB35B,GAAYA,EAAS7pB,WAAWqX,cAAgBwS,EAAS7pB,YAGjFxG,EAAAgqD,gBAAAA,EAMAhqD,EAAA2qD,oBAAA,SAAoCt6B,GACnC,OAAOshB,EAASthB,IAAaA,EAASstB,WAQvC39C,EAAAo5C,gBAAAA,EAeAp5C,EAAAoqD,iBAAAA,EAIApqD,EAAAg5C,QAAA,SAAwBl4C,EAAwB8pD,EAAyB9V,EAAakV,EAAgBlpD,IACrG,GAAIA,IAAU8pD,EACb,OAAO,EAGR,IAAK9pD,IAAU8pD,EACd,OAAO,EAGR,GAAI9pD,EAAM88C,SAAWgN,EAAOhN,SAAWwM,EAAiBtpD,EAAM68C,UAAWiN,EAAOjN,WAC/E,OAAO,EAGR,MAAMkN,EAAK/pD,EAAM8T,MAAQ,IAAKk2C,EAAKF,EAAOh2C,MAAQ,IAClD,OAAOi2C,IAAOC,GAAMhW,GAAcgD,EAAAzC,iBAAiBwV,GAAM,IAAKC,GAAM,MAGrE9qD,EAAA2xC,SAAAA,EAIA3xC,EAAA4xC,QAAA,SAAwBvhB,GACvB,OAAOuf,EAAM0B,MAAMM,QAAQvhB,EAASzb,OASrC5U,EAAA0xC,QAAA,SAAwBrhB,GACvB,GAA6B,IAAzBA,EAASzb,KAAK/W,OACjB,OAAOwyB,EAER,GAAIA,EAASutB,SAAWqM,EAAA13B,QAAQQ,KAC/B,OAAOkuB,EAAAvC,IAAI3rB,KAAK6c,EAAM8B,QAAQyY,EAAe95B,KAE9C,IAAIqhB,EAAU9B,EAAM0B,MAAMI,QAAQrhB,EAASzb,MAK3C,OAJIyb,EAASstB,WAAajM,EAAQ7zC,QAA+B,KAArB6zC,EAAQtqC,WAAW,KAC9DQ,QAAQmB,kBAAkBsnB,EAAS7pB,0CACnCkrC,EAAU,KAEJrhB,EAASuuB,MACfhqC,KAAM88B,KAWR1xC,EAAA+qD,SAAA,SAAyB16B,KAAkB26B,GAC1C,IAAIC;CAMJ,OAJCA,EADG56B,EAASutB,SAAWqM,EAAA13B,QAAQQ,KAClBkuB,EAAAvC,IAAI3rB,KAAK6c,EAAMj2B,KAAKwwC,EAAe95B,MAAc26B,IAAep2C,KAEhEg7B,EAAM0B,MAAM33B,KAAK0W,EAASzb,MAAQ,OAAQo2C,GAEjD36B,EAASuuB,MACfhqC,KAAMq2C,KAURjrD,EAAAkrD,cAAA,SAA8B76B,GAC7B,IAAKA,EAASzb,KAAK/W,OAClB,OAAOwyB,EAER,IAAI86B,EAMJ,OAJCA,EADG96B,EAASutB,SAAWqM,EAAA13B,QAAQQ,KACdkuB,EAAAvC,IAAI3rB,KAAK6c,EAAMK,UAAUka,EAAe95B,KAAYzb,KAEpDg7B,EAAM0B,MAAMrB,UAAU5f,EAASzb,MAE1Cyb,EAASuuB,MACfhqC,KAAMu2C,KAQRnrD,EAAAmqD,eAAAA,EA0BAnqD,EAAAorD,eAAA,SAA+B/6B,GAC9B,QAASA,EAASzb,MAA6B,MAArByb,EAASzb,KAAK,IAMzC5U,EAAAwqD,yBAAAA,EAeAxqD,EAAAqrD,4BAAA,SAA4Ch7B,GAC3C,OAAIm6B,EAAyBn6B,GACrBA,EAASuuB,MAAOhqC,KAAMyb,EAASzb,KAAKmiC,OAAO,EAAG1mB,EAASzb,KAAK/W,OAAS,KAEtEwyB,GAQRrwB,EAAAghD,aAAAA,EAcAhhD,EAAAsrD,YAAA,SAA4Bxc,EAAWl6B,GACtC,IAAIi8B,EAMJ,OAJCA,EADG/B,EAAK8O,SAAWqM,EAAA13B,QAAQQ,KACZkuB,EAAAvC,IAAI3rB,KAAK6c,EAAM/hC,QAAQs8C,EAAerb,GAAOl6B,IAAOA,KAEpDg7B,EAAM0B,MAAMzjC,QAAQihC,EAAKl6B,KAAMA,GAExCk6B,EAAK8P,MACXhqC,KAAMi8B,KAIR7wC,EAAAurD,gBAAA,SAAmCv6C,EAAYw6C,GAC9C,MAAMD,KACN,IAAK,IAAI5tD,EAAI,EAAGA,EAAIqT,EAAMnT,OAAQF,IAAK,CACtC,MAAM8tD,EAAoBD,EAAiBx6C,EAAMrT,IAC7CqT,EAAMo3C,KAAK,CAACsD,EAAWr8C,IACtBA,IAAU1R,GAIPy7C,EAAgBqS,EAAmBD,EAAiBE,MAK5DH,EAAgBnsD,KAAK4R,EAAMrT,IAG5B,OAAO4tD,IAMR,SAAiBI,GAEHA,EAAAC,gBAAkB,QAClBD,EAAAE,sBAAwB,cACxBF,EAAAG,eAAiB,OACjBH,EAAAI,eAAiB,OAEdJ,EAAAK,cAAhB,SAA8BC,GAC7B,MAAMC,EAAW,IAAIjmC;CAIRgmC,EAAQr3C,KAAKnB,UAAUw4C,EAAQr3C,KAAKnL,QAAQ,KAAO,EAAGwiD,EAAQr3C,KAAK85B,YAAY,MACvF/jC,MAAM,KAAK5J,QAAQorD,IACvB,MAAOzrD,EAAKR,GAASisD,EAASxhD,MAAM,KAChCjK,GAAOR,GACVgsD,EAAShmC,IAAIxlB,EAAKR,KAMpB,MAAMksD,EAAOH,EAAQr3C,KAAKnB,UAAU,EAAGw4C,EAAQr3C,KAAKnL,QAAQ,MAK5D,OAJI2iD,GACHF,EAAShmC,IAAIylC,EAAAI,eAAgBK,GAGvBF,GA3BT,CAAiBlsD,EAAA2rD,UAAA3rD,EAAA2rD,mBAgCJU,EAKZntD,YACCotD,EACAC,GAJgBhtD,KAAAitD,kBAAoF1D,EAAAxG,kBAAkBmK,WAMtHltD,KAAK+sD,iBAAmBI,EAAAr1C,MAAMi1C,GAC9B,IAAK,MAAMzE,KAAc0E,EACxBhtD,KAAKitD,kBAAkBtmC,IAAI2hC,EAAW3uC,KAAK1S,YAAc0S,KAAM2uC,EAAW3uC,KAAM2uC,WAAY6E,EAAAr1C,MAAMwwC,EAAWA,cAI/G3oD,QAAQmxB,GACP,MAAMs8B,EAAiBptD,KAAKitD,kBAAkBI,WAAWv8B,EAAS7pB,YAClE,GAAImmD,EAAgB,CACnB,MAAM/3C,EAAOosC,EAAa2L,EAAezzC,KAAMmX,GAC/C,GAAIzb,GAAU+3C,EAAe9E,WAAWjzC,GACvC,OAAO,EAGT,QAASrV,KAAK+sD,iBAAiBj8B,EAASzb,OAvB1C5U,EAAAqsD,oBAAAA,+EC/LA,SAASQ,EAAej4C,GACvB,SAAU24B,EAAA9Y,YAAa7f,GAAoB,MAAZA,EAAK,IAGrC,SAAgBk4C,EAAqBl4C,GACpC,OAAIi4C,EAAej4C,GACXA,EAAKqG,OAAO,GAAGib,cAAgBthB,EAAKtV,MAAM,GAG3CsV,EAIR,SAAgBm4C,EAAQn4C,EAAco4C,GACrC,GAAIzf,EAAA9Y,YAAc7f,IAASo4C,EAC1B,OAAOp4C,EAIR,IAAIq4C,EAAqBC,EAAyB1rD,WAAawrD,EAAWE,EAAyBC,gBAAaxkD,EAWhH,OAVKskD,IACJA,KAAwBnV,EAAA5F,MAAM8a,EAAUvU,EAAAnH,MAAMl5B,OAAOqgC,EAAAnH,MAAMl5B,MAC3D80C,GAA6B1rD,SAAUwrD,EAAUG,WAAYF;CAI1D1f,EAAA5Y,QAAUmjB,EAAAjE,WAAWj/B,EAAMq4C,GAAsBnV,EAAAxC,qBAAqB1gC,EAAMq4C,MAC/Er4C,OAAYA,EAAKmiC,OAAOkW,EAAmBpvD,WAGrC+W,mDAlGR5U,EAAAotD,aAAA,SAA6B/8B,EAAwBg9B,EAAsCC,GAM1F,GALwB,iBAAbj9B,IACVA,EAAW4wB,EAAAvC,IAAI3rB,KAAK1C,IAIjBi9B,EAAc,CACjB,MAAMC,EAAeD,EAAaE,mBAAmBn9B,GACrD,GAAIk9B,EAAc,CACjB,MAAME,EAAmBH,EAAaI,eAAeC,QAAQ9vD,OAAS,EAEtE,IAAI+vD,EAQJ,GANCA,EADGC,EAAA7U,QAAQuU,EAAa7P,IAAKrtB,GACjB,GAGAooB,EAAAxI,UAAU6H,EAAAhG,MAAMzhB,EAASzb,KAAKmiC,OAAOwW,EAAa7P,IAAI9oC,KAAK/W,QAAS46C,EAAAnH,MAAMl5B,MAGnFq1C,EAAkB,CACrB,MAAMK,EAAYP,GAAgBA,EAAavkD,KAAQukD,EAAavkD,KAAO6kD,EAAAlc,SAAS4b,EAAa7P,KACjGkQ,EAAYA,EAAaE,EAAW,MAAQF,EAAaE,EAG1D,OAAOF,GAKT,GAAIv9B,EAASutB,SAAWqM,EAAA13B,QAAQQ,MAAQ1C,EAASutB,SAAWqM,EAAA13B,QAAQU,SACnE,OAAO5C,EAASuuB,MAAOxH,MAAO,KAAM4G,SAAU,OAAQx3C,UAAS,GAIhE,GAAIqmD,EAAex8B,EAASsuB,QAC3B,OAAOlG,EAAAxI,UAAU6c,EAAqBz8B,EAASsuB,SAIhD,IAAIz8B,EAAMu2B,EAAAxI,UAAU5f,EAASsuB,QAK7B,OAJKpR,EAAA9Y,WAAa44B,IACjBnrC,EAAM6qC,EAAQ7qC,EAAKmrC,EAAiBL,WAG9B9qC,GAKRliB,EAAA+tD,aAAA,SAA6B19B,GAC5B,IAAKA,EACJ,OAGuB,iBAAbA,IACVA,EAAW4wB,EAAAvC,IAAI3rB,KAAK1C,IAGrB,MAAMye,EAAO+e,EAAAlc,SAASthB,KAAcA,EAASutB,SAAWqM,EAAA13B,QAAQQ,KAAO1C,EAASsuB,OAAStuB,EAASzb,MAGlG,OAAIi4C,EAAe/d,GACXge,EAAqBhe,GAGtBA,GAOR9uC,EAAA8sD,qBAAAA,EAQA,IAAII,EAAqE5sD,OAAOc,OAAO,MACvFpB,EAAA+sD,QAAAA,EAoBA/sD,EAAAguD,UAAA,SAA0Bp5C,EAAco4C,GACvC,OAAOp4C,EAAK8E,QAAQ,iBAAkBszC;CAgCvC,MAAMiB,EAAW,IACXC,EAAM,OACNC,EAAO,IACbnuD,EAAAouD,QAAA,SAAwBxe,GACvB,MAAMye,EAA2B,IAAI1/C,MAAMihC,EAAM/xC,QAGjD,IAAImqC,GAAQ,EACZ,IAAK,IAAIsmB,EAAY,EAAGA,EAAY1e,EAAM/xC,OAAQywD,IAAa,CAC9D,IAAI15C,EAAOg7B,EAAM0e,GAEjB,GAAa,KAAT15C,EAAa,CAChBy5C,EAAeC,OAAiB7V,EAAArgC,MAChC,SAGD,IAAKxD,EAAM,CACVy5C,EAAeC,GAAa15C,EAC5B,SAGDozB,GAAQ,EAGR,IAAIumB,EAAS,GACa,IAAtB35C,EAAKnL,QAAQykD,IAChBK,EAAS35C,EAAKmiC,OAAO,EAAGniC,EAAKnL,QAAQykD,GAAOA,EAAIrwD,QAChD+W,EAAOA,EAAKmiC,OAAOniC,EAAKnL,QAAQykD,GAAOA,EAAIrwD,SACX,IAAtB+W,EAAKnL,QAAQgvC,EAAArgC,MACvBm2C,EAAS35C,EAAKmiC,OAAO,EAAGniC,EAAKnL,QAAQgvC,EAAArgC,KAAOqgC,EAAArgC,IAAIva,QAChD+W,EAAOA,EAAKmiC,OAAOniC,EAAKnL,QAAQgvC,EAAArgC,KAAOqgC,EAAArgC,IAAIva,SACV,IAAvB+W,EAAKnL,QAAQ0kD,KACvBI,EAAS35C,EAAKmiC,OAAO,EAAGniC,EAAKnL,QAAQ0kD,GAAQA,EAAKtwD,QAClD+W,EAAOA,EAAKmiC,OAAOniC,EAAKnL,QAAQ0kD,GAAQA,EAAKtwD,SAI9C,MAAMoa,EAAqBrD,EAAKjK,MAAM8tC,EAAArgC,KACtC,IAAK,IAAIo2C,EAAgB,EAAGxmB,GAASwmB,GAAiBv2C,EAASpa,OAAQ2wD,IACtE,IAAK,IAAIxiD,EAAQiM,EAASpa,OAAS2wD,EAAexmB,GAASh8B,GAAS,EAAGA,IAAS,CAC/Eg8B,GAAQ,EACR,IAAIymB,EAAUx2C,EAAS3Y,MAAM0M,EAAOA,EAAQwiD,GAAe70C,KAAK8+B,EAAArgC,KAGhE,IAAK,IAAIs2C,EAAiB,GAAI1mB,GAAS0mB,EAAiB9e,EAAM/xC,OAAQ6wD,IAGrE,GAAIA,IAAmBJ,GAAa1e,EAAM8e,IAAmB9e,EAAM8e,GAAgBjlD,QAAQglD,IAAY,EAAG,CACzG,MAAME,EAA4B3iD,EAAQwiD,IAAkBv2C,EAASpa,OAI/D+wD,EAA0B5iD,EAAQ,GAAK4jC,EAAM8e,GAAgBjlD,QAAQgvC,EAAArgC,MAAQ,EAAKqgC,EAAArgC,IAAMq2C,EAAUA,EAClGI,EAA6B/W,EAAAhE,SAASlE,EAAM8e,GAAiBE,GAEnE5mB,GAAS2mB,GAAmBE,EAK9B,IAAK7mB,EAAO,CACX,IAAItqC,EAAS,IAGTo6C,EAAAhE,SAAS77B,EAAS,GAAI,MAAmB,KAAXs2C,KACnB,IAAVviD,IAEHA,EAAQ,EACRwiD,IACAC,EAAUx2C,EAAS,GAAKwgC,EAAArgC,IAAMq2C,GAG3BziD,EAAQ,IACXtO,EAASua,EAAS,GAAKwgC,EAAArgC,KAGxB1a,EAAS6wD,EAAS7wD,GAIfsO,EAAQ,IACXtO,EAASA,EAASuwD,EAAWxV,EAAArgC,KAG9B1a,GAAkB+wD,EAGdziD,EAAQwiD,EAAgBv2C,EAASpa,SACpCH,EAASA,EAAS+6C,EAAArgC,IAAM61C,GAGzBI,EAAeC,GAAa5wD,GAK3BsqC,IACHqmB,EAAeC,GAAa15C,GAI9B,OAAOy5C,GAOR,IAAKS,GAAL,SAAKA,GACJA,EAAAA,EAAA,KAAA,GAAA;AACAA,EAAAA,EAAA,SAAA,GAAA,WACAA,EAAAA,EAAA,UAAA,GAAA,YAHD,CAAKA,IAAAA,OAiBL9uD,EAAA+uD,SAAA,SAAyBA,EAAkBvuD,EAAwDF,OAAOc,OAAO,OAChH,MAAM6W,KAEN,IAAI+2C,GAAa,EACbnK,EAAS,GACb,IAAK,MAAM5uB,KAAQ84B,EAElB,GAAa,MAAT94B,GAAiB+4B,GAAuB,MAAT/4B,EAC9B4uB,GACH5sC,EAAS7Y,MAAOc,MAAO2kD,EAAQhwC,KAAMi6C,EAAKG,OAG3CpK,EAAS,GACTmK,GAAa,OAIT,GAAa,MAAT/4B,GAAgB+4B,EAAY,CACpC,MAAM96B,EAAW1zB,EAAOqkD,GAGxB,GAAwB,iBAAb3wB,EACNA,EAASr2B,QACZoa,EAAS7Y,MAAOc,MAAOg0B,EAAUrf,KAAMi6C,EAAKI,gBAKzC,GAAIh7B,EAAU,CAClB,MAAMi7B,EAAcl3C,EAASA,EAASpa,OAAS,GAC1CsxD,GAAeA,EAAYt6C,OAASi6C,EAAKM,WAC7Cn3C,EAAS7Y,MAAOc,MAAOg0B,EAASm7B,MAAOx6C,KAAMi6C,EAAKM,YAIpDvK,EAAS,GACTmK,GAAa,OAKbnK,GAAU5uB,EASZ,OAJI4uB,IAAWmK,GACd/2C,EAAS7Y,MAAOc,MAAO2kD,EAAQhwC,KAAMi6C,EAAKG,OAGpCh3C,EAAS5J,OAAO,CAAC8K,EAAS9J,IAG5B8J,EAAQtE,OAASi6C,EAAKM,YACZn3C,EAAS5I,EAAQ,GAChB4I,EAAS5I,EAAQ,IAEV8qC,MAAMhhC,GAAWA,IAAYA,EAAQtE,OAASi6C,EAAKI,UAAY/1C,EAAQtE,OAASi6C,EAAKG,OAAS91C,EAAQjZ,MAAMrC,OAAS,IAKzIoT,IAAIkI,GAAWA,EAAQjZ,OAAOyZ,KAAK,KASvC3Z,EAAAsvD,kBAAA,SAAkCD,EAAeE,GAChD,OAAIhiB,EAAA7Y,aAAe66B,EACXF,EAAM31C,QAAQ,eAAgB,IAAIA,QAAQ,KAAM6zB,EAAA7Y,YAAc,IAAM,MAGrE26B,EAAM31C,QAAQ,QAASpW,GAAW,MAANA,EAAY,KAAO,MASvDtD,EAAAwvD,oBAAA,SAAoCH,GACnC,OAAI9hB,EAAA7Y,YACI26B,EAAM31C,QAAQ,eAAgB,IAGlC6zB,EAAA9Y,UACI46B,EAAM31C,QAAQ,QAASpW,GAAW,MAANA,EAAY,KAAO,KAGhD+rD,EAAM31C,QAAQ,MAAO,MAG7B1Z,EAAAyvD,gBAAA,SAAgCJ,GAC/B,OAAOA,EAAM31C,QAAQ,KAAM;AAM5B1Z,EAAA0vD,UAAA,SAA0BC,GACzB,IAAK,IAAIhyD,EAAIgyD,EAAS9xD,OAAS,EAAGF,GAAK,EAAGA,IAAK,CAC9C,MAAM0V,EAAOs8C,EAASvoD,WAAWzJ,GACjC,GAAQ,KAAJ0V,GAA+B,KAAJA,EAC9B,OAASu8C,WAAYD,EAAS5Y,OAAO,EAAGp5C,GAAIqL,KAAM2mD,EAAS5Y,OAAOp5C,EAAI,IAGxE,OAASiyD,WAAY,GAAI5mD,KAAM2mD,uDC1ThC,SAAgBE,IACf,OAAO,IAAIC,EAKZ,SAAgBC,EAAO7vD,GACtB,OAAO8vD,EAAa7nB,KAAKjoC,0DA1EpB+vD,EAEL/wD,YAAmBizB,GAAA5yB,KAAA4yB,OAAAA,EAIZjzB,QACN,OAAOK,KAAK4yB,cAIR29B,UAAeG,EAcpB/wD,cACCmT,OACCy9C,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACP,IACAJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACP,IACA,IACAJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACP,IACAJ,EAAOK,OAAOL,EAAOM,eACrBN,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACP,IACAJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,aACPJ,EAAOI,cACNv2C,KAAK,KA9CAza,cAAc4L,GACrB,OAAOA,EAAMjJ,KAAKqJ,MAAMJ,EAAMjN,OAASgE,KAAK2O;AAGrCtR,oBACP,OAAO4wD,EAAOK,OAAOL,EAAOO,SATLP,EAAAO,QAAU,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAErFP,EAAAM,eAAiB,IAAK,IAAK,IAAK,KAoDzDpwD,EAAA6vD,GAAAA,EAIA,MAAMG,EAAe,kEAErBhwD,EAAA+vD,OAAAA,EAQA/vD,EAAAqX,MAAA,SAAsBnX,GACrB,IAAK6vD,EAAO7vD,GACX,MAAM,IAAIE,MAAM,gBAGjB,OAAO,IAAI6vD,EAAU/vD,IAGtBF,EAAAswD,aAAA,WACC,OAAOT,IAAKU,iEC5Db,SAAgBhhC,EAAQihC,EAAY/oD,EAAkHzG,GAQrJ,GALAyvD,EAAOxwD,GAAGuwD,EAAO,2BACjBC,EAAOxwD,GAAmB,mBAAT,EAAqB,uEACtCwwD,EAAOxwD,GAAyB,mBAAf,EAA2B,0EAGrB,mBAAZ,EACV,IACCuwD,EAAM,CAACznD,EAAcrL,KAChBqL,EACH/H,EAAS+H,EAAO,MAEhBwmB,EAAK7xB,EAAQ+J,EAAIzG,KAGlB,MAAO+H,GACR/H,EAAS+H,EAAO,UAKb,CACJ,MAAMukB,KAEAojC,EAA8B,SAAU/yD,GAG7C,GAAIA,EAAI6yD,EAAM3yD,OAGb,IACC4J,EAAG+oD,EAAM7yD,GAAI,CAACoL,EAAYrL,MAGX,IAAVqL,IAA4B,IAAVA,IACrBrL,EAASqL,EACTA,EAAQ,MAILA,EACH/H,EAAS+H,EAAO,OAKZrL,GACH4vB,EAAQluB,KAAK1B,GAGdi2B,QAAQpP,SAAS,KAChBmsC,EAAO/yD,EAAI,OAGXA,EAAG6yD,EAAM3yD,QACX,MAAOkL,GACR/H,EAAS+H,EAAO,WAMjB/H,EAAS,KAAMssB,IAKjBojC,EAAO,IAqET,SAAgBvjC,EAASwjC,IAjEzB,SAAkBA;AAGjBF,EAAOxwD,GAAG0wD,EAAU9yD,OAAS,EAAG,wEAChC8yD,EAAU5vD,QAASosB,IAClBsjC,EAAOxwD,GAAyB,mBAAf,KAIlB,MAAM2J,EAAe+mD,EAAUnnD,OAAO,EAAG,GAAG,GAC5C,IAAIonD,EAAsB,KAE1BrhC,EAAKohC,EAAW,CAACxjC,EAAU81B,KAC1B,MAAM4N,EAAmB,SAAU9nD,EAAYrL,IAGhC,IAAVqL,IAA4B,IAAVA,IACrBrL,EAASqL,EACTA,EAAQ,MAILA,EACHk6C,EAAIl6C,EAAO,OAEX6nD,EAAiBlzD,EACjBulD,EAAI,KAAM,QAOZ,IACC91B,EAASxsB,KAAKkwD,EAAkBD,GAC/B,MAAO7nD,GACRk6C,EAAIl6C,EAAO,QAEV,CAACA,EAAOrL,KACNqL,GACHa,EAAab,KA0Bf+nD,CAAUniD,MAAMC,QAAQ+hD,GAAcA,EAAYhiD,MAAMpO,UAAUjB,MAAMqB,KAAK0Q,6DA9K9ErR,EAAA+wD,SAAA,SAA+BvI,EAAW/gD,EAAgFzG,GACzH,MAAMssB,EAAU,IAAI3e,MAAM65C,EAAK3qD,QACzB2a,EAAS,IAAI7J,MAAoB65C,EAAK3qD,QAC5C,IAAImzD,GAAgB,EAChBC,EAAY,EAEhB,GAAoB,IAAhBzI,EAAK3qD,OACR,OAAOmD,EAAS,SAGjBwnD,EAAKznD,QAAQ,CAACsU,EAAMhG,KACnB5H,EAAG4N,EAAM,CAACtM,EAAOrL,KAUhB,GATIqL,GACHioD,GAAgB,EAChB1jC,EAAQje,GAAS,KACjBmJ,EAAOnJ,GAAStG,IAEhBukB,EAAQje,GAAS3R,EACjB8a,EAAOnJ,GAAS,QAGX4hD,IAAczI,EAAK3qD,OACxB,OAAOmD,EAASgwD,EAAgBx4C,EAAS,KAAM8U,QAanDttB,EAAAuvB,KAAAA,EA0IAvvB,EAAAmtB,SAAAA,2GC5KA,MAAM+jC,EAAYC,EAAArQ,qBAAqBsQ,EAAS,SAC1CxhB,EAAQwhB,EAAQC,iBAAyBH,GAClClxD,EAAAsxD,eAAiB1hB,EAAM0hB,eACvBtxD,EAAAuxD,uBAAyB3hB,EAAM2hB;kDCA5CvxD,EAAAwxD,kBAAA,SAAkCz+B,EAAc0+B,GAC/C,OAAO,IAAI7jD,QAAoB,CAACC,EAASC,KACxC4jD,EAAGpoB,KAAKvW,EAAM,IAAK,KAAM,CAACroB,EAAKinD,KAK9B,SAASz/C,EAAIxH,EAAmBknD,EAA6BC,GAC5DH,EAAGI,MAAMH,EAAII,GACRA,EACIjkD,EAAOikD,GAGXrnD,GAA2B,WAAdA,EAAK2I,KACdvF,EAAOpD,GAGRmD,GAAUyW,OAAQstC,EAAcC,UAAAA,KAOzC,SAASG,IACRN,EAAGO,KAAKN,EAAIrtC,EAAQpP,EAAQu8C,EAAav8C,EAAQ,KAAM,CAACxK,EAAKmnD,IACxDnnD,EACIwH,EAAIxH,EAAK,KAAM,GAGL,IAAdmnD,EACI3/C,EAAI,KAAMoS,EAAQpP,IAG1BA,GAAU28C,KAEKJ,EACPv/C,EAAI,KAAMoS,EAAQpP,GAGnB88C,KArCT,GAAItnD,EACH,OAAOoD,EAAOpD,GAiBf,MAAM4Z,EAAS4tC,OAAOC,YAAYV,GAClC,IAAIv8C,EAAS,EAsBb88C,SAcHhyD,EAAAoyD,qBAAA,SAAqCr/B,EAAcs/B,EAAwBC,EAAoBC,GAC9F,OAAO,IAAI3kD,QAAuB,CAACC,EAASC,IAC3C4jD,EAAGpoB,KAAKvW,EAAM,IAAK,KAAM,CAACroB,EAAKinD,KAK9B,SAASz/C,EAAIxH,EAAmBhN,GAC/Bg0D,EAAGI,MAAMH,EAAII,GACRA,EACIjkD,EAAOikD,GAGXrnD,GAA2B,WAAdA,EAAK2I,KACdvF,EAAOpD,GAGRmD,EAAQnQ,IAOjB,SAASs0D,IACRN,EAAGO,KAAKN,EAAIrtC,EAAQpP,EAAQo9C,EAAY,KAAM,CAAC5nD,EAAKmnD,KACnD,GAAInnD,EACH,OAAOwH,EAAIxH,EAAK,MAGjB,GAAkB,IAAdmnD,EACH,OAAO3/C,EAAI,KAAM,MAGlBgD,GAAU28C,EAEV,MAAMW,EAAeluC,EAAO7a,QAAQ4oD,GACpC,OAAIG,GAAgB,EACZtgD,EAAI,KAAMoS,EAAO9d,SAAS,QAAQuwC,OAAO,EAAGyb,IAGhDt9C,GAAUq9C,EACNrgD,EAAI,IAAI9R,wBAAwBiyD,cAA2BE,cAA+Bx/B,KAAS,MAGpGi/B,MA1CT,GAAItnD,EACH,OAAOoD,EAAOpD,GAiBf,MAAM4Z,EAAS4tC,OAAOC,YAAYI,GAClC,IAAIr9C,EAAS,EA2Bb88C,qFCKH,SAAgBS,EAAaC,GAC5B,OAAOC,EAAMF,aAAaG,EAAeF,IAO1C,SAASE,EAAeC;AACvB,OAAIA,IAAQ7yD,EAAA8yD,eAAyB,OAARD,EACrB7yD,EAAA+yD,KAGDF,EAGR,SAAgBG,EAA8B1uC,EAAuButC,GACpE,IAAKvtC,GAAUutC,EAAY,EAC1B,OAAO,KAGR,MAAMoB,EAAK3uC,EAAO4uC,UAAU,GACtBC,EAAK7uC,EAAO4uC,UAAU,GAG5B,GAAW,MAAPD,GAAsB,MAAPE,EAClB,OAAOnzD,EAAAozD,QAIR,GAAW,MAAPH,GAAsB,MAAPE,EAClB,OAAOnzD,EAAAqzD,QAGR,GAAIxB,EAAY,EACf,OAAO,KAGR,MAAMyB,EAAKhvC,EAAO4uC,UAAU,GAG5B,OAAW,MAAPD,GAAsB,MAAPE,GAAsB,MAAPG,EAC1BtzD,EAAA+yD,KAGD,KAiBR,SAAgBQ,EAAsBjvC,GACrC,OAAO,IAAA1W,QAAA,CAAA4lD,EAAAC,KAAArC,GAAO,aAAWoC,EAAAC,KAAEtlD,KAAKulD,IAC/BA,EAAUC,UAAUC,kBAAoBA,EAExC,MAAMC,EAAUH,EAAUI,OAAOxvC,GACjC,IAAKuvC,IAAYA,EAAQnB,SACxB,OAAO,KAGR,MAAMG,EAAMgB,EAAQnB,SAAS70C,cAI7B,OAAI,GAAKk2C,EAAiBtqD,QAAQopD,GAC1B,KAGDmB,EAAoBH,EAAQnB,YASrC,SAASsB,EAAoBC,GAC5B,MAAMC,EAAyBD,EAAav6C,QAAQ,gBAAiB,IAAImE,cAGzE,OAFes2C,EAA6BD,IAE3BA,EAmDlB,SAAgBE,GAAyB9vC,OAAEA,EAAMutC,UAAEA,GAAgCwC,GAGlF,IAAI3B,EAAWM,EAA8B1uC,EAAQutC,GAIjDyC,GAAc,EAClB,GAAI5B,IAAa1yD,EAAAozD,SAAWV,IAAa1yD,EAAAqzD,SAAW/uC,EAAQ,CAC3D,IAAIiwC,GAAiB,EACjBC,GAAiB,EACjBC,GAAmB,EAQvB,IAAK,IAAI92D,EAAI,EAAGA,EAAIk0D,GAAal0D,EAAI+2D,EAAoC/2D,IAAK,CAC7E,MAAMg3D,EAAYh3D,EAAI,GAAM,EACtBi3D,EAAqC,IAAvBtwC,EAAOuwC,SAASl3D,GAiBpC,GAfIi3D,IACHH,GAAmB,GAIhBF,IAAmBI,IAAaC,IAAeD,GAAYC,KAC9DL,GAAiB,GAIdC,IAAmBG,GAAYC,IAAeD,IAAaC,KAC9DJ,GAAiB,GAIdI,IAAeL,IAAmBC,EACrC,MAKEC,IACCF,EACH7B,EAAW1yD,EAAAqzD,QACDmB,EACV9B,EAAW1yD,EAAAozD,QAEXkB,GAAc,GAMjB,OAAID,IAAsBC,IAAgB5B,GAAYpuC,EAC9CivC,EAAsBjvC,EAAOhlB,MAAM,EAAGuyD,IAAY1jD,KAAK2mD,KAE5DR,aAAa,EACb5B,SAAUoC,MAKJR,YAAAA,EAAa5B,SAAAA;iDApUV1yD,EAAA+yD,KAAO,OACP/yD,EAAA8yD,cAAgB,UAChB9yD,EAAAozD,QAAU,UACVpzD,EAAAqzD,QAAU,UAQvBrzD,EAAA+0D,eAAA,SAA+BC,EAAoBx/C,GASlD,OARKA,EAAQy/C,+BACZz/C,EAAQy/C,6BAA+Bz/C,EAAQ0/C,cAAgBC,EAA4BC,GAGvF5/C,EAAQ6/C,oBACZ7/C,EAAQ6/C,kBAAoBC,CAAAA,GAAYA,GAAYt1D,EAAA+yD,OAG9C,IAAInlD,QAA8E,CAACC,EAASC,KAElGknD,EAAS/vC,GAAG,QAASnX,GAErBknD,EAASO,KAAK,kBAAkBC,EAAAC,SAAdv2D,kCAITK,KAAAilB,WACAjlB,KAAAm2D,eAAiB,EAEzBx2D,OAAOy2D,EAAYjD,EAAkB1xD,GAC/BkxD,OAAO0D,SAASD,IACpB30D,EAAS,IAAIZ,MAAM,0BAGhBb,KAAKs2D,cAERt2D,KAAKs2D,cAAcC,MAAMH,EAAO30D,IAIjCzB,KAAKilB,QAAQplB,KAAKu2D,GAClBp2D,KAAKm2D,gBAAkBC,EAAM93D,OAEzB0B,KAAKw2D,0BAERx2D,KAAKw2D,0BAA0B5nD,KAAKkW,GAAKrjB,IAAY0J,GAAO1J,EAAS0J,IAEX,iBAAzC8K,EAAQy/C,8BAA6C11D,KAAKm2D,gBAAkBlgD,EAAQy/C,6BAErG11D,KAAKy2D,mBAAmBh1D,GAIxBA,KAIF9B,mBAAmB8B,GAElBzB,KAAKw2D,0BAA4BnoD,QAAQC,QAAQumD,GAChD9vC,OAAQ4tC,OAAO1iD,OAAOjQ,KAAKilB,SAAUqtC,UAAWtyD,KAAKm2D,gBACnDlgD,EAAQ0/C,gBAAgB/mD,KAAKmnD;AAC3B9/C,EAAQ6/C,oBACXC,EAAS5C,SAAWl9C,EAAQ6/C,kBAAkBC,EAAS5C,WAExDnzD,KAAKs2D,cAAgBpD,EAAa6C,EAAS5C,UAC3C,IAAK,MAAMpuC,KAAU/kB,KAAKilB,QACzBjlB,KAAKs2D,cAAcC,MAAMxxC,GAE1BtjB,IACA6M,GAAUynD,SAAAA,EAAUW,OAAQ12D,KAAKs2D,iBAE/BnrD,IACFnL,KAAKoK,KAAK,QAASe,GACnB1J,EAAS0J,KAGXxL,OAAO8B,GACFzB,KAAKs2D,cAERt2D,KAAKs2D,cAAc3jD,IAAIlR,GAGvBzB,KAAKy2D,mBAAmB,IAAMz2D,KAAKs2D,cAAc3jD,IAAIlR,UAO1DhB,EAAAk2D,UAAA,SAA0BxD,GACzB,OAAQA,GACP,KAAK1yD,EAAA+yD,KACJ,OAAO,EACR,KAAK/yD,EAAAozD,QACL,KAAKpzD,EAAAqzD,QACJ,OAAO,EAGT,OAAO,GAGRrzD,EAAAm2D,OAAA,SAAuB7xC,EAAgBouC,GACtC,OAAOC,EAAMwD,OAAO7xC,EAAQsuC,EAAeF,KAG5C1yD,EAAAo2D,OAAA,SAAuBz7C,EAA0B+3C,EAAkBl9C,GAClE,OAAOm9C,EAAMyD,OAAOz7C,EAASi4C,EAAeF,GAAWl9C,IAGxDxV,EAAAq2D,eAAA,SAA+B3D,GAC9B,OAAOC,EAAM0D,eAAezD,EAAeF,KAG5C1yD,EAAAyyD,aAAAA,EAIAzyD,EAAAs2D,aAAA,SAA6B5D,EAAkBl9C,GAC9C,OAAOm9C,EAAM2D,aAAa1D,EAAeF,GAAWl9C,IAWrDxV,EAAAgzD,8BAAAA,EAoCAhzD,EAAAu2D,oBAAA,SAAoCxjC,GACnC,OAAOkjC,EAAOzE,kBAAkBz+B,EAAM,GAAG5kB,KAAK,EAAGmW,OAAAA,EAAQutC,UAAAA,KAAgBmB,EAA8B1uC,EAAQutC,KAGhH,MAAM+B,EAAoB,GACpBG,GAAoB,QAAS,QAAS,SAAU,UAKtD/zD,EAAAuzD,sBAAAA,EAqBA,MAAMY,GACLqC,OAAU,QACVC,KAAQ,SAeTz2D,EAAA02D,gBAAA,SAAgC7D,GAC/B,OAAQA,GACP,IAAK,WACJ,MAAO;CACR,IAAK,UACJ,MAAO,WACR,IAAK,UACJ,MAAO,WACR,IAAK,YACJ,MAAO,aACR,IAAK,QACJ,MAAO,SACR,IAAK,QACJ,MAAO,SACR,IAAK,QACJ,MAAO,SACR,IAAK,QACJ,MAAO,SACR,IAAK,WACJ,MAAO,cACR,IAAK,UACJ,MAAO,OACR,QACC,MAAMvvD,EAAIuvD,EAAI7qB,MAAM,gBACpB,OAAI1kC,EACI,WAAaA,EAAE,GAGhBuvD,IAIV,MAAM6B,EAAqC,IACrCU,EAA0B,IAC1BD,EAA4B,KASlCn1D,EAAAo0D,yBAAAA,EAqEA,MAAMuC,GACLC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,IAAO,QACPC,KAAQ,UAGTx3D,EAAAy3D,wBAAA,SAAwCC,GACvC,IAAIC,EAGJ,MAAMC,EAAiBjkC,QAAQK,IAAyB,oBA0CxD,OAzCI4jC,GACCF,GACH9vD,QAAQiwD,2CAA2CD,KAGpDD,EAAqB/pD,QAAQC,QAAQ+pD,IAKrCD,EADQpqB,EAAA5Y,SAAW4Y,EAAA7Y,YACE,IAAI9mB,QAAgBC,IACpC6pD,GACH9vD,QAAQiwD,IAAI,2DAGbC,EAAA7vB,KAAK,iBAAkB,CAACv9B,EAAKqtD,EAAQC,IAAWnqD,EAAQkqD,MAMpC,IAAInqD,QAAgBC,IACpC6pD,GACH9vD,QAAQiwD,IAAI,iDAGbC,EAAA7vB,KAAK,OAAQ,CAACv9B,EAAKqtD,EAAQC,KAC1B,GAAID,EAAQ,CACX,MAAME,EAA8B33D,OAAO4nC,KAAKyuB;CAChD,IAAK,MAAMj2D,KAAOu3D,EACjB,GAAIF,EAAOtuD,QAAQ/I,IAAQ,EAC1B,OAAOmN,EAAQ8oD,EAAyBj2D,IAK3C,OAAOmN,OAAQlF,OAKXgvD,EAAmBxpD,KAAK+pD,IAK9B,GAJIR,GACH9vD,QAAQiwD,uCAAuCK,MAG3CA,GAA6C,UAA9BA,EAAYr6C,eAA6Bq6C,EAAYr6C,gBAAkB7d,EAAA+yD,KAC1F,OAAO/yD,EAAA+yD,KAGR,MAAMoF,EAAgBnE,EAAoBkE,GAC1C,OAAIvF,EAAM0D,eAAe8B,GACjBA,GAGJT,GACH9vD,QAAQiwD,IAAI,yDAGN73D,EAAA+yD,0GChZT,SAAgBqF,EAAYxjD,GAG3B,OAAIkf,EAASY,YACLg9B,EAAG0G,YAAYxjD,GAAM3D,IAAIzN,GAAK60D,EAAAxO,aAAarmD,IAG5CkuD,EAAG0G,YAAYxjD,GAGvB,SAAgB0jD,EAAQ1jD,EAAc5T,GAGrC,OAAI8yB,EAASY,YACLg9B,EAAG4G,QAAQ1jD,EAAM,CAAC7L,EAAO4L,IAC3B5L,EACI/H,EAAS+H,MAGV/H,EAAS,KAAM2T,EAAS1D,IAAIzN,GAAK60D,EAAAxO,aAAarmD,MAIhDkuD,EAAG4G,QAAQ1jD,EAAM5T,GAwBzB,SAAgBu3D,EAAK3rC,EAAgBtrB,EAAgBN,EAAyCw3D,GAC7F,MAAMC,EAAgBD,GAAoCl4D,OAAOc,OAAO,MAExEswD,EAAGgH,KAAK9rC,EAAQ,CAAC7jB,EAAO2vD,KACvB,GAAI3vD,EACH,OAAO/H,EAAS+H,GAGjB,IAAK2vD,EAAKC,cACT,OAqBH,SAAoB/rC,EAAgBtrB,EAAgBs3D,EAAc53D,GACjE,MAAM63D,EAASnH,EAAGoH,iBAAiBlsC,GAC7BmsC,EAASrH,EAAGsH,kBAAkB13D,GAAUs3D,KAAAA,IAE9C,IAAIK,GAAW,EACf,MAAMC,EAAUnwD,IACVkwD,IACJA,GAAW,EAGPlwD,EACH/H,EAAS+H,GAKT2oD,EAAGyH,MAAM73D,EAAQs3D,EAAM53D,KAM1B63D,EAAO3nD,KAAK,QAASnI,GAASmwD,EAAOnwD,IACrCgwD,EAAO7nD,KAAK,QAASnI,GAASmwD,EAAOnwD,IAGrCgwD,EAAO7nD,KAAK,QAAS,IAAMgoD,KAG3BL,EAAOtD,KAAKwD,GAlDHK,CAAWxsC,EAAQtrB,EAAoB,IAAZo3D,EAAKE,KAAY53D,GAGpD,GAAIy3D,EAAc7rC,GACjB,OAAO5rB,EAAS;CAGjBy3D,EAAc7rC,IAAU,EAExB,MAAMysC,EAAU,WACff,EAAQ1rC,EAAQ,CAACliB,EAAK4uD,KACrB/pC,EAAK+pC,EAAO,CAACvmC,EAAckwB,KAC1BsV,EAAK3oB,EAAMj2B,KAAKiT,EAAQmG,GAAO6c,EAAMj2B,KAAKrY,EAAQyxB,GAAQhqB,GAAiBk6C,EAAIl6C,MAAY0vD,IACzFz3D,MAILu4D,EAAOj4D,EAAoB,IAAZo3D,EAAKE,MAAYzqD,KAAKkrD,EAASA,KAoChD,SAAgBE,EAAO3kD,EAAcgkD,EAAejrD,GACnD,MAAM6rD,EAAQ,IACN/4B,EAAAlP,OAAOmgC,EAAG8H,MAAO5kD,EAAMgkD,GAAMzqD,UAAKxF,EAAY8wD,GAG9B,WAAlBA,EAASpmD,KACLzF,QAAQE,OAAO2rD,GAKhBh5B,EAAAlP,OAAOmgC,EAAGgH,KAAM9jD,GAAMzG,KAAMuqD,GAC7BA,EAAKC,cAIH,KAHC/qD,QAAQE,OAAO,IAAI1N,UAAUwU,sCAInC8kD,GACK9rD,QAAQE,OAAO2rD,KAMzB,OAAI7kD,IAASg7B,EAAM8B,QAAQ98B,GACnBhH,QAAQC,SAAQ,GAIjB2rD,IAAQrrD,UAAKxF,EAAY+B,GAG3BiD,GAASA,EAAMM,wBACXL,QAAQC,SAAQ,GAKP,WAAbnD,EAAI2I,KACAkmD,EAAO3pB,EAAM8B,QAAQ98B,GAAOgkD,GAAMzqD,KAAKqrD,GAIxC5rD,QAAQE,OAAOpD,IAiDxB,SAASivD,EAAY/kD,EAAc5T,GAClC,GAAI4T,IAASg7B,EAAMR,MAAMh3B,KAAOxD,IAASg7B,EAAM0B,MAAMl5B,IACpD,OAAOpX,EAAS,IAAIZ,MAAM,0BAG3BsxD,EAAGkI,OAAOhlD,EAAMglD,IACVA,EAGJlI,EAAGmI,MAAMjlD,EAAM,CAAClK,EAAKguD,KACpB,GAAIhuD,IAAQguD,EACX13D,EAAS0J,QACH,IAAKguD,EAAKC,eAAiBD,EAAKoB,iBAAuE,CAC7G,MAAMlB,EAAOF,EAAKE,KACL,IAAPA,EASLlH,EAAGqI,OAAOnlD,EAAM5T,GARhB0wD,EAAGyH,MAAMvkD,EAAa,IAAPgkD,EAAaluD,IACvBA,EACH1J,EAAS0J,GAETgnD,EAAGqI,OAAOnlD,EAAM5T,UAOnBs3D,EAAQ1jD,EAAM,CAAClK,EAAKiK,KACnB,GAAIjK,IAAQiK,EACX3T,EAAS0J,QACH,GAAwB,IAApBiK,EAAS9W,OACnB6zD,EAAGsI,MAAMplD,EAAM5T,OACT,CACN,IAAIi5D,EAA2B,KAC3BC,EAAevlD,EAAS9W,OAC5B8W,EAAS5T,QAAQ45B,IAChBg/B,EAAY/pB,EAAMj2B,KAAK/E,EAAM+lB,GAASjwB,IACrCwvD,IACIxvD,IACHuvD,EAAaA,GAAcvvD,GAGP,IAAjBwvD,IACCD,EACHj5D,EAASi5D,GAETvI,EAAGsI,MAAMplD,EAAM5T,aAtCvBA,EAAS,QAmDZ,SAAgBm5D,EAAQvlD;AACvB,GAAIA,IAASg7B,EAAMR,MAAMh3B,KAAOxD,IAASg7B,EAAM0B,MAAMl5B,IACpD,MAAM,IAAIhY,MAAM,yBAGjB,IACC,MAAMs4D,EAAOhH,EAAG0I,UAAUxlD,GACtB8jD,EAAKC,gBAAkBD,EAAKoB,kBAC/B1B,EAAYxjD,GAAM7T,QAAQ45B,GAASw/B,EAAQvqB,EAAMj2B,KAAK/E,EAAM+lB,KAC5D+2B,EAAG2I,UAAUzlD,IAEb88C,EAAG4I,WAAW1lD,GAEd,MAAOlK,GACR,GAAiB,WAAbA,EAAI2I,KACP,OAGD,MAAM3I,GA6ER,SAAgB6vD,EAAkB3lD,EAAc1T,EAA+CsU,EAA4BxU,GAC1HwU,EAAUglD,EAAchlD,GAEJ,iBAATtU,GAAqBgxD,OAAO0D,SAAS10D,GAmHjD,SAA6B0T,EAAc1T,EAAuBsU,EAA4BxU,GACzFwU,EAAQk9C,WACXxxD,EAAOu5D,EAAArE,OAAOl1D,EAAMsU,EAAQk9C,SAASgI,SAAWC,OAAQnlD,EAAQk9C,SAASiI,UAG1E,IAAKC,EACJ,OAAOlJ,EAAGmJ,UAAUjmD,EAAM1T,GAAQ03D,KAAMpjD,EAAQojD,KAAMkC,KAAMtlD,EAAQslD,MAAQ95D,GAI7E0wD,EAAGpoB,KAAK10B,EAA8B,iBAAjBY,EAAQslD,KAAoBtlD,EAAQslD,KAAO,IAAKtlD,EAAQojD,KAAM,CAACmC,EAAWpJ,KAC9F,GAAIoJ,EACH,OAAO/5D,EAAS+5D,GAIjBrJ,EAAGmJ,UAA2BjmD,EAAM1T,EAAM85D,IACzC,GAAIA,EACH,OAAOtJ,EAAGI,MAAMH,EAAI,IAAM3wD,EAASg6D,IAIpCtJ,EAAGuJ,UAAUtJ,EAAKuJ,IAIbA,IACHtzD,QAAQC,KAAK,8EAA+EqzD,GAC5FN,GAAW,GAGLlJ,EAAGI,MAAMH,EAAII,GAAc/wD,EAAS+wD,UAjJ7CoJ,CAAoBvmD,EAAM1T,EAAMsU,EAASxU,GAM3C,SAAmC4T,EAAcikD,EAA+BrjD,EAA4BxU,GAC3G,GAAI2yB,QAAQK,IAAIonC,UAAW,CAC1B,IAAIzgD,EAAU,GACVg7C,EAAQkD,EAAO5G,OACnB,KAAiB,OAAV0D,GACNh7C,GAAWg7C,EACXA,EAAQkD,EAAO5G,OAWhB,YATAP,EAAGmJ,UAAUjmD,EAAM+F,EAAS,QAAS,SAAU5R,GAC1CA,EACH/H,EAAS+H,GAIT/H,MAMH,IAAIi4D,GAAW,EACf,MAAMC,EAAUnwD,IACVkwD,IACJA,GAAW,EAIPlwD,EACCsyD,GACHtC,EAAO7nD,KAAK,QAAS,IAAMlQ,EAAS+H,IACpCgwD,EAAOuC,WAEPt6D,EAAS+H,GAMV/H,MAOG+3D,EAASrH,EAAGsH,kBAAkBpkD;AAAQgkD,KAAMpjD,EAAQojD,KAAM2C,MAAO/lD,EAAQslD,KAAMU,WAAW,IAKhG,IAAI7J,EACA0J,EACJtC,EAAO7nD,KAAK,OAAQ3J,IACnBoqD,EAAKpqD,EACL8zD,GAAS,EAIL7lD,EAAQk9C,WACXmG,EAASA,EAAOtD,KAAKkF,EAAAnE,aAAa9gD,EAAQk9C,SAASgI,SAAWC,OAAQnlD,EAAQk9C,SAASiI,WAMxF9B,EAAOtD,KAAKwD,KAKbF,EAAO3nD,KAAK,QAASnI,GAASmwD,EAAOnwD,IACrCgwD,EAAO7nD,KAAK,QAASnI,GAASmwD,EAAOnwD,IAMrCgwD,EAAO7nD,KAAK,SAAU,KAGjB0pD,GAAYS,EACf3J,EAAGuJ,UAAUtJ,EAAKuJ,IAIbA,IACHtzD,QAAQC,KAAK,8EAA+EqzD,GAC5FN,GAAW,GAGZ7B,EAAOuC,YAGRvC,EAAOuC,YAOTvC,EAAO7nD,KAAK,QAAS,IAAMgoD,KAxG1BuC,CAA0B7mD,EAAM1T,EAAMsU,EAASxU,GAoLjD,SAASw5D,EAAchlD,GACtB,IAAKA,EACJ,OAASojD,KAAM,IAAOkC,KAAM,KAG7B,MAAMY,GAAsC9C,KAAMpjD,EAAQojD,KAAMkC,KAAMtlD,EAAQslD,KAAMpI,SAAUl9C,EAAQk9C,UAUtG,MARmC,iBAAxBgJ,EAAe9C,OACzB8C,EAAe9C,KAAO,KAGY,iBAAxB8C,EAAeZ,OACzBY,EAAeZ,KAAO,KAGhBY,EAYR,SAAgBC,EAAa/mD,GAC5B,MAAMi6B,EAAMe,EAAM8B,QAAQ98B,GAC1B,GAAIA,IAASi6B,EACZ,OAAOj6B,EAGR,MAAM5L,GAAQ4mC,EAAM+B,SAAS/8B,IAAmDA,GAAMiJ,cACtF,IACC,MACMzE,EADUg/C,EAAYvpB,GACNxgC,OAAO9P,GAAKA,EAAEsf,gBAAkB7U,GACtD,GAAqB,IAAjBoQ,EAAMvb,OAAc,CAEvB,MAAM0wD,EAASoN,EAAa9sB,GAC5B,GAAI0f,EACH,OAAO3e,EAAMj2B,KAAK40C,EAAQn1C,EAAM,SAE3B,GAAIA,EAAMvb,OAAS,EAAG,CAE5B,MAAM+9D,EAAKxiD,EAAM3P,QAAQT,GACzB,GAAI4yD,GAAM,EAAG,CACZ,MAAMrN,EAASoN,EAAa9sB,GAC5B,GAAI0f,EACH,OAAO3e,EAAMj2B,KAAK40C,EAAQn1C,EAAMwiD,MAIlC,MAAO7yD,IAIT,OAAO,KAuCR,SAASmiD,EAAct2C,GACtB,OAAO0wC,EAAQpT,MAAMtC,EAAMK,UAAUr7B,GAAOg7B,EAAMx3B;WA/nBnD,MAAMmX,EAAOssC,EAAKtsC,KAElBvvB,EAAAo4D,YAAAA,EAUAp4D,EAAAs4D,QAAAA,EAqBAt4D,EAAA87D,SAAA,SAAyBlnD,EAAc5T,GACtC0wD,EAAGmI,MAAMjlD,EAAM,CAAC7L,EAAO8wD,KAClB9wD,GAAS8wD,EAAMC,iBAClBpI,EAAGgH,KAAK9jD,EAAM,CAAC7L,EAAO2vD,KACrB,GAAI3vD,EACH,OAAO/H,EAAS+H,EAAO,MAGxB/H,EAAS,MAAQ03D,KAAAA,EAAMoB,eAAgBD,GAASA,EAAMC,qBAGvD94D,EAAS,MAAQ03D,KAAMmB,EAAOC,gBAAgB,OAKjD95D,EAAAu4D,KAAAA,EA8DAv4D,EAAAu5D,OAAAA,EAmDAv5D,EAAA+7D,IAAA,SAAoBnnD,EAAconD,EAAmBh7D,EAAyCuQ,GAC7FmgD,EAAGkI,OAAOhlD,EAAMglD,IACf,IAAKA,EACJ,OAAO54D,EAAS,MAGjB0wD,EAAGgH,KAAK9jD,EAAM,CAAClK,EAAKguD,KACnB,GAAIhuD,IAAQguD,EACX,OAAO13D,EAAS0J,GAKjB,GAA8B,MAA1BkK,EAAKA,EAAK/W,OAAS,IAAcynD,EAAQxR,SAASl/B,EAAM,OAAS0wC,EAAQxR,SAASl/B,EAAM,OAC3F,OAAO+kD,EAAY/kD,EAAM5T,GAG1B,MAAMi7D,EAAarsB,EAAMj2B,KAAKqiD,EAAWE,EAAK5L,gBAC9CoB,EAAGyK,OAAOvnD,EAAMqnD,EAAalzD,IAC5B,GAAIA,EACH,OAAO4wD,EAAY/kD,EAAM5T,GAI1BA,EAAS,MAGT24D,EAAYsC,EAAYlzD,IACnBA,GACHnB,QAAQmB,MAAMA,GAGXwI,GACHA,EAAKxI,YAkEX/I,EAAAm6D,QAAAA,EAsBAn6D,EAAAo8D,GAAA,SAAmBxvC,EAAgBtrB,EAAgBN,GAKlD,SAASq7D,EAAY3xD,GACpB,GAAIA,EACH,OAAO1J,EAAS0J,GAGjBgnD,EAAGgH,KAAKp3D,EAAQ,CAACyH,EAAO2vD,IACnB3vD,EACI/H,EAAS+H,GAGb2vD,EAAKC,cACD33D,EAAS,WAGjB0wD,EAAGpoB,KAAKhoC,EAAQ,IAAK,KAAM,CAACoJ,EAAYinD,KACvC,GAAIjnD,EACH,OAAO1J,EAAS0J,GAGjBgnD,EAAG4K,QAAQ3K,EAAI+G,EAAK6D,MAAO,IAAIp4C,KAASzZ,IACvC,GAAIA,EACH,OAAO1J,EAAS0J,GAGjBgnD,EAAGI,MAAMH,EAAI3wD,QA5BjB,GAAI4rB,IAAWtrB,EACd,OAAON,EAAS,MAkCjB0wD,EAAGyK,OAAOvvC,EAAQtrB,EAASoJ,GACrBA,EAYDA,GAAOkiB,EAAO/O,gBAAkBvc,EAAOuc,eAAsC,UAAdnT,EAAK2I,MAAqBiyC,EAAQxR,SAASlnB,EAAQ,KAC9G2rC,EAAK3rC,EAAQtrB,EAASoJ,IAC5B,GAAIA,EACH,OAAO1J,EAAS0J,GAGjBivD,EAAY/sC,EAAQyvC,KAIfr7D,EAAS0J,GArBR2xD,EAAY,QAkCtB,IAAIzB,GAAW,EACf56D,EAAAu6D,kBAAAA;AA2JAv6D,EAAAw8D,sBAAA,SAAsC5nD,EAAc1T,EAAuBsU,GAO1E,IANAA,EAAUglD,EAAchlD,IAEZk9C,WACXxxD,EAAOu5D,EAAArE,OAAOl1D,EAAMsU,EAAQk9C,SAASgI,SAAWC,OAAQnlD,EAAQk9C,SAASiI,WAGrEC,EACJ,OAAOlJ,EAAG+K,cAAc7nD,EAAM1T,GAAQ03D,KAAMpjD,EAAQojD,KAAMkC,KAAMtlD,EAAQslD,OAIzE,MAAMnJ,EAAKD,EAAGgL,SAAS9nD,EAA8B,iBAAjBY,EAAQslD,KAAoBtlD,EAAQslD,KAAO,IAAKtlD,EAAQojD,MAE5F,IAGClH,EAAG+K,cAAc7nD,EAAM1T,GAGvB,IACCwwD,EAAGiL,cAAchL,GAChB,MAAOuJ,GACRtzD,QAAQC,KAAK,kFAAmFqzD,GAChGN,GAAW,WAGZlJ,EAAGkL,UAAUjL,KA+Bf3xD,EAAA27D,aAAAA,EAiCA37D,EAAA68D,aAAA,SAA6BjoD,GAC5B,IACC,OAAO88C,EAAGmL,aAAajoD,GACtB,MAAO7L,GAOR,MAAMoiD,EAAiBD,EAAct2C,GAGrC,OAFA88C,EAAGoL,WAAW3R,EAAgBuG,EAAGqL,UAAUC,MAEpC7R,IAITnrD,EAAAi9D,SAAA,SAAyBroD,EAAc5T,GACtC,OAAO0wD,EAAGuL,SAASroD,EAAM,CAAC7L,EAAOk0D,KAChC,IAAKl0D,EACJ,OAAO/H,EAAS,KAAMi8D,GAQvB,MAAM9R,EAAiBD,EAAct2C,GAErC,OAAO88C,EAAGwL,OAAO/R,EAAgBuG,EAAGqL,UAAUC,KAAMj0D,GAC5C/H,EAAS+H,EAAOoiD,OAS1BnrD,EAAAm9D,MAAA,SAAsBvoD,EAAcwoD,EAAiDhnD,GACpF,IACC,MAAMinD,EAAU3L,EAAGyL,MAAMvoD,GAkBzB,OAhBAyoD,EAAQp4C,GAAG,SAAU,CAACpQ,EAAMyoD,KAC3B,IAAIvqC,EACAuqC,IACHvqC,EAAOuqC,EAAI92D,WACPstB,EAASY,cAGZ3B,EAAOslC,EAAAxO,aAAa92B,KAItBqqC,EAASvoD,EAAMke,KAGhBsqC,EAAQp4C,GAAG,QAAS,CAAC5R,EAAckQ,IAAmBnN,qBAA2BxB,kBAAqBvB,MAASkQ,OAExGG,EAAApD,aAAa,KACnB+8C,EAAQE,qBACRF,EAAQvL,UAER,MAAO/oD,GACR2oD,EAAGkI,OAAOhlD,EAAMglD;AACXA,GACHxjD,qBAA2BxB,kBAAqB7L,EAAMvC,iBAKzD,OAAOkd,EAAAnD,WAAWI,MAGnB3gB,EAAAw9D,iBAAA,SAAiCr7C,EAAmBmrB,GAiCnD,OA9BIxZ,EAASW,WAAa6wB,EAAQxR,SAAS3xB,EAAW,OACrDA,GAAaytB,EAAMx3B,KAIfw3B,EAAMD,WAAWxtB,KACrBA,EAAYytB,EAAMj2B,KAAK2zB,EAAKnrB,IAI7BA,EAAYytB,EAAMK,UAAU9tB,GAGxB2R,EAASW,WACZtS,EAAYmjC,EAAQpT,MAAM/vB,EAAWytB,EAAMx3B,KAGvCktC,EAAQxR,SAAS3xB,EAAW,OAC/BA,GAAaytB,EAAMx3B,OAIpB+J,EAAYmjC,EAAQpT,MAAM/vB,EAAWytB,EAAMx3B,QAI1C+J,EAAYytB,EAAMx3B,KAIb+J,sFC1sBR,SAAgBm2C,EAAQ1jD,GACvB,OAAO6rB,EAAAlP,OAAOksC,EAAMnF,QAAS1jD,GAa9B,SAAgB8oD,EAAO9oD,GACtB,OAAOilD,EAAMjlD,GAAMzG,KAAKuqD,GACnBA,EAAKC,gBAAkBD,EAAKoB,iBACxBxB,EAAQ1jD,GACbzG,KAAKwG,GAAY/G,QAAQ8Z,IAAI/S,EAAS1D,IAAI0pB,GAAS+iC,EAAOjlB,EAAA9+B,KAAK/E,EAAM+lB,OACrExsB,KAAK,IAAM6rD,EAAMplD,IAEZmlD,EAAOnlD,GAEZlK,IACH,GAAiB,WAAbA,EAAI2I,KAIR,OAAOzF,QAAQE,OAAOpD,KAQxB,SAAgBguD,EAAK9jD,GACpB,OAAO6rB,EAAAlP,OAAOmgC,EAAGgH,KAAM9jD,GAOxB,SAAgBilD,EAAMjlD,GACrB,OAAO6rB,EAAAlP,OAAOmgC,EAAGmI,MAAOjlD,GAazB,SAAgBolD,EAAMplD,GACrB,OAAO6rB,EAAAlP,OAAOmgC,EAAGsI,MAAOplD,GAGzB,SAAgBmlD,EAAOnlD,GACtB,OAAO6rB,EAAAlP,OAAOmgC,EAAGqI,OAAQnlD,GA+B1B,SAAgBimD,EAAUjmD,EAAc1T,EAAWsU,GAGlD,OAYD,SAA8BmoD,GAC7B,IAAIC,EAAiBC,EAAmBF,GACxC,IAAKC,EAAgB,CACpBA,EAAiB,IAAIn9B,EAAAvQ,MACrB2tC,EAAmBF,GAAYC,EAEdj1C,EAAArG,MAAMpR,KAAK0sD,EAAe9tC,WAC3CguC,CAAS,YACDD,EAAmBF,GAC1BC,EAAe79C,YAIjB,OAAO69C,EAzBAG,CAGR,SAAoBnpD,GACnB,IAAI+oD,EAAW/oD,GACXkf,EAASW,WAAaX,EAASY,eAClCipC,EAAWA,EAAS9/C;CAGrB,OAAO8/C,EAXUK,CAAWppD,IAEUkZ,MAAM,IAAM2S,EAAAlP,OAAOksC,EAAMlD,kBAAmB3lD,EAAM1T,EAAMsU,IA0C/F,SAAgByoD,EAAUrpD,GACzB,OAAO8jD,EAAK9jD,GAAMzG,KAAKuqD,GAAQA,EAAKC,cAAe,KAAM,GAoB1D,SAAgBoD,EAAInnD,EAAcspD,GAL5BC,IACJA,EAAUC,EAAGC,UAEPF,IAGP,OAAO19B,EAAAlP,OAAOksC,EAAM1B,IAAKnnD,EAAMspD,oDAjKhCl+D,EAAAs4D,QAAAA,EAIAt4D,EAAA45D,OAAA,SAAuBhlD,GACtB,OAAO,IAAIhH,QAAQpK,GAAKkuD,EAAGkI,OAAOhlD,EAAMpR,KAGzCxD,EAAAm5D,MAAA,SAAsBvkD,EAAcgkD,GACnC,OAAOn4B,EAAAlP,OAAOmgC,EAAGyH,MAAOvkD,EAAMgkD,IAGjB54D,EAAAu5D,OAASkE,EAAMlE,OAE7Bv5D,EAAA09D,OAAAA,EAkBA19D,EAAAi9D,SAAA,SAAyBroD,GACxB,OAAO6rB,EAAAlP,OAAOksC,EAAMR,SAAUroD,IAG/B5U,EAAA04D,KAAAA,EAIA14D,EAAA87D,SAAA,SAAyBlnD,GACxB,OAAO6rB,EAAAlP,OAAOksC,EAAM3B,SAAUlnD,IAG/B5U,EAAA65D,MAAAA,EAIA75D,EAAAm8D,OAAA,SAAuBmC,EAAiBC,GACvC,OAAO99B,EAAAlP,OAAOmgC,EAAGyK,OAAQmC,EAASC,IAGnCv+D,EAAAw+D,kBAAA,SAAkCF,EAAiBC,GAClD,OAAO,IAAI3wD,QAAQC,IAClB6jD,EAAGyK,OAAOmC,EAASC,EAAS,IAAM1wD,QAIpC7N,EAAAg6D,MAAAA,EAIAh6D,EAAA+5D,OAAAA,EAIA/5D,EAAAy+D,QAAA,SAAwBn9D,EAAgBsT,EAAcC,GACrD,OAAO4rB,EAAAlP,OAAamgC,EAAG+M,QAASn9D,EAAQsT,EAAMC,IAG/C7U,EAAA0+D,SAAA,SAAyB9pD,GACxB,OAAO6rB,EAAAlP,OAAemgC,EAAGgN,SAAU9pD,IAGpC5U,EAAA2+D,SAAA,SAAyB/pD,EAAchX,GACtC,OAAO6iC,EAAAlP,OAAOmgC,EAAGiN,SAAU/pD,EAAMhX,IAKlCoC,EAAA4+D,SAAA,SAAyBhqD,EAAc89C,GACtC,OAAOjyB,EAAAlP,OAAOmgC,EAAGkN,SAAUhqD,EAAM89C,IAMlC,MAAMmL,EAAsDv9D,OAAOc,OAAO,MAO1EpB,EAAA66D,UAAAA,EAkCA76D,EAAA6+D,cAAA,SAA8BC;AAC7B,OAAOxG,EAAQwG,GAAS3wD,KAAKwG,GACrB/G,QAAQ8Z,IAAI/S,EAAS1D,IAAIzN,GAAKy6D,EAAUxlB,EAAA9+B,KAAKmlD,EAASt7D,MAAM2K,KAAKyrD,GAChEjlD,EAAStG,OAAO,CAACgW,EAAG1mB,IAAMi8D,EAAOj8D,OAQ3CqC,EAAAi+D,UAAAA,EAOAj+D,EAAA++D,WAAA,SAA2BnqD,GAC1B,OAAO8jD,EAAK9jD,GAAMzG,KAAKuqD,GAAQA,EAAKsG,SAAU,KAAM,IAMrD,IAAIb,EAAyB,KAO7Bn+D,EAAA+7D,IAAAA,EAIA/7D,EAAAi/D,YAAA,SAA4BrqD,GAG3B,OAAO,IAAIhH,QAAcC,IACxB,IAAIqxD,GAAU,EACd,MAAMvuC,EAAWC,YAAY,KACvBsuC,IACJA,GAAU,EACVxN,EAAGkI,OAAOhlD,EAAMglD,IACfsF,GAAU,EAELtF,IACJlpC,cAAcC,GACd9iB,OAAQlF,QAIT,QAIL3I,EAAAu4D,KAAA,SAAqB3rC,EAAgBtrB,GACpC,OAAOm/B,EAAAlP,OAAOksC,EAAMlF,KAAM3rC,EAAQtrB,6ECrCnC,SAAS69D,EAAiBv+D,GACzB,MAAMlD,EAASw0D,OAAOC,YAAY,GAElC,OADAz0D,EAAO0hE,cAAcx+D,EAAM,GACpBlD,EAGR,SAAS2hE,EAAexG,GACvB,OAAOA,EAAO5G,KAAK,GAAGqN,aAAa,GAWpC,SAASC,EAAUxG,EAAiB73D,GACnC,QAAoB,IAATA,EACV63D,EAAOjD,MAAM0J,EAAcC,gBACrB,GAAoB,iBAATv+D,EAAmB,CACpC,MAAMojB,EAAS4tC,OAAOzxD,KAAKS,GAC3B63D,EAAOjD,MAAM0J,EAAc50D,QAC3BmuD,EAAOjD,MAAMqJ,EAAiB76C,EAAOzmB,SACrCk7D,EAAOjD,MAAMxxC,QACP,GAAI4tC,OAAO0D,SAAS10D,GAC1B63D,EAAOjD,MAAM0J,EAActN,QAC3B6G,EAAOjD,MAAMqJ,EAAiBj+D,EAAKrD,SACnCk7D,EAAOjD,MAAM50D,QACP,GAAIyN,MAAMC,QAAQ1N,GAAO,CAC/B63D,EAAOjD,MAAM0J,EAAc7wD,OAC3BoqD,EAAOjD,MAAMqJ,EAAiBj+D,EAAKrD,SAEnC,IAAK,MAAMm7B,KAAM93B,EAChBq+D,EAAUxG,EAAQ//B,OAEb,CACN,MAAM1U,EAAS4tC,OAAOzxD,KAAK2W,KAAKiF,UAAUnb,IAC1C63D,EAAOjD,MAAM0J,EAAcl/D,QAC3By4D,EAAOjD,MAAMqJ,EAAiB76C,EAAOzmB,SACrCk7D,EAAOjD,MAAMxxC,IAIf,SAASo7C,EAAY7G;AAGpB,OAFaA,EAAO5G,KAAK,GAAGiB,UAAU,IAGrC,KAAKyM,EAASF,UAAW,OACzB,KAAKE,EAAS/0D,OAAQ,OAAOiuD,EAAO5G,KAAKoN,EAAexG,IAASryD,WACjE,KAAKm5D,EAASzN,OAAQ,OAAO2G,EAAO5G,KAAKoN,EAAexG,IACxD,KAAK8G,EAAShxD,MAAO,CACpB,MAAM9Q,EAASwhE,EAAexG,GACxBn7D,KAEN,IAAK,IAAIC,EAAI,EAAGA,EAAIE,EAAQF,IAC3BD,EAAO0B,KAAKsgE,EAAY7G,IAGzB,OAAOn7D,EAER,KAAKiiE,EAASr/D,OAAQ,OAAO8W,KAAKC,MAAMwhD,EAAO5G,KAAKoN,EAAexG,IAASryD,aA8c9E,SAAgBo5D,EAAsCv6C,GACrD,OACC1kB,KAAI,CAACuyB,EAAiBtvB,EAAWi8D,IACzBx6C,EAAQlX,KAAK3K,GAAKA,EAAE7C,KAAQuyB,EAAStvB,EAAKi8D,IAGlD3gE,OAAUqjB,EAAe3e,GACxB,MAAMk8D,EAAQ,IAAIn3C,EAAAT,MAElB,OADA7C,EAAQlX,KAAK3K,GAAKs8D,EAAMx3C,MAAQ9kB,EAAEu8D,OAAOx9C,EAAO3e,IACzCk8D,EAAMv9C,0DA5qBhB,SAAkBy9C,GACjBA,EAAAA,EAAA,QAAA,KAAA,UACAA,EAAAA,EAAA,cAAA,KAAA,gBACAA,EAAAA,EAAA,YAAA,KAAA,cACAA,EAAAA,EAAA,aAAA,KAAA,eAJD,CAAkBhgE,EAAAggE,cAAAhgE,EAAAggE,kBAalB,SAAkBC,GACjBA,EAAAA,EAAA,WAAA,KAAA,aACAA,EAAAA,EAAA,eAAA,KAAA,iBACAA,EAAAA,EAAA,aAAA,KAAA,eACAA,EAAAA,EAAA,gBAAA,KAAA,kBACAA,EAAAA,EAAA,UAAA,KAAA,YALD,CAAkBjgE,EAAAigE,eAAAjgE,EAAAigE,kBAwBlB,IAAKC,GAAL,SAAKA,GACJA,EAAAA,EAAA,cAAA,GAAA,gBACAA,EAAAA,EAAA,KAAA,GAAA,OAFD,CAAKA,IAAAA,aAgFCC,EAILjhE,YAAoBolB,GAAA/kB,KAAA+kB,OAAAA,EAFZ/kB,KAAA0T,IAAM,EAId/T,KAAKkhE;AACJ,MAAM1iE,EAAS6B,KAAK+kB,OAAOhlB,MAAMC,KAAK0T,IAAK1T,KAAK0T,IAAMmtD,GAEtD,OADA7gE,KAAK0T,KAAOvV,EAAOG,OACZH,SAIH2iE,EAANnhE,cAESK,KAAA0oB,WAER3D,aACC,OAAO4tC,OAAO1iD,OAAOjQ,KAAK0oB,SAG3B/oB,MAAMolB,GACL/kB,KAAK0oB,QAAQ7oB,KAAKklB,IAIpB,IAAKq7C,GAAL,SAAKA,GACJA,EAAAA,EAAA,UAAA,GAAA,YACAA,EAAAA,EAAA,OAAA,GAAA,SACAA,EAAAA,EAAA,OAAA,GAAA,SACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,OAAA,GAAA,SALD,CAAKA,IAAAA,OAkBL,MAAMH,GACLC,UAAWvN,OAAOoO,MAAM,EAAGX,EAASF,WACpC70D,OAAQsnD,OAAOoO,MAAM,EAAGX,EAAS/0D,QACjCsnD,OAAQA,OAAOoO,MAAM,EAAGX,EAASzN,QACjCvjD,MAAOujD,OAAOoO,MAAM,EAAGX,EAAShxD,OAChCrO,OAAQ4xD,OAAOoO,MAAM,EAAGX,EAASr/D,eAmDrBigE,EAMZrhE,YAAoBf,EAA2CirB,GAA3C7pB,KAAApB,SAAAA,EAA2CoB,KAAA6pB,IAAAA,EAJvD7pB,KAAAihE,SAAW,IAAIv6C,IACf1mB,KAAAkhE,eAAiB,IAAIx6C,IAI5B1mB,KAAKmhE,iBAAmBnhE,KAAKpB,SAASwiE,UAAUxxB,GAAO5vC,KAAKqhE,aAAazxB,IACzE5vC,KAAKshE,cAAehsD,KAAI,MAGzB3V,gBAAgB4hE,EAAqBC,GACpCxhE,KAAKihE,SAASt6C,IAAI46C,EAAaC,GAGxB7hE,aAAa8hE,GACpB,OAAQA,EAASnsD,MAChB,KAAA,IACC,OAAOtV,KAAK0hE,MAAMD,EAASnsD,OAE5B,KAAA,IACA,KAAA,IACA,KAAA,IACA,KAAA,IACC,OAAOtV,KAAK0hE,MAAMD,EAASnsD,KAAMmsD,EAASj8C,IAAKi8C,EAAS9/D,OAInDhC,KAAKgiE,EAAa7pC,GACzB,MAAM0hC,EAAS,IAAIsH,EACnBd,EAAUxG,EAAQmI,GAClB3B,EAAUxG,EAAQ1hC,GAClB93B,KAAK4hE,WAAWpI,EAAOz0C,QAGhBplB,WAAWiB,GAClB,IACCZ,KAAKpB,SAAS8iE,KAAK9gE,GAClB,MAAOuK;AAKFxL,aAAaiB,GACpB,MAAM04D,EAAS,IAAIsH,EAAahgE,GAC1B+gE,EAASxB,EAAY7G,GACrBxhC,EAAOqoC,EAAY7G,GACnBhkD,EAAOqsD,EAAO,GAEpB,OAAQrsD,GACP,KAAA,IACC,OAAOtV,KAAK6hE,WAAYvsD,KAAAA,EAAMkQ,GAAIm8C,EAAO,GAAIJ,YAAaI,EAAO,GAAIl4D,KAAMk4D,EAAO,GAAIt9D,IAAKyzB,IAC5F,KAAA,IACC,OAAO93B,KAAK8hE,eAAgBxsD,KAAAA,EAAMkQ,GAAIm8C,EAAO,GAAIJ,YAAaI,EAAO,GAAIl4D,KAAMk4D,EAAO,GAAIt9D,IAAKyzB,IAChG,KAAA,IAEA,KAAA,IACC,OAAO93B,KAAK+hE,sBAAuBzsD,KAAAA,EAAMkQ,GAAIm8C,EAAO,MAI/ChiE,UAAUqiE,GACjB,MAAMR,EAAUxhE,KAAKihE,SAAS94D,IAAI65D,EAAQT,aAC1C,IAAKC,EACJ,MAAM,IAAI3gE,MAAM,mBAEjB,MAAMohE,EAA0B,IAAI30C,EAAAN,wBACpC,IAAIlH,EAEJ,IACCA,EAAU07C,EAAQpgE,KAAKpB,KAAK6pB,IAAKm4C,EAAQv4D,KAAMu4D,EAAQ39D,IAAK49D,EAAwB7zD,OACnF,MAAOjD,GACR2a,EAAUzX,QAAQE,OAAOpD,GAG1B,MAAMqa,EAAKw8C,EAAQx8C,GAEnBM,EAAQlX,KAAKjN,IACZ3B,KAAKshE,cAA6B97C,GAAAA,EAAI7jB,KAAAA,EAAM2T,KAAI,MAChDtV,KAAKkhE,eAAe3kB,OAAOylB,EAAQx8C,KACjCra,IACEA,aAAetK,MAClBb,KAAKshE,cACJ97C,GAAAA,EAAI7jB,MACHf,QAASuK,EAAIvK,QACb6I,KAAM0B,EAAI1B,KACVK,MAAOqB,EAAIrB,MAASqB,EAAIrB,MAAMsB,MAAQD,EAAIrB,MAAMsB,MAAM,MAAQD,EAAIrB,WAASV,GACzEkM,KAAI,MAGRtV,KAAKshE,cAA6B97C,GAAAA,EAAI7jB,KAAMwJ,EAAKmK,KAAI,MAGtDtV,KAAKkhE,eAAe3kB,OAAOylB,EAAQx8C,MAGpC,MAAM08C,EAAa/9C,EAAApD,aAAa,IAAMkhD,EAAwB/0C,UAC9DltB,KAAKkhE,eAAev6C,IAAIq7C,EAAQx8C,GAAI08C,GAG7BviE,cAAcqiE,GACrB,MAAMR,EAAUxhE,KAAKihE,SAAS94D,IAAI65D,EAAQT,aAC1C,IAAKC,EACJ,MAAM,IAAI3gE,MAAM;CAGjB,MAAM2kB,EAAKw8C,EAAQx8C,GAEb08C,EADQV,EAAQhB,OAAOxgE,KAAK6pB,IAAKm4C,EAAQv4D,KAAMu4D,EAAQ39D,IAC1C2e,CAAMrhB,GAAQ3B,KAAKshE,cAA6B97C,GAAAA,EAAI7jB,KAAAA,EAAM2T,KAAI,OAEjFtV,KAAKkhE,eAAev6C,IAAIq7C,EAAQx8C,GAAI08C,GAG7BviE,qBAAqBqiE,GAC5B,MAAME,EAAaliE,KAAKkhE,eAAe/4D,IAAI65D,EAAQx8C,IAE/C08C,IACHA,EAAW1hD,UACXxgB,KAAKkhE,eAAe3kB,OAAOylB,EAAQx8C,KAI9B7lB,UACFK,KAAKmhE,mBACRnhE,KAAKmhE,iBAAiB3gD,UACtBxgB,KAAKmhE,iBAAmB,MAEzBnhE,KAAKkhE,eAAe1/D,QAAQkf,GAAKA,EAAEF,WACnCxgB,KAAKkhE,eAAe36C,SAhItB9lB,EAAAugE,cAAAA,QAoIamB,EAWZxiE,YAAoBf,GAAAoB,KAAApB,SAAAA,EATZoB,KAAAwnC,MAAem5B,EAAMyB,cACrBpiE,KAAAkhE,eAAiB,IAAIlkB,IACrBh9C,KAAAqiE,SAAW,IAAI37C,IACf1mB,KAAAsiE,cAAwB,EAGxBtiE,KAAAuiE,iBAAmB,IAAIn5C,EAAA3F,QACtBzjB,KAAAwiE,gBAAkBxiE,KAAKuiE,iBAAiBv/C,MAGhDhjB,KAAKmhE,iBAAmBnhE,KAAKpB,SAASwiE,UAAUxxB,GAAO5vC,KAAKyiE,SAAS7yB,IAGtEjwC,WAA+B4hE,GAC9B,MAAMmB,EAAO1iE,KACb,OACCoB,KAAI,CAACuyB,EAAiBtvB,EAAWi8D,IACzBoC,EAAKC,eAAepB,EAAa5tC,EAAStvB,EAAKi8D,GAEvDE,OAAM,CAACx9C,EAAe3e,IACdq+D,EAAKE,aAAarB,EAAav+C,EAAO3e,IAKxC1E,eAAe4hE,EAAqB93D,EAAcpF,EAAWi8D,EAAoBhzC,EAAAb,kBAAkBrL,MAC1G,MAAMoE,EAAKxlB,KAAKsiE,gBAEVN,GAAyBx8C,GAAAA,EAAIlQ,KADzB,IAC+BisD,YAAAA,EAAa93D,KAAAA,EAAMpF,IAAAA,GAE5D,GAAIi8D,EAAkB5xD,wBACrB,OAAOL,QAAQE,OAAO0K,EAAOrO,YAG9B,IAAIs3D;CAqDJ,OAnDe,IAAI7zD,QAAQ,CAACpK,EAAGjF,KAC9B,GAAIshE,EAAkB5xD,wBACrB,OAAO1P,EAAEia,EAAOrO,YAGjB,IAAIi4D,EAAuD3hC,EAAA9T,wBAAwBtI,GAAK9kB,KAAK8iE,mBAC7FD,EAAqBj0D,KAAK,KACzBi0D,EAAuB,KAwBvB7iE,KAAKqiE,SAAS17C,IAAInB,EAtBQi8C,IACzB,OAAQA,EAASnsD,MAChB,KAAA,IACCtV,KAAKqiE,SAAS9lB,OAAO/2B,GACrBvhB,EAAEw9D,EAAS9/D,MACX,MAED,KAAA,IACC3B,KAAKqiE,SAAS9lB,OAAO/2B,GACrB,MAAMhc,EAAQ,IAAI3I,MAAM4gE,EAAS9/D,KAAKf,SAChC4I,EAAOM,MAAQ23D,EAAS9/D,KAAKmI,MACnCN,EAAMC,KAAOg4D,EAAS9/D,KAAK8H,KAC3BzK,EAAEwK,GACF,MAED,KAAA,IACCxJ,KAAKqiE,SAAS9lB,OAAO/2B,GACrBxmB,EAAEyiE,EAAS9/D,SAMd3B,KAAK+iE,YAAYf,KAGlB,MAAM90C,EAAS,KACV21C,GACHA,EAAqB31C,SACrB21C,EAAuB,MAEvB7iE,KAAK+iE,aAAcv9C,GAAAA,EAAIlQ,KAAI,MAG5BtW,EAAEia,EAAOrO,aAGJo4D,EAA4B1C,EAAkBzzC,wBAAwBK,GAC5Eg1C,EAAa/9C,EAAAtD,oBAAoBsD,EAAApD,aAAamM,GAAS81C,IACvDhjE,KAAKkhE,eAAe/iC,IAAI+jC,KAGXz0C,QAAQ,IAAMztB,KAAKkhE,eAAe3kB,OAAO2lB,IAGhDviE,aAAa4hE,EAAqB93D,EAAcpF,GACvD,MAAMmhB,EAAKxlB,KAAKsiE,gBAEVN,GAAyBx8C,GAAAA,EAAIlQ,KADzB,IAC+BisD,YAAAA,EAAa93D,KAAAA,EAAMpF,IAAAA,GAE5D,IAAIw+D,EAAuD,KAE3D,MAAMr/C,EAAU,IAAI4F,EAAA3F,SACnBgC,mBAAoB,MACnBo9C,EAAuB3hC,EAAA9T,wBAAwBtI,GAAK9kB,KAAK8iE,oBACpCl0D,KAAK,KACzBi0D,EAAuB,KACvB7iE,KAAKkhE,eAAe/iC,IAAI3a,GACxBxjB,KAAK+iE,YAAYf,MAGnBr8C,qBAAsB,KACjBk9C,GACHA,EAAqB31C,SACrB21C,EAAuB,OAEvB7iE,KAAKkhE,eAAe3kB,OAAO/4B;AAC3BxjB,KAAK+iE,aAAcv9C,GAAAA,EAAIlQ,KAAI,UAQ9B,OAFAtV,KAAKqiE,SAAS17C,IAAInB,EADS7C,GAA+Ba,EAAQE,KAAKf,EAAIhhB,OAGpE6hB,EAAQR,MAGRrjB,YAAYqiE,GACnB,OAAQA,EAAQ1sD,MACf,KAAA,IACA,KAAA,IACC,OAAOtV,KAAK0hE,MAAMM,EAAQ1sD,KAAM0sD,EAAQx8C,GAAIw8C,EAAQT,YAAaS,EAAQv4D,MAAOu4D,EAAQ39D,KAEzF,KAAA,IACA,KAAA,IACC,OAAOrE,KAAK0hE,MAAMM,EAAQ1sD,KAAM0sD,EAAQx8C,MAInC7lB,KAAKgiE,EAAa7pC,GACzB,MAAM0hC,EAAS,IAAIsH,EACnBd,EAAUxG,EAAQmI,GAClB3B,EAAUxG,EAAQ1hC,GAClB93B,KAAK4hE,WAAWpI,EAAOz0C,QAGhBplB,WAAWiB,GAClB,IACCZ,KAAKpB,SAAS8iE,KAAK9gE,GAClB,MAAOuK,KAKFxL,SAASiB,GAChB,MAAM04D,EAAS,IAAIsH,EAAahgE,GAC1B+gE,EAASxB,EAAY7G,GACrBxhC,EAAOqoC,EAAY7G,GAGzB,OAF2BqI,EAAO,IAGjC,KAAA,IACC,OAAO3hE,KAAKijE,YAAa3tD,KAAMqsD,EAAO,KAEvC,KAAA,IACA,KAAA,IACA,KAAA,IACA,KAAA,IACC,OAAO3hE,KAAKijE,YAAa3tD,KAAMqsD,EAAO,GAAIn8C,GAAIm8C,EAAO,GAAIhgE,KAAMm2B,KAI1Dn4B,WAAW8hE,GAClB,GAAiB,MAAbA,EAASnsD,KAGZ,OAFAtV,KAAKwnC,MAAQm5B,EAAMuC,UACnBljE,KAAKuiE,iBAAiB7+C,OAIvB,MAAMiM,EAAU3vB,KAAKqiE,SAASl6D,IAAIs5D,EAASj8C,IAEvCmK,GACHA,EAAQ8xC,GAIF9hE,kBACP,OAAIK,KAAKwnC,QAAUm5B,EAAMuC,KACjB70D,QAAQC,UAER8a,EAAArG,MAAMgD,UAAU/lB,KAAKwiE,iBAI9B7iE,UACKK,KAAKmhE,mBACRnhE,KAAKmhE,iBAAiB3gD,UACtBxgB,KAAKmhE,iBAAmB,MAEzBnhE,KAAKkhE,eAAe1/D,QAAQ8B,GAAKA,EAAEkd,WACnCxgB,KAAKkhE,eAAe36C,SAtMtB9lB,EAAA0hE,cAAAA,QA2NagB,EAcZxjE,YAAYyjE,GAZJpjE,KAAAihE,SAAW,IAAIv6C;AACf1mB,KAAAqjE,aAAe,IAAIrmB,IAEnBh9C,KAAAsjE,wBAA0B,IAAIl6C,EAAA3F,QAC7BzjB,KAAAujE,uBAAsDvjE,KAAKsjE,wBAAwBtgD,MAS3FogD,EAAmB,EAAGxkE,SAAAA,EAAU4kE,sBAAAA,MACRp6C,EAAArG,MAAMpR,KAAK/S,EAASwiE,UAE3CqC,CAAe7zB,IACd,MACM/lB,EAAMs2C,EADG,IAAIS,EAAahxB,IAG1B8zB,EAAgB,IAAI1C,EAAcpiE,EAAUirB,GAC5C85C,EAAgB,IAAIxB,EAAcvjE,GAExCoB,KAAKihE,SAASz/D,QAAQ,CAACggE,EAAS/3D,IAASi6D,EAAcE,gBAAgBn6D,EAAM+3D,IAE7E,MAAMqC,GAAqCF,cAAAA,EAAe95C,IAAAA,GAC1D7pB,KAAKqjE,aAAallC,IAAI0lC,GACtB7jE,KAAKsjE,wBAAwB5/C,KAAKmgD,GAElCL,EAAsB,KACrBE,EAAcljD,UACdmjD,EAAcnjD,UACdxgB,KAAKqjE,aAAa9mB,OAAOsnB,SA1B7BC,kBACC,MAAM3lE,KAEN,OADA6B,KAAKqjE,aAAa7hE,QAAQqoB,GAAO1rB,EAAO0B,KAAKgqB,IACtC1rB,EA6BRwB,WAA+B4hE,EAAqBwC,GACnD,MAAMrB,EAAO1iE,KAEb,OACCoB,KAAI,CAACuyB,EAAiBtvB,EAAWi8D,IAIzBD,EAHgB0D,EAAOC,UAAUtB,EAAM/uC,EAAStvB,GACrDuK,KAAKi1D,GAAeA,EAAoCF,cAAcM,WAAW1C,KAGjFngE,KAAKuyB,EAAStvB,EAAKi8D,GAEtBE,OAAM,CAACx9C,EAAe3e,IAIdg8D,EAHgB0D,EAAOG,WAAWxB,EAAM1/C,EAAO3e,GACpDuK,KAAKi1D,GAAeA,EAAoCF,cAAcM,WAAW1C,KAGjFf,OAAOx9C,EAAO3e,IAKnB1E,gBAAgB4hE,EAAqBC,GACpCxhE,KAAKihE,SAASt6C,IAAI46C,EAAaC,GAGhC7hE,UACCK,KAAKihE,SAAS16C,QACdvmB,KAAKqjE,aAAa98C,QAClBvmB,KAAKsjE,wBAAwB9iD,WApE/B/f,EAAA0iE,UAAAA,QA+EagB,EAKZxkE,YAAYf,EAAmCirB,GAC9C,MAAM2vC,EAAS,IAAIsH,EACnBd,EAAUxG,EAAQ3vC,GAClBjrB,EAAS8iE,KAAKlI,EAAOz0C,QAErB/kB,KAAK2jE,cAAgB,IAAIxB,EAAcvjE;AACvCoB,KAAK0jE,cAAgB,IAAI1C,EAAcpiE,EAAUirB,GAGlDlqB,WAA+B4hE,GAC9B,OAAOvhE,KAAK2jE,cAAcM,WAAW1C,GAGtC5hE,gBAAgB4hE,EAAqBC,GACpCxhE,KAAK0jE,cAAcE,gBAAgBrC,EAAaC,GAGjD7hE,UACCK,KAAK2jE,cAAcnjD,UACnBxgB,KAAK0jE,cAAcljD,WAxBrB/f,EAAA0jE,UAAAA,EA4BA1jE,EAAA4/D,kBAAAA,EAcA5/D,EAAA2jE,mBAAA,SAAuD5C,GACtD,IAAI6C,GAAU,EAEd,OACCjjE,KAAI,CAAIuyB,EAAiBtvB,EAAWi8D,IAC/B+D,EACI7C,EAAQpgE,KAAKuyB,EAAStvB,EAAKi8D,GAG5Bp/B,EAAAxT,QAAQ,GACb9e,KAAK,IAAMy1D,GAAU,GACrBz1D,KAAK,IAAM4yD,EAAQpgE,KAAQuyB,EAAStvB,EAAKi8D,IAE5C3gE,OAAUqjB,EAAe3e,GACxB,GAAIggE,EACH,OAAO7C,EAAQhB,OAAUx9C,EAAO3e,GAGjC,MAAMk8D,EAAQ,IAAIn3C,EAAAT,MAMlB,OAJAuY,EAAAxT,QAAQ,GACN9e,KAAK,IAAMy1D,GAAU,GACrBz1D,KAAK,IAAM2xD,EAAMx3C,MAAQy4C,EAAQhB,OAAUx9C,EAAO3e,IAE7Ck8D,EAAMv9C,eAKHshD,EAEZ3kE,YAAoBuI,GAAAlI,KAAAkI,GAAAA,EAEpBvI,UAAU4kE,GACT,OAAOvkE,KAAKwkE,MAAMD,GAGnB5kE,WAAW4kE,GACV,OAAOvkE,KAAKwkE,MAAMD,GAGL5kE,MAAM4kE,2CACnB,IAAK,MAAMV,KAAcU,EAAIT,YAC5B,SAAUz1D,QAAQC,QAAQtO,KAAKkI,GAAG27D,EAAWh6C,MAC5C,OAAOxb,QAAQC,QAAQu1D,GAKzB,aADMz6C,EAAArG,MAAMgD,UAAUw+C,EAAIhB,8BACbvjE,KAAKwkE,MAAMD,MApB1B9jE,EAAA6jE,aAAAA,4GC7sBaG,EAEZ9kE,YAAoB+kE,EAAyBtD,GAAzBphE,KAAA0kE,OAAAA,EAAyB1kE,KAAAohE,UAAAA;AAE7CzhE,KAAKiB,GACJ,IACCZ,KAAK0kE,OAAOhD,KAAK,cAAe9gE,GAC/B,MAAO5B,KAKVW,UACCK,KAAK0kE,OAAOhD,KAAK,iBAAkB,OAbrCjhE,EAAAgkE,SAAAA,+HCDaE,UAAeC,EAAAT,UAInBxkE,wBACP,MAAMyhE,EAAYh4C,EAAArG,MAAMuC,qBAA6Bu/C,EAAAC,YAAa,cAAe,CAAChgD,EAAGlkB,IAAoBA,GAEzG,OADAikE,EAAAC,YAAYpD,KAAK,aACV,IAAIqD,EAAAN,SAASI,EAAAC,YAAa1D,GAGlCzhE,YAAY6lB,GACX,MAAM5mB,EAAW+lE,EAAOK,iBACxBlyD,MAAMlU,EAAU4mB,GAChBxlB,KAAKpB,SAAWA,EAGjBe,UACCK,KAAKpB,SAAS4hB,WAjBhB/f,EAAAkkE,OAAAA,iFCoTA,SAASM,EAAuB53C,GAC/B,IAAI7J,EACA6E,GAAe,EACf68C,GAAuB,EACvBC,KAEJ,MAAMC,EAAkB,KACvB,IAAIF,EAAJ,CAIA,IADAA,GAAuB,EAChB78C,GAAgB88C,EAAiB7mE,OAAS,GAChDklB,EAAQE,KAAKyhD,EAAiBr9C,SAE/Bo9C,GAAuB,IAqBxB,OAlBA73C,EAAQruB,IACPmmE,EAAiBtlE,KAAKb,GACtBomE,OAGD5hD,EAAU,IAAI4F,EAAA3F,SACbgC,mBAAoB,KACnB4C,GAAe,EAIf+L,QAAQpP,SAASogD,IAElBz/C,qBAAsB,KACrB0C,GAAe,MAIFrF,uDArVhBviB,EAAA4kE,uBAAA,WACC,MAAMC,EAAeC,EAAAxU;CACrB,MAAyB,UAArB38B,QAAQG,oCACuB+wC,SAG3BpsB,EAAA9+B,KAAKorD,EAAA1G,uBAAwBwG,iBAIhCG,EAKLC,iBACC,OAAO1lE,KAAK2lE,aAGbhmE,cACCK,KAAK4lE,WACL5lE,KAAK2lE,aAAe,EAGdhmE,YAAYkmE,GAClB7lE,KAAK4lE,QAAQ/lE,KAAKgmE,GAClB7lE,KAAK2lE,cAAgBE,EAAKH,WAGpB/lE,eAEN,OADUK,KAAK0yD,KAAK,GACTqN,aAAa,GAGlBpgE,KAAKmmE,GACX,GAAkB,IAAdA,EACH,OAAOnT,OAAOC,YAAY,GAG3B,GAAIkT,EAAY9lE,KAAK2lE,aACpB,MAAM,IAAI9kE,MAAM,8BAGjB,GAAIb,KAAK4lE,QAAQ,GAAGF,aAAeI,EAAW,CAE7C,MAAM3nE,EAAS6B,KAAK4lE,QAAQ99C,QAE5B,OADA9nB,KAAK2lE,cAAgBG,EACd3nE,EAGR,GAAI6B,KAAK4lE,QAAQ,GAAGF,WAAaI,EAAW,CAE3C,MAAM3nE,EAAS6B,KAAK4lE,QAAQ,GAAG7lE,MAAM,EAAG+lE,GAGxC,OAFA9lE,KAAK4lE,QAAQ,GAAK5lE,KAAK4lE,QAAQ,GAAG7lE,MAAM+lE,GACxC9lE,KAAK2lE,cAAgBG,EACd3nE,EAGR,IAAIA,EAASw0D,OAAOC,YAAYkT,GAC5BC,EAAe,EACnB,KAAOD,EAAY,GAAG,CACrB,MAAM1P,EAAQp2D,KAAK4lE,QAAQ,GACvBxP,EAAMsP,WAAaI,GAEtB9lE,KAAK4lE,QAAQ,GAAKxP,EAAMr2D,MAAM+lE,GAE9B1P,EAAM4C,KAAK76D,EAAQ4nE,EAAc,EAAGD,GACpCC,GAAgBD,EAChB9lE,KAAK2lE,cAAgBG,EACrBA,GAAaA,IAGb9lE,KAAK4lE,QAAQ99C,QAEbsuC,EAAM4C,KAAK76D,EAAQ4nE,EAAc,EAAG3P,EAAMsP,YAC1CK,GAAgB3P,EAAMsP,WACtB1lE,KAAK2lE,cAAgBvP,EAAMsP,WAC3BI,GAAa1P,EAAMsP,YAGrB,OAAOvnE,SAYIsmE,EAiBZ9kE,YAAoBqmE,GAAAhmE,KAAAgmE,QAAAA;AANZhmE,KAAAimE,WAAa,IAAI78C,EAAA3F,QAChBzjB,KAAAohE,UAA2BphE,KAAKimE,WAAWjjD,MAE5ChjB,KAAAkmE,SAAW,IAAI98C,EAAA3F,QACdzjB,KAAAmmE,QAAuBnmE,KAAKkmE,SAASljD,MAqFtChjB,KAAAomE,aAAe,UAAIzmE,cAElBK,KAAAqmE,SACArmE,KAAA2lE,aAAe,EAEvBhmE,IAAI2mE,EAAcxuC,GACjB,MAAMyuC,EAAiC,IAAtBvmE,KAAK2lE,aAGtB,OAFA3lE,KAAKqmE,MAAMxmE,KAAKymE,EAAMxuC,GACtB93B,KAAK2lE,cAAgBW,EAAKhoE,OAASw5B,EAAKx5B,OACjCioE,EAGR5mE,OACC,MAAMkyC,EAAM8gB,OAAO1iD,OAAOjQ,KAAKqmE,MAAOrmE,KAAK2lE,cAG3C,OAFA3lE,KAAKqmE,MAAM/nE,OAAS,EACpB0B,KAAK2lE,aAAe,EACb9zB,IAlGR7xC,KAAKwmE,aAAc,EACnBxmE,KAAKymE,cAAgB,IAAIhB,EAEzB,MAAMj+B,GACLk/B,UAAU,EACVC,SAAU,GAyCX3mE,KAAK4mE,oBAAsB,CAACjlE,IAtCR,CAACA,IAIpB,IAFA3B,KAAKymE,cAAcI,YAAYllE,GAExB3B,KAAKymE,cAAcf,WAAa,GAAG,CAEzC,GAAIl+B,EAAMk/B,SAAU,CAEnB,KAAI1mE,KAAKymE,cAAcf,YAAcjB,EAASqC,YAI7C,MAHAt/B,EAAMm/B,QAAU3mE,KAAKymE,cAAc1G,eACnCv4B,EAAMk/B,UAAW,EAMnB,IAAKl/B,EAAMk/B,SAAU,CAGpB,KAAI1mE,KAAKymE,cAAcf,YAAcl+B,EAAMm/B,SAa1C,MAbmD,CACnD,MAAM5hD,EAAS/kB,KAAKymE,cAAc/T,KAAKlrB,EAAMm/B,SAO7C,GALAn/B,EAAMm/B,SAAW,EACjBn/B,EAAMk/B,UAAW,EAEjB1mE,KAAKimE,WAAWviD,KAAKqB,GAEjB/kB,KAAKwmE,YAER,UAUJK,CAAYllE,KAEbqkE,EAAQtgD,GAAG,OAAQ1lB,KAAK4mE,qBAExB5mE,KAAK+mE,mBAAqB;AAE1Bf,EAAQtgD,GAAG,MAAO1lB,KAAK+mE,oBAEvB/mE,KAAKgnE,qBAAuB,MAC3BhnE,KAAKkmE,SAASxiD,SAEfsiD,EAAQr0D,KAAK,QAAS3R,KAAKgnE,sBAG5BrnE,UACCK,KAAKwmE,aAAc,EACnBxmE,KAAKgmE,QAAQpgD,eAAe,OAAQ5lB,KAAK4mE,qBACzC5mE,KAAKgmE,QAAQpgD,eAAe,MAAO5lB,KAAK+mE,oBACxC/mE,KAAKgmE,QAAQpgD,eAAe,QAAS5lB,KAAKgnE,sBAG3CrnE,MACCK,KAAKgmE,QAAQrzD,MAGdhT,mBACC,OAAOK,KAAKymE,cAAc/T,KAAK1yD,KAAKymE,cAAcf,YAGnD/lE,KAAKolB,GACJ,MAAM48C,EAAShP,OAAOC,YAAY6R,EAASqC,YAC3CnF,EAAO9B,cAAc96C,EAAOzmB,OAAQ,GAAG,GACvC0B,KAAKinE,WAAWtF,EAAQ58C,GAuBjBplB,WAAWgiE,EAAgBhgE,GAC9B3B,KAAKomE,aAAajoC,IAAIwjC,EAAQhgE,IACjCo0B,aAAa,KAER/1B,KAAKgmE,QAAQkB,WAQjBlnE,KAAKgmE,QAAQzP,MAAMv2D,KAAKomE,aAAae,WAlIhB1C,EAAAqC,WAAa,EAFtCrmE,EAAAgkE,SAAAA,QA0Ia2C,UAAexC,EAAAzB,UAEnBxjE,+BAA+B0nE,GACtC,MAAMC,EAAel+C,EAAArG,MAAMuC,qBAA6B+hD,EAAQ,cAEhE,OAAOj+C,EAAArG,MAAMrR,IAAI41D,EAAcC,KAC9B3oE,SAAU,IAAI6lE,EAAS8C,GACvB/D,sBAAuBp6C,EAAArG,MAAMpR,KAAKyX,EAAArG,MAAMuC,qBAA2BiiD,EAAQ,aAM7E5nE,YAAY0nE,GACXv0D,MAAMs0D,EAAOI,wBAAwBH,IACrCrnE,KAAKqnE,OAASA;AAGf1nE,UACCmT,MAAM0N,UACFxgB,KAAKqnE,SACRrnE,KAAKqnE,OAAO9U,QACZvyD,KAAKqnE,OAAS,OAtBjB5mE,EAAA2mE,OAAAA,QA2BazC,UAAkCC,EAAAT,UAQ9CxkE,YAAoBf,EAAuC4mB,GAC1D1S,MAAMlU,EAAU4mB,GADGxlB,KAAApB,SAAAA,EANpBe,kBAAqC4nE,EAAgB/hD,GACpD,OAAO,IAAIm/C,EAAO,IAAIF,EAAS8C,GAAS/hD,GAGzC2gD,cAA6B,OAAOnmE,KAAKpB,SAASunE,QAMlDxmE,UACCmT,MAAM0N,UACNxgB,KAAKpB,SAAS+T,OAdhBlS,EAAAkkE,OAAAA,EAoBAlkE,EAAAgnE,MAAA,SAAsBn/C,GACrB,OAAO,IAAIja,QAAgB,CAACpK,EAAGjF,KAC9B,MAAMqoE,EAASK,EAAAC,eAEfN,EAAO3hD,GAAG,QAAS1mB,GACnBqoE,EAAO7G,OAAOl4C,EAAM,KACnB++C,EAAOzhD,eAAe,QAAS5mB,GAC/BiF,EAAE,IAAImjE,EAAOC,SAQhB5mE,EAAAmnE,QAAA,SAAwBt/C,EAAWu/C,GAClC,OAAO,IAAIx5D,QAAgB,CAACpK,EAAGjF,KAC9B,MAAMuoE,EAASG,EAAAI,iBAAiBx/C,EAAM,KACrCi/C,EAAO3hD,eAAe,QAAS5mB,GAC/BiF,EAAE0gE,EAAOoD,WAAWR,EAAQM,MAG7BN,EAAO51D,KAAK,QAAS3S,YAgDVgpE,EAMZroE,YAAY+vC,GACX1vC,KAAKioE,QAAUv4B,EACf1vC,KAAKohE,UAAY6D,EAAoBjlE,KAAKioE,QAAQ7G,WAClDphE,KAAKmmE,QAAUlB,EAAoBjlE,KAAKioE,QAAQ9B,SAG1CxmE,KAAKolB,GACX/kB,KAAKioE,QAAQvG,KAAK38C,GAGZplB,MACNK,KAAKioE,QAAQt1D,OAjBflS,EAAAunE,iBAAAA,iHCrUaE,EAGZvoE,YAAYwoE,GACX,MAAMC,GACLC,UAAS,EACTC,mBAAmB,EACnBC,sBAAsB;AACtBC,oBAAoB,EACpBC,mBAAmB,EACnBC,2BAA2B,EAC3BC,8BAA8B,EAC9BC,kBAGD5oE,KAAKqmE,MAAQ8B,EAAcU,EAAA5rB,OAAOmrB,EAAaD,GAAeC,EAG/DzoE,UACC,OAAOK,KAAKqmE,MAGb1mE,OAAOmpE,GACND,EAAA5rB,OAAOj9C,KAAKqmE,MAAOyC,GAGpBnpE,YACC,0BACeK,KAAK+oE,8BAEpB/oE,KAAKqmE,MAAM2C,qBACXhpE,KAAKipE,2CACYjpE,KAAKqmE,MAAM6C,aAAelpE,KAAKqmE,MAAM6C,YAAYC,8BACtDnpE,KAAKqmE,MAAM6C,aAAelpE,KAAKqmE,MAAM6C,YAAYrK,SAE7D7+D,KAAKopE,yDAINzpE,kBAKC,OAJqD,IAApBK,KAAKqmE,MAAMgC,WACpB,IAApBroE,KAAKqmE,MAAMgC,WACS,IAApBroE,KAAKqmE,MAAMgC,YAEoBroE,KAAKqmE,MAAMgD,gBAGvC1pE,sBACP,OAAIK,KAAKqpE,mBAAqBrpE,KAAKqmE,MAAMiD,0CACTtpE,KAAKqmE,MAAMiD,kBAAkBx9C,UAErD,GAIDnsB,oBACP,OAAwB,IAApBK,KAAKqmE,MAAMgC,UACP,MACuB,IAApBroE,KAAKqmE,MAAMgC,UACd,oBACuB,IAApBroE,KAAKqmE,MAAMgC,UACd,wBAEA,kBAID1oE;AACP,IAAI4pE,EAAO,GAoCX,OAlCwB,IAApBvpE,KAAKqmE,MAAMgC,WAAmD,IAApBroE,KAAKqmE,MAAMgC,WACpDroE,KAAKqmE,MAAMiC,mBAAqBtoE,KAAKqmE,MAAMmD,aAC9CD,GAAQvpE,KAAKypE,wBAIS,IAApBzpE,KAAKqmE,MAAMgC,YAEVroE,KAAKqmE,MAAMmC,qBACde,GAAQvpE,KAAK0pE,yBAGV1pE,KAAKqmE,MAAMkC,uBACdgB,GAAQvpE,KAAK2pE,4BAIS,IAApB3pE,KAAKqmE,MAAMgC,WAAmD,IAApBroE,KAAKqmE,MAAMgC,YACnDroE,KAAKqmE,MAAMgD,iBAAmBrpE,KAAKqmE,MAAMoC,oBAC7Cc,GAAQvpE,KAAK4pE,wBAIS,IAApB5pE,KAAKqmE,MAAMgC,YACVroE,KAAKqmE,MAAMqC,4BACda,GAAQvpE,KAAK4pE,wBAGV5pE,KAAKqmE,MAAMsC,+BACdY,GAAQvpE,KAAK6pE,iCACbN,GAAQ,KAAOvpE,KAAK8pE,0CAIfP,EAGA5pE,uBACP,IAAIoqE,EAAK,yEAiBT,OAVAhpE,OAAO4nC,KAAK3oC,KAAKqmE,MAAMmD,YAAYhoE,QAAQwX;AAC1C,MAAMrX,EAA2C,iBAA7B3B,KAAKqmE,MAAMmD,WAAWxwD,GACvCjY,OAAO4nC,KAAK3oC,KAAKqmE,MAAMmD,WAAWxwD,IAAItH,IAAIvQ,MAAUA,MAAQnB,KAAKqmE,MAAMmD,WAAWxwD,GAAG7X,MAAQiZ,KAAK,QAClGpa,KAAKqmE,MAAMmD,WAAWxwD,GAEzB+wD,OAAU/wD,KAAKrX,SAGhBooE,GAAM,eAKCpqE,wBACP,+DAIAK,KAAKqmE,MAAM2D,sCAOJrqE,0BACP,iEAIAK,KAAKqmE,MAAM4D,yCAOJtqE,uBACP,GAAIK,KAAKqmE,MAAM6D,mBACd,MAAO,sBAGR,MAAMC,EAAoBnqE,KAAKqmE,MAAM+D,6BAA+BpqE,KAAKqmE,MAAM+D,oDAAsD,GAErI,IAAKpqE,KAAKqmE,MAAMgE,yBACf,MAAO,mBAAqBF,EAG7B,MAEMG,EAAQtqE,KAAKqmE,MAAMgE,yBAAyB34D,IAAI1S,MAC3CA,EAAEyK,QAAQzK,EAAEurE,UAAU/yB,OAAO,EAAG,MAAMx4C,EAAE8sB,WAChD1R,KAAK;CAER,uCAAwCpa,KAAKqmE,MAAMgE,yBAAyB/rE,2EAG5EgsE,MACAH,kBAKOxqE,wCACP,kBACOK,KAAKqmE,MAAMxuB,2BACD73C,KAAKqmE,MAAMmE,oBAGrB7qE,iCACP,IAAKK,KAAKqmE,MAAMoE,oBACf,MAAO,GAGR,IAAKzqE,KAAKqmE,MAAMoE,oBAAoBnsE,OACnC,MAAO,mBASR,sFAJc0B,KAAKqmE,MAAMoE,oBAAoB/4D,IAAIg5D,MACtCA,EAAQvpE,OAAOupE,EAAQC,eAAet/D,OAAOq/D,EAAQE,OAAO7qE,MAAM,EAAG,MAC7Eqa,KAAK,uBArMV3Z,EAAAynE,mBAAAA,0GC5BAznE,EAAAoqE,mBAAA,SAAmC/gC,GAiBlC,OAfIyO,EAAAhE,SAASzK,EAAK,UACjBA,EAAMA,EAAI0N,OAAO,EAAG1N,EAAIxrC,OAAS,IAIlCwrC,EAAMyO,EAAA5F,MAAM7I,EAAK,KAEbyO,EAAAhE,SAASzK,EAAK,UACjBA,EAAMyO,EAAA5F,MAAM7I,EAAK,SAGdyO,EAAAhE,SAASzK,EAAK,aACjBA,EAAMyO,EAAA5F,MAAM7I,EAAK,YAGXA,KrDxBRprB,OAAA1gB,EAAA,IAAAC,GAAA;sIsD0BA,MAAM6sE,GACLC,iBAAkBC,EAAA5mE,MAAM6mE,QAAQ,WAChCC,sBAAuBF,EAAA5mE,MAAM6mE,QAAQ,WACrCE,iBAAkBH,EAAA5mE,MAAMqC,aAGZ2kE,UAAejnD,EAAAnD,WAe3BrhB,YAAYi8B,EAAwB3lB,GACnCnD,QANO9S,KAAAqrE,YAAcrrE,KAAKihC,UAAU,IAAI7X,EAAA3F,SAQxCzjB,KAAKiW,QAAUA,GAAWlV,OAAOc,OAAO,MACxCgnE,EAAArsB,MAAMx8C,KAAKiW,QAAS60D,GAAgB,GAEpC9qE,KAAK+qE,iBAAmB/qE,KAAKiW,QAAQ80D,iBACrC/qE,KAAKkrE,sBAAwBlrE,KAAKiW,QAAQi1D,sBAC1ClrE,KAAKmrE,iBAAmBnrE,KAAKiW,QAAQk1D,iBACrCnrE,KAAKsrE,aAAetrE,KAAKiW,QAAQq1D,aAEjCtrE,KAAKurE,SAAWjsE,SAASwqB,cAAc,KACvC0hD,EAAI3tC,SAAS79B,KAAKurE,SAAU,iBAC5BvrE,KAAKurE,SAASE,SAAW,EACzBzrE,KAAKurE,SAAS1iC,aAAa,OAAQ,UAEnCjN,EAAUG,YAAY/7B,KAAKurE,UAE3BG,EAAA/gC,QAAQghC,UAAU3rE,KAAKurE,WAEtBC,EAAI/mC,UAAUC,MAAOgnC,EAAAjnC,UAAU6F,KAAK9oC,QAAQoqE,IAC5C5rE,KAAKihC,UAAUuqC,EAAIlyC,sBAAsBt5B,KAAKurE,SAAUK,EAAW5sE;AAC7DgB,KAAK6rE,QAKV7rE,KAAKqrE,YAAY3nD,KAAK1kB,GAJrBwsE,EAAItkC,YAAY9a,KAAKptB,QAQxBgB,KAAKihC,UAAUuqC,EAAIlyC,sBAAsBt5B,KAAKurE,SAAUC,EAAI/mC,UAAUY,SAAUrmC,IAC/E,MAAMgkB,EAAQ,IAAIkc,EAAA3I,sBAAsBv3B,GACxC,IAAI8sE,GAAe,EACf9rE,KAAK6rE,SAAW7oD,EAAMhe,OAAM,IAAmBge,EAAMhe,OAAM,KAC9DhF,KAAKqrE,YAAY3nD,KAAK1kB,GACtB8sE,GAAe,GACL9oD,EAAMhe,OAAM,KACtBhF,KAAKurE,SAASQ,OACdD,GAAe,GAGZA,GACHN,EAAItkC,YAAY9a,KAAKpJ,GAAO,MAI9BhjB,KAAKihC,UAAUuqC,EAAIlyC,sBAAsBt5B,KAAKurE,SAAUC,EAAI/mC,UAAUK,WAAY9lC,IAC5EwsE,EAAIltC,SAASt+B,KAAKurE,SAAU,aAChCvrE,KAAKgsE,wBAIPhsE,KAAKihC,UAAUuqC,EAAIlyC,sBAAsBt5B,KAAKurE,SAAUC,EAAI/mC,UAAUO,UAAWhmC,IAChFgB,KAAKisE,iBAINjsE,KAAKksE,aAAelsE,KAAKihC,UAAUuqC,EAAIvjC,WAAWjoC,KAAKurE,WACvDvrE,KAAKihC,UAAUjhC,KAAKksE,aAAatkC,WAAW,IAAM5nC,KAAKgsE,uBACvDhsE,KAAKihC,UAAUjhC,KAAKksE,aAAapkC,UAAU,IAAM9nC,KAAKisE,gBAEtDjsE,KAAKisE,cAlENE,iBAAqC,OAAOnsE,KAAKqrE,YAAYroD,MAqErDrjB,qBACP,MAAMysE,EAAkBpsE,KAAKkrE,sBAAwBlrE,KAAKkrE,sBAAsBjkE,WAAa,KACzFmlE,IACHpsE,KAAKurE,SAAS1vC,MAAMwwC,gBAAkBD,GAIxCzsE,MAAM2sE;AACLtsE,KAAKmrE,iBAAmBmB,EAAOnB,iBAC/BnrE,KAAK+qE,iBAAmBuB,EAAOvB,iBAC/B/qE,KAAKkrE,sBAAwBoB,EAAOpB,sBACpClrE,KAAKsrE,aAAegB,EAAOhB,aAE3BtrE,KAAKisE,cAGEtsE,cACP,GAAIK,KAAKurE,SAAU,CAClB,MAAM3lE,EAAa5F,KAAK+qE,iBAAmB/qE,KAAK+qE,iBAAiB9jE,WAAa,KACxEjB,EAAahG,KAAKmrE,iBAAmBnrE,KAAKmrE,iBAAiBlkE,WAAa,KACxEg8B,EAASjjC,KAAKsrE,aAAetrE,KAAKsrE,aAAarkE,WAAa,KAElEjH,KAAKurE,SAAS1vC,MAAM32B,MAAQc,EAC5BhG,KAAKurE,SAAS1vC,MAAMwwC,gBAAkBzmE,EAEtC5F,KAAKurE,SAAS1vC,MAAM0wC,YAActpC,EAAS,MAAQ,KACnDjjC,KAAKurE,SAAS1vC,MAAM2wC,YAAcvpC,EAAS,QAAU,KACrDjjC,KAAKurE,SAAS1vC,MAAM4wC,YAAcxpC,GAIpCnhC,cACC,OAAO9B,KAAKurE,SAGbzb,UAAUnvD,GACJ6qE,EAAIltC,SAASt+B,KAAKurE,SAAU,uBAChCC,EAAI3tC,SAAS79B,KAAKurE,SAAU,sBAE7BvrE,KAAKurE,SAASmB,YAAc/rE,EACxBX,KAAKiW,QAAQ02D,QAChB3sE,KAAKurE,SAASoB,MAAQhsE,GAIxBisE,SAASC,GACRrB,EAAI3tC,SAAS79B,KAAKurE,SAAUsB,GAG7BhB,YAAYlrE,GACPA,GACH6qE,EAAI1tC,YAAY99B,KAAKurE,SAAU,YAC/BvrE,KAAKurE,SAAS1iC,aAAa,gBAAiBx9B,QAAO;AACnDrL,KAAKurE,SAASE,SAAW,IAEzBD,EAAI3tC,SAAS79B,KAAKurE,SAAU,YAC5BvrE,KAAKurE,SAAS1iC,aAAa,gBAAiBx9B,QAAO,IACnDmgE,EAAItvC,6BAA6Bl8B,KAAKurE,WAIxCM,cACC,OAAQL,EAAIltC,SAASt+B,KAAKurE,SAAU,YAGrC5rE,QACCK,KAAKurE,SAAS7uC,SAlJhBj8B,EAAA2qE,OAAAA,QAsJa0B,UAAoB3oD,EAAAnD,WAGhCrhB,YAAYi8B,EAAwBt6B,EAAe2U,GAClDnD,QAHO9S,KAAA+sE,YAKP/sE,KAAK6B,OAAO+5B,EAAWt6B,EAAO2U,GAG/B+2D,cACC,OAAOhtE,KAAK+sE,SAGLptE,OAAOi8B,EAAwBt6B,EAAe2U,GACrD,IAAK,IAAInG,EAAQ,EAAGA,EAAQxO,EAAOwO,IAAS,CAC3C,MAAMunB,EAASr3B,KAAKihC,UAAU,IAAImqC,EAAOxvC,EAAW3lB,IACpDjW,KAAK+sE,SAASltE,KAAKw3B,GAGf/1B,EAAQ,GACXtB,KAAKihC,UAAUuqC,EAAIlyC,sBAAsBjC,EAAOv1B,QAAS0pE,EAAI/mC,UAAUY,SAAUrmC,IAChF,MAAMgkB,EAAQ,IAAIkc,EAAA3I,sBAAsBv3B,GACxC,IAGIiuE,EAHAnB,GAAe,EAIf9oD,EAAMhe,OAAM,IACfioE,EAAqBn9D,EAAQ,EAAIA,EAAQ,EAAI9P,KAAK+sE,SAASzuE,OAAS,EAC1D0kB,EAAMhe,OAAM,IACtBioE,EAAqBn9D,IAAU9P,KAAK+sE,SAASzuE,OAAS,EAAI,EAAIwR,EAAQ,EAEtEg8D,GAAe,EAGZA,GAA8C,iBAAvBmB,IAC1BjtE,KAAK+sE,SAASE,GAAoBvwC,QAClC8uC,EAAItkC,YAAY9a,KAAKptB,GAAG,SApC9ByB,EAAAqsE,YAAAA,ItDtLApuD,OAAA1gB,EAAA,IAAAC,GAAA,SAAAygB,OAAA1gB,EAAA,IAAAC,GAAA,oEuDeA,SAAgBivE,EAAepd,GAC9B,OAPD,SAAgBz8C;AACf,OAAOA,EAAK8G,QAAQ,0BAA2B,CAACgzD,EAAQC,EAAK3jE,EAAM4jE,EAAKC,oCAChC7jE,KAAQ6jE,uBAAiCA,IAAc,eAKxFC,CAAOh1B,EAAArE,OAAO4b,qDADtBrvD,EAAAysE,eAAAA,QAIaM,EAEZ7tE,YACkB8tE,GAAAztE,KAAAytE,WAAAA,EAGlBp6D,SAASA,GACRrT,KAAKytE,WAAWC,UAAYR,EAAe75D,GAAQ,IAGpDs5D,UAAUA,GACT3sE,KAAKytE,WAAWd,MAAQA,GAX1BlsE,EAAA+sE,aAAAA,IvDnBA9uD,OAAA1gB,EAAA,IAAAC,GAAA,SAAAygB,OAAA1gB,EAAA,IAAAC,GAAA,GAAA,KAAA,SAAA0vE,EAAAhsE,GAAA,OAAAgsE,EAAA9rE,OAAA,mDAAAF;AwDQAlB,EAAAmtE,QAAe,oFAEiCr1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAqB,8HAInCv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAkB,uQAOhCv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAoB,sQAIpBv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAA8B,OAC/G3zD,QAAQ,wFAAyFo+B,EAAArE,OAAO25B,EAAAC,SAAS,EAAqB,wIAI9Ev1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAmB,oTAQ3Cv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAmB,4IACJv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAsB,uHACxBv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAyB,whBAgBzEv1B,EAAArE,OAAO25B,EAAAC,SAAS,EAAW,sRAOvCv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA,gUAUfv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA,uWAYdv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA,kXAYnBv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA,yWAURv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA,kWAUbv1B,EAAArE,OAAO25B,EAAAC,SAAS,GAAA,OAAA3zD,QAAA,sCAAAo+B,EAAArE,OAAA25B,EAAAC,SAAA,GAAA;GxDrH/EpvD,OAAA1gB,EAAA,IAAAC,GAAA,GAAA,KAAA,SAAA0vE,EAAAhsE,GAAA,OAAAgsE,EAAA9rE,OAAA,yDAAAF,KAAA+c,OAAA1gB,EAAA,IAAAC,GAAA,GAAA,KAAA,SAAA0vE,EAAAhsE,GAAA,OAAAgsE,EAAA9rE,OAAA,gDAAAF,KAAA+c,OAAA1gB,EAAA,IAAAC,GAAA,GAAA,KAAA,SAAA0vE,EAAAhsE,GAAA,OAAAgsE,EAAA9rE,OAAA,2CAAAF,6GyDOaosE,EAMZpuE,YAAY07C,EAAiC2yB,KAA6BC,GAAwC,GACjHjuE,KAAKq7C,KAAOA,EACZr7C,KAAKguE,gBAAkBA,EACvBhuE,KAAKiuE,6BAA+BA,GATtCxtE,EAAAstE,eAAAA,EAqEattE,EAAAytE,qBAAuC,EAAI7yB,KAAc2yB,IAC9D,IAAID,EAAkB1yB,EAAM2yB,wHCvDvBG,EAIZxuE,YAAoByuE,GAAApuE,KAAAouE,QAAAA,EAFZpuE,KAAAquE,OAAqCttE,OAAOc,OAAO,MAM3DlC,QACC,MAAMkyC,KAMN,OALAy8B,EAAA9sE,QAAQxB,KAAKquE,OAAQE,IAChBvyB,EAAAhB,cAAcuzB,EAAM5tE,MAAM6tE,WAC7B38B,EAAIhyC,KAAK0uE,EAAM5tE,SAGVkxC,EAGRlyC,WAAWuB,EAAS8N,GACnB,MAAMy/D,EAAWzuE,KAAK0uE,mBAAmBxtE,GACxCytE,EAAS3uE,KAAK0uE,mBAAmB1/D,GAElCy/D,EAASD,SAASxuE,KAAKouE,QAAQp/D,IAAO2/D,EACtCA,EAAOC,SAAS5uE,KAAKouE,QAAQltE,IAASutE;AAGvC9uE,WAAWgC,GACV,MAAMR,EAAMnB,KAAKouE,QAAQzsE,UAClB3B,KAAKquE,OAAOltE,GACnBmtE,EAAA9sE,QAAQxB,KAAKquE,OAASE,WACdA,EAAM5tE,MAAM6tE,SAASrtE,UACrBotE,EAAM5tE,MAAMiuE,SAASztE,KAI9BxB,mBAAmBgC,GAClB,MAAMR,EAAMnB,KAAKouE,QAAQzsE,GACzB,IAAIwT,EAAOnV,KAAKquE,OAAOltE,GAOvB,OALKgU,IACJA,EAhDH,SAAoBxT,GACnB,OACCA,KAAMA,EACNitE,SAAU7tE,OAAOc,OAAO,MACxB2sE,SAAUztE,OAAOc,OAAO,OA4ChBwgB,CAAQ1gB,GACf3B,KAAKquE,OAAOltE,GAAOgU,GAGbA,EAGRxV,OAAOgC,GACN,OAAO3B,KAAKquE,OAAOruE,KAAKouE,QAAQzsE,IAGjChC,UACC,IAAK,MAAMkvE,KAAQ7uE,KAAKquE,OACvB,OAAO,EAER,OAAO,EAGR1uE,WACC,IAAIgC,KAIJ,OAHA2sE,EAAA9sE,QAAQxB,KAAKquE,OAAQE,IACpB5sE,EAAK9B,QAAQ0uE,EAAMptE,mBAAmBJ,OAAO4nC,KAAK4lC,EAAM5tE,MAAMiuE,UAAUx0D,KAAK,sBAAsBrZ,OAAO4nC,KAAK4lC,EAAM5tE,MAAM6tE,UAAUp0D,KAAK,WAEpIzY,EAAKyY,KAAK,OA/DnB3Z,EAAA0tE,MAAAA,oDC6FA,SAASW,EAAuBtpD,EAAczjB,EAAkB+N,EAAei/D,GAC1EhtE,EAAOitE,EAAMC,aAAeltE,EAC/BA,EAAOitE,EAAME,iBAAiBrvE,MAAO2lB,GAAAA,EAAI1V,MAAAA,EAAOi/D,SAAAA,KAEhDhtE,EAAOitE,EAAME,mBAAsB1pD,GAAAA,EAAI1V,MAAAA,EAAOi/D,SAAAA,IAC9ChtE,EAAOitE,EAAMC,WAAaltE,GAO5B,SAAgB+F,EAAmBqnE,GAElC,GAAIH,EAAMI,WAAWjzB,IAAIgzB,GACxB,OAAOH,EAAMI,WAAWjnE,IAAIgnE,GAG7B,MAAM3pD,EAAU,SAAUzjB,EAAkBZ,EAAa2O;AACxD,GAAyB,IAArBgC,UAAUxT,OACb,MAAM,IAAIuC,MAAM,oEAEjBiuE,EAAuBtpD,EAAIzjB,EAAQ+N,GAAO,IAM3C,OAHA0V,EAAGve,SAAW,KAAMkoE,GAEpBH,EAAMI,WAAWzoD,IAAIwoD,EAAW3pD,GACzBA,mDArIR,IAAiBwpD,GAAjB,SAAiBA,GAEHA,EAAAI,WAAa,IAAI1oD,IAEjBsoD,EAAAC,UAAY,aACZD,EAAAE,gBAAkB,mBAEfF,EAAAK,uBAAhB,SAAuCh0B,GACtC,OAAOA,EAAK2zB,EAAAE,sBARd,CAAiBF,EAAAvuE,EAAAuuE,QAAAvuE,EAAAuuE,WAsDJvuE,EAAA6uE,sBAAwBxnE,EAAuC,wBA+D5ErH,EAAAqH,gBAAAA,EAsBArH,EAAAsuE,SAAA,SAA4BQ,GAE3B,OAAO,SAAUxtE,EAAkBZ,EAAa2O,GAC/C,GAAyB,IAArBgC,UAAUxT,OACb,MAAM,IAAIuC,MAAM,gEAEjBiuE,EAAuBS,EAAmBxtE,EAAQ+N,GAAO,6GChJ9CrP,EAAA+uE,oBAAsBC,EAAA3nE,gBAAqC,sBAwBxErH,EAAAivE,kBAAA,SAAkCC,GACjC,QAASA,EAAgB,WAG1BlvE,EAAAmvE,eAAA,SAA+BD,GAC9B,QAASA,EAAgB,WAG1BlvE,EAAAovE,aAAA,SAA6BF,GAC5B,QAASA,EAAc;wDCpCXG,EAIZnwE,eAAeoiD,GAFP/hD,KAAA+vE,SAAW,IAAIrpD,IAGtB,IAAK,IAAKlB,EAAIwqD,KAAYjuB,EACzB/hD,KAAK2mB,IAAInB,EAAIwqD,GAIfrwE,IAAO6lB,EAA0ByqD,GAChC,MAAM9xE,EAAS6B,KAAK+vE,SAAS5nE,IAAIqd,GAEjC,OADAxlB,KAAK+vE,SAASppD,IAAInB,EAAIyqD,GACf9xE,EAGRwB,QAAQ8B,GACPzB,KAAK+vE,SAASvuE,QAAQ,CAACb,EAAOQ,IAAQM,EAASN,EAAKR,IAGrDhB,IAAI6lB,GACH,OAAOxlB,KAAK+vE,SAAS5zB,IAAI32B,GAG1B7lB,IAAO6lB,GACN,OAAOxlB,KAAK+vE,SAAS5nE,IAAIqd,IAzB3B/kB,EAAAqvE,kBAAAA,uICMA,MAMMI,EAAgC,mBAAVC,YAEfC,EAQZzwE,YAAY0wE,EAA8B,IAAIC,EAAAR,kBAAqBS,GAAkB,EAAO9xE,GAC3FuB,KAAKwwE,UAAYH,EACjBrwE,KAAKu/C,QAAUgxB,EACfvwE,KAAKywE,QAAUhyE,EAEfuB,KAAKwwE,UAAU7pD,IAAI8oD,EAAAH,sBAAuBtvE,MAG3CL,YAAY0wE,GACX,OAAO,IAAID,EAAqBC,EAAUrwE,KAAKu/C,QAASv/C,MAGzDL,eAAuCuI,KAAuDM,GAC7F,IAAIkoE,EAASC,EAAMC,gBAAgB1oE,GAC/B2oE,GAAQ,EACZ,IACC,MAAMC,GACL3oE,IAAK,CAAIqd,EAA0BurD,KAElC,GAAIF,EACH,MAAMliE,EAAA7D,aAAa,6EAGpB,MAAM3M,EAAS6B,KAAKgxE,4BAA4BxrD,EAAIkrD,GACpD,IAAKvyE,GAAU4yE,IAAetB,EAAAV,SAC7B,MAAM,IAAIluE,2CAA2C2kB,MAEtD,OAAOrnB;EAGT,OAAO+J,EAAGW,WAAMO,GAAY0nE,KAAatoE,YAEzCqoE,GAAQ,EACRH,EAAOtkD,QAITzsB,eAAesxE,KAAgDxwD,GAC9D,IAAIiwD,EACAvyE,EASJ,OARI8yE,aAA4BC,EAAAnD,gBAC/B2C,EAASC,EAAMQ,cAAcF,EAAiB51B,MAC9Cl9C,EAAS6B,KAAKoxE,gBAAgBH,EAAiB51B,KAAM41B,EAAiBjD,gBAAgB/9D,OAAOwQ,GAAOiwD,KAEpGA,EAASC,EAAMQ,cAAcF,GAC7B9yE,EAAS6B,KAAKoxE,gBAAgBH,EAAkBxwD,EAAMiwD,IAEvDA,EAAOtkD,OACAjuB,EAGAwB,gBAAmB07C,EAAW7yC,KAAkBkoE,GAGvD,IAAIW,EAAsB5B,EAAAT,MAAMK,uBAAuBh0B,GAAMptC,KAAK,CAACpL,EAAGD,IAAMC,EAAEiN,MAAQlN,EAAEkN,OACpFwhE,KACJ,IAAK,MAAMC,KAAcF,EAAqB,CAC7C,IAAIrB,EAAUhwE,KAAKgxE,4BAA4BO,EAAW/rD,GAAIkrD,GAC9D,IAAKV,GAAWhwE,KAAKu/C,UAAYgyB,EAAWxC,SAC3C,MAAM,IAAIluE,0BAA0Bw6C,EAAK5xC,mCAAmC8nE,EAAW/rD,OAExF8rD,EAAYzxE,KAAKmwE,GAGlB,IAAIwB,EAAqBH,EAAoB/yE,OAAS,EAAI+yE,EAAoB,GAAGvhE,MAAQtH,EAAKlK,OAG9F,GAAIkK,EAAKlK,SAAWkzE,EAAoB,CACvCnpE,QAAQC,qDAAqD+yC,EAAK5xC,oBACjE+nE,EAAqB,oBAAoBhpE,EAAKlK,2BAE/C,IAAIwF,EAAQ0tE,EAAqBhpE,EAAKlK,OAErCkK,EADG1E,EAAQ,EACJ0E,EAAKyH,OAAO,IAAIb,MAAMtL,IAEtB0E,EAAKzI,MAAM,EAAGyxE,GAKvB,OAAUx1B,EAAAn6C,OAAOgH,MAAM,MAAOwyC,GAAMprC,OAAOzH,EAAM8oE,IAG1C3xE,oBAAuB6lB,EAA0BisD,GACxD,GAAIzxE,KAAKwwE,UAAUroE,IAAIqd,aAAe0rD,EAAAnD,eACrC/tE,KAAKwwE,UAAU7pD,IAAInB,EAAIisD,OACjB;AAAA,IAAIzxE,KAAKywE,QAGf,MAAM,IAAI5vE,MAAM,mDAFhBb,KAAKywE,QAAQiB,oBAAoBlsD,EAAIisD,IAM/B9xE,gCAAmC6lB,GAC1C,IAAImsD,EAAiB3xE,KAAKwwE,UAAUroE,IAAIqd,GACxC,OAAKmsD,GAAkB3xE,KAAKywE,QACpBzwE,KAAKywE,QAAQmB,gCAAgCpsD,GAE7CmsD,EAIDhyE,4BAA+B6lB,EAA0BkrD,GAChE,IAAI9vD,EAAQ5gB,KAAK4xE,gCAAgCpsD,GACjD,OAAI5E,aAAiBswD,EAAAnD,eACb/tE,KAAK6xE,+BAA+BrsD,EAAI5E,EAAO8vD,EAAOoB,OAAOtsD,GAAI,KAExEkrD,EAAOoB,OAAOtsD,GAAI,GACX5E,GAIDjhB,+BAAkC6lB,EAA0BusD,EAAyBrB,GAI5F,SAASsB,IACR,MAAM7mE,EAAM,IAAItK,MAAM,uDAEtB,MADAsK,EAAIvK,QAAUqxE,EAAMhrE,WACdkE,EALP,MAAM8mE,EAAQ,IAAIC,EAAA/D,MAAcxsE,GAAQA,EAAK6jB,GAAGve,YAQhD,IAAI3F,EAAQ,EACZ,MAAMwI,IAAW0b,GAAAA,EAAIusD,KAAAA,EAAMrB,OAAAA,IAC3B,KAAO5mE,EAAMxL,QAAQ,CACpB,MAAMwX,EAAOhM,EAAMoD,MACnB+kE,EAAMvD,mBAAmB54D,GAIrBxU,IAAU,KACb0wE,IAID,IAAIG,EAAe1C,EAAAT,MAAMK,uBAAuBv5D,EAAKi8D,KAAK12B,MAC1D,IAAK,IAAIk2B,KAAcY,EAAc,CAEpC,IAAIR,EAAiB3xE,KAAK4xE,gCAAgCL,EAAW/rD,IAKrE,GAJKmsD,GAAmBJ,EAAWxC,UAClC1mE,QAAQC,yBAAyBkd,gBAAiB+rD,EAAW/rD,+BAG1DmsD,aAA0BT,EAAAnD,eAAgB,CAC7C,MAAMrtD,GAAM8E,GAAI+rD,EAAW/rD;AAAIusD,KAAMJ,EAAgBjB,OAAQ56D,EAAK46D,OAAOoB,OAAOP,EAAW/rD,IAAI,IAC/FysD,EAAMG,WAAWt8D,EAAM4K,GACvB5W,EAAMjK,KAAK6gB,KAKd,OAAa,CACZ,IAAI2xD,EAAQJ,EAAMI,QAIlB,GAAqB,IAAjBA,EAAM/zE,OAAc,CAClB2zE,EAAM5qD,WACV2qD,IAED,MAGD,IAAK,IAAIrwE,KAAEA,KAAU0wE,EAAO,CAE3B,MAAMZ,EAAWzxE,KAAKsyE,gCAAgC3wE,EAAK6jB,GAAI7jB,EAAKowE,KAAK12B,KAAM15C,EAAKowE,KAAK/D,gBAAiBrsE,EAAKowE,KAAK9D,6BAA8BtsE,EAAK+uE,QACvJ1wE,KAAK0xE,oBAAoB/vE,EAAK6jB,GAAIisD,GAClCQ,EAAMl1C,WAAWp7B,IAInB,OAAU3B,KAAK4xE,gCAAgCpsD,GAGxC7lB,gCAAmC6lB,EAA0B61B,EAAW7yC,KAAkBylE,EAAuCyC,GACxI,GAAI1wE,KAAKwwE,UAAUroE,IAAIqd,aAAe0rD,EAAAnD,eACrC,OAAO/tE,KAAKuyE,uBAAuBl3B,EAAM7yC,EAAMylE,EAA8ByC,GACvE,GAAI1wE,KAAKywE,QACf,OAAOzwE,KAAKywE,QAAQ6B,gCAAgC9sD,EAAI61B,EAAM7yC,EAAMylE,EAA8ByC,GAElG,MAAM,IAAI7vE,MAAM,oDAIVlB,uBAA0B07C,EAAW7yC,KAAkBgqE,EAAwC9B,GACtG,GAAK8B,GAAkCtC,EAIhC,CAIN,MAAMuC,EAAO,IAAIvxC,EAAAzO,UAAU,IAAMzyB,KAAKoxE,gBAAgB/1B,EAAM7yC,EAAMkoE,IAClE,OAAU,IAAIP,MAAMpvE,OAAOc,OAAO,OACjCsG,IAAG,CAACuqE,EAAYl9D,IACRi9D,EAAKE,WAAWn9D,GAExBmR,IAAG,CAAC+rD,EAAYpvE,EAAgB3C,KAC/B8xE,EAAKE,WAAWrvE,GAAK3C,GACd,KAbT,OAAOX,KAAKoxE,gBAAgB/1B,EAAM7yC,EAAMkoE,IAnM3CjwE,EAAA2vE,qBAAAA,EAyNA,IAAWwC,GAAX,SAAWA,GACVA,EAAAA,EAAA,SAAA,GAAA,WAAUA,EAAAA,EAAA,WAAA,GAAA;AAAYA,EAAAA,EAAA,OAAA,GAAA,SADvB,CAAWA,IAAAA,aAILjC,EAoBLhxE,YACU2V,EACA7L,GADAzJ,KAAAsV,KAAAA,EACAtV,KAAAyJ,KAAAA,EALOzJ,KAAA6yE,OAAiBjuD,KAAK6E,MACtBzpB,KAAA8yE,QAVjBnzE,uBAAuB07C,GACtB,OAAyBs1B,EAAMoC,MAGhCpzE,qBAAqB07C,GACpB,OAAyBs1B,EAAMoC,MAYhCpzE,OAAO6lB,EAA4BjkB,GAClC,IAAI65B,EAAQ,IAAIu1C,EAAK,EAAmBnrD,EAAGve,YAE3C,OADAjH,KAAK8yE,KAAKjzE,MAAM2lB,EAAIjkB,EAAO65B,IACpBA,EAGRz7B,OAMC,SAASqzE,EAAWhsE,EAAWw4C,GAC9B,IAAI78B,KACAqsC,EAAS,IAAI5/C,MAAMpI,EAAI,GAAGoT,KAAK,MACnC,IAAK,MAAOoL,EAAIjkB,EAAO65B,KAAUokB,EAAMszB,KACtC,GAAIvxE,GAAS65B,EAAO,CACnB63C,GAAiB,EACjBtwD,EAAI9iB,QAAQmvD,eAAoBxpC,KAChC,IAAI0tD,EAASF,EAAWhsE,EAAI,EAAGo0B,GAC3B83C,GACHvwD,EAAI9iB,KAAKqzE,QAGVvwD,EAAI9iB,QAAQmvD,YAAiBxpC,KAG/B,OAAO7C,EAAIvI,KAAK,MApBjB,IAAI+4D,EAAMvuD,KAAK6E,MAAQzpB,KAAK6yE,OAC5BlC,EAAMyC,SAAWD,EAEjB,IAAIF,GAAiB,EAoBjBI,MACS,IAATrzE,KAAKsV,KAA8B,SAAW,UAAUtV,KAAKyJ,UAC7DupE,EAAW,EAAGhzE,sBACHmzE,EAAI7rE,QAAQ,qBAAqBqpE,EAAMyC,QAAQ9rE,QAAQ,UAGlE6rE,EAAM,GAAKF,IACd5qE,QAAQiwD,IAAI+a,EAAMj5D,KAAK,QA5DVu2D,EAAAoC,MAAQ,kBAAkBpC,EACxChxE,cAAgBmT,OAAO,EAAG,MAC1BnT,QACAA,SAAW,OAAOK,OAWJ2wE,EAAAyC,QAAkB,mHCzPrB3yE,EAAA6yE,oBAAsB7D,EAAA3nE,gBAAqC,4BAW3DyrE,UAA2BpvD,EAAAnD;AAMvCrhB,YACC6zE,GAEA1gE,QAEA9S,KAAKyzE,sBAAwBzzE,KAAKihC,UAAU,IAAIyyC,EAAA/O,iBAAiB6O,MAGlE7zE,WAAW4hE,GACV,OAAOvhE,KAAKyzE,sBAAsBxP,WAAW1C,GAG9C5hE,gBAAgB4hE,EAAqBC,GACpCxhE,KAAKyzE,sBAAsB7P,gBAAgBrC,EAAaC,IAnB1D/gE,EAAA8yE,mBAAAA,qECRA,SAAS9pD,IACR,OAAO,IAAI7E,MAAO+uD,+DAHNlzE,EAAAmzE,YAAcnE,EAAA3nE,gBAAoC,cAM/D,IAAY+rE,GAAZ,SAAYA,GACXA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,MAAA,GAAA,QACAA,EAAAA,EAAA,SAAA,GAAA,WACAA,EAAAA,EAAA,IAAA,GAAA,MAPD,CAAYA,EAAApzE,EAAAozE,WAAApzE,EAAAozE,cAUCpzE,EAAAqzE,kBAA8BD,EAASE,WAgB9BC,UAA2B7vD,EAAAnD,WAAjDrhB,kCAESK,KAAAi0E,MAAkBxzE,EAAAqzE,kBACT9zE,KAAAk0E,qBAA0Cl0E,KAAKihC,UAAU,IAAI7X,EAAA3F,SACrEzjB,KAAAm0E,oBAAuCn0E,KAAKk0E,qBAAqBlxD,MAE1ErjB,SAASs0E,GACJj0E,KAAKi0E,QAAUA,IAClBj0E,KAAKi0E,MAAQA,EACbj0E,KAAKk0E,qBAAqBxwD,KAAK1jB,KAAKi0E,QAItCt0E,WACC,OAAOK,KAAKi0E;AAddxzE,EAAAuzE,mBAAAA,QAkBaI,UAA8BJ,EAK1Cr0E,YAAY00E,EAAqB5zE,EAAAqzE,mBAChChhE,QACA9S,KAAKs0E,SAASD,GACdr0E,KAAKu0E,WAAavmC,EAAA9Y,UAGnBv1B,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAASlD,QAC3B3wE,KAAKu0E,UACRlsE,QAAQiwD,kBAAqB7uC,WAAiB7oB,KAAY4H,GAE1DH,QAAQiwD,aAAa7uC,OAAU7oB,KAAY4H,IAK9C7I,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAASY,QAC3Bz0E,KAAKu0E,UACRlsE,QAAQiwD,kBAAqB7uC,WAAiB7oB,KAAY4H,GAE1DH,QAAQiwD,aAAa7uC,OAAU7oB,KAAY4H,IAK9C7I,KAAKiB,KAAoB4H,GACpBxI,KAAKw0E,YAAcX,EAASE,OAC3B/zE,KAAKu0E,UACRlsE,QAAQiwD,kBAAqB7uC,WAAiB7oB,KAAY4H,GAE1DH,QAAQiwD,aAAa7uC,OAAU7oB,KAAY4H,IAK9C7I,KAAKiB,KAA4B4H,GAC5BxI,KAAKw0E,YAAcX,EAASa,UAC3B10E,KAAKu0E,UACRlsE,QAAQC,mBAAsBmhB,WAAiB7oB,KAAY4H,GAE3DH,QAAQC,cAAcmhB,OAAU7oB,KAAY4H,IAK/C7I,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAAShzE,QAC3Bb,KAAKu0E,UACRlsE,QAAQmB,oBAAuBigB,WAAiB7oB,KAAY4H,GAE5DH,QAAQmB,eAAeigB,OAAU7oB,KAAY4H,IAKhD7I,SAASiB,KAAoB4H,GACxBxI,KAAKw0E,YAAcX,EAASc,WAC3B30E,KAAKu0E,UACRlsE,QAAQmB,oBAAuBigB,WAAiB7oB,KAAY4H,GAE5DH,QAAQmB,eAAeigB,OAAU7oB,KAAY4H,IAKhD7I,YAvEDc,EAAA2zE,sBAAAA;OA4EaQ,UAA0BZ,EAItCr0E,YAAY00E,EAAqB5zE,EAAAqzE,mBAChChhE,QACA9S,KAAKs0E,SAASD,GAGf10E,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAASlD,OAC/BtoE,QAAQiwD,IAAI,UAAW,cAAe13D,KAAY4H,GAIpD7I,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAASY,OAC/BpsE,QAAQiwD,IAAI,UAAW,gCAAiC13D,KAAY4H,GAItE7I,KAAKiB,KAAoB4H,GACpBxI,KAAKw0E,YAAcX,EAASE,MAC/B1rE,QAAQiwD,IAAI,UAAW,cAAe13D,KAAY4H,GAIpD7I,KAAKiB,KAA4B4H,GAC5BxI,KAAKw0E,YAAcX,EAASa,SAC/BrsE,QAAQiwD,IAAI,UAAW,cAAe13D,KAAY4H,GAIpD7I,MAAMiB,KAAoB4H,GACrBxI,KAAKw0E,YAAcX,EAAShzE,OAC/BwH,QAAQiwD,IAAI,UAAW,cAAe13D,KAAY4H,GAIpD7I,SAASiB,KAAoB4H,GACxBxI,KAAKw0E,YAAcX,EAASc,UAC/BtsE,QAAQiwD,IAAI,UAAW,iCAAkC13D,KAAY4H,GAIvE7I,YA7CDc,EAAAm0E,kBAAAA,QAgDaC,UAA4Bb,EAGxCr0E,YAAoBm1E,GACnBhiE,QADmB9S,KAAA80E,YAAAA,EAEfA,EAAYx2E,QACf0B,KAAKs0E,SAASQ,EAAY,GAAGN,YAI/B70E,SAASs0E,GACR,IAAK,MAAMc,KAAc/0E,KAAK80E,YAC7BC,EAAWT,SAASL,GAErBnhE,MAAMwhE,SAASL,GAGhBt0E,MAAMiB,KAAoB4H,GACzB,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWv1B,MAAM5+C,KAAY4H,GAI/B7I,MAAMiB,KAAoB4H,GACzB,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWC,MAAMp0E,KAAY4H,GAI/B7I,KAAKiB,KAAoB4H,GACxB,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWxL,KAAK3oE,KAAY4H;AAI9B7I,KAAKiB,KAAoB4H,GACxB,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWzsE,KAAK1H,KAAY4H,GAI9B7I,MAAMiB,KAA4B4H,GACjC,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWvrE,MAAM5I,KAAY4H,GAI/B7I,SAASiB,KAA4B4H,GACpC,IAAK,MAAMusE,KAAc/0E,KAAK80E,YAC7BC,EAAWE,SAASr0E,KAAY4H,GAIlC7I,UACC,IAAK,MAAMo1E,KAAc/0E,KAAK80E,YAC7BC,EAAWv0D,WAvDd/f,EAAAo0E,oBAAAA,QA4DaK,UAA4B/wD,EAAAnD,WAGxCrhB,YAAoBo1E,GACnBjiE,QADmB9S,KAAA+0E,WAAAA,EAEnB/0E,KAAKihC,UAAU8zC,GAGhBZ,0BACC,OAAOn0E,KAAK+0E,WAAWZ,oBAGxBx0E,SAASs0E,GACRj0E,KAAK+0E,WAAWT,SAASL,GAG1Bt0E,WACC,OAAOK,KAAK+0E,WAAWP,WAGxB70E,MAAMiB,KAAoB4H,GACzBxI,KAAK+0E,WAAWv1B,MAAM5+C,KAAY4H,GAGnC7I,MAAMiB,KAAoB4H,GACzBxI,KAAK+0E,WAAWC,MAAMp0E,KAAY4H,GAGnC7I,KAAKiB,KAAoB4H,GACxBxI,KAAK+0E,WAAWxL,KAAK3oE,KAAY4H,GAGlC7I,KAAKiB,KAAoB4H,GACxBxI,KAAK+0E,WAAWzsE,KAAK1H,KAAY4H,GAGlC7I,MAAMiB,KAA4B4H,GACjCxI,KAAK+0E,WAAWvrE,MAAM5I,KAAY4H,GAGnC7I,SAASiB,KAA4B4H,GACpCxI,KAAK+0E,WAAWE,SAASr0E,KAAY4H,IAzCvC/H,EAAAy0E,oBAAAA,QA6CaC,EAAbx1E,cAEUK,KAAAm0E,qBAAuC,IAAI/qD,EAAA3F,SAAoBT,MACxErjB,SAASs0E,IACTt0E,WAAuB,OAAOk0E,EAASE,KACvCp0E,MAAMiB,KAAoB4H,IAC1B7I,MAAMiB,KAAoB4H,IAC1B7I,KAAKiB,KAAoB4H,IACzB7I,KAAKiB,KAAoB4H,IACzB7I,MAAMiB,KAA4B4H,IAClC7I,SAASiB,KAA4B4H,IACrC7I;AAXDc,EAAA00E,eAAAA,EAcA10E,EAAA20E,YAAA,SAA4BC,GAC3B,GAAIA,EAAmBld,QACtB,OAAO0b,EAASlD,MAEjB,GAA2C,iBAAhC0E,EAAmB7sE,KAAK8vD,IAElC,OADiB+c,EAAmB7sE,KAAK8vD,IAAIh6C,eAE5C,IAAK,QACJ,OAAOu1D,EAASlD,MACjB,IAAK,QACJ,OAAOkD,EAASY,MACjB,IAAK,OACJ,OAAOZ,EAASE,KACjB,IAAK,OACJ,OAAOF,EAASa,QACjB,IAAK,QACJ,OAAOb,EAAShzE,MACjB,IAAK,WACJ,OAAOgzE,EAASc,SACjB,IAAK,MACJ,OAAOd,EAASyB,IAGnB,OAAO70E,EAAAqzE,sIC9TKyB,EAIZ51E,YAAoBqwE,GAAAhwE,KAAAgwE,QAAAA,EACnBhwE,KAAKm0E,oBAAsB/qD,EAAArG,MAAMgC,OAAOirD,EAAQmE,qBAAqB,GAGtEx0E,OAAOmlB,EAAG9B,GACT,OAAQA,GACP,IAAK,sBAAuB,OAAOhjB,KAAKm0E,oBAGzC,MAAM,IAAItzE,0BAA0BmiB,KAGrCrjB,KAAKmlB,EAAG6O,EAAiBtvB,GACxB,OAAQsvB,GACP,IAAK,WAAwC,OAA5B3zB,KAAKgwE,QAAQsE,SAASjwE,GAAagK,QAAQC,UAG7D,MAAM,IAAIzN,yBAAyB8yB,MArBrClzB,EAAA80E,sBAAAA,QAyBaC,EAEZ71E,YAAoB6hE,GAAAxhE,KAAAwhE,QAAAA,EAEpB2S,0BACC,OAAOn0E,KAAKwhE,QAAQhB,OAAO,uBAG5B7gE,SAASs0E,GACRj0E,KAAKwhE,QAAQpgE,KAAK,WAAY6yE;AAThCxzE,EAAA+0E,4BAAAA,QAaaC,UAA2BC,EAAAR,oBAGvCv1E,YAAoBg2E,EAAqCZ,GACxDjiE,MAAMiiE,GADa/0E,KAAA21E,OAAAA,EAEnB31E,KAAKihC,UAAU00C,EAAOxB,oBAAoBF,GAASc,EAAWT,SAASL,KAGxEt0E,SAASs0E,GACRj0E,KAAK21E,OAAOrB,SAASL,IATvBxzE,EAAAg1E,mBAAAA,oHCpCAh1E,EAAAm1E,oBAAA,SAAoCC,EAAqBxB,EAAoByB,GAE5E,IACC,MAAMC,EAAyBlkB,EAAQC,iBAAiB,UACxDikB,EAAQC,aAAa,KAAM,KAC3B,MAAMC,EAAc5gE,EAAK+E,KAAK07D,KAAeD,SACvCK,EAAS,IAAIH,EAAQI,eAAeN,EAAaI,EAAa,QAAiB,GAGrF,OAFAC,EAAO5B,SAAS,GAET,IAAI8B,EAAcF,EAAQ7B,GAChC,MAAOr1E,GAER,OAAO,IAAI02E,EAAAP,iBAIb10E,EAAA41E,qBAAA,SAAqC5sE,EAAc6sE,EAAkBC,EAAkBC,GACtF,IAEC,OAAO,IADwB3kB,EAAQC,iBAAiB,UACrCqkB,gBAAe1sE,EAAM6sE,EAAUC,EAAUC,GAC3D,MAAOx3E,GACR,GAAsB,oBAAXY,OAEV+1B,KAAK8gD,aACJC,MAAO,aACPC,OACCltE,KAAAA,EAAM6sE,SAAAA,EAAUC,SAAAA,EAAUC,UAAAA,SAGtB,CACN,MAAMI,EAAON,EAASlrE,MAAM,KAC5BwrE,EAAK1pE,MACL,IAAI2pE,EAAY,GAChBD,EAAKp1E,QAAQ8tC,IACPA,IAGLunC,OAAiBvnC,IACZ6iB,EAAG2kB,WAAWD,IAClB1kB,EAAG4kB,UAAUF,MAGV1kB,EAAG2kB,WAAWR,IAClBnkB,EAAG+K,cAAcoZ,EAAU,GAAI,SAGjC,OACCpxD,MAAO,aACP+vD,SAAU,SAAU75D;AACnB,GAAsB,oBAAXxb,OAEV+1B,KAAK8gD,aACJC,MAAO,eACPC,OACCL,SAAAA,EAAUl7D,QAAAA,SAGN,CACN,MAAM47D,EAAc7kB,EAAG8kB,aAAaX,GAAUrvE,WAC9CkrD,EAAG+K,cAAcoZ,EAAUU,EAAc57D,EAAS,WAGpD87D,gBAAiB,sBAKdd,UAAsBV,EAAA1B,mBAI3Br0E,YACkBu2E,EACjBjC,EAAkByB,EAAA7B,SAAShzE,OAE3BiS,QAHiB9S,KAAAk2E,OAAAA,EAIjBl2E,KAAKs0E,SAASL,GAGft0E,QACKK,KAAKw0E,YAAckB,EAAA7B,SAASlD,OAC/B3wE,KAAKk2E,OAAO12B,MAAMx/C,KAAKkG,OAAO4L,YAIhCnS,QACKK,KAAKw0E,YAAckB,EAAA7B,SAASY,OAC/Bz0E,KAAKk2E,OAAOlB,MAAMh1E,KAAKkG,OAAO4L,YAIhCnS,OACKK,KAAKw0E,YAAckB,EAAA7B,SAASE,MAC/B/zE,KAAKk2E,OAAO3M,KAAKvpE,KAAKkG,OAAO4L,YAI/BnS,OACKK,KAAKw0E,YAAckB,EAAA7B,SAASa,SAC/B10E,KAAKk2E,OAAO5tE,KAAKtI,KAAKkG,OAAO4L,YAI/BnS,QACC,GAAIK,KAAKw0E,YAAckB,EAAA7B,SAAShzE,MAAO,CACtC,MAAMwD,EAAMyN,UAAU,GAEtB,GAAIzN,aAAexD,MAAO,CACzB,MAAM0K,EAAQ6D,MAAMpO,UAAUjB,MAAMqB,KAAK0Q,WACzCvG,EAAM,GAAKlH,EAAIyF,MACf9J,KAAKk2E,OAAO1sE,MAAMxJ,KAAKkG,OAAOqF,SAE9BvL,KAAKk2E,OAAO1sE,MAAMxJ,KAAKkG,OAAO4L,aAKjCnS,WACKK,KAAKw0E,YAAckB,EAAA7B,SAASc,UAC/B30E,KAAKk2E,OAAOjB,SAASj1E,KAAKkG,OAAO4L,YAInCnS,UACCK,KAAKk2E,OAAOiB,OAGLx3E,OAAO6I;AACd,IAAIrK,EAAS,GAEb,IAAK,IAAIC,EAAI,EAAGA,EAAIoK,EAAKlK,OAAQF,IAAK,CACrC,IAAIyE,EAAI2F,EAAKpK,GAEb,GAAiB,iBAANyE,EACV,IACCA,EAAIgV,KAAKiF,UAAUja,GAClB,MAAO7D,IAGVb,IAAWC,EAAI,EAAI,IAAM,IAAMyE,EAGhC,OAAO1E,iHC5IT,MAAMi5E,EAAW/hE,EAAK88B,QAAQyf,EAAArQ,qBAAqBsQ,EAAS,KACtDwlB,EAAkBhiE,EAAK+E,KAAKg9D,EAAU,gBAC5C32E,EAAAmtE,QAAe/b,EAAQC,iBAAiBulB,gHC8ExC,MAAMD,EAAW/hE,EAAK88B,QAAQyf,EAAArQ,qBAAqBsQ,EAAS,KACtDylB,EAAkBjiE,EAAK+E,KAAKg9D,EAAU,gBACtCG,EAAU1lB,EAAQC,iBAAiBwlB,GAErCljD,QAAQK,IAAgB,aAC3B8iD,EAAQC,WAAa,OACrBD,EAAQE,UAAY,OACpBF,EAAQG,gBAAkB,QAG3Bj3E,EAAAmtE,QAAe2J,yGClEf,SAASI,EAAaC,EAAsBtiE,GAC3C,OAAI04B,EAAA9Y,UAPL,SAA2B0iD,EAAsBtiE,GAGhD,sBAFcuiE,EAAOC,WAAW,OAAOC,OAAOH,GAAcI,OAAO,UAEnCC,EAAArK,QAAI9hD,WAAWxW,SAKvC4iE,CAAkBN,EAActiE,GAjBzC,SAAyBsiE,EAAsBtiE,GAC9C,GAAI6iE,EAAe,CAClB,MAAMC,EAAQP,EAAOC,WAAW,OAAOC,OAAOH,GAAcI,OAAO,OAAOxgC,OAAO,EAAG;CACpF,OAAOniC,EAAK+E,KAAK+9D,YAAyBC,KAASH,EAAArK,QAAI9hD,WAAWxW,UAGnE,OAAOD,EAAK+E,KAAKw9D,KAAiBK,EAAArK,QAAI9hD,WAAWxW,UAc1C+iE,CAAgBT,EAActiE,GA0NtC,SAAgBgjE,EAAuB9vE,EAAkB+vE,GACxD,OAAOC,EAAehwE,EAAK,sBAAuBA,EAAK,0BAA2B,KAAM+vE,EAAS/vE,EAAKiwE,SAGvG,SAAgBC,EAAgBlwE,EAAkB+vE,GACjD,OAAOC,EAAehwE,EAAK,kBAAmBA,EAAK,sBAAuB,KAAM+vE,GAGjF,SAAgBC,EAAeG,EAA8BC,EAAiCC,EAA0BN,EAAkBE,GACzI,MAAMK,EAAUF,GAAeD,EACzB75E,EAAOg8C,OAAOg+B,KAAcP,EAA6B,KAAnBM,GAE5C,OAAS/5E,KAAAA,EAAMi6E,QADHj6E,GAAOm/B,UAAU26C,GACFH,QAAAA,GAG5B,SAASO,EAAa30E,EAAyB+vB,GAC9C,IAAK/vB,EACJ,OAKD,MAAMswB,EAAWtf,EAAK/G,QAAQjK,GAE9B,OAAIgR,EAAKq7B,UAAUrsC,KAASswB,EACpBA,EAEAtf,EAAK/G,QAAQ8lB,EAAQK,IAAgB,YAAKL,EAAQ2Z,MAAO1pC,GAIlE,SAAgB40E,EAAiBzwE,EAAkB4rB,GAClD,OAAO4kD,EAAaxwE,EAAK,iBAAkB4rB,IAAY/e,EAAK/G,QAAQ+hC,EAAM2hB,uBAAuB59B,EAAQG,4DAhR1G,MAAM4jD,EAAgB/jD,QAAQK,IAAqB,sBAqDtCykD,EAiLZv5E,YAAoBw5E,EAA2BC,GAC9C,GADmBp5E,KAAAm5E,MAAAA,EAA2Bn5E,KAAAo5E,UAAAA,GACzChlD,QAAQK,IAAiB,YAAG,CAChC,MAAMtzB,EAAMk4E,EAAAjhC,iBAAiB,IAAIxzB,MAAQzK,QAAQ,eAAgB,IACjEia,QAAQK,IAAiB,YAAIpf,EAAK+E,KAAKpa,KAAK43E,aAAc,OAAQz2E,GAGnEnB,KAAKs5E,SAAWllD,QAAQK,IAAiB,YAnL1CjsB,WAAyB,OAAOxI,KAAKm5E,MAGrCI;AAAwB,OAAOlkE,EAAK88B,QAAQyf,EAAArQ,qBAAqBsQ,EAAS,KAE1E2nB,eAAyB,OAAOx5E,KAAKo5E,UAGrCK,cAAwB,OAxCzB,SAAoBD,EAAkBD,EAAiBG,GAGtD,OAAI1rC,EAAA9Y,UACCwkD,EACIrkE,EAAK+E,KAAK/E,EAAK88B,QAAQqnC,GAAW,SAAUG,EAAA/L,QAAQgM,uBAGrDvkE,EAAK+E,KAAKm/D,EAAS,UAAW,gBAIlCvrC,EAAA5Y,QACCskD,EACIrkE,EAAK+E,KAAK/E,EAAK88B,QAAQqnC,GAAW,SAAUG,EAAA/L,QAAQgM,mBAGrDvkE,EAAK+E,KAAKm/D,EAAS,UAAW,eAIlCG,EACIrkE,EAAK+E,KAAKm/D,EAAS,MAAO,QAG3BlkE,EAAK+E,KAAKm/D,EAAS,UAAW,eAeNM,CAAW75E,KAAKw5E,SAAUx5E,KAAKu5E,QAASv5E,KAAK05E,SAK5EjsB,eAAyB,OAAOoR,EAAGib,UAGnClC,mBACC,MAAMmC,EAAiB3lD,QAAQK,IAAqB,gBACpD,OAAIslD,EACI1kE,EAAK+E,KAAK2/D,EAAgB,aAG3Bd,EAAiBj5E,KAAKm5E,MAAO/kD,SAGrC4lD,kBAA4B,OAAOL,EAAA/L,QAAQ6J,SAE3CwC,iBAAuC,OAAON,EAAA/L,QAAQsM,QAGtDC,sBAAgC,OAAO9kE,EAAK+E,KAAKpa,KAAK43E,aAAc,QAGpEwC,sBAAgC,OAAO/kE,EAAK+E,KAAKpa,KAAKm6E,gBAAiB,iBAGvEE,wBAAkC,OAAOhlE,EAAK+E,KAAKpa,KAAKm6E,gBAAiB,iBAGzEG,2BAAqC,OAAOjlE,EAAK+E,KAAKpa,KAAKm6E,gBAAiB,oBAG5EI;AAAkD,OAAOZ,EAAA/L,QAAQ2M,sBAGjEC,wBAA8C,OAAOb,EAAA/L,QAAQ4M,kBAG7DC,yBAAmC,OAAOplE,EAAK+E,KAAKpa,KAAKm6E,gBAAiB,oBAG1EO,6BAAwC,QAAS16E,KAAKm5E,MAAMwB,yBAG5DC,iBAA2B,OAAOvlE,EAAK+E,KAAKpa,KAAK43E,aAAc,WAG/DiD,2BAAqC,OAAOxlE,EAAK+E,KAAKpa,KAAK46E,WAAY,mBAGvEE,6BAAoC,OAAOp5B,EAAAvC,IAAI3rB,KAAKne,EAAK+E,KAAKpa,KAAK43E,aAAc,eAGjFmD,wBAAkC,OAAO1lE,EAAK+E,KAAKpa,KAAK43E,aAAc,iBAGtEoD,4BACC,MAAMC,EAAWjC,EAAah5E,KAAKm5E,MAAM,0BAA2B/kD,SACpE,OAAI6mD,GAGI5lE,EAAKq7B,UAAUr7B,EAAK+E,KAAKw3C,EAAArQ,qBAAqBsQ,EAAS,IAAK,KAAM,eAK3EqpB,qBACC,MAAMD,EAAWjC,EAAah5E,KAAKm5E,MAAM,kBAAmB/kD,SAE5D,GAAI6mD,EACH,OAAOA,EAGR,MAAME,EAAmB/mD,QAAQK,IAAuB,kBACxD,GAAI0mD,EACH,OAAOA,EAGR,MAAMpB,EAAiB3lD,QAAQK,IAAqB,gBACpD,OAAIslD,EACI1kE,EAAK+E,KAAK2/D,EAAgB,cAG3B1kE,EAAK+E,KAAKpa,KAAKytD,SAAUksB,EAAA/L,QAAQ8J,eAAgB,cAIzD0D;AACC,MAAMl4E,EAAIlD,KAAKm5E,MAAMwB,yBACrB,GAAIz3E,EACH,MAAI,kBAAkB0lC,KAAK1lC,GACnBw+C,EAAAvC,IAAIrnC,MAAM5U,GAEXw+C,EAAAvC,IAAI3rB,KAAKne,EAAKq7B,UAAUxtC,IAMjCm4E,gCACC,MAAMn4E,EAAIlD,KAAKm5E,MAAMmC,mBACrB,GAAIp4E,EACH,MAAI,kBAAkB0lC,KAAK1lC,GACnBw+C,EAAAvC,IAAIrnC,MAAM5U,GAEXw+C,EAAAvC,IAAI3rB,KAAKne,EAAKq7B,UAAUxtC,IAKjCq4E,wBACC,GAAIv7E,KAAKm5E,MAAM,sBACd,OAAO,EAER,MAAMoC,EAAoBv7E,KAAKm5E,MAAM,qBACrC,GAAIoC,EAAmB,CACtB,GAAiC,iBAAtBA,EACV,OAAQA,GAET,GAAInsE,MAAMC,QAAQksE,IAAsBA,EAAkBj9E,OAAS,EAClE,OAAOi9E,EAGT,OAAO,EAGRC,yBAAoC,QAASx7E,KAAKm5E,MAAM,wBAExDsC,uBAAkC,QAASz7E,KAAKm5E,MAAM,sBAEtDuC,8BAAyC,QAAS17E,KAAKm5E,MAAM,+BAG7DwC,yBAAsD,OAAOrD,EAAuBt4E,KAAKm5E,MAAOn5E,KAAK05E,SAGrGkC,kBAAkC,OAAOlD,EAAgB14E,KAAKm5E,MAAOn5E,KAAK05E,SAE1EA,cAAyB,OAAQtlD,QAAQK,IAAgB,WACzD0jC,cAAyB,QAASn4D,KAAKm5E,MAAMhhB,QAC7CG,UAAgC,OAAOt4D,KAAKm5E,MAAM7gB,IAElDujB,WAAsB,QAAS77E,KAAKm5E,MAAM0C,KAE1CC;AAA+C,QAAS97E,KAAKm5E,MAAM2C,8BAEnEC,aAAwB,QAAS/7E,KAAKm5E,MAAM4C,OAG5CC,oBAA8B,OAAOrE,EAAa33E,KAAK43E,aAAc,QAGrEqE,sBAAgC,OAAOtE,EAAa33E,KAAK43E,aAAc,UAGvEsE,wBAA8C,OAAO9nD,QAAQK,IAAiC,kCAAKrrB,EAEnG+yE,qBAAgC,QAASn8E,KAAKm5E,MAAM,mBACpDiD,2BAAsC,QAASp8E,KAAKm5E,MAAM,0BAE1DkD,mBAAyC,OAAOr8E,KAAKm5E,MAAc,OACnEmD,oBAA+B,QAASt8E,KAAKm5E,MAAM,mBAxKnDvrC,GADCC,EAAAzlC,qCAMDwlC,GADCC,EAAAzlC,qCAMDwlC,GADCC,EAAAzlC,sCAIDwlC,GADCC,EAAAzlC,0CAeDwlC,GADCC,EAAAzlC,6CAIDwlC,GADCC,EAAAzlC,6CAIDwlC,GADCC,EAAAzlC,+CAIDwlC,GADCC,EAAAzlC,kDAIDwlC,GADCC,EAAAzlC,mDAIDwlC,GADCC,EAAAzlC;AAIDwlC,GADCC,EAAAzlC,gDAIDwlC,GADCC,EAAAzlC,oDAIDwlC,GADCC,EAAAzlC,wCAIDwlC,GADCC,EAAAzlC,kDAIDwlC,GADCC,EAAAzlC,oDAIDwlC,GADCC,EAAAzlC,+CAIDwlC,GADCC,EAAAzlC,mDAWDwlC,GADCC,EAAAzlC,4CAsBDwlC,GADCC,EAAAzlC,6DAaDwlC,GADCC,EAAAzlC,uDAmCDwlC,GADCC,EAAAzlC,gDAIDwlC,GADCC,EAAAzlC,yCAcDwlC,GADCC,EAAAzlC,2CAIDwlC,GADCC,EAAAzlC,6CAIDwlC,GADCC,EAAAzlC,+CAxKF3H,EAAAy4E,mBAAAA,EA2LAz4E,EAAA63E,uBAAAA,EAIA73E,EAAAi4E,gBAAAA,EAIAj4E,EAAA+3E,eAAAA,EAuBA/3E,EAAAw4E,iBAAAA;OCpQMsD,EAIL58E,cACCK,KAAK2B,QAGChC,IAAI6lB,EAAY7jB,GACtB66E,EAAO97E,GAAG+7E,EAAMxiC,SAASz0B,IACzBg3D,EAAO97E,GAAG+7E,EAAMtiC,SAASx4C,IACzB66E,EAAO97E,IAAIV,KAAK2B,KAAKb,eAAe0kB,GAAK,8CAEzCxlB,KAAK2B,KAAK6jB,GAAM7jB,EAGVhC,MAAM6lB,GACZ,OAAOxlB,KAAK2B,KAAKb,eAAe0kB,GAG1B7lB,GAAG6lB,GACT,OAAOxlB,KAAK2B,KAAK6jB,IAAO,MAIb/kB,EAAAi8E,SAAsB,IAAIH,+GC/C1B97E,EAAAk8E,YACZC,iBAAkB,iCAwCbC,EAOLl9E,cAHiBK,KAAA88E,mBAAqB,IAAI1zD,EAAA3F,QACjCzjB,KAAA+8E,kBAAmC/8E,KAAK88E,mBAAmB95D,MAGnEhjB,KAAKg9E,eAGCr9E,eAAew+C,EAAa8+B,GAClCj9E,KAAKg9E,YArBP,SAAqBx3D,GACpB,OAAIA,EAAGlnB,OAAS,GAAkC,MAA7BknB,EAAG9J,OAAO8J,EAAGlnB,OAAS,GACnCknB,EAAGtR,UAAU,EAAGsR,EAAGlnB,OAAS,GAE7BknB,EAiBW03D,CAAY/+B,IAAQ8+B,EACrCj9E,KAAK88E,mBAAmBp5D,KAAKy6B,GAGvBx+C,oBAAoBw+C,GAC1Bn+C,KAAK88E,mBAAmBp5D,KAAKy6B,GAGvBx+C,yBACN,OACCw9E,QAASn9E,KAAKg9E,cAMjB,MAAMI,EAA2B,IAAIP,EACrCtoD,EAASmoD,SAASv+C,IAAI19B,EAAAk8E,WAAWC,iBAAkBQ,kFC4UnD,SAAgBC,EAAgB/nE;AAE/B,OADUlG,MAAMC,QAAQiG,GAAmBA,EAAM,GAAaA,GAE7D,IAAK,UACJ,OAAO,EACR,IAAK,UACL,IAAK,SACJ,OAAO,EACR,IAAK,SACJ,MAAO,GACR,IAAK,QACJ,SACD,IAAK,SACJ,SACD,QACC,OAAO,MAQV,SAAgBgoE,EAAiB1wB,GAChC,OAAInsD,EAAA88E,0BAA0B30C,KAAKgkB,GAC3B+gB,EAAIG,SAAS,EAAmC,KAAoKlhB,QAEvJxjD,IAAjEo0E,EAAsBC,6BAA6B7wB,GAC/C+gB,EAAIG,SAAS,EAA6B,KAA+DlhB,GAE1G,sDA3aKnsD,EAAAk8E,YACZe,cAAe,qCAqEhB,SAAkBC,GACjBA,EAAAA,EAAA,YAAA,GAAA,cACAA,EAAAA,EAAA,OAAA,GAAA,SACAA,EAAAA,EAAA,SAAA,GAAA,WAHD,CAAkBl9E,EAAAk9E,qBAAAl9E,EAAAk9E,wBAgCLl9E,EAAAm9E,aAA2DC,cAAgBC,sBAC3Er9E,EAAAs9E,qBAAmEF,cAAgBC,sBACnFr9E,EAAAu9E,gBAA8DH,cAAgBC,sBAC9Er9E,EAAAw9E,kBAAgEJ,cAAgBC,sBAEhFr9E,EAAAy9E,4BAA8B,mCAC3C,MAAMC,EAAuBnwC,EAAA0uC,SAAS0B,GAA8BC,EAAA1B,WAAeC,wBAE7E0B,EAgBL3+E,cATiBK,KAAAu+E,uBAGAv+E,KAAAw+E,mBAAqB,IAAIp1D,EAAA3F;AACjCzjB,KAAAy+E,kBAAiCz+E,KAAKw+E,mBAAmBx7D,MAEjDhjB,KAAA0+E,0BAA+C,IAAIt1D,EAAA3F,QAC3DzjB,KAAA2+E,yBAA4C3+E,KAAK0+E,0BAA0B17D,MAGnFhjB,KAAK4+E,mCACJp5D,GAAI,mBACJmnD,MAAOgB,EAAIG,SAAS,EAA+B,MACnD+P,eAED79E,KAAK6+E,2BAA6B7+E,KAAK4+E,mCACvC5+E,KAAK8+E,2BAA8BjB,cAAgBC,qBAAuBiB,sBAAsB,EAAOC,aAAc,wCACrHh/E,KAAKi/E,2BACLj/E,KAAKk/E,mCACLl/E,KAAKm/E,iCAELhB,EAAqBiB,eAAe3+E,EAAAy9E,4BAA6Bl+E,KAAK8+E,2BAGhEn/E,sBAAsB0/E,EAAmCC,GAAoB,GACnFt/E,KAAKu/E,wBAAwBF,GAAgBC,GAGvC3/E,uBAAuB6/E,EAAsCF,GAAoB,GACvF,MAAMzB,KACN2B,EAAeh+E,QAAQ69E,IACtBxB,EAAWh+E,QAAQG,KAAKy/E,8BAA8BJ,EAAeC,IACrEt/E,KAAK6+E,0BAA0Bh/E,KAAKw/E,GACpCr/E,KAAK0/E,0BAA0BL,GAC/Br/E,KAAK2/E,6CAA6CN,KAGnDr/E,KAAKw+E,mBAAmB96D;AACxB1jB,KAAK0+E,0BAA0Bh7D,KAAKm6D,GAG9Bl+E,yBAAyB6/E,GAC/B,MAAM3B,KACA+B,EAA2BP,IAChC,GAAIA,EAAcxB,WACjB,IAAK,MAAM18E,KAAOk+E,EAAcxB,WAQ/B,OAPAA,EAAWh+E,KAAKsB,UAETnB,KAAKi/E,wBAAwB99E,UAC7BnB,KAAK8+E,0BAA0BjB,WAAY18E,UAG3CV,EAAAm9E,YAAYC,WAAW18E,GACtBk+E,EAAcxB,WAAW18E,GAAKi3E,OACrC,KAAA,SACQ33E,EAAAs9E,oBAAoBF,WAAW18E,GACtC,MACD,KAAA,SACQV,EAAAu9E,eAAeH,WAAW18E,GACjC,MACD,KAAA,SACQV,EAAAw9E,iBAAiBJ,WAAW18E,GAKnCk+E,EAAcQ,OACjBR,EAAcQ,MAAMr+E,QAAQ2T,GAAQyqE,EAAwBzqE,KAG9D,IAAK,MAAMkqE,KAAiBG,EAAgB,CAC3CI,EAAwBP,GACxB,MAAMvvE,EAAQ9P,KAAK6+E,0BAA0B30E,QAAQm1E,IACtC,IAAXvvE,GACH9P,KAAK6+E,0BAA0B50E,OAAO6F,EAAO,GAI/CquE,EAAqBiB,eAAe3+E,EAAAy9E,4BAA6Bl+E,KAAK8+E,2BACtE9+E,KAAKw+E,mBAAmB96D,OACxB1jB,KAAK0+E,0BAA0Bh7D,KAAKm6D,GAG9Bl+E,8BAA8BmgF,GACpC,MAAMjC,KAEN,IAAK,MAAMkC,KAAwBD,EAClC,IAAK,MAAM3+E,KAAO4+E,EAAqBC,SAAU,CAChD,MAAMjwD,EAAegwD,EAAqBC,SAAS7+E,GACnD,GAAIV,EAAA88E,0BAA0B30C,KAAKznC,IAAgC,iBAAjB4uB,EAA2B,CAC5E,MAAMkwD,GACL3qE,KAAM,SACNs4D,QAAS79C,EACTwY,YAAaolC,EAAIG,SAAS,EAAgC,KAAgE3sE;AAC1H++E,KAAMz/E,EAAAy9E,6BAEPz9E,EAAAm9E,YAAYC,WAAW18E,GAAO8+E,EAC9BjgF,KAAK4+E,kCAAkCf,WAAY18E,GAAO8+E,EAC1DjgF,KAAKi/E,wBAAwB99E,GAAO8+E,EACpCpC,EAAWh+E,KAAKsB,IAKnBnB,KAAKw+E,mBAAmB96D,OACxB1jB,KAAK0+E,0BAA0Bh7D,KAAKm6D,GAG9Bl+E,gCAAgCmgF,GACtC,MAAMjC,KACN,IAAK,MAAMkC,KAAwBD,EAClC,IAAK,MAAM3+E,KAAO4+E,EAAqBC,SACtCnC,EAAWh+E,KAAKsB,UACTV,EAAAm9E,YAAYC,WAAW18E,UACvBnB,KAAK4+E,kCAAkCf,WAAY18E,UACnDnB,KAAKi/E,wBAAwB99E,GAGtCnB,KAAKw+E,mBAAmB96D,OACxB1jB,KAAK0+E,0BAA0Bh7D,KAAKm6D,GAG9Bl+E,oCAAoC6/E,GAC1Cx/E,KAAKw+E,mBAAmB96D,OAGlB/jB,4BAA4B4+E,GAClCv+E,KAAKu+E,oBAAoB1+E,QAAQ0+E,GACjCv+E,KAAKmgF,mCAGExgF,8BAA8B0/E,EAAmCC,GAAoB,EAAMlH,EAAA,EAAuDgI,GAAuB,GAChLhI,EAAQiI,EAAMhmC,kBAAkBglC,EAAcjH,OAASA,EAAQiH,EAAcjH,MAC7EgI,EAAcf,EAAce,aAAeA,EAC3C,IAAIE,KACAzC,EAAawB,EAAcxB,WAC/B,GAAIA,EACH,IAAK,IAAI18E,KAAO08E,EAAY,CAC3B,IAAIj9E,EACJ,GAAI0+E,IAAa1+E,EAAU08E,EAAiBn8E,IAAO,CAClDkH,QAAQC,KAAK1H,UACNi9E,EAAW18E,GAClB,SAGD,IAAIyrD,EAAWixB,EAAW18E,GACtB4uB,EAAe68B,EAASghB,QACxByS,EAAMjmC,YAAYrqB,KACrB68B,EAASghB,QAAUyP,EAAgBzwB,EAASt3C,OAGzC8qE,IACHxzB,EAASwzB,aAAc;AAGpB3/E,EAAA88E,0BAA0B30C,KAAKznC,GAClCyrD,EAASwrB,WAAQhvE,EAEjBwjD,EAASwrB,MAAQiI,EAAMhmC,kBAAkBuS,EAASwrB,OAASA,EAAQxrB,EAASwrB,OAKzEyF,EAAW18E,GAAKL,eAAe,aAAgB+8E,EAAW18E,GAAKo/E,UAKlEvgF,KAAKi/E,wBAAwB99E,GAAO08E,EAAW18E,GAGhDm/E,EAAazgF,KAAKsB,KAPjBnB,KAAKk/E,gCAAgC/9E,GAAO08E,EAAW18E,UAChD08E,EAAW18E,IASrB,IAAIq/E,EAAWnB,EAAcQ,MAC7B,GAAIW,EACH,IAAK,IAAIrrE,KAAQqrE,EAChBF,EAAazgF,QAAQG,KAAKy/E,8BAA8BtqE,EAAMmqE,EAAUlH,EAAOgI,IAGjF,OAAOE,EAGR3gF,oBACC,OAAOK,KAAK6+E,0BAGbl/E,6BACC,OAAOK,KAAKi/E,wBAGbt/E,qCACC,OAAOK,KAAKk/E,gCAGLv/E,0BAA0B0/E,GACjC,SAASoB,EAASpB,GACjB,IAAIxB,EAAawB,EAAcxB,WAC/B,GAAIA,EACH,IAAK,MAAM18E,KAAO08E,EAEjB,OADAp9E,EAAAm9E,YAAYC,WAAW18E,GAAO08E,EAAW18E,GACjC08E,EAAW18E,GAAKi3E,OACvB,KAAA,EACC33E,EAAAs9E,oBAAoBF,WAAW18E,GAAO08E,EAAW18E,GACjD,MACD,KAAA,EACCV,EAAAu9E,eAAeH,WAAW18E,GAAO08E,EAAW18E,GAC5C,MACD,KAAA,EACCV,EAAAw9E,iBAAiBJ,WAAW18E,GAAO08E,EAAW18E,GAKlD,IAAIq/E,EAAWnB,EAAcQ,MACzBW,GACHA,EAASh/E,QAAQi/E,GAGnBA,EAASpB,GAGF1/E,6CAA6C0/E,GAChDA,EAAc75D,KAAOk7D,IACxB1gF,KAAK+3E,OAAOsH;AACZlB,EAAqBiB,eAAe3+E,EAAAy9E,4BAA6Bl+E,KAAK8+E,4BAIhEn/E,mCACP,IAAIm+E,EAAiCr9E,EAAAm9E,YAAYE,kBAAkB99E,KAAK2gF,yBACnE7C,IACJA,GACCxoE,KAAM,SACNizB,YAAaolC,EAAIG,SAAS,EAAuC,MACjEkR,aAAc,+CACdkB,KAAMz/E,EAAAy9E,qCAIDz9E,EAAAm9E,YAAYE,kBAAkB99E,KAAK2gF,gCACnClgF,EAAAs9E,oBAAoBD,kBAAkB99E,KAAK2gF,gCAC3ClgF,EAAAu9E,eAAeF,kBAAkB99E,KAAK2gF,gCACtClgF,EAAAw9E,iBAAiBH,kBAAkB99E,KAAK2gF,yBAE/C3gF,KAAKm/E,iCAEL1+E,EAAAm9E,YAAYE,kBAAkB99E,KAAK2gF,yBAA2B7C,EAC9Dr9E,EAAAs9E,oBAAoBD,kBAAkB99E,KAAK2gF,yBAA2B7C,EACtEr9E,EAAAu9E,eAAeF,kBAAkB99E,KAAK2gF,yBAA2B7C,EACjEr9E,EAAAw9E,iBAAiBH,kBAAkB99E,KAAK2gF,yBAA2B7C,EAEnE99E,KAAKw+E,mBAAmB96D,OAGjB/jB,OAAO0/E,GACd,IAAIxB,EAAawB,EAAcxB;CAC/B,GAAIA,EACH,IAAK,IAAI18E,KAAO08E,EACXA,EAAW18E,GAAKi/E,cACnBpgF,KAAK8+E,0BAA0BjB,WAAY18E,GAAOnB,KAAKy9E,6BAA6Bt8E,IAIvF,IAAIq/E,EAAWnB,EAAcQ,MACzBW,GACHA,EAASh/E,QAAQo/E,GAAW5gF,KAAK+3E,OAAO6I,IAIlCjhF,iCACPK,KAAK2gF,wBAA0B3gF,KAAKu+E,oBAAoBjgF,OAASuiF,EAAmC1mE,QAAQ,OAAQna,KAAKu+E,oBAAoB7sE,IAAI65B,GAAcwa,EAAQvR,aAAajJ,GAAY,GAAOle,QAAQjT,KAAK,MAAQ0mE,GAI9N,MAAMJ,EAA6B,WAC7BI,EAAoB,YACpBD,EAAqC,gBAC9BpgF,EAAA88E,0BAA4B,IAAIvoC,OAAO8rC,GAEpDrgF,EAAA48E,gBAAAA,EAoBA,MAAMG,EAAwB,IAAIc,EAClCtwC,EAAA0uC,SAASv+C,IAAI19B,EAAAk8E,WAAWe,cAAeF,GAEvC/8E,EAAA68E,iBAAAA,EAUA78E,EAAAsgF,UAAA,WACC,MAAMC,KACA/B,EAA0BzB,EAAsBC,6BACtD,IAAK,MAAMt8E,KAAOJ,OAAO4nC,KAAKs2C,GAC7B+B,EAAO7/E,GAAO89E,EAAwB99E,GAAKi3E,MAI5C,OAFA4I,EAAe,OAAC,EAChBA,EAAa,KAAC,EACPA,kFCpSR,SAAgBC,EAAapD,EAA6CqD,GACzE,MAAMvnE,EAAO5Y,OAAOc,OAAO,MAE3B,IAAK,IAAIV,KAAO08E,EACfsD,EAAexnE,EAAMxY,EAAK08E,EAAW18E,GAAM+/E,GAG5C,OAAOvnE,EAGR,SAAgBwnE,EAAeC,EAAuBjgF,EAAaR,EAAYugF,GAC9E,MAAMxoE,EAAWvX,EAAIiK,MAAM,KACrB+H,EAAOuF,EAASxL,MAEtB,IAAIyiE,EAAOyR,EACX,IAAK,IAAIhjF,EAAI,EAAGA,EAAIsa,EAASpa,OAAQF,IAAK,CACzC,IAAI8E,EAAIwV,EAASta,GACb+Q,EAAMwgE,EAAKzsE,GACf,cAAeiM,GACd,IAAK,YACJA,EAAMwgE,EAAKzsE,GAAKnC,OAAOc,OAAO,MAC9B;CACD,IAAK,SACJ,MACD,QAEC,YADAq/E,cAA6B//E,QAAUuX,EAAS3Y,MAAM,EAAG3B,EAAI,GAAGgc,KAAK,WAAWvC,KAAKiF,UAAU3N,MAGjGwgE,EAAOxgE,EAGY,iBAATwgE,EACVA,EAAKx8D,GAAQxS,EAEbugF,cAA6B//E,QAAUuX,EAAS0B,KAAK,WAAWvC,KAAKiF,UAAU6yD,MASjF,SAAS0R,EAAsBC,EAAgB5oE,GAC9C,MAAMnX,EAAQmX,EAASoP,QACvB,GAAwB,IAApBpP,EAASpa,QAMb,IAA+C,IAA3CyC,OAAO4nC,KAAK24C,GAAWp3E,QAAQ3I,GAAe,CACjD,MAAMZ,EAAQ2gF,EAAU//E,GACH,iBAAVZ,GAAuByO,MAAMC,QAAQ1O,KAC/C0gF,EAAsB1gF,EAAO+X,GACK,IAA9B3X,OAAO4nC,KAAKhoC,GAAOrC,eACfgjF,EAAU//E,iBATZ+/E,EAAU//E,GAkBnB,SAAgBggF,EAAyBC,EAAaC,EAAqB1xD,GAY1E,MACM5xB,EAZN,SAAuBqjF,EAAansE,GACnC,IAAIzC,EAAU4uE,EACd,IAAK,MAAME,KAAarsE,EAAM,CAC7B,GAAuB,iBAAZzC,GAAoC,OAAZA,EAClC,OAEDA,EAAUA,EAAQ8uE,GAEnB,OAAU9uE,EAII+uE,CAAcH,EADhBC,EAAYr2E,MAAM,MAG/B,YAAyB,IAAXjN,EAAyB4xB,EAAe5xB,EAGvD,SAAgBklB,EAAMksB,EAAWpR,EAAUue,GAC1C37C,OAAO4nC,KAAKxK,GAAK38B,QAAQL,IACpBA,KAAOouC,EACN8wC,EAAMlmC,SAAS5K,EAAKpuC,KAASk/E,EAAMlmC,SAAShc,EAAIh9B,IACnDkiB,EAAMksB,EAAKpuC,GAAMg9B,EAAIh9B,GAAMu7C,GACjBA,IACVnN,EAAKpuC,GAAOg9B,EAAIh9B,IAGjBouC,EAAKpuC,GAAOg9B,EAAIh9B,KAsBnB,SAAgBygF,EAA0BzgF,GACzC,OAAOA,EAAI+S,UAAU,EAAG/S,EAAI7C,OAAS,oDApQzBmC,EAAAohF,sBAAwBpS,EAAA3nE,gBAAuC,wBAE5ErH,EAAAqhF,yBAAA,SAAyClhE;AACxC,OAAOA,GACc,iBAAVA,KACLA,EAAMmhE,oBAA0D,iBAA7BnhE,EAAMmhE,uBACzCnhE,EAAMkQ,UAAYlQ,EAAMkQ,oBAAoB4wB,EAAAvC,OAQnD,SAAkB6iC,GACjBA,EAAAA,EAAA,KAAA,GAAA,OACAA,EAAAA,EAAA,UAAA,GAAA,YACAA,EAAAA,EAAA,iBAAA,GAAA,mBACAA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,OAAA,GAAA,SALD,CAAkBvhF,EAAAuhF,sBAAAvhF,EAAAuhF,yBAOlBvhF,EAAAwhF,4BAAA,SAA4CC,GAC3C,OAAQA,GACP,KAAA,EAA+B,MAAO,OACtC,KAAA,EAAoC,MAAO,YAC3C,KAAA,EAA2C,MAAO,mBAClD,KAAA,EAAkC,MAAO,UACzC,KAAA,EAAiC,MAAO,WAkF1CzhF,EAAAoL,QAAA,SAAwB3K,EAA2B8N,GAClD,MAAMhB,EAAQgB,EAAG25B,KAAK75B,OAAO3N,IAAmC,IAA5BD,EAAKynC,KAAKz+B,QAAQ/I,IAChD4M,EAAU7M,EAAKynC,KAAK75B,OAAO3N,IAAiC,IAA1B6N,EAAG25B,KAAKz+B,QAAQ/I,IAClDghF,KAEN,IAAK,MAAMhhF,KAAOD,EAAKynC,KAAM,CAC5B,MAAMy5C,EAASb,EAAsBrgF,EAAKmhF,SAAUlhF,GAC9CmhF,EAASf,EAAsBvyE,EAAGqzE,SAAUlhF,GAC7C+5C,EAAQl2C,OAAOo9E,EAAQE,IAC3BH,EAAQtiF,KAAKsB,GAIf,OAAS6M,MAAAA,EAAOD,QAAAA,EAASo0E,QAAAA,IAG1B1hF,EAAA8hF,YAAA,SAA4BxkB,EAAUmjB,GACrC,MAAMsB,KACAvD,EAA0BjxC,EAAA0uC,SAAS0B,GAA2BqE,EAAA9F,WAAWe,eAAeD,6BAC9F,IAAK,MAAMt8E,KAAOJ,OAAO4nC,KAAKo1B,GAC7B,GAAI0kB,EAAAlF,0BAA0B30C,KAAKznC,GAAM,CACxC,MAAMuhF,KACN,IAAK,MAAMC,KAAoB5kB,EAAI58D,GAC9B89E,EAAwB0D,IAAqB1D,EAAwB0D,GAAkBvC,cAC1FsC,EAAYC,GAAoB5kB,EAAI58D,GAAKwhF;CAG3CH,EAAU3iF,MACT+iF,aAAchB,EAA0BzgF,GAAKk8B,QAC7CglD,SAAUpB,EAAayB,EAAaxB,KAIvC,OAAOsB,GAGR/hF,EAAAwgF,aAAAA,EAUAxgF,EAAA0gF,eAAAA,EA4BA1gF,EAAAoiF,oBAAA,SAAoCvB,EAAgBngF,GAEnDkgF,EAAsBC,EADLngF,EAAIiK,MAAM,OA0B5B3K,EAAA8gF,sBAAAA,EAkBA9gF,EAAA4iB,MAAAA,EAcA5iB,EAAAqiF,qBAAA,WACC,MAAMjF,EAAa7vC,EAAA0uC,SAAS0B,GAA2BqE,EAAA9F,WAAWe,eAAeD,6BACjF,OAAO18E,OAAO4nC,KAAKk1C,IAGpBp9E,EAAAsiF,iBAAA,WACC,MAAMC,EAAqBjiF,OAAOc,OAAO,MACnCg8E,EAAa7vC,EAAA0uC,SAAS0B,GAA2BqE,EAAA9F,WAAWe,eAAeD,6BAEjF,IAAK,IAAIt8E,KAAO08E,EAEfsD,EAAe6B,EAAe7hF,EADlB08E,EAAW18E,GAAKysE,QACchtE,GAAWyH,QAAQmB,uCAAuC5I,MAGrG,OAAOoiF,GAGRviF,EAAAmhF,0BAAAA,EAIAnhF,EAAAwiF,0BAAA,SAA0ClB,GACzC,UAAWA,MAGZthF,EAAAyiF,wBAAA,SAA2CC,EAA6CC,EAA4BC,GACnH,MAAM3Y,EAAUyY,EAAqBG,QAAWF,GAC1CG,EAAgBJ,EAAqBG,QAAWD,GAEtD,YAA4B,IAAjB3Y,EAAQ8Y,WAAqD,IAAtB9Y,EAAQ+Y,gBAAgE,IAA5B/Y,EAAQgZ,gBAC9FhZ,EAAQ/pE,WACyB,IAAvB4iF,EAAcC,WAA2D,IAA5BD,EAAcE,gBAAsE,IAAlCF,EAAcG,gBACvHH,EAAc5iF,MAEd+pE,EAAQkD;wIC7QjB,IAAa+V,QAeZhkF,YACC6hF,EACyCoC,GAAA5jF,KAAA4jF,sBAAAA,EALlC5jF,KAAA6jF,gBACA7jF,KAAA8jF,oBAMP9jF,KAAK+jF,UAAYvC,EAAOwC,SACxBhkF,KAAKikF,kBAAoBzC,EAAO0C,kBAAoB71E,QAAQC,YAC5DtO,KAAKmkF,UAAY3C,EAAO4C,aACxBpkF,KAAKqkF,YAAa,EAGlBrkF,KAAK8jF,kBAAoB,sCAEzB,IAAK,IAAIQ,KAAWtkF,KAAKmkF,UACxBnkF,KAAK8jF,iBAAiBjkF,KAAK,IAAIm1C,OAAOuD,EAAAjG,uBAAuBgyC,GAAU,OAGpEtkF,KAAK4jF,wBACR5jF,KAAKukF,mBACLvkF,KAAK4jF,sBAAsBY,yBAAyBxkF,KAAKukF,iBAAkBvkF,KAAMA,KAAK6jF,cAMtF7jF,KAAKykF,UAAU,eAAiBC,MAAO1kF,KAAKqkF,aAE5CrkF,KAAKikF,kBAAkBr1E,KAAK3N,IAC3B,MAAM0jF,EAAa,eAAe/7C,KAAK3nC,EAAO,qBAO9CjB,KAAKykF,UAAU,qBAAuBG,mBAAoBD,OAKrDhlF,mBACP,MAAM6hF,EAASxhF,KAAK4jF,sBAAsBjR,SAAckS,GACxD7kF,KAAKqkF,WAAa7C,EAASA,EAAOsD,gBAAkB9kF,KAAKqkF,WAG1DU;AACC,OAAO/kF,KAAKqkF,WAGb1kF,mBACC,OAAOK,KAAKikF,kBAAkBr1E,KAAK3N,IAMlC,OAAS+jF,UAJO/jF,EAAkB,UAIdgkF,WAHHhkF,EAAO,qBAGQikF,UAFhBjkF,EAAO,uBAMzBtB,UACCK,KAAK6jF,aAAe1/D,EAAA3D,QAAQxgB,KAAK6jF,cAGlClkF,UAAU4lB,EAAmB5jB,EAAuBwjF,GAEnD,OAAKnlF,KAAKqkF,WAIHrkF,KAAKikF,kBAAkBr1E,KAAK3N,IAGlCU,EAAOknE,EAAArsB,MAAM76C,EAAMV,GAGnBU,EAAOknE,EAAA9rB,eAAep7C,EAAMhB,IAC3B,GAAqB,iBAAVA,EACV,OAAOX,KAAKolF,aAAazkF,EAAOwkF,KAKlCnlF,KAAK+jF,UAAUzrB,IAAI/yC,EAAW5jB,IAE5BwJ,IAEF9C,QAAQmB,MAAM2B,KApBPkD,QAAQC,aAAQlF,GAwBjBzJ,aAAamK,EAAeq7E,GACnC,IAAIE,EAAev7E,EAEnB,GAAIq7E,EAAoB,CACvB,MAAMG,KACN,IAAK,IAAIpwC,KAAUl1C,KAAK8jF,iBACvB,OAAa,CACZ,MAAM3lF,EAAS+2C,EAAOxM,KAAK5+B,GAC3B,IAAK3L,EACJ,MAEDmnF,EAAezlF,MAAM1B,EAAO2R,MAAOolC,EAAOC,YAI5C,MAAMowC,EAAmB,kDACnBC,EAAY,sFAClB,IAAIrwC,EAAY,EAGhB,IAFAkwC,EAAe,KAEF,CACZ,MAAMlnF,EAASqnF,EAAU98C,KAAK5+B,GAC9B,IAAK3L,EACJ,OAGIonF,EAAiB38C,KAAKzqC,EAAO,KAAOmnF,EAAe1qC,MAAM,EAAE12C,EAAGmpC,KAAOlvC,EAAO2R,MAAQ5L,GAAK/F,EAAO2R,OAASu9B,KAC7Gg4C,GAAgBv7E,EAAMoK,UAAUihC,EAAWh3C,EAAO2R,OAAS,6BAC3DqlC,EAAYqwC,EAAUrwC,WAGpBA,EAAYrrC,EAAMxL,SACrB+mF,GAAgBv7E,EAAM0tC,OAAOrC,IAK/B,IAAK,IAAID,KAAUl1C,KAAK8jF,iBACvBuB,EAAeA,EAAalrE,QAAQ+6B,EAAQ;CAE7C,OAAOmwC,IA/ID1B,EAAA8B,sBAAwB,gBACxB9B,EAAA+B,qBAAuB,eAHlB/B,EAAgB/1C,GAiB1B+3C,EAAA,EAAAlW,EAAAV,SAAS6W,EAAA/D,yBAjBC8B,GAAAljF,EAAAkjF,iBAAAA,EAsJb,MAAMkB,EAAuB,YAE7B72C,EAAA0uC,SAAS0B,GAA2BqE,EAAA9F,WAAWe,eAAemI,uBAC7DrgE,GAAMq/D,EACNiB,MAAS,IACTxwE,KAAQ,SACRq3D,MAASkB,EAAAC,SAAS,EAA+B,MACjD+P,YACCkI,6BACCzwE,KAAQ,UACRizB,YAAeslC,EAAAC,SAAS,EAA6B,MACrDF,SAAW,EACXoY,MAAS,uFCIZ,SAAgBC,EAAuBC,EAAqC/C,GAC3E,OAAOA,EAAqBqB,yBAAyBxhE,IACpC,IAAZA,EAAMqK,SAOT64D,EAAiBzB,UAAU,uBAC1B0B,oBAAqBP,EAAA3D,4BAA4Bj/D,EAAMqK,QACvD+4D,kBAoCJ,SAAqBzlF,GACpB,IAAKA,EACJ,SAED,MAAMxC,KAEN,OADAkoF,EAASloF,EAAQ,GAAIwC,GACdxC,EA1CemoF,CAAYtjE,EAAMujE,gBAQtCL,EAAiBzB,UAAU,6BAC1B0B,oBAAqBP,EAAA3D,4BAA4Bj/D,EAAMqK,QACvDm5D,oBA4CJ,SAAuB7lF,EAAegoC,GACrC,IAAKhoC,EACJ,SAGD,OAAOgoC,EAAKp4B,OAAO,CAAChF,EAAOpK,KAC1B,MAAMyC,EAAIzC,EAAIiK,MAAM,KAClBmF,OAAO,CAACouD,EAAK3lD,IAAM2lD,GAAsB,iBAARA,EAAmBA,EAAI3lD,QAAK5P,EAAWzI,GAI1E,YAHiB,IAANiD,GACV2H,EAAM1L;AAAOF,CAACwB,GAAMyC,IAEd2H,OAvDgBk7E,CAAczjE,EAAMujE,aAAcG,QAmC3D,SAASL,EAASloF,EAAkB6wD,EAAgBruD,GAC/CA,GAA0B,iBAAVA,IAAuByO,MAAMC,QAAQ1O,GACxDI,OAAO4nC,KAAKhoC,GACVa,QAAQL,GAAOklF,EAASloF,EAAQ6wD,KAAYA,KAAU7tD,IAAQA,EAAKR,EAAMQ,KAE3EhD,EAAO0B,KAAKmvD,oDA9ODvuD,EAAAkmF,qBAAuB,UAEnChnF,UAAU4lB,EAAmB5jB,GAC5B,OAAO0M,QAAQC,aAAQlF,GAGxBzJ,mBACC,OAAO0O,QAAQC,SACd22E,WAAY,uBACZD,UAAW,sBACXE,UAAW,0BAUdzkF,EAAAmmF,iBAAA,YAAoCC,GACnC,OACCvuB,IAAK,CAACt5D,EAAG0hB,IAAMmmE,EAAUrlF,QAAQqB,GAAKA,EAAEy1D,IAAIt5D,EAAG0hB,IAC/CF,QAAS,IAAMnS,QAAQ8Z,IAAI0+D,EAAUn1E,IAAI7O,GAAKA,EAAE2d,cAIrC/f,EAAAqmF,cAAqCxuB,IAAK,IAAM,KAAM93C,QAAS,IAAMnS,QAAQC,QAAQ,OAGlG,IAAay4E,QAGZpnF,YAA0CqnF,GAAAhnF,KAAAgnF,YAAAA,EADlChnF,KAAAinF,sBAAwB,2DAGhCtnF,UACC,OAAO0O,QAAQC,aAAQlF,GAGxBzJ,IAAI4lB,EAAmB5jB,GACtB,MAAMulF,KACNnmF,OAAO4nC,KAAKhnC,GAAMH,QAAQL,IACpBnB,KAAKinF,sBAAsBr+C,KAAKznC,KACpC+lF,EAAa/lF,GAAOQ,EAAKR,MAG3BnB,KAAKgnF,YAAYxnC,mBAAmBj6B,IAAa2hE,KAhBtCH,EAAWn5C,GAGV+3C,EAAA,EAAAjQ,EAAA9B,cAHDmT,GAAAtmF,EAAAsmF,YAAAA;CAsCb,MAAML,GACL,oBACA,oBACA,kBACA,oBACA,uBACA,qBACA,gBACA,wBACA,iBACA,oBACA,sBACA,2BACA,0BACA,8BACA,yBACA,sBACA,kCACA,2BACA,4CACA,kCACA,kBACA,wBACA,wBACA,qCACA,6BACA,0BACA,+BACA,gCACA,8BACA,6BACA,2BACA,sBACA,oBACA,sBACA,uBACA,oCACA,iCACA,2CACA,4BACA,iCACA,8BACA,0BACA,yBACA,2BACA,uBACA,4BACA,8BACA,4BACA,6BACA,wBACA,oCACA,qBACA,wBACA,uBACA,mCACA,0BACA,iCACA,4BACA,6BACA,kBACA,iBACA,6BACA,uBACA,qBACA,qBACA,4BACA,oBACA,qBACA,sBACA,yBAEA,sBACA,uBACA,yBACA,8BACA,2BACA,+BACA,wBACA,qBACA,0BACA,iBACA,sBACA,iBACA,YACA,gBACA,+BACA,kBACA,cACA,sBACA,6BACA,gCACA,sBACA,mBACA,iCACA,8BACA,wBACA,mBACA,iCACA,8CACA,4BACA,yCACA,mCACA,6BACA,0BACA,8BACA;CAGDjmF,EAAAwlF,uBAAAA,EA2BAxlF,EAAA0mF,qBAAA,SAAqCjB,EAAqCkB,GACzE,OAAOA,EAAkBC,uBAAuBrkE,IAC/B,IAAZA,EAAMqK,QAAoCrK,EAAMskE,aAMnDpB,EAAiBzB,UAAU,qBAC1B8C,SAAUvkE,EAAMskE,YAAY51E,IAAI81E,KAC/BrmF,IAAKqmF,EAAQrmF,IACbwyB,QAAS6zD,EAAQ7zD,QACjB40B,KA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","file":"issueReporterMain.js","sourcesContent":["}).call(this);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Represents a window in a possible chain of iframes\n */\nexport interface IWindowChainElement {\n\t/**\n\t * The window object for it\n\t */\n\twindow: Window;\n\t/**\n\t * The iframe element inside the window.parent corresponding to window\n\t */\n\tiframeElement: HTMLIFrameElement | null;\n}\n\nlet hasDifferentOriginAncestorFlag: boolean = false;\nlet sameOriginWindowChainCache: IWindowChainElement[] | null = null;\n\nfunction getParentWindowIfSameOrigin(w: Window): Window | null {\n\tif (!w.parent || w.parent === w) {\n\t\treturn null;\n\t}\n\n\t// Cannot really tell if we have access to the parent window unless we try to access something in it\n\ttry {\n\t\tlet location = w.location;\n\t\tlet parentLocation = w.parent.location;\n\t\tif (location.protocol !== parentLocation.protocol || location.hostname !== parentLocation.hostname || location.port !== parentLocation.port) {\n\t\t\thasDifferentOriginAncestorFlag = true;\n\t\t\treturn null;\n\t\t}\n\t} catch (e) {\n\t\thasDifferentOriginAncestorFlag = true;\n\t\treturn null;\n\t}\n\n\treturn w.parent;\n}\n\nfunction findIframeElementInParentWindow(parentWindow: Window, childWindow: Window): HTMLIFrameElement | null {\n\tlet parentWindowIframes = parentWindow.document.getElementsByTagName('iframe');\n\tlet iframe: HTMLIFrameElement;\n\tfor (let i = 0, len = parentWindowIframes.length; i < len; i++) {\n\t\tiframe = parentWindowIframes[i];\n\t\tif (iframe.contentWindow === childWindow) {\n\t\t\treturn iframe;\n\t\t}\n\t}\n\treturn null;\n}\n\nexport class IframeUtils {\n\n\t/**\n\t * Returns a chain of embedded windows with the same origin (which can be accessed programmatically).\n\t * Having a chain of length 1 might mean that the current execution environment is running outside of an iframe or inside an iframe embedded in a window with a different origin.\n\t * To distinguish if at one point the current execution environment is running inside a window with a different origin, see hasDifferentOriginAncestor()\n\t */\n\tpublic static getSameOriginWindowChain(): IWindowChainElement[] {\n\t\tif (!sameOriginWindowChainCache) {\n\t\t\tsameOriginWindowChainCache = [];\n\t\t\tlet w: Window | null = window;\n\t\t\tlet parent: Window | null;\n\t\t\tdo {\n\t\t\t\tparent = getParentWindowIfSameOrigin(w);\n\t\t\t\tif (parent) {\n\t\t\t\t\tsameOriginWindowChainCache.push({\n\t\t\t\t\t\twindow: w,\n\t\t\t\t\t\tiframeElement: findIframeElementInParentWindow(parent, w)\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tsameOriginWindowChainCache.push({\n\t\t\t\t\t\twindow: w,\n\t\t\t\t\t\tiframeElement: null\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tw = parent;\n\t\t\t} while (w);\n\t\t}\n\t\treturn sameOriginWindowChainCache.slice(0);\n\t}\n\n\t/**\n\t * Returns true if the current execution environment is chained in a list of iframes which at one point ends in a window with a different origin.\n\t * Returns false if the current execution environment is not running inside an iframe or if the entire chain of iframes have the same origin.\n\t */\n\tpublic static hasDifferentOriginAncestor(): boolean {\n\t\tif (!sameOriginWindowChainCache) {\n\t\t\tthis.getSameOriginWindowChain();\n\t\t}\n\t\treturn hasDifferentOriginAncestorFlag;\n\t}\n\n\t/**\n\t * Returns the position of `childWindow` relative to `ancestorWindow`\n\t */\n\tpublic static getPositionOfChildWindowRelativeToAncestorWindow(childWindow: Window, ancestorWindow: any) {\n\n\t\tif (!ancestorWindow || childWindow === ancestorWindow) {\n\t\t\treturn {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t};\n\t\t}\n\n\t\tlet top = 0, left = 0;\n\n\t\tlet windowChain = this.getSameOriginWindowChain();\n\n\t\tfor (const windowChainEl of windowChain) {\n\n\t\t\tif (windowChainEl.window === ancestorWindow) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (!windowChainEl.iframeElement) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tlet boundingRect = windowChainEl.iframeElement.getBoundingClientRect();\n\t\t\ttop += boundingRect.top;\n\t\t\tleft += boundingRect.left;\n\t\t}\n\n\t\treturn {\n\t\t\ttop: top,\n\t\t\tleft: left\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Throws an error with the provided message if the provided value does not evaluate to a true Javascript value.\n */\nexport function ok(value?: any, message?: string) {\n\tif (!value) {\n\t\tthrow new Error(message ? 'Assertion failed (' + message + ')' : 'Assertion Failed');\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * An interface for a JavaScript object that\n * acts a dictionary. The keys are strings.\n */\nexport interface IStringDictionary<V> {\n\t[name: string]: V;\n}\n\n/**\n * An interface for a JavaScript object that\n * acts a dictionary. The keys are numbers.\n */\nexport interface INumberDictionary<V> {\n\t[idx: number]: V;\n}\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * Returns an array which contains all values that reside\n * in the given set.\n */\nexport function values<T>(from: IStringDictionary<T> | INumberDictionary<T>): T[] {\n\tconst result: T[] = [];\n\tfor (let key in from) {\n\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\tresult.push((from as any)[key]);\n\t\t}\n\t}\n\treturn result;\n}\n\nexport function size<T>(from: IStringDictionary<T> | INumberDictionary<T>): number {\n\tlet count = 0;\n\tfor (let key in from) {\n\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\tcount += 1;\n\t\t}\n\t}\n\treturn count;\n}\n\nexport function first<T>(from: IStringDictionary<T> | INumberDictionary<T>): T | undefined {\n\tfor (let key in from) {\n\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\treturn from[key];\n\t\t}\n\t}\n\treturn undefined;\n}\n\n/**\n * Iterates over each entry in the provided set. The iterator allows\n * to remove elements and will stop when the callback returns {{false}}.\n */\nexport function forEach<T>(from: IStringDictionary<T> | INumberDictionary<T>, callback: (entry: { key: any; value: T; }, remove: () => void) => any): void {\n\tfor (let key in from) {\n\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\tconst result = callback({ key: key, value: (from as any)[key] }, function () {\n\t\t\t\tdelete (from as any)[key];\n\t\t\t});\n\t\t\tif (result === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Groups the collection into a dictionary based on the provided\n * group function.\n */\nexport function groupBy<T>(data: T[], groupFn: (element: T) => string): IStringDictionary<T[]> {\n\tconst result: IStringDictionary<T[]> = Object.create(null);\n\tfor (const element of data) {\n\t\tconst key = groupFn(element);\n\t\tlet target = result[key];\n\t\tif (!target) {\n\t\t\ttarget = result[key] = [];\n\t\t}\n\t\ttarget.push(element);\n\t}\n\treturn result;\n}\n\nexport function fromMap<T>(original: Map<string, T>): IStringDictionary<T> {\n\tconst result: IStringDictionary<T> = Object.create(null);\n\tif (original) {\n\t\toriginal.forEach((value, key) => {\n\t\t\tresult[key] = value;\n\t\t});\n\t}\n\treturn result;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\n\nfunction roundFloat(number: number, decimalPoints: number): number {\n\tconst decimal = Math.pow(10, decimalPoints);\n\treturn Math.round(number * decimal) / decimal;\n}\n\nexport class RGBA {\n\t_rgbaBrand: void;\n\n\t/**\n\t * Red: integer in [0-255]\n\t */\n\treadonly r: number;\n\n\t/**\n\t * Green: integer in [0-255]\n\t */\n\treadonly g: number;\n\n\t/**\n\t * Blue: integer in [0-255]\n\t */\n\treadonly b: number;\n\n\t/**\n\t * Alpha: float in [0-1]\n\t */\n\treadonly a: number;\n\n\tconstructor(r: number, g: number, b: number, a: number = 1) {\n\t\tthis.r = Math.min(255, Math.max(0, r)) | 0;\n\t\tthis.g = Math.min(255, Math.max(0, g)) | 0;\n\t\tthis.b = Math.min(255, Math.max(0, b)) | 0;\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\n\t}\n\n\tstatic equals(a: RGBA, b: RGBA): boolean {\n\t\treturn a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\n\t}\n}\n\nexport class HSLA {\n\n\t_hslaBrand: void;\n\n\t/**\n\t * Hue: integer in [0, 360]\n\t */\n\treadonly h: number;\n\n\t/**\n\t * Saturation: float in [0, 1]\n\t */\n\treadonly s: number;\n\n\t/**\n\t * Luminosity: float in [0, 1]\n\t */\n\treadonly l: number;\n\n\t/**\n\t * Alpha: float in [0, 1]\n\t */\n\treadonly a: number;\n\n\tconstructor(h: number, s: number, l: number, a: number) {\n\t\tthis.h = Math.max(Math.min(360, h), 0) | 0;\n\t\tthis.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\n\t\tthis.l = roundFloat(Math.max(Math.min(1, l), 0), 3);\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\n\t}\n\n\tstatic equals(a: HSLA, b: HSLA): boolean {\n\t\treturn a.h === b.h && a.s === b.s && a.l === b.l && a.a === b.a;\n\t}\n\n\t/**\n\t * Converts an RGB color value to HSL. Conversion formula\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n\t * Assumes r, g, and b are contained in the set [0, 255] and\n\t * returns h in the set [0, 360], s, and l in the set [0, 1].\n\t */\n\tstatic fromRGBA(rgba: RGBA): HSLA {\n\t\tconst r = rgba.r / 255;\n\t\tconst g = rgba.g / 255;\n\t\tconst b = rgba.b / 255;\n\t\tconst a = rgba.a;\n\n\t\tconst max = Math.max(r, g, b);\n\t\tconst min = Math.min(r, g, b);\n\t\tlet h = 0;\n\t\tlet s = 0;\n\t\tconst l = (min + max) / 2;\n\t\tconst chroma = max - min;\n\n\t\tif (chroma > 0) {\n\t\t\ts = Math.min((l <= 0.5 ? chroma / (2 * l) : chroma / (2 - (2 * l))), 1);\n\n\t\t\tswitch (max) {\n\t\t\t\tcase r: h = (g - b) / chroma + (g < b ? 6 : 0); break;\n\t\t\t\tcase g: h = (b - r) / chroma + 2; break;\n\t\t\t\tcase b: h = (r - g) / chroma + 4; break;\n\t\t\t}\n\n\t\t\th *= 60;\n\t\t\th = Math.round(h);\n\t\t}\n\t\treturn new HSLA(h, s, l, a);\n\t}\n\n\tprivate static _hue2rgb(p: number, q: number, t: number): number {\n\t\tif (t < 0) {\n\t\t\tt += 1;\n\t\t}\n\t\tif (t > 1) {\n\t\t\tt -= 1;\n\t\t}\n\t\tif (t < 1 / 6) {\n\t\t\treturn p + (q - p) * 6 * t;\n\t\t}\n\t\tif (t < 1 / 2) {\n\t\t\treturn q;\n\t\t}\n\t\tif (t < 2 / 3) {\n\t\t\treturn p + (q - p) * (2 / 3 - t) * 6;\n\t\t}\n\t\treturn p;\n\t}\n\n\t/**\n\t * Converts an HSL color value to RGB. Conversion formula\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n\t * Assumes h in the set [0, 360] s, and l are contained in the set [0, 1] and\n\t * returns r, g, and b in the set [0, 255].\n\t */\n\tstatic toRGBA(hsla: HSLA): RGBA {\n\t\tconst h = hsla.h / 360;\n\t\tconst { s, l, a } = hsla;\n\t\tlet r: number, g: number, b: number;\n\n\t\tif (s === 0) {\n\t\t\tr = g = b = l; // achromatic\n\t\t} else {\n\t\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\t\tconst p = 2 * l - q;\n\t\t\tr = HSLA._hue2rgb(p, q, h + 1 / 3);\n\t\t\tg = HSLA._hue2rgb(p, q, h);\n\t\t\tb = HSLA._hue2rgb(p, q, h - 1 / 3);\n\t\t}\n\n\t\treturn new RGBA(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255), a);\n\t}\n}\n\nexport class HSVA {\n\n\t_hsvaBrand: void;\n\n\t/**\n\t * Hue: integer in [0, 360]\n\t */\n\treadonly h: number;\n\n\t/**\n\t * Saturation: float in [0, 1]\n\t */\n\treadonly s: number;\n\n\t/**\n\t * Value: float in [0, 1]\n\t */\n\treadonly v: number;\n\n\t/**\n\t * Alpha: float in [0, 1]\n\t */\n\treadonly a: number;\n\n\tconstructor(h: number, s: number, v: number, a: number) {\n\t\tthis.h = Math.max(Math.min(360, h), 0) | 0;\n\t\tthis.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\n\t\tthis.v = roundFloat(Math.max(Math.min(1, v), 0), 3);\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\n\t}\n\n\tstatic equals(a: HSVA, b: HSVA): boolean {\n\t\treturn a.h === b.h && a.s === b.s && a.v === b.v && a.a === b.a;\n\t}\n\n\t// from http://www.rapidtables.com/convert/color/rgb-to-hsv.htm\n\tstatic fromRGBA(rgba: RGBA): HSVA {\n\t\tconst r = rgba.r / 255;\n\t\tconst g = rgba.g / 255;\n\t\tconst b = rgba.b / 255;\n\t\tconst cmax = Math.max(r, g, b);\n\t\tconst cmin = Math.min(r, g, b);\n\t\tconst delta = cmax - cmin;\n\t\tconst s = cmax === 0 ? 0 : (delta / cmax);\n\t\tlet m: number;\n\n\t\tif (delta === 0) {\n\t\t\tm = 0;\n\t\t} else if (cmax === r) {\n\t\t\tm = ((((g - b) / delta) % 6) + 6) % 6;\n\t\t} else if (cmax === g) {\n\t\t\tm = ((b - r) / delta) + 2;\n\t\t} else {\n\t\t\tm = ((r - g) / delta) + 4;\n\t\t}\n\n\t\treturn new HSVA(Math.round(m * 60), s, cmax, rgba.a);\n\t}\n\n\t// from http://www.rapidtables.com/convert/color/hsv-to-rgb.htm\n\tstatic toRGBA(hsva: HSVA): RGBA {\n\t\tconst { h, s, v, a } = hsva;\n\t\tconst c = v * s;\n\t\tconst x = c * (1 - Math.abs((h / 60) % 2 - 1));\n\t\tconst m = v - c;\n\t\tlet [r, g, b] = [0, 0, 0];\n\n\t\tif (h < 60) {\n\t\t\tr = c;\n\t\t\tg = x;\n\t\t} else if (h < 120) {\n\t\t\tr = x;\n\t\t\tg = c;\n\t\t} else if (h < 180) {\n\t\t\tg = c;\n\t\t\tb = x;\n\t\t} else if (h < 240) {\n\t\t\tg = x;\n\t\t\tb = c;\n\t\t} else if (h < 300) {\n\t\t\tr = x;\n\t\t\tb = c;\n\t\t} else if (h < 360) {\n\t\t\tr = c;\n\t\t\tb = x;\n\t\t}\n\n\t\tr = Math.round((r + m) * 255);\n\t\tg = Math.round((g + m) * 255);\n\t\tb = Math.round((b + m) * 255);\n\n\t\treturn new RGBA(r, g, b, a);\n\t}\n}\n\nexport class Color {\n\n\tstatic fromHex(hex: string): Color {\n\t\treturn Color.Format.CSS.parseHex(hex) || Color.red;\n\t}\n\n\treadonly rgba: RGBA;\n\tprivate _hsla: HSLA;\n\tget hsla(): HSLA {\n\t\tif (this._hsla) {\n\t\t\treturn this._hsla;\n\t\t} else {\n\t\t\treturn HSLA.fromRGBA(this.rgba);\n\t\t}\n\t}\n\n\tprivate _hsva: HSVA;\n\tget hsva(): HSVA {\n\t\tif (this._hsva) {\n\t\t\treturn this._hsva;\n\t\t}\n\t\treturn HSVA.fromRGBA(this.rgba);\n\t}\n\n\tconstructor(arg: RGBA | HSLA | HSVA) {\n\t\tif (!arg) {\n\t\t\tthrow new Error('Color needs a value');\n\t\t} else if (arg instanceof RGBA) {\n\t\t\tthis.rgba = arg;\n\t\t} else if (arg instanceof HSLA) {\n\t\t\tthis._hsla = arg;\n\t\t\tthis.rgba = HSLA.toRGBA(arg);\n\t\t} else if (arg instanceof HSVA) {\n\t\t\tthis._hsva = arg;\n\t\t\tthis.rgba = HSVA.toRGBA(arg);\n\t\t} else {\n\t\t\tthrow new Error('Invalid color ctor argument');\n\t\t}\n\t}\n\n\tequals(other: Color): boolean {\n\t\treturn !!other && RGBA.equals(this.rgba, other.rgba) && HSLA.equals(this.hsla, other.hsla) && HSVA.equals(this.hsva, other.hsva);\n\t}\n\n\t/**\n\t * http://www.w3.org/TR/WCAG20/#relativeluminancedef\n\t * Returns the number in the set [0, 1]. O => Darkest Black. 1 => Lightest white.\n\t */\n\tgetRelativeLuminance(): number {\n\t\tconst R = Color._relativeLuminanceForComponent(this.rgba.r);\n\t\tconst G = Color._relativeLuminanceForComponent(this.rgba.g);\n\t\tconst B = Color._relativeLuminanceForComponent(this.rgba.b);\n\t\tconst luminance = 0.2126 * R + 0.7152 * G + 0.0722 * B;\n\n\t\treturn roundFloat(luminance, 4);\n\t}\n\n\tprivate static _relativeLuminanceForComponent(color: number): number {\n\t\tconst c = color / 255;\n\t\treturn (c <= 0.03928) ? c / 12.92 : Math.pow(((c + 0.055) / 1.055), 2.4);\n\t}\n\n\t/**\n\t * http://www.w3.org/TR/WCAG20/#contrast-ratiodef\n\t * Returns the contrast ration number in the set [1, 21].\n\t */\n\tgetContrastRatio(another: Color): number {\n\t\tconst lum1 = this.getRelativeLuminance();\n\t\tconst lum2 = another.getRelativeLuminance();\n\t\treturn lum1 > lum2 ? (lum1 + 0.05) / (lum2 + 0.05) : (lum2 + 0.05) / (lum1 + 0.05);\n\t}\n\n\t/**\n\t *\thttp://24ways.org/2010/calculating-color-contrast\n\t *  Return 'true' if darker color otherwise 'false'\n\t */\n\tisDarker(): boolean {\n\t\tconst yiq = (this.rgba.r * 299 + this.rgba.g * 587 + this.rgba.b * 114) / 1000;\n\t\treturn yiq < 128;\n\t}\n\n\t/**\n\t *\thttp://24ways.org/2010/calculating-color-contrast\n\t *  Return 'true' if lighter color otherwise 'false'\n\t */\n\tisLighter(): boolean {\n\t\tconst yiq = (this.rgba.r * 299 + this.rgba.g * 587 + this.rgba.b * 114) / 1000;\n\t\treturn yiq >= 128;\n\t}\n\n\tisLighterThan(another: Color): boolean {\n\t\tconst lum1 = this.getRelativeLuminance();\n\t\tconst lum2 = another.getRelativeLuminance();\n\t\treturn lum1 > lum2;\n\t}\n\n\tisDarkerThan(another: Color): boolean {\n\t\tconst lum1 = this.getRelativeLuminance();\n\t\tconst lum2 = another.getRelativeLuminance();\n\t\treturn lum1 < lum2;\n\t}\n\n\tlighten(factor: number): Color {\n\t\treturn new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l + this.hsla.l * factor, this.hsla.a));\n\t}\n\n\tdarken(factor: number): Color {\n\t\treturn new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l - this.hsla.l * factor, this.hsla.a));\n\t}\n\n\ttransparent(factor: number): Color {\n\t\tconst { r, g, b, a } = this.rgba;\n\t\treturn new Color(new RGBA(r, g, b, a * factor));\n\t}\n\n\tisTransparent(): boolean {\n\t\treturn this.rgba.a === 0;\n\t}\n\n\tisOpaque(): boolean {\n\t\treturn this.rgba.a === 1;\n\t}\n\n\topposite(): Color {\n\t\treturn new Color(new RGBA(255 - this.rgba.r, 255 - this.rgba.g, 255 - this.rgba.b, this.rgba.a));\n\t}\n\n\tblend(c: Color): Color {\n\t\tconst rgba = c.rgba;\n\n\t\t// Convert to 0..1 opacity\n\t\tconst thisA = this.rgba.a;\n\t\tconst colorA = rgba.a;\n\n\t\tconst a = thisA + colorA * (1 - thisA);\n\t\tif (a < 1e-6) {\n\t\t\treturn Color.transparent;\n\t\t}\n\n\t\tconst r = this.rgba.r * thisA / a + rgba.r * colorA * (1 - thisA) / a;\n\t\tconst g = this.rgba.g * thisA / a + rgba.g * colorA * (1 - thisA) / a;\n\t\tconst b = this.rgba.b * thisA / a + rgba.b * colorA * (1 - thisA) / a;\n\n\t\treturn new Color(new RGBA(r, g, b, a));\n\t}\n\n\tflatten(...backgrounds: Color[]): Color {\n\t\tconst background = backgrounds.reduceRight((accumulator, color) => {\n\t\t\treturn Color._flatten(color, accumulator);\n\t\t});\n\t\treturn Color._flatten(this, background);\n\t}\n\n\tprivate static _flatten(foreground: Color, background: Color) {\n\t\tconst backgroundAlpha = 1 - foreground.rgba.a;\n\t\treturn new Color(new RGBA(\n\t\t\tbackgroundAlpha * background.rgba.r + foreground.rgba.a * foreground.rgba.r,\n\t\t\tbackgroundAlpha * background.rgba.g + foreground.rgba.a * foreground.rgba.g,\n\t\t\tbackgroundAlpha * background.rgba.b + foreground.rgba.a * foreground.rgba.b\n\t\t));\n\t}\n\n\ttoString(): string {\n\t\treturn '' + Color.Format.CSS.format(this);\n\t}\n\n\tstatic getLighterColor(of: Color, relative: Color, factor?: number): Color {\n\t\tif (of.isLighterThan(relative)) {\n\t\t\treturn of;\n\t\t}\n\t\tfactor = factor ? factor : 0.5;\n\t\tconst lum1 = of.getRelativeLuminance();\n\t\tconst lum2 = relative.getRelativeLuminance();\n\t\tfactor = factor * (lum2 - lum1) / lum2;\n\t\treturn of.lighten(factor);\n\t}\n\n\tstatic getDarkerColor(of: Color, relative: Color, factor?: number): Color {\n\t\tif (of.isDarkerThan(relative)) {\n\t\t\treturn of;\n\t\t}\n\t\tfactor = factor ? factor : 0.5;\n\t\tconst lum1 = of.getRelativeLuminance();\n\t\tconst lum2 = relative.getRelativeLuminance();\n\t\tfactor = factor * (lum1 - lum2) / lum1;\n\t\treturn of.darken(factor);\n\t}\n\n\tstatic readonly white = new Color(new RGBA(255, 255, 255, 1));\n\tstatic readonly black = new Color(new RGBA(0, 0, 0, 1));\n\tstatic readonly red = new Color(new RGBA(255, 0, 0, 1));\n\tstatic readonly blue = new Color(new RGBA(0, 0, 255, 1));\n\tstatic readonly green = new Color(new RGBA(0, 255, 0, 1));\n\tstatic readonly cyan = new Color(new RGBA(0, 255, 255, 1));\n\tstatic readonly lightgrey = new Color(new RGBA(211, 211, 211, 1));\n\tstatic readonly transparent = new Color(new RGBA(0, 0, 0, 0));\n}\n\nexport namespace Color {\n\texport namespace Format {\n\t\texport namespace CSS {\n\n\t\t\texport function formatRGB(color: Color): string {\n\t\t\t\tif (color.rgba.a === 1) {\n\t\t\t\t\treturn `rgb(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b})`;\n\t\t\t\t}\n\n\t\t\t\treturn Color.Format.CSS.formatRGBA(color);\n\t\t\t}\n\n\t\t\texport function formatRGBA(color: Color): string {\n\t\t\t\treturn `rgba(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b}, ${+(color.rgba.a).toFixed(2)})`;\n\t\t\t}\n\n\t\t\texport function formatHSL(color: Color): string {\n\t\t\t\tif (color.hsla.a === 1) {\n\t\t\t\t\treturn `hsl(${color.hsla.h}, ${(color.hsla.s * 100).toFixed(2)}%, ${(color.hsla.l * 100).toFixed(2)}%)`;\n\t\t\t\t}\n\n\t\t\t\treturn Color.Format.CSS.formatHSLA(color);\n\t\t\t}\n\n\t\t\texport function formatHSLA(color: Color): string {\n\t\t\t\treturn `hsla(${color.hsla.h}, ${(color.hsla.s * 100).toFixed(2)}%, ${(color.hsla.l * 100).toFixed(2)}%, ${color.hsla.a.toFixed(2)})`;\n\t\t\t}\n\n\t\t\tfunction _toTwoDigitHex(n: number): string {\n\t\t\t\tconst r = n.toString(16);\n\t\t\t\treturn r.length !== 2 ? '0' + r : r;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Formats the color as #RRGGBB\n\t\t\t */\n\t\t\texport function formatHex(color: Color): string {\n\t\t\t\treturn `#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}`;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Formats the color as #RRGGBBAA\n\t\t\t * If 'compact' is set, colors without transparancy will be printed as #RRGGBB\n\t\t\t */\n\t\t\texport function formatHexA(color: Color, compact = false): string {\n\t\t\t\tif (compact && color.rgba.a === 1) {\n\t\t\t\t\treturn Color.Format.CSS.formatHex(color);\n\t\t\t\t}\n\n\t\t\t\treturn `#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}${_toTwoDigitHex(Math.round(color.rgba.a * 255))}`;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The default format will use HEX if opaque and RGBA otherwise.\n\t\t\t */\n\t\t\texport function format(color: Color): string | null {\n\t\t\t\tif (!color) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (color.isOpaque()) {\n\t\t\t\t\treturn Color.Format.CSS.formatHex(color);\n\t\t\t\t}\n\n\t\t\t\treturn Color.Format.CSS.formatRGBA(color);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Converts an Hex color value to a Color.\n\t\t\t * returns r, g, and b are contained in the set [0, 255]\n\t\t\t * @param hex string (#RGB, #RGBA, #RRGGBB or #RRGGBBAA).\n\t\t\t */\n\t\t\texport function parseHex(hex: string): Color | null {\n\t\t\t\tif (!hex) {\n\t\t\t\t\t// Invalid color\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst length = hex.length;\n\n\t\t\t\tif (length === 0) {\n\t\t\t\t\t// Invalid color\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (hex.charCodeAt(0) !== CharCode.Hash) {\n\t\t\t\t\t// Does not begin with a #\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (length === 7) {\n\t\t\t\t\t// #RRGGBB format\n\t\t\t\t\tconst r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\n\t\t\t\t\tconst g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\n\t\t\t\t\tconst b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\n\t\t\t\t\treturn new Color(new RGBA(r, g, b, 1));\n\t\t\t\t}\n\n\t\t\t\tif (length === 9) {\n\t\t\t\t\t// #RRGGBBAA format\n\t\t\t\t\tconst r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\n\t\t\t\t\tconst g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\n\t\t\t\t\tconst b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\n\t\t\t\t\tconst a = 16 * _parseHexDigit(hex.charCodeAt(7)) + _parseHexDigit(hex.charCodeAt(8));\n\t\t\t\t\treturn new Color(new RGBA(r, g, b, a / 255));\n\t\t\t\t}\n\n\t\t\t\tif (length === 4) {\n\t\t\t\t\t// #RGB format\n\t\t\t\t\tconst r = _parseHexDigit(hex.charCodeAt(1));\n\t\t\t\t\tconst g = _parseHexDigit(hex.charCodeAt(2));\n\t\t\t\t\tconst b = _parseHexDigit(hex.charCodeAt(3));\n\t\t\t\t\treturn new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b));\n\t\t\t\t}\n\n\t\t\t\tif (length === 5) {\n\t\t\t\t\t// #RGBA format\n\t\t\t\t\tconst r = _parseHexDigit(hex.charCodeAt(1));\n\t\t\t\t\tconst g = _parseHexDigit(hex.charCodeAt(2));\n\t\t\t\t\tconst b = _parseHexDigit(hex.charCodeAt(3));\n\t\t\t\t\tconst a = _parseHexDigit(hex.charCodeAt(4));\n\t\t\t\t\treturn new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b, (16 * a + a) / 255));\n\t\t\t\t}\n\n\t\t\t\t// Invalid color\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction _parseHexDigit(charCode: CharCode): number {\n\t\t\t\tswitch (charCode) {\n\t\t\t\t\tcase CharCode.Digit0: return 0;\n\t\t\t\t\tcase CharCode.Digit1: return 1;\n\t\t\t\t\tcase CharCode.Digit2: return 2;\n\t\t\t\t\tcase CharCode.Digit3: return 3;\n\t\t\t\t\tcase CharCode.Digit4: return 4;\n\t\t\t\t\tcase CharCode.Digit5: return 5;\n\t\t\t\t\tcase CharCode.Digit6: return 6;\n\t\t\t\t\tcase CharCode.Digit7: return 7;\n\t\t\t\t\tcase CharCode.Digit8: return 8;\n\t\t\t\t\tcase CharCode.Digit9: return 9;\n\t\t\t\t\tcase CharCode.a: return 10;\n\t\t\t\t\tcase CharCode.A: return 10;\n\t\t\t\t\tcase CharCode.b: return 11;\n\t\t\t\t\tcase CharCode.B: return 11;\n\t\t\t\t\tcase CharCode.c: return 12;\n\t\t\t\t\tcase CharCode.C: return 12;\n\t\t\t\t\tcase CharCode.d: return 13;\n\t\t\t\t\tcase CharCode.D: return 13;\n\t\t\t\t\tcase CharCode.e: return 14;\n\t\t\t\t\tcase CharCode.E: return 14;\n\t\t\t\t\tcase CharCode.f: return 15;\n\t\t\t\t\tcase CharCode.F: return 15;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function createDecorator(mapFn: (fn: Function, key: string) => Function): Function {\n\treturn (target: any, key: string, descriptor: any) => {\n\t\tlet fnKey: string | null = null;\n\t\tlet fn: Function | null = null;\n\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfnKey = 'value';\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfnKey = 'get';\n\t\t\tfn = descriptor.get;\n\t\t}\n\n\t\tif (!fn) {\n\t\t\tthrow new Error('not supported');\n\t\t}\n\n\t\tdescriptor[fnKey!] = mapFn(fn, key);\n\t};\n}\n\nexport function memoize(target: any, key: string, descriptor: any) {\n\tlet fnKey: string | null = null;\n\tlet fn: Function | null = null;\n\n\tif (typeof descriptor.value === 'function') {\n\t\tfnKey = 'value';\n\t\tfn = descriptor.value;\n\n\t\tif (fn!.length !== 0) {\n\t\t\tconsole.warn('Memoize should only be used in functions with zero parameters');\n\t\t}\n\t} else if (typeof descriptor.get === 'function') {\n\t\tfnKey = 'get';\n\t\tfn = descriptor.get;\n\t}\n\n\tif (!fn) {\n\t\tthrow new Error('not supported');\n\t}\n\n\tconst memoizeKey = `$memoize$${key}`;\n\n\tdescriptor[fnKey!] = function (...args: any[]) {\n\t\tif (!this.hasOwnProperty(memoizeKey)) {\n\t\t\tObject.defineProperty(this, memoizeKey, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: fn!.apply(this, args)\n\t\t\t});\n\t\t}\n\n\t\treturn this[memoizeKey];\n\t};\n}\n\nexport interface IDebouceReducer<T> {\n\t(previousValue: T, ...args: any[]): T;\n}\n\nexport function debounce<T>(delay: number, reducer?: IDebouceReducer<T>, initialValueProvider?: () => T): Function {\n\treturn createDecorator((fn, key) => {\n\t\tconst timerKey = `$debounce$${key}`;\n\t\tconst resultKey = `$debounce$result$${key}`;\n\n\t\treturn function (this: any, ...args: any[]) {\n\t\t\tif (!this[resultKey]) {\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t}\n\n\t\t\tclearTimeout(this[timerKey]);\n\n\t\t\tif (reducer) {\n\t\t\t\tthis[resultKey] = reducer(this[resultKey], ...args);\n\t\t\t\targs = [this[resultKey]];\n\t\t\t}\n\n\t\t\tthis[timerKey] = setTimeout(() => {\n\t\t\t\tfn.apply(this, args);\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t}, delay);\n\t\t};\n\t});\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface ErrorListenerCallback {\n\t(error: any): void;\n}\n\nexport interface ErrorListenerUnbind {\n\t(): void;\n}\n\n// Avoid circular dependency on EventEmitter by implementing a subset of the interface.\nexport class ErrorHandler {\n\tprivate unexpectedErrorHandler: (e: any) => void;\n\tprivate listeners: ErrorListenerCallback[];\n\n\tconstructor() {\n\n\t\tthis.listeners = [];\n\n\t\tthis.unexpectedErrorHandler = function (e: any) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (e.stack) {\n\t\t\t\t\tthrow new Error(e.message + '\\n\\n' + e.stack);\n\t\t\t\t}\n\n\t\t\t\tthrow e;\n\t\t\t}, 0);\n\t\t};\n\t}\n\n\tpublic addListener(listener: ErrorListenerCallback): ErrorListenerUnbind {\n\t\tthis.listeners.push(listener);\n\n\t\treturn () => {\n\t\t\tthis._removeListener(listener);\n\t\t};\n\t}\n\n\tprivate emit(e: any): void {\n\t\tthis.listeners.forEach((listener) => {\n\t\t\tlistener(e);\n\t\t});\n\t}\n\n\tprivate _removeListener(listener: ErrorListenerCallback): void {\n\t\tthis.listeners.splice(this.listeners.indexOf(listener), 1);\n\t}\n\n\tpublic setUnexpectedErrorHandler(newUnexpectedErrorHandler: (e: any) => void): void {\n\t\tthis.unexpectedErrorHandler = newUnexpectedErrorHandler;\n\t}\n\n\tpublic getUnexpectedErrorHandler(): (e: any) => void {\n\t\treturn this.unexpectedErrorHandler;\n\t}\n\n\tpublic onUnexpectedError(e: any): void {\n\t\tthis.unexpectedErrorHandler(e);\n\t\tthis.emit(e);\n\t}\n\n\t// For external errors, we don't want the listeners to be called\n\tpublic onUnexpectedExternalError(e: any): void {\n\t\tthis.unexpectedErrorHandler(e);\n\t}\n}\n\nexport const errorHandler = new ErrorHandler();\n\nexport function setUnexpectedErrorHandler(newUnexpectedErrorHandler: (e: any) => void): void {\n\terrorHandler.setUnexpectedErrorHandler(newUnexpectedErrorHandler);\n}\n\nexport function onUnexpectedError(e: any): undefined {\n\t// ignore errors from cancelled promises\n\tif (!isPromiseCanceledError(e)) {\n\t\terrorHandler.onUnexpectedError(e);\n\t}\n\treturn undefined;\n}\n\nexport function onUnexpectedExternalError(e: any): undefined {\n\t// ignore errors from cancelled promises\n\tif (!isPromiseCanceledError(e)) {\n\t\terrorHandler.onUnexpectedExternalError(e);\n\t}\n\treturn undefined;\n}\n\nexport interface SerializedError {\n\treadonly $isError: true;\n\treadonly name: string;\n\treadonly message: string;\n\treadonly stack: string;\n}\n\nexport function transformErrorForSerialization(error: Error): SerializedError;\nexport function transformErrorForSerialization(error: any): any;\nexport function transformErrorForSerialization(error: any): any {\n\tif (error instanceof Error) {\n\t\tlet { name, message } = error;\n\t\tconst stack: string = (<any>error).stacktrace || (<any>error).stack;\n\t\treturn {\n\t\t\t$isError: true,\n\t\t\tname,\n\t\t\tmessage,\n\t\t\tstack\n\t\t};\n\t}\n\n\t// return as is\n\treturn error;\n}\n\n// see https://github.com/v8/v8/wiki/Stack%20Trace%20API#basic-stack-traces\nexport interface V8CallSite {\n\tgetThis(): any;\n\tgetTypeName(): string;\n\tgetFunction(): string;\n\tgetFunctionName(): string;\n\tgetMethodName(): string;\n\tgetFileName(): string;\n\tgetLineNumber(): number;\n\tgetColumnNumber(): number;\n\tgetEvalOrigin(): string;\n\tisToplevel(): boolean;\n\tisEval(): boolean;\n\tisNative(): boolean;\n\tisConstructor(): boolean;\n\ttoString(): string;\n}\n\nconst canceledName = 'Canceled';\n\n/**\n * Checks if the given error is a promise in canceled state\n */\nexport function isPromiseCanceledError(error: any): boolean {\n\treturn error instanceof Error && error.name === canceledName && error.message === canceledName;\n}\n\n/**\n * Returns an error that signals cancellation.\n */\nexport function canceled(): Error {\n\tconst error = new Error(canceledName);\n\terror.name = error.message;\n\treturn error;\n}\n\nexport function illegalArgument(name?: string): Error {\n\tif (name) {\n\t\treturn new Error(`Illegal argument: ${name}`);\n\t} else {\n\t\treturn new Error('Illegal argument');\n\t}\n}\n\nexport function illegalState(name?: string): Error {\n\tif (name) {\n\t\treturn new Error(`Illegal state: ${name}`);\n\t} else {\n\t\treturn new Error('Illegal state');\n\t}\n}\n\nexport function readonly(name?: string): Error {\n\treturn name\n\t\t? new Error(`readonly property '${name} cannot be changed'`)\n\t\t: new Error('readonly property cannot be changed');\n}\n\nexport function disposed(what: string): Error {\n\tconst result = new Error(`${what} has been disposed`);\n\tresult.name = 'DISPOSED';\n\treturn result;\n}\n\nexport function getErrorMessage(err: any): string {\n\tif (!err) {\n\t\treturn 'Error';\n\t}\n\n\tif (err.message) {\n\t\treturn err.message;\n\t}\n\n\tif (err.stack) {\n\t\treturn err.stack.split('\\n')[0];\n\t}\n\n\treturn String(err);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { canceled } from 'vs/base/common/errors';\nimport { ISplice } from 'vs/base/common/sequence';\n\n/**\n * Returns the last element of an array.\n * @param array The array.\n * @param n Which element from the end (default is zero).\n */\nexport function tail<T>(array: ArrayLike<T>, n: number = 0): T {\n\treturn array[array.length - (1 + n)];\n}\n\nexport function tail2<T>(arr: T[]): [T[], T] {\n\tif (arr.length === 0) {\n\t\tthrow new Error('Invalid tail call');\n\t}\n\n\treturn [arr.slice(0, arr.length - 1), arr[arr.length - 1]];\n}\n\nexport function equals<T>(one: ReadonlyArray<T> | undefined, other: ReadonlyArray<T> | undefined, itemEquals: (a: T, b: T) => boolean = (a, b) => a === b): boolean {\n\tif (one === other) {\n\t\treturn true;\n\t}\n\n\tif (!one || !other) {\n\t\treturn false;\n\t}\n\n\tif (one.length !== other.length) {\n\t\treturn false;\n\t}\n\n\tfor (let i = 0, len = one.length; i < len; i++) {\n\t\tif (!itemEquals(one[i], other[i])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function binarySearch<T>(array: ReadonlyArray<T>, key: T, comparator: (op1: T, op2: T) => number): number {\n\tlet low = 0,\n\t\thigh = array.length - 1;\n\n\twhile (low <= high) {\n\t\tconst mid = ((low + high) / 2) | 0;\n\t\tconst comp = comparator(array[mid], key);\n\t\tif (comp < 0) {\n\t\t\tlow = mid + 1;\n\t\t} else if (comp > 0) {\n\t\t\thigh = mid - 1;\n\t\t} else {\n\t\t\treturn mid;\n\t\t}\n\t}\n\treturn -(low + 1);\n}\n\n/**\n * Takes a sorted array and a function p. The array is sorted in such a way that all elements where p(x) is false\n * are located before all elements where p(x) is true.\n * @returns the least x for which p(x) is true or array.length if no element fullfills the given function.\n */\nexport function findFirstInSorted<T>(array: ReadonlyArray<T>, p: (x: T) => boolean): number {\n\tlet low = 0, high = array.length;\n\tif (high === 0) {\n\t\treturn 0; // no children\n\t}\n\twhile (low < high) {\n\t\tconst mid = Math.floor((low + high) / 2);\n\t\tif (p(array[mid])) {\n\t\t\thigh = mid;\n\t\t} else {\n\t\t\tlow = mid + 1;\n\t\t}\n\t}\n\treturn low;\n}\n\ntype Compare<T> = (a: T, b: T) => number;\n\n/**\n * Like `Array#sort` but always stable. Usually runs a little slower `than Array#sort`\n * so only use this when actually needing stable sort.\n */\nexport function mergeSort<T>(data: T[], compare: Compare<T>): T[] {\n\t_sort(data, compare, 0, data.length - 1, []);\n\treturn data;\n}\n\nfunction _merge<T>(a: T[], compare: Compare<T>, lo: number, mid: number, hi: number, aux: T[]): void {\n\tlet leftIdx = lo, rightIdx = mid + 1;\n\tfor (let i = lo; i <= hi; i++) {\n\t\taux[i] = a[i];\n\t}\n\tfor (let i = lo; i <= hi; i++) {\n\t\tif (leftIdx > mid) {\n\t\t\t// left side consumed\n\t\t\ta[i] = aux[rightIdx++];\n\t\t} else if (rightIdx > hi) {\n\t\t\t// right side consumed\n\t\t\ta[i] = aux[leftIdx++];\n\t\t} else if (compare(aux[rightIdx], aux[leftIdx]) < 0) {\n\t\t\t// right element is less -> comes first\n\t\t\ta[i] = aux[rightIdx++];\n\t\t} else {\n\t\t\t// left element comes first (less or equal)\n\t\t\ta[i] = aux[leftIdx++];\n\t\t}\n\t}\n}\n\nfunction _sort<T>(a: T[], compare: Compare<T>, lo: number, hi: number, aux: T[]) {\n\tif (hi <= lo) {\n\t\treturn;\n\t}\n\tconst mid = lo + ((hi - lo) / 2) | 0;\n\t_sort(a, compare, lo, mid, aux);\n\t_sort(a, compare, mid + 1, hi, aux);\n\tif (compare(a[mid], a[mid + 1]) <= 0) {\n\t\t// left and right are sorted and if the last-left element is less\n\t\t// or equals than the first-right element there is nothing else\n\t\t// to do\n\t\treturn;\n\t}\n\t_merge(a, compare, lo, mid, hi, aux);\n}\n\n\nexport function groupBy<T>(data: ReadonlyArray<T>, compare: (a: T, b: T) => number): T[][] {\n\tconst result: T[][] = [];\n\tlet currentGroup: T[] | undefined = undefined;\n\tfor (const element of mergeSort(data.slice(0), compare)) {\n\t\tif (!currentGroup || compare(currentGroup[0], element) !== 0) {\n\t\t\tcurrentGroup = [element];\n\t\t\tresult.push(currentGroup);\n\t\t} else {\n\t\t\tcurrentGroup.push(element);\n\t\t}\n\t}\n\treturn result;\n}\n\ninterface IMutableSplice<T> extends ISplice<T> {\n\tdeleteCount: number;\n}\n\n/**\n * Diffs two *sorted* arrays and computes the splices which apply the diff.\n */\nexport function sortedDiff<T>(before: ReadonlyArray<T>, after: ReadonlyArray<T>, compare: (a: T, b: T) => number): ISplice<T>[] {\n\tconst result: IMutableSplice<T>[] = [];\n\n\tfunction pushSplice(start: number, deleteCount: number, toInsert: T[]): void {\n\t\tif (deleteCount === 0 && toInsert.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst latest = result[result.length - 1];\n\n\t\tif (latest && latest.start + latest.deleteCount === start) {\n\t\t\tlatest.deleteCount += deleteCount;\n\t\t\tlatest.toInsert.push(...toInsert);\n\t\t} else {\n\t\t\tresult.push({ start, deleteCount, toInsert });\n\t\t}\n\t}\n\n\tlet beforeIdx = 0;\n\tlet afterIdx = 0;\n\n\twhile (true) {\n\t\tif (beforeIdx === before.length) {\n\t\t\tpushSplice(beforeIdx, 0, after.slice(afterIdx));\n\t\t\tbreak;\n\t\t}\n\t\tif (afterIdx === after.length) {\n\t\t\tpushSplice(beforeIdx, before.length - beforeIdx, []);\n\t\t\tbreak;\n\t\t}\n\n\t\tconst beforeElement = before[beforeIdx];\n\t\tconst afterElement = after[afterIdx];\n\t\tconst n = compare(beforeElement, afterElement);\n\t\tif (n === 0) {\n\t\t\t// equal\n\t\t\tbeforeIdx += 1;\n\t\t\tafterIdx += 1;\n\t\t} else if (n < 0) {\n\t\t\t// beforeElement is smaller -> before element removed\n\t\t\tpushSplice(beforeIdx, 1, []);\n\t\t\tbeforeIdx += 1;\n\t\t} else if (n > 0) {\n\t\t\t// beforeElement is greater -> after element added\n\t\t\tpushSplice(beforeIdx, 0, [afterElement]);\n\t\t\tafterIdx += 1;\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Takes two *sorted* arrays and computes their delta (removed, added elements).\n * Finishes in `Math.min(before.length, after.length)` steps.\n */\nexport function delta<T>(before: ReadonlyArray<T>, after: ReadonlyArray<T>, compare: (a: T, b: T) => number): { removed: T[], added: T[] } {\n\tconst splices = sortedDiff(before, after, compare);\n\tconst removed: T[] = [];\n\tconst added: T[] = [];\n\n\tfor (const splice of splices) {\n\t\tremoved.push(...before.slice(splice.start, splice.start + splice.deleteCount));\n\t\tadded.push(...splice.toInsert);\n\t}\n\n\treturn { removed, added };\n}\n\n/**\n * Returns the top N elements from the array.\n *\n * Faster than sorting the entire array when the array is a lot larger than N.\n *\n * @param array The unsorted array.\n * @param compare A sort function for the elements.\n * @param n The number of elements to return.\n * @return The first n elemnts from array when sorted with compare.\n */\nexport function top<T>(array: ReadonlyArray<T>, compare: (a: T, b: T) => number, n: number): T[] {\n\tif (n === 0) {\n\t\treturn [];\n\t}\n\tconst result = array.slice(0, n).sort(compare);\n\ttopStep(array, compare, result, n, array.length);\n\treturn result;\n}\n\n/**\n * Asynchronous variant of `top()` allowing for splitting up work in batches between which the event loop can run.\n *\n * Returns the top N elements from the array.\n *\n * Faster than sorting the entire array when the array is a lot larger than N.\n *\n * @param array The unsorted array.\n * @param compare A sort function for the elements.\n * @param n The number of elements to return.\n * @param batch The number of elements to examine before yielding to the event loop.\n * @return The first n elemnts from array when sorted with compare.\n */\nexport function topAsync<T>(array: T[], compare: (a: T, b: T) => number, n: number, batch: number, token?: CancellationToken): Promise<T[]> {\n\tif (n === 0) {\n\t\treturn Promise.resolve([]);\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\t(async () => {\n\t\t\tconst o = array.length;\n\t\t\tconst result = array.slice(0, n).sort(compare);\n\t\t\tfor (let i = n, m = Math.min(n + batch, o); i < o; i = m, m = Math.min(m + batch, o)) {\n\t\t\t\tif (i > n) {\n\t\t\t\t\tawait new Promise(resolve => setTimeout(resolve)); // nextTick() would starve I/O.\n\t\t\t\t}\n\t\t\t\tif (token && token.isCancellationRequested) {\n\t\t\t\t\tthrow canceled();\n\t\t\t\t}\n\t\t\t\ttopStep(array, compare, result, i, m);\n\t\t\t}\n\t\t\treturn result;\n\t\t})()\n\t\t\t.then(resolve, reject);\n\t});\n}\n\nfunction topStep<T>(array: ReadonlyArray<T>, compare: (a: T, b: T) => number, result: T[], i: number, m: number): void {\n\tfor (const n = result.length; i < m; i++) {\n\t\tconst element = array[i];\n\t\tif (compare(element, result[n - 1]) < 0) {\n\t\t\tresult.pop();\n\t\t\tconst j = findFirstInSorted(result, e => compare(element, e) < 0);\n\t\t\tresult.splice(j, 0, element);\n\t\t}\n\t}\n}\n\n/**\n * @returns a new array with all falsy values removed. The original array IS NOT modified.\n */\nexport function coalesce<T>(array: Array<T | undefined | null>): T[] {\n\tif (!array) {\n\t\treturn array;\n\t}\n\treturn <T[]>array.filter(e => !!e);\n}\n\n/**\n * Remove all falsey values from `array`. The original array IS modified.\n */\nexport function coalesceInPlace<T>(array: Array<T | undefined | null>): void {\n\tif (!array) {\n\t\treturn;\n\t}\n\tlet to = 0;\n\tfor (let i = 0; i < array.length; i++) {\n\t\tif (!!array[i]) {\n\t\t\tarray[to] = array[i];\n\t\t\tto += 1;\n\t\t}\n\t}\n\tarray.length = to;\n}\n\n/**\n * Moves the element in the array for the provided positions.\n */\nexport function move(array: any[], from: number, to: number): void {\n\tarray.splice(to, 0, array.splice(from, 1)[0]);\n}\n\n/**\n * @returns false if the provided object is an array and not empty.\n */\nexport function isFalsyOrEmpty(obj: any): boolean {\n\treturn !Array.isArray(obj) || obj.length === 0;\n}\n\n/**\n * @returns True if the provided object is an array and has at least one element.\n */\nexport function isNonEmptyArray<T>(obj: ReadonlyArray<T> | undefined | null): obj is Array<T> {\n\treturn Array.isArray(obj) && obj.length > 0;\n}\n\n/**\n * Removes duplicates from the given array. The optional keyFn allows to specify\n * how elements are checked for equalness by returning a unique string for each.\n */\nexport function distinct<T>(array: ReadonlyArray<T>, keyFn?: (t: T) => string): T[] {\n\tif (!keyFn) {\n\t\treturn array.filter((element, position) => {\n\t\t\treturn array.indexOf(element) === position;\n\t\t});\n\t}\n\n\tconst seen: { [key: string]: boolean; } = Object.create(null);\n\treturn array.filter((elem) => {\n\t\tconst key = keyFn(elem);\n\t\tif (seen[key]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tseen[key] = true;\n\n\t\treturn true;\n\t});\n}\n\nexport function uniqueFilter<T>(keyFn: (t: T) => string): (t: T) => boolean {\n\tconst seen: { [key: string]: boolean; } = Object.create(null);\n\n\treturn element => {\n\t\tconst key = keyFn(element);\n\n\t\tif (seen[key]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tseen[key] = true;\n\t\treturn true;\n\t};\n}\n\nexport function firstIndex<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean): number {\n\tfor (let i = 0; i < array.length; i++) {\n\t\tconst element = array[i];\n\n\t\tif (fn(element)) {\n\t\t\treturn i;\n\t\t}\n\t}\n\n\treturn -1;\n}\n\nexport function first<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean, notFoundValue: T): T;\nexport function first<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean): T | null;\nexport function first<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean, notFoundValue: T | null): T | null;\nexport function first<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean, notFoundValue: T | null = null): T | null {\n\tconst index = firstIndex(array, fn);\n\treturn index < 0 ? notFoundValue : array[index];\n}\n\nexport function commonPrefixLength<T>(one: ReadonlyArray<T>, other: ReadonlyArray<T>, equals: (a: T, b: T) => boolean = (a, b) => a === b): number {\n\tlet result = 0;\n\n\tfor (let i = 0, len = Math.min(one.length, other.length); i < len && equals(one[i], other[i]); i++) {\n\t\tresult++;\n\t}\n\n\treturn result;\n}\n\nexport function flatten<T>(arr: T[][]): T[] {\n\treturn (<T[]>[]).concat(...arr);\n}\n\nexport function range(to: number): number[];\nexport function range(from: number, to: number): number[];\nexport function range(arg: number, to?: number): number[] {\n\tlet from = typeof to === 'number' ? arg : 0;\n\n\tif (typeof to === 'number') {\n\t\tfrom = arg;\n\t} else {\n\t\tfrom = 0;\n\t\tto = arg;\n\t}\n\n\tconst result: number[] = [];\n\n\tif (from <= to) {\n\t\tfor (let i = from; i < to; i++) {\n\t\t\tresult.push(i);\n\t\t}\n\t} else {\n\t\tfor (let i = from; i > to; i--) {\n\t\t\tresult.push(i);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport function fill<T>(num: number, value: T, arr: T[] = []): T[] {\n\tfor (let i = 0; i < num; i++) {\n\t\tarr[i] = value;\n\t}\n\n\treturn arr;\n}\n\nexport function index<T>(array: ReadonlyArray<T>, indexer: (t: T) => string): { [key: string]: T; };\nexport function index<T, R>(array: ReadonlyArray<T>, indexer: (t: T) => string, merger?: (t: T, r: R) => R): { [key: string]: R; };\nexport function index<T, R>(array: ReadonlyArray<T>, indexer: (t: T) => string, merger: (t: T, r: R) => R = t => t as any): { [key: string]: R; } {\n\treturn array.reduce((r, t) => {\n\t\tconst key = indexer(t);\n\t\tr[key] = merger(t, r[key]);\n\t\treturn r;\n\t}, Object.create(null));\n}\n\n/**\n * Inserts an element into an array. Returns a function which, when\n * called, will remove that element from the array.\n */\nexport function insert<T>(array: T[], element: T): () => void {\n\tarray.push(element);\n\n\treturn () => {\n\t\tconst index = array.indexOf(element);\n\t\tif (index > -1) {\n\t\t\tarray.splice(index, 1);\n\t\t}\n\t};\n}\n\n/**\n * Insert `insertArr` inside `target` at `insertIndex`.\n * Please don't touch unless you understand https://jsperf.com/inserting-an-array-within-an-array\n */\nexport function arrayInsert<T>(target: T[], insertIndex: number, insertArr: T[]): T[] {\n\tconst before = target.slice(0, insertIndex);\n\tconst after = target.slice(insertIndex);\n\treturn before.concat(insertArr, after);\n}\n\n/**\n * Uses Fisher-Yates shuffle to shuffle the given array\n */\nexport function shuffle<T>(array: T[], _seed?: number): void {\n\tlet rand: () => number;\n\n\tif (typeof _seed === 'number') {\n\t\tlet seed = _seed;\n\t\t// Seeded random number generator in JS. Modified from:\n\t\t// https://stackoverflow.com/questions/521295/seeding-the-random-number-generator-in-javascript\n\t\trand = () => {\n\t\t\tconst x = Math.sin(seed++) * 179426549; // throw away most significant digits and reduce any potential bias\n\t\t\treturn x - Math.floor(x);\n\t\t};\n\t} else {\n\t\trand = Math.random;\n\t}\n\n\tfor (let i = array.length - 1; i > 0; i -= 1) {\n\t\tconst j = Math.floor(rand() * (i + 1));\n\t\tconst temp = array[i];\n\t\tarray[i] = array[j];\n\t\tarray[j] = temp;\n\t}\n}\n\n/**\n * Pushes an element to the start of the array, if found.\n */\nexport function pushToStart<T>(arr: T[], value: T): void {\n\tconst index = arr.indexOf(value);\n\n\tif (index > -1) {\n\t\tarr.splice(index, 1);\n\t\tarr.unshift(value);\n\t}\n}\n\n/**\n * Pushes an element to the end of the array, if found.\n */\nexport function pushToEnd<T>(arr: T[], value: T): void {\n\tconst index = arr.indexOf(value);\n\n\tif (index > -1) {\n\t\tarr.splice(index, 1);\n\t\tarr.push(value);\n\t}\n}\n\nexport function find<T>(arr: ArrayLike<T>, predicate: (value: T, index: number, arr: ArrayLike<T>) => any): T | undefined {\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst element = arr[i];\n\t\tif (predicate(element, i, arr)) {\n\t\t\treturn element;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nexport function mapArrayOrNot<T, U>(items: T | T[], fn: (_: T) => U): U | U[] {\n\treturn Array.isArray(items) ?\n\t\titems.map(fn) :\n\t\tfn(items);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function once<T extends Function>(this: any, fn: T): T {\n\tconst _this = this;\n\tlet didCall = false;\n\tlet result: any;\n\n\treturn function () {\n\t\tif (didCall) {\n\t\t\treturn result;\n\t\t}\n\n\t\tdidCall = true;\n\t\tresult = fn.apply(_this, arguments);\n\n\t\treturn result;\n\t} as any as T;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface IteratorDefinedResult<T> {\n\treadonly done: false;\n\treadonly value: T;\n}\nexport interface IteratorUndefinedResult {\n\treadonly done: true;\n\treadonly value: undefined;\n}\nexport const FIN: IteratorUndefinedResult = { done: true, value: undefined };\nexport type IteratorResult<T> = IteratorDefinedResult<T> | IteratorUndefinedResult;\n\nexport interface Iterator<T> {\n\tnext(): IteratorResult<T>;\n}\n\nexport module Iterator {\n\tconst _empty: Iterator<any> = {\n\t\tnext() {\n\t\t\treturn FIN;\n\t\t}\n\t};\n\n\texport function empty<T>(): Iterator<T> {\n\t\treturn _empty;\n\t}\n\n\texport function fromArray<T>(array: T[], index = 0, length = array.length): Iterator<T> {\n\t\treturn {\n\t\t\tnext(): IteratorResult<T> {\n\t\t\t\tif (index >= length) {\n\t\t\t\t\treturn FIN;\n\t\t\t\t}\n\n\t\t\t\treturn { done: false, value: array[index++] };\n\t\t\t}\n\t\t};\n\t}\n\n\texport function from<T>(elements: Iterator<T> | T[] | undefined): Iterator<T> {\n\t\tif (!elements) {\n\t\t\treturn Iterator.empty();\n\t\t} else if (Array.isArray(elements)) {\n\t\t\treturn Iterator.fromArray(elements);\n\t\t} else {\n\t\t\treturn elements;\n\t\t}\n\t}\n\n\texport function map<T, R>(iterator: Iterator<T>, fn: (t: T) => R): Iterator<R> {\n\t\treturn {\n\t\t\tnext() {\n\t\t\t\tconst element = iterator.next();\n\t\t\t\tif (element.done) {\n\t\t\t\t\treturn FIN;\n\t\t\t\t} else {\n\t\t\t\t\treturn { done: false, value: fn(element.value) };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\texport function filter<T>(iterator: Iterator<T>, fn: (t: T) => boolean): Iterator<T> {\n\t\treturn {\n\t\t\tnext() {\n\t\t\t\twhile (true) {\n\t\t\t\t\tconst element = iterator.next();\n\t\t\t\t\tif (element.done) {\n\t\t\t\t\t\treturn FIN;\n\t\t\t\t\t}\n\t\t\t\t\tif (fn(element.value)) {\n\t\t\t\t\t\treturn { done: false, value: element.value };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\texport function forEach<T>(iterator: Iterator<T>, fn: (t: T) => void): void {\n\t\tfor (let next = iterator.next(); !next.done; next = iterator.next()) {\n\t\t\tfn(next.value);\n\t\t}\n\t}\n\n\texport function collect<T>(iterator: Iterator<T>): T[] {\n\t\tconst result: T[] = [];\n\t\tforEach(iterator, value => result.push(value));\n\t\treturn result;\n\t}\n}\n\nexport type ISequence<T> = Iterator<T> | T[];\n\nexport function getSequenceIterator<T>(arg: Iterator<T> | T[]): Iterator<T> {\n\tif (Array.isArray(arg)) {\n\t\treturn Iterator.fromArray(arg);\n\t} else {\n\t\treturn arg;\n\t}\n}\n\nexport interface INextIterator<T> {\n\tnext(): T | null;\n}\n\nexport class ArrayIterator<T> implements INextIterator<T> {\n\n\tprivate items: T[];\n\tprotected start: number;\n\tprotected end: number;\n\tprotected index: number;\n\n\tconstructor(items: T[], start: number = 0, end: number = items.length, index = start - 1) {\n\t\tthis.items = items;\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t\tthis.index = index;\n\t}\n\n\tpublic first(): T | null {\n\t\tthis.index = this.start;\n\t\treturn this.current();\n\t}\n\n\tpublic next(): T | null {\n\t\tthis.index = Math.min(this.index + 1, this.end);\n\t\treturn this.current();\n\t}\n\n\tprotected current(): T | null {\n\t\tif (this.index === this.start - 1 || this.index === this.end) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.items[this.index];\n\t}\n}\n\nexport class ArrayNavigator<T> extends ArrayIterator<T> implements INavigator<T> {\n\n\tconstructor(items: T[], start: number = 0, end: number = items.length, index = start - 1) {\n\t\tsuper(items, start, end, index);\n\t}\n\n\tpublic current(): T | null {\n\t\treturn super.current();\n\t}\n\n\tpublic previous(): T | null {\n\t\tthis.index = Math.max(this.index - 1, this.start - 1);\n\t\treturn this.current();\n\t}\n\n\tpublic first(): T | null {\n\t\tthis.index = this.start;\n\t\treturn this.current();\n\t}\n\n\tpublic last(): T | null {\n\t\tthis.index = this.end - 1;\n\t\treturn this.current();\n\t}\n\n\tpublic parent(): T | null {\n\t\treturn null;\n\t}\n}\n\nexport class MappedIterator<T, R> implements INextIterator<R> {\n\n\tconstructor(protected iterator: INextIterator<T>, protected fn: (item: T | null) => R) {\n\t\t// noop\n\t}\n\n\tnext() { return this.fn(this.iterator.next()); }\n}\n\nexport interface INavigator<T> extends INextIterator<T> {\n\tcurrent(): T | null;\n\tprevious(): T | null;\n\tparent(): T | null;\n\tfirst(): T | null;\n\tlast(): T | null;\n\tnext(): T | null;\n}\n\nexport class MappedNavigator<T, R> extends MappedIterator<T, R> implements INavigator<R> {\n\n\tconstructor(protected navigator: INavigator<T>, fn: (item: T) => R) {\n\t\tsuper(navigator, fn);\n\t}\n\n\tcurrent() { return this.fn(this.navigator.current()); }\n\tprevious() { return this.fn(this.navigator.previous()); }\n\tparent() { return this.fn(this.navigator.parent()); }\n\tfirst() { return this.fn(this.navigator.first()); }\n\tlast() { return this.fn(this.navigator.last()); }\n\tnext() { return this.fn(this.navigator.next()); }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const enum ScanError {\n\tNone = 0,\n\tUnexpectedEndOfComment = 1,\n\tUnexpectedEndOfString = 2,\n\tUnexpectedEndOfNumber = 3,\n\tInvalidUnicode = 4,\n\tInvalidEscapeCharacter = 5,\n\tInvalidCharacter = 6\n}\n\nexport const enum SyntaxKind {\n\tOpenBraceToken = 1,\n\tCloseBraceToken = 2,\n\tOpenBracketToken = 3,\n\tCloseBracketToken = 4,\n\tCommaToken = 5,\n\tColonToken = 6,\n\tNullKeyword = 7,\n\tTrueKeyword = 8,\n\tFalseKeyword = 9,\n\tStringLiteral = 10,\n\tNumericLiteral = 11,\n\tLineCommentTrivia = 12,\n\tBlockCommentTrivia = 13,\n\tLineBreakTrivia = 14,\n\tTrivia = 15,\n\tUnknown = 16,\n\tEOF = 17\n}\n\n/**\n * The scanner object, representing a JSON scanner at a position in the input string.\n */\nexport interface JSONScanner {\n\t/**\n\t * Sets the scan position to a new offset. A call to 'scan' is needed to get the first token.\n\t */\n\tsetPosition(pos: number): void;\n\t/**\n\t * Read the next token. Returns the token code.\n\t */\n\tscan(): SyntaxKind;\n\t/**\n\t * Returns the current scan position, which is after the last read token.\n\t */\n\tgetPosition(): number;\n\t/**\n\t * Returns the last read token.\n\t */\n\tgetToken(): SyntaxKind;\n\t/**\n\t * Returns the last read token value. The value for strings is the decoded string content. For numbers its of type number, for boolean it's true or false.\n\t */\n\tgetTokenValue(): string;\n\t/**\n\t * The start offset of the last read token.\n\t */\n\tgetTokenOffset(): number;\n\t/**\n\t * The length of the last read token.\n\t */\n\tgetTokenLength(): number;\n\t/**\n\t * An error code of the last scan.\n\t */\n\tgetTokenError(): ScanError;\n}\n\n\nexport interface ParseError {\n\terror: ParseErrorCode;\n\toffset: number;\n\tlength: number;\n}\n\nexport const enum ParseErrorCode {\n\tInvalidSymbol = 1,\n\tInvalidNumberFormat = 2,\n\tPropertyNameExpected = 3,\n\tValueExpected = 4,\n\tColonExpected = 5,\n\tCommaExpected = 6,\n\tCloseBraceExpected = 7,\n\tCloseBracketExpected = 8,\n\tEndOfFileExpected = 9,\n\tInvalidCommentToken = 10,\n\tUnexpectedEndOfComment = 11,\n\tUnexpectedEndOfString = 12,\n\tUnexpectedEndOfNumber = 13,\n\tInvalidUnicode = 14,\n\tInvalidEscapeCharacter = 15,\n\tInvalidCharacter = 16\n}\n\nexport type NodeType = 'object' | 'array' | 'property' | 'string' | 'number' | 'boolean' | 'null';\n\nexport interface Node {\n\treadonly type: NodeType;\n\treadonly value?: any;\n\treadonly offset: number;\n\treadonly length: number;\n\treadonly colonOffset?: number;\n\treadonly parent?: Node;\n\treadonly children?: Node[];\n}\n\nexport type Segment = string | number;\nexport type JSONPath = Segment[];\n\nexport interface Location {\n\t/**\n\t * The previous property key or literal value (string, number, boolean or null) or undefined.\n\t */\n\tpreviousNode?: Node;\n\t/**\n\t * The path describing the location in the JSON document. The path consists of a sequence strings\n\t * representing an object property or numbers for array indices.\n\t */\n\tpath: JSONPath;\n\t/**\n\t * Matches the locations path against a pattern consisting of strings (for properties) and numbers (for array indices).\n\t * '*' will match a single segment, of any property name or index.\n\t * '**' will match a sequece of segments or no segment, of any property name or index.\n\t */\n\tmatches: (patterns: JSONPath) => boolean;\n\t/**\n\t * If set, the location's offset is at a property key.\n\t */\n\tisAtPropertyKey: boolean;\n}\n\nexport interface ParseOptions {\n\tdisallowComments?: boolean;\n\tallowTrailingComma?: boolean;\n}\n\nexport namespace ParseOptions {\n\texport const DEFAULT = {\n\t\tallowTrailingComma: true\n\t};\n}\n\nexport interface JSONVisitor {\n\t/**\n\t * Invoked when an open brace is encountered and an object is started. The offset and length represent the location of the open brace.\n\t */\n\tonObjectBegin?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a property is encountered. The offset and length represent the location of the property name.\n\t */\n\tonObjectProperty?: (property: string, offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a closing brace is encountered and an object is completed. The offset and length represent the location of the closing brace.\n\t */\n\tonObjectEnd?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when an open bracket is encountered. The offset and length represent the location of the open bracket.\n\t */\n\tonArrayBegin?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a closing bracket is encountered. The offset and length represent the location of the closing bracket.\n\t */\n\tonArrayEnd?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a literal value is encountered. The offset and length represent the location of the literal value.\n\t */\n\tonLiteralValue?: (value: any, offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a comma or colon separator is encountered. The offset and length represent the location of the separator.\n\t */\n\tonSeparator?: (character: string, offset: number, length: number) => void;\n\n\t/**\n\t * When comments are allowed, invoked when a line or block comment is encountered. The offset and length represent the location of the comment.\n\t */\n\tonComment?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked on an error.\n\t */\n\tonError?: (error: ParseErrorCode, offset: number, length: number) => void;\n}\n\n/**\n * Creates a JSON scanner on the given text.\n * If ignoreTrivia is set, whitespaces or comments are ignored.\n */\nexport function createScanner(text: string, ignoreTrivia: boolean = false): JSONScanner {\n\n\tlet pos = 0,\n\t\tlen = text.length,\n\t\tvalue: string = '',\n\t\ttokenOffset = 0,\n\t\ttoken: SyntaxKind = SyntaxKind.Unknown,\n\t\tscanError: ScanError = ScanError.None;\n\n\tfunction scanHexDigits(count: number): number {\n\t\tlet digits = 0;\n\t\tlet value = 0;\n\t\twhile (digits < count) {\n\t\t\tconst ch = text.charCodeAt(pos);\n\t\t\tif (ch >= CharacterCodes._0 && ch <= CharacterCodes._9) {\n\t\t\t\tvalue = value * 16 + ch - CharacterCodes._0;\n\t\t\t}\n\t\t\telse if (ch >= CharacterCodes.A && ch <= CharacterCodes.F) {\n\t\t\t\tvalue = value * 16 + ch - CharacterCodes.A + 10;\n\t\t\t}\n\t\t\telse if (ch >= CharacterCodes.a && ch <= CharacterCodes.f) {\n\t\t\t\tvalue = value * 16 + ch - CharacterCodes.a + 10;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpos++;\n\t\t\tdigits++;\n\t\t}\n\t\tif (digits < count) {\n\t\t\tvalue = -1;\n\t\t}\n\t\treturn value;\n\t}\n\n\tfunction setPosition(newPosition: number) {\n\t\tpos = newPosition;\n\t\tvalue = '';\n\t\ttokenOffset = 0;\n\t\ttoken = SyntaxKind.Unknown;\n\t\tscanError = ScanError.None;\n\t}\n\n\tfunction scanNumber(): string {\n\t\tconst start = pos;\n\t\tif (text.charCodeAt(pos) === CharacterCodes._0) {\n\t\t\tpos++;\n\t\t} else {\n\t\t\tpos++;\n\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t}\n\t\t}\n\t\tif (pos < text.length && text.charCodeAt(pos) === CharacterCodes.dot) {\n\t\t\tpos++;\n\t\t\tif (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tscanError = ScanError.UnexpectedEndOfNumber;\n\t\t\t\treturn text.substring(start, pos);\n\t\t\t}\n\t\t}\n\t\tlet end = pos;\n\t\tif (pos < text.length && (text.charCodeAt(pos) === CharacterCodes.E || text.charCodeAt(pos) === CharacterCodes.e)) {\n\t\t\tpos++;\n\t\t\tif (pos < text.length && text.charCodeAt(pos) === CharacterCodes.plus || text.charCodeAt(pos) === CharacterCodes.minus) {\n\t\t\t\tpos++;\n\t\t\t}\n\t\t\tif (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t\tend = pos;\n\t\t\t} else {\n\t\t\t\tscanError = ScanError.UnexpectedEndOfNumber;\n\t\t\t}\n\t\t}\n\t\treturn text.substring(start, end);\n\t}\n\n\tfunction scanString(): string {\n\n\t\tlet result = '',\n\t\t\tstart = pos;\n\n\t\twhile (true) {\n\t\t\tif (pos >= len) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlet ch = text.charCodeAt(pos);\n\t\t\tif (ch === CharacterCodes.doubleQuote) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tpos++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (ch === CharacterCodes.backslash) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tpos++;\n\t\t\t\tif (pos >= len) {\n\t\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tch = text.charCodeAt(pos++);\n\t\t\t\tswitch (ch) {\n\t\t\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\t\t\t\tresult += '\\\"';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.backslash:\n\t\t\t\t\t\tresult += '\\\\';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.slash:\n\t\t\t\t\t\tresult += '/';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.b:\n\t\t\t\t\t\tresult += '\\b';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.f:\n\t\t\t\t\t\tresult += '\\f';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.n:\n\t\t\t\t\t\tresult += '\\n';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.r:\n\t\t\t\t\t\tresult += '\\r';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.t:\n\t\t\t\t\t\tresult += '\\t';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.u:\n\t\t\t\t\t\tconst ch = scanHexDigits(4);\n\t\t\t\t\t\tif (ch >= 0) {\n\t\t\t\t\t\t\tresult += String.fromCharCode(ch);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscanError = ScanError.InvalidUnicode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tscanError = ScanError.InvalidEscapeCharacter;\n\t\t\t\t}\n\t\t\t\tstart = pos;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (ch >= 0 && ch <= 0x1F) {\n\t\t\t\tif (isLineBreak(ch)) {\n\t\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tscanError = ScanError.InvalidCharacter;\n\t\t\t\t\t// mark as error but continue with string\n\t\t\t\t}\n\t\t\t}\n\t\t\tpos++;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction scanNext(): SyntaxKind {\n\n\t\tvalue = '';\n\t\tscanError = ScanError.None;\n\n\t\ttokenOffset = pos;\n\n\t\tif (pos >= len) {\n\t\t\t// at the end\n\t\t\ttokenOffset = len;\n\t\t\treturn token = SyntaxKind.EOF;\n\t\t}\n\n\t\tlet code = text.charCodeAt(pos);\n\t\t// trivia: whitespace\n\t\tif (isWhiteSpace(code)) {\n\t\t\tdo {\n\t\t\t\tpos++;\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tcode = text.charCodeAt(pos);\n\t\t\t} while (isWhiteSpace(code));\n\n\t\t\treturn token = SyntaxKind.Trivia;\n\t\t}\n\n\t\t// trivia: newlines\n\t\tif (isLineBreak(code)) {\n\t\t\tpos++;\n\t\t\tvalue += String.fromCharCode(code);\n\t\t\tif (code === CharacterCodes.carriageReturn && text.charCodeAt(pos) === CharacterCodes.lineFeed) {\n\t\t\t\tpos++;\n\t\t\t\tvalue += '\\n';\n\t\t\t}\n\t\t\treturn token = SyntaxKind.LineBreakTrivia;\n\t\t}\n\n\t\tswitch (code) {\n\t\t\t// tokens: []{}:,\n\t\t\tcase CharacterCodes.openBrace:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.OpenBraceToken;\n\t\t\tcase CharacterCodes.closeBrace:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CloseBraceToken;\n\t\t\tcase CharacterCodes.openBracket:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.OpenBracketToken;\n\t\t\tcase CharacterCodes.closeBracket:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CloseBracketToken;\n\t\t\tcase CharacterCodes.colon:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.ColonToken;\n\t\t\tcase CharacterCodes.comma:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CommaToken;\n\n\t\t\t// strings\n\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\t\tpos++;\n\t\t\t\tvalue = scanString();\n\t\t\t\treturn token = SyntaxKind.StringLiteral;\n\n\t\t\t// comments\n\t\t\tcase CharacterCodes.slash:\n\t\t\t\tconst start = pos - 1;\n\t\t\t\t// Single-line comment\n\t\t\t\tif (text.charCodeAt(pos + 1) === CharacterCodes.slash) {\n\t\t\t\t\tpos += 2;\n\n\t\t\t\t\twhile (pos < len) {\n\t\t\t\t\t\tif (isLineBreak(text.charCodeAt(pos))) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos++;\n\n\t\t\t\t\t}\n\t\t\t\t\tvalue = text.substring(start, pos);\n\t\t\t\t\treturn token = SyntaxKind.LineCommentTrivia;\n\t\t\t\t}\n\n\t\t\t\t// Multi-line comment\n\t\t\t\tif (text.charCodeAt(pos + 1) === CharacterCodes.asterisk) {\n\t\t\t\t\tpos += 2;\n\n\t\t\t\t\tconst safeLength = len - 1; // For lookahead.\n\t\t\t\t\tlet commentClosed = false;\n\t\t\t\t\twhile (pos < safeLength) {\n\t\t\t\t\t\tconst ch = text.charCodeAt(pos);\n\n\t\t\t\t\t\tif (ch === CharacterCodes.asterisk && text.charCodeAt(pos + 1) === CharacterCodes.slash) {\n\t\t\t\t\t\t\tpos += 2;\n\t\t\t\t\t\t\tcommentClosed = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!commentClosed) {\n\t\t\t\t\t\tpos++;\n\t\t\t\t\t\tscanError = ScanError.UnexpectedEndOfComment;\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = text.substring(start, pos);\n\t\t\t\t\treturn token = SyntaxKind.BlockCommentTrivia;\n\t\t\t\t}\n\t\t\t\t// just a single slash\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.Unknown;\n\n\t\t\t// numbers\n\t\t\tcase CharacterCodes.minus:\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\tif (pos === len || !isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t\t\t}\n\t\t\t// found a minus, followed by a number so\n\t\t\t// we fall through to proceed with scanning\n\t\t\t// numbers\n\t\t\tcase CharacterCodes._0:\n\t\t\tcase CharacterCodes._1:\n\t\t\tcase CharacterCodes._2:\n\t\t\tcase CharacterCodes._3:\n\t\t\tcase CharacterCodes._4:\n\t\t\tcase CharacterCodes._5:\n\t\t\tcase CharacterCodes._6:\n\t\t\tcase CharacterCodes._7:\n\t\t\tcase CharacterCodes._8:\n\t\t\tcase CharacterCodes._9:\n\t\t\t\tvalue += scanNumber();\n\t\t\t\treturn token = SyntaxKind.NumericLiteral;\n\t\t\t// literals and unknown symbols\n\t\t\tdefault:\n\t\t\t\t// is a literal? Read the full word.\n\t\t\t\twhile (pos < len && isUnknownContentCharacter(code)) {\n\t\t\t\t\tpos++;\n\t\t\t\t\tcode = text.charCodeAt(pos);\n\t\t\t\t}\n\t\t\t\tif (tokenOffset !== pos) {\n\t\t\t\t\tvalue = text.substring(tokenOffset, pos);\n\t\t\t\t\t// keywords: true, false, null\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase 'true': return token = SyntaxKind.TrueKeyword;\n\t\t\t\t\t\tcase 'false': return token = SyntaxKind.FalseKeyword;\n\t\t\t\t\t\tcase 'null': return token = SyntaxKind.NullKeyword;\n\t\t\t\t\t}\n\t\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t\t\t}\n\t\t\t\t// some\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t}\n\t}\n\n\tfunction isUnknownContentCharacter(code: CharacterCodes) {\n\t\tif (isWhiteSpace(code) || isLineBreak(code)) {\n\t\t\treturn false;\n\t\t}\n\t\tswitch (code) {\n\t\t\tcase CharacterCodes.closeBrace:\n\t\t\tcase CharacterCodes.closeBracket:\n\t\t\tcase CharacterCodes.openBrace:\n\t\t\tcase CharacterCodes.openBracket:\n\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\tcase CharacterCodes.colon:\n\t\t\tcase CharacterCodes.comma:\n\t\t\tcase CharacterCodes.slash:\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\n\tfunction scanNextNonTrivia(): SyntaxKind {\n\t\tlet result: SyntaxKind;\n\t\tdo {\n\t\t\tresult = scanNext();\n\t\t} while (result >= SyntaxKind.LineCommentTrivia && result <= SyntaxKind.Trivia);\n\t\treturn result;\n\t}\n\n\treturn {\n\t\tsetPosition: setPosition,\n\t\tgetPosition: () => pos,\n\t\tscan: ignoreTrivia ? scanNextNonTrivia : scanNext,\n\t\tgetToken: () => token,\n\t\tgetTokenValue: () => value,\n\t\tgetTokenOffset: () => tokenOffset,\n\t\tgetTokenLength: () => pos - tokenOffset,\n\t\tgetTokenError: () => scanError\n\t};\n}\n\nfunction isWhiteSpace(ch: number): boolean {\n\treturn ch === CharacterCodes.space || ch === CharacterCodes.tab || ch === CharacterCodes.verticalTab || ch === CharacterCodes.formFeed ||\n\t\tch === CharacterCodes.nonBreakingSpace || ch === CharacterCodes.ogham || ch >= CharacterCodes.enQuad && ch <= CharacterCodes.zeroWidthSpace ||\n\t\tch === CharacterCodes.narrowNoBreakSpace || ch === CharacterCodes.mathematicalSpace || ch === CharacterCodes.ideographicSpace || ch === CharacterCodes.byteOrderMark;\n}\n\nfunction isLineBreak(ch: number): boolean {\n\treturn ch === CharacterCodes.lineFeed || ch === CharacterCodes.carriageReturn || ch === CharacterCodes.lineSeparator || ch === CharacterCodes.paragraphSeparator;\n}\n\nfunction isDigit(ch: number): boolean {\n\treturn ch >= CharacterCodes._0 && ch <= CharacterCodes._9;\n}\n\nconst enum CharacterCodes {\n\tnullCharacter = 0,\n\tmaxAsciiCharacter = 0x7F,\n\n\tlineFeed = 0x0A,              // \\n\n\tcarriageReturn = 0x0D,        // \\r\n\tlineSeparator = 0x2028,\n\tparagraphSeparator = 0x2029,\n\n\t// REVIEW: do we need to support this?  The scanner doesn't, but our IText does.  This seems\n\t// like an odd disparity?  (Or maybe it's completely fine for them to be different).\n\tnextLine = 0x0085,\n\n\t// Unicode 3.0 space characters\n\tspace = 0x0020,   // \" \"\n\tnonBreakingSpace = 0x00A0,   //\n\tenQuad = 0x2000,\n\temQuad = 0x2001,\n\tenSpace = 0x2002,\n\temSpace = 0x2003,\n\tthreePerEmSpace = 0x2004,\n\tfourPerEmSpace = 0x2005,\n\tsixPerEmSpace = 0x2006,\n\tfigureSpace = 0x2007,\n\tpunctuationSpace = 0x2008,\n\tthinSpace = 0x2009,\n\thairSpace = 0x200A,\n\tzeroWidthSpace = 0x200B,\n\tnarrowNoBreakSpace = 0x202F,\n\tideographicSpace = 0x3000,\n\tmathematicalSpace = 0x205F,\n\togham = 0x1680,\n\n\t_ = 0x5F,\n\t$ = 0x24,\n\n\t_0 = 0x30,\n\t_1 = 0x31,\n\t_2 = 0x32,\n\t_3 = 0x33,\n\t_4 = 0x34,\n\t_5 = 0x35,\n\t_6 = 0x36,\n\t_7 = 0x37,\n\t_8 = 0x38,\n\t_9 = 0x39,\n\n\ta = 0x61,\n\tb = 0x62,\n\tc = 0x63,\n\td = 0x64,\n\te = 0x65,\n\tf = 0x66,\n\tg = 0x67,\n\th = 0x68,\n\ti = 0x69,\n\tj = 0x6A,\n\tk = 0x6B,\n\tl = 0x6C,\n\tm = 0x6D,\n\tn = 0x6E,\n\to = 0x6F,\n\tp = 0x70,\n\tq = 0x71,\n\tr = 0x72,\n\ts = 0x73,\n\tt = 0x74,\n\tu = 0x75,\n\tv = 0x76,\n\tw = 0x77,\n\tx = 0x78,\n\ty = 0x79,\n\tz = 0x7A,\n\n\tA = 0x41,\n\tB = 0x42,\n\tC = 0x43,\n\tD = 0x44,\n\tE = 0x45,\n\tF = 0x46,\n\tG = 0x47,\n\tH = 0x48,\n\tI = 0x49,\n\tJ = 0x4A,\n\tK = 0x4B,\n\tL = 0x4C,\n\tM = 0x4D,\n\tN = 0x4E,\n\tO = 0x4F,\n\tP = 0x50,\n\tQ = 0x51,\n\tR = 0x52,\n\tS = 0x53,\n\tT = 0x54,\n\tU = 0x55,\n\tV = 0x56,\n\tW = 0x57,\n\tX = 0x58,\n\tY = 0x59,\n\tZ = 0x5A,\n\n\tampersand = 0x26,             // &\n\tasterisk = 0x2A,              // *\n\tat = 0x40,                    // @\n\tbackslash = 0x5C,             // \\\n\tbar = 0x7C,                   // |\n\tcaret = 0x5E,                 // ^\n\tcloseBrace = 0x7D,            // }\n\tcloseBracket = 0x5D,          // ]\n\tcloseParen = 0x29,            // )\n\tcolon = 0x3A,                 // :\n\tcomma = 0x2C,                 // ,\n\tdot = 0x2E,                   // .\n\tdoubleQuote = 0x22,           // \"\n\tequals = 0x3D,                // =\n\texclamation = 0x21,           // !\n\tgreaterThan = 0x3E,           // >\n\tlessThan = 0x3C,              // <\n\tminus = 0x2D,                 // -\n\topenBrace = 0x7B,             // {\n\topenBracket = 0x5B,           // [\n\topenParen = 0x28,             // (\n\tpercent = 0x25,               // %\n\tplus = 0x2B,                  // +\n\tquestion = 0x3F,              // ?\n\tsemicolon = 0x3B,             // ;\n\tsingleQuote = 0x27,           // '\n\tslash = 0x2F,                 // /\n\ttilde = 0x7E,                 // ~\n\n\tbackspace = 0x08,             // \\b\n\tformFeed = 0x0C,              // \\f\n\tbyteOrderMark = 0xFEFF,\n\ttab = 0x09,                   // \\t\n\tverticalTab = 0x0B,           // \\v\n}\n\ninterface NodeImpl extends Node {\n\ttype: NodeType;\n\tvalue?: any;\n\toffset: number;\n\tlength: number;\n\tcolonOffset?: number;\n\tparent?: NodeImpl;\n\tchildren?: NodeImpl[];\n}\n\n/**\n * For a given offset, evaluate the location in the JSON document. Each segment in the location path is either a property name or an array index.\n */\nexport function getLocation(text: string, position: number): Location {\n\tconst segments: Segment[] = []; // strings or numbers\n\tconst earlyReturnException = new Object();\n\tlet previousNode: NodeImpl | undefined = undefined;\n\tconst previousNodeInst: NodeImpl = {\n\t\tvalue: {},\n\t\toffset: 0,\n\t\tlength: 0,\n\t\ttype: 'object',\n\t\tparent: undefined\n\t};\n\tlet isAtPropertyKey = false;\n\tfunction setPreviousNode(value: string, offset: number, length: number, type: NodeType) {\n\t\tpreviousNodeInst.value = value;\n\t\tpreviousNodeInst.offset = offset;\n\t\tpreviousNodeInst.length = length;\n\t\tpreviousNodeInst.type = type;\n\t\tpreviousNodeInst.colonOffset = undefined;\n\t\tpreviousNode = previousNodeInst;\n\t}\n\ttry {\n\n\t\tvisit(text, {\n\t\t\tonObjectBegin: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tisAtPropertyKey = position > offset;\n\t\t\t\tsegments.push(''); // push a placeholder (will be replaced)\n\t\t\t},\n\t\t\tonObjectProperty: (name: string, offset: number, length: number) => {\n\t\t\t\tif (position < offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tsetPreviousNode(name, offset, length, 'property');\n\t\t\t\tsegments[segments.length - 1] = name;\n\t\t\t\tif (position <= offset + length) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonObjectEnd: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.pop();\n\t\t\t},\n\t\t\tonArrayBegin: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.push(0);\n\t\t\t},\n\t\t\tonArrayEnd: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.pop();\n\t\t\t},\n\t\t\tonLiteralValue: (value: any, offset: number, length: number) => {\n\t\t\t\tif (position < offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tsetPreviousNode(value, offset, length, getLiteralNodeType(value));\n\n\t\t\t\tif (position <= offset + length) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSeparator: (sep: string, offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tif (sep === ':' && previousNode && previousNode.type === 'property') {\n\t\t\t\t\tpreviousNode.colonOffset = offset;\n\t\t\t\t\tisAtPropertyKey = false;\n\t\t\t\t\tpreviousNode = undefined;\n\t\t\t\t} else if (sep === ',') {\n\t\t\t\t\tconst last = segments[segments.length - 1];\n\t\t\t\t\tif (typeof last === 'number') {\n\t\t\t\t\t\tsegments[segments.length - 1] = last + 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tisAtPropertyKey = true;\n\t\t\t\t\t\tsegments[segments.length - 1] = '';\n\t\t\t\t\t}\n\t\t\t\t\tpreviousNode = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} catch (e) {\n\t\tif (e !== earlyReturnException) {\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\treturn {\n\t\tpath: segments,\n\t\tpreviousNode,\n\t\tisAtPropertyKey,\n\t\tmatches: (pattern: Segment[]) => {\n\t\t\tlet k = 0;\n\t\t\tfor (let i = 0; k < pattern.length && i < segments.length; i++) {\n\t\t\t\tif (pattern[k] === segments[i] || pattern[k] === '*') {\n\t\t\t\t\tk++;\n\t\t\t\t} else if (pattern[k] !== '**') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn k === pattern.length;\n\t\t}\n\t};\n}\n\n\n/**\n * Parses the given text and returns the object the JSON content represents. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n * Therefore always check the errors list to find out if the input was valid.\n */\nexport function parse(text: string, errors: ParseError[] = [], options: ParseOptions = ParseOptions.DEFAULT): any {\n\tlet currentProperty: string | null = null;\n\tlet currentParent: any = [];\n\tconst previousParents: any[] = [];\n\n\tfunction onValue(value: any) {\n\t\tif (Array.isArray(currentParent)) {\n\t\t\t(<any[]>currentParent).push(value);\n\t\t} else if (currentProperty) {\n\t\t\tcurrentParent[currentProperty] = value;\n\t\t}\n\t}\n\n\tconst visitor: JSONVisitor = {\n\t\tonObjectBegin: () => {\n\t\t\tconst object = {};\n\t\t\tonValue(object);\n\t\t\tpreviousParents.push(currentParent);\n\t\t\tcurrentParent = object;\n\t\t\tcurrentProperty = null;\n\t\t},\n\t\tonObjectProperty: (name: string) => {\n\t\t\tcurrentProperty = name;\n\t\t},\n\t\tonObjectEnd: () => {\n\t\t\tcurrentParent = previousParents.pop();\n\t\t},\n\t\tonArrayBegin: () => {\n\t\t\tconst array: any[] = [];\n\t\t\tonValue(array);\n\t\t\tpreviousParents.push(currentParent);\n\t\t\tcurrentParent = array;\n\t\t\tcurrentProperty = null;\n\t\t},\n\t\tonArrayEnd: () => {\n\t\t\tcurrentParent = previousParents.pop();\n\t\t},\n\t\tonLiteralValue: onValue,\n\t\tonError: (error: ParseErrorCode, offset: number, length: number) => {\n\t\t\terrors.push({ error, offset, length });\n\t\t}\n\t};\n\tvisit(text, visitor, options);\n\treturn currentParent[0];\n}\n\n\n/**\n * Parses the given text and returns a tree representation the JSON content. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n */\nexport function parseTree(text: string, errors: ParseError[] = [], options: ParseOptions = ParseOptions.DEFAULT): Node {\n\tlet currentParent: NodeImpl = { type: 'array', offset: -1, length: -1, children: [], parent: undefined }; // artificial root\n\n\tfunction ensurePropertyComplete(endOffset: number) {\n\t\tif (currentParent.type === 'property') {\n\t\t\tcurrentParent.length = endOffset - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t}\n\t}\n\n\tfunction onValue(valueNode: Node): Node {\n\t\tcurrentParent.children!.push(valueNode);\n\t\treturn valueNode;\n\t}\n\n\tconst visitor: JSONVisitor = {\n\t\tonObjectBegin: (offset: number) => {\n\t\t\tcurrentParent = onValue({ type: 'object', offset, length: -1, parent: currentParent, children: [] });\n\t\t},\n\t\tonObjectProperty: (name: string, offset: number, length: number) => {\n\t\t\tcurrentParent = onValue({ type: 'property', offset, length: -1, parent: currentParent, children: [] });\n\t\t\tcurrentParent.children!.push({ type: 'string', value: name, offset, length, parent: currentParent });\n\t\t},\n\t\tonObjectEnd: (offset: number, length: number) => {\n\t\t\tcurrentParent.length = offset + length - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonArrayBegin: (offset: number, length: number) => {\n\t\t\tcurrentParent = onValue({ type: 'array', offset, length: -1, parent: currentParent, children: [] });\n\t\t},\n\t\tonArrayEnd: (offset: number, length: number) => {\n\t\t\tcurrentParent.length = offset + length - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonLiteralValue: (value: any, offset: number, length: number) => {\n\t\t\tonValue({ type: getLiteralNodeType(value), offset, length, parent: currentParent, value });\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonSeparator: (sep: string, offset: number, length: number) => {\n\t\t\tif (currentParent.type === 'property') {\n\t\t\t\tif (sep === ':') {\n\t\t\t\t\tcurrentParent.colonOffset = offset;\n\t\t\t\t} else if (sep === ',') {\n\t\t\t\t\tensurePropertyComplete(offset);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonError: (error: ParseErrorCode, offset: number, length: number) => {\n\t\t\terrors.push({ error, offset, length });\n\t\t}\n\t};\n\tvisit(text, visitor, options);\n\n\tconst result = currentParent.children![0];\n\tif (result) {\n\t\tdelete result.parent;\n\t}\n\treturn result;\n}\n\n/**\n * Finds the node at the given path in a JSON DOM.\n */\nexport function findNodeAtLocation(root: Node, path: JSONPath): Node | undefined {\n\tif (!root) {\n\t\treturn undefined;\n\t}\n\tlet node = root;\n\tfor (let segment of path) {\n\t\tif (typeof segment === 'string') {\n\t\t\tif (node.type !== 'object' || !Array.isArray(node.children)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tlet found = false;\n\t\t\tfor (const propertyNode of node.children) {\n\t\t\t\tif (Array.isArray(propertyNode.children) && propertyNode.children[0].value === segment) {\n\t\t\t\t\tnode = propertyNode.children[1];\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tconst index = <number>segment;\n\t\t\tif (node.type !== 'array' || index < 0 || !Array.isArray(node.children) || index >= node.children.length) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tnode = node.children[index];\n\t\t}\n\t}\n\treturn node;\n}\n\n/**\n * Gets the JSON path of the given JSON DOM node\n */\nexport function getNodePath(node: Node): JSONPath {\n\tif (!node.parent || !node.parent.children) {\n\t\treturn [];\n\t}\n\tconst path = getNodePath(node.parent);\n\tif (node.parent.type === 'property') {\n\t\tconst key = node.parent.children[0].value;\n\t\tpath.push(key);\n\t} else if (node.parent.type === 'array') {\n\t\tconst index = node.parent.children.indexOf(node);\n\t\tif (index !== -1) {\n\t\t\tpath.push(index);\n\t\t}\n\t}\n\treturn path;\n}\n\n/**\n * Evaluates the JavaScript object of the given JSON DOM node\n */\nexport function getNodeValue(node: Node): any {\n\tswitch (node.type) {\n\t\tcase 'array':\n\t\t\treturn node.children!.map(getNodeValue);\n\t\tcase 'object':\n\t\t\tconst obj = Object.create(null);\n\t\t\tfor (let prop of node.children!) {\n\t\t\t\tconst valueNode = prop.children![1];\n\t\t\t\tif (valueNode) {\n\t\t\t\t\tobj[prop.children![0].value] = getNodeValue(valueNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\tcase 'null':\n\t\tcase 'string':\n\t\tcase 'number':\n\t\tcase 'boolean':\n\t\t\treturn node.value;\n\t\tdefault:\n\t\t\treturn undefined;\n\t}\n\n}\n\nexport function contains(node: Node, offset: number, includeRightBound = false): boolean {\n\treturn (offset >= node.offset && offset < (node.offset + node.length)) || includeRightBound && (offset === (node.offset + node.length));\n}\n\n/**\n * Finds the most inner node at the given offset. If includeRightBound is set, also finds nodes that end at the given offset.\n */\nexport function findNodeAtOffset(node: Node, offset: number, includeRightBound = false): Node | undefined {\n\tif (contains(node, offset, includeRightBound)) {\n\t\tconst children = node.children;\n\t\tif (Array.isArray(children)) {\n\t\t\tfor (let i = 0; i < children.length && children[i].offset <= offset; i++) {\n\t\t\t\tconst item = findNodeAtOffset(children[i], offset, includeRightBound);\n\t\t\t\tif (item) {\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\treturn node;\n\t}\n\treturn undefined;\n}\n\n\n/**\n * Parses the given text and invokes the visitor functions for each object, array and literal reached.\n */\nexport function visit(text: string, visitor: JSONVisitor, options: ParseOptions = ParseOptions.DEFAULT): any {\n\n\tconst _scanner = createScanner(text, false);\n\n\tfunction toNoArgVisit(visitFunction?: (offset: number, length: number) => void): () => void {\n\t\treturn visitFunction ? () => visitFunction(_scanner.getTokenOffset(), _scanner.getTokenLength()) : () => true;\n\t}\n\tfunction toOneArgVisit<T>(visitFunction?: (arg: T, offset: number, length: number) => void): (arg: T) => void {\n\t\treturn visitFunction ? (arg: T) => visitFunction(arg, _scanner.getTokenOffset(), _scanner.getTokenLength()) : () => true;\n\t}\n\n\tconst onObjectBegin = toNoArgVisit(visitor.onObjectBegin),\n\t\tonObjectProperty = toOneArgVisit(visitor.onObjectProperty),\n\t\tonObjectEnd = toNoArgVisit(visitor.onObjectEnd),\n\t\tonArrayBegin = toNoArgVisit(visitor.onArrayBegin),\n\t\tonArrayEnd = toNoArgVisit(visitor.onArrayEnd),\n\t\tonLiteralValue = toOneArgVisit(visitor.onLiteralValue),\n\t\tonSeparator = toOneArgVisit(visitor.onSeparator),\n\t\tonComment = toNoArgVisit(visitor.onComment),\n\t\tonError = toOneArgVisit(visitor.onError);\n\n\tconst disallowComments = options && options.disallowComments;\n\tconst allowTrailingComma = options && options.allowTrailingComma;\n\tfunction scanNext(): SyntaxKind {\n\t\twhile (true) {\n\t\t\tconst token = _scanner.scan();\n\t\t\tswitch (_scanner.getTokenError()) {\n\t\t\t\tcase ScanError.InvalidUnicode:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidUnicode);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.InvalidEscapeCharacter:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidEscapeCharacter);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfNumber:\n\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfNumber);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfComment:\n\t\t\t\t\tif (!disallowComments) {\n\t\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfComment);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfString:\n\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfString);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.InvalidCharacter:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidCharacter);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tswitch (token) {\n\t\t\t\tcase SyntaxKind.LineCommentTrivia:\n\t\t\t\tcase SyntaxKind.BlockCommentTrivia:\n\t\t\t\t\tif (disallowComments) {\n\t\t\t\t\t\thandleError(ParseErrorCode.InvalidCommentToken);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tonComment();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.Unknown:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidSymbol);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.Trivia:\n\t\t\t\tcase SyntaxKind.LineBreakTrivia:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn token;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction handleError(error: ParseErrorCode, skipUntilAfter: SyntaxKind[] = [], skipUntil: SyntaxKind[] = []): void {\n\t\tonError(error);\n\t\tif (skipUntilAfter.length + skipUntil.length > 0) {\n\t\t\tlet token = _scanner.getToken();\n\t\t\twhile (token !== SyntaxKind.EOF) {\n\t\t\t\tif (skipUntilAfter.indexOf(token) !== -1) {\n\t\t\t\t\tscanNext();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (skipUntil.indexOf(token) !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttoken = scanNext();\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction parseString(isValue: boolean): boolean {\n\t\tconst value = _scanner.getTokenValue();\n\t\tif (isValue) {\n\t\t\tonLiteralValue(value);\n\t\t} else {\n\t\t\tonObjectProperty(value);\n\t\t}\n\t\tscanNext();\n\t\treturn true;\n\t}\n\n\tfunction parseLiteral(): boolean {\n\t\tswitch (_scanner.getToken()) {\n\t\t\tcase SyntaxKind.NumericLiteral:\n\t\t\t\tlet value = 0;\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(_scanner.getTokenValue());\n\t\t\t\t\tif (typeof value !== 'number') {\n\t\t\t\t\t\thandleError(ParseErrorCode.InvalidNumberFormat);\n\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\thandleError(ParseErrorCode.InvalidNumberFormat);\n\t\t\t\t}\n\t\t\t\tonLiteralValue(value);\n\t\t\t\tbreak;\n\t\t\tcase SyntaxKind.NullKeyword:\n\t\t\t\tonLiteralValue(null);\n\t\t\t\tbreak;\n\t\t\tcase SyntaxKind.TrueKeyword:\n\t\t\t\tonLiteralValue(true);\n\t\t\t\tbreak;\n\t\t\tcase SyntaxKind.FalseKeyword:\n\t\t\t\tonLiteralValue(false);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t\tscanNext();\n\t\treturn true;\n\t}\n\n\tfunction parseProperty(): boolean {\n\t\tif (_scanner.getToken() !== SyntaxKind.StringLiteral) {\n\t\t\thandleError(ParseErrorCode.PropertyNameExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\treturn false;\n\t\t}\n\t\tparseString(false);\n\t\tif (_scanner.getToken() === SyntaxKind.ColonToken) {\n\t\t\tonSeparator(':');\n\t\t\tscanNext(); // consume colon\n\n\t\t\tif (!parseValue()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t} else {\n\t\t\thandleError(ParseErrorCode.ColonExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseObject(): boolean {\n\t\tonObjectBegin();\n\t\tscanNext(); // consume open brace\n\n\t\tlet needsComma = false;\n\t\twhile (_scanner.getToken() !== SyntaxKind.CloseBraceToken && _scanner.getToken() !== SyntaxKind.EOF) {\n\t\t\tif (_scanner.getToken() === SyntaxKind.CommaToken) {\n\t\t\t\tif (!needsComma) {\n\t\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\t\t\t}\n\t\t\t\tonSeparator(',');\n\t\t\t\tscanNext(); // consume comma\n\t\t\t\tif (_scanner.getToken() === SyntaxKind.CloseBraceToken && allowTrailingComma) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (needsComma) {\n\t\t\t\thandleError(ParseErrorCode.CommaExpected, [], []);\n\t\t\t}\n\t\t\tif (!parseProperty()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t\tneedsComma = true;\n\t\t}\n\t\tonObjectEnd();\n\t\tif (_scanner.getToken() !== SyntaxKind.CloseBraceToken) {\n\t\t\thandleError(ParseErrorCode.CloseBraceExpected, [SyntaxKind.CloseBraceToken], []);\n\t\t} else {\n\t\t\tscanNext(); // consume close brace\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseArray(): boolean {\n\t\tonArrayBegin();\n\t\tscanNext(); // consume open bracket\n\n\t\tlet needsComma = false;\n\t\twhile (_scanner.getToken() !== SyntaxKind.CloseBracketToken && _scanner.getToken() !== SyntaxKind.EOF) {\n\t\t\tif (_scanner.getToken() === SyntaxKind.CommaToken) {\n\t\t\t\tif (!needsComma) {\n\t\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\t\t\t}\n\t\t\t\tonSeparator(',');\n\t\t\t\tscanNext(); // consume comma\n\t\t\t\tif (_scanner.getToken() === SyntaxKind.CloseBracketToken && allowTrailingComma) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (needsComma) {\n\t\t\t\thandleError(ParseErrorCode.CommaExpected, [], []);\n\t\t\t}\n\t\t\tif (!parseValue()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBracketToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t\tneedsComma = true;\n\t\t}\n\t\tonArrayEnd();\n\t\tif (_scanner.getToken() !== SyntaxKind.CloseBracketToken) {\n\t\t\thandleError(ParseErrorCode.CloseBracketExpected, [SyntaxKind.CloseBracketToken], []);\n\t\t} else {\n\t\t\tscanNext(); // consume close bracket\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseValue(): boolean {\n\t\tswitch (_scanner.getToken()) {\n\t\t\tcase SyntaxKind.OpenBracketToken:\n\t\t\t\treturn parseArray();\n\t\t\tcase SyntaxKind.OpenBraceToken:\n\t\t\t\treturn parseObject();\n\t\t\tcase SyntaxKind.StringLiteral:\n\t\t\t\treturn parseString(true);\n\t\t\tdefault:\n\t\t\t\treturn parseLiteral();\n\t\t}\n\t}\n\n\tscanNext();\n\tif (_scanner.getToken() === SyntaxKind.EOF) {\n\t\treturn true;\n\t}\n\tif (!parseValue()) {\n\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\treturn false;\n\t}\n\tif (_scanner.getToken() !== SyntaxKind.EOF) {\n\t\thandleError(ParseErrorCode.EndOfFileExpected, [], []);\n\t}\n\treturn true;\n}\n\n/**\n * Takes JSON with JavaScript-style comments and remove\n * them. Optionally replaces every none-newline character\n * of comments with a replaceCharacter\n */\nexport function stripComments(text: string, replaceCh?: string): string {\n\n\tlet _scanner = createScanner(text),\n\t\tparts: string[] = [],\n\t\tkind: SyntaxKind,\n\t\toffset = 0,\n\t\tpos: number;\n\n\tdo {\n\t\tpos = _scanner.getPosition();\n\t\tkind = _scanner.scan();\n\t\tswitch (kind) {\n\t\t\tcase SyntaxKind.LineCommentTrivia:\n\t\t\tcase SyntaxKind.BlockCommentTrivia:\n\t\t\tcase SyntaxKind.EOF:\n\t\t\t\tif (offset !== pos) {\n\t\t\t\t\tparts.push(text.substring(offset, pos));\n\t\t\t\t}\n\t\t\t\tif (replaceCh !== undefined) {\n\t\t\t\t\tparts.push(_scanner.getTokenValue().replace(/[^\\r\\n]/g, replaceCh));\n\t\t\t\t}\n\t\t\t\toffset = _scanner.getPosition();\n\t\t\t\tbreak;\n\t\t}\n\t} while (kind !== SyntaxKind.EOF);\n\n\treturn parts.join('');\n}\n\nfunction getLiteralNodeType(value: any): NodeType {\n\tswitch (typeof value) {\n\t\tcase 'boolean': return 'boolean';\n\t\tcase 'number': return 'number';\n\t\tcase 'string': return 'string';\n\t\tdefault: return 'null';\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createScanner, SyntaxKind, ScanError } from './json';\n\nexport interface FormattingOptions {\n\t/**\n\t * If indentation is based on spaces (`insertSpaces` = true), then what is the number of spaces that make an indent?\n\t */\n\ttabSize?: number;\n\t/**\n\t * Is indentation based on spaces?\n\t */\n\tinsertSpaces?: boolean;\n\t/**\n\t * The default 'end of line' character. If not set, '\\n' is used as default.\n\t */\n\teol?: string;\n}\n\n/**\n * Represents a text modification\n */\nexport interface Edit {\n\t/**\n\t * The start offset of the modification.\n\t */\n\toffset: number;\n\t/**\n\t * The length of the modification. Must not be negative. Empty length represents an *insert*.\n\t */\n\tlength: number;\n\t/**\n\t * The new content. Empty content represents a *remove*.\n\t */\n\tcontent: string;\n}\n\n/**\n * A text range in the document\n*/\nexport interface Range {\n\t/**\n\t * The start offset of the range.\n\t */\n\toffset: number;\n\t/**\n\t * The length of the range. Must not be negative.\n\t */\n\tlength: number;\n}\n\n\nexport function format(documentText: string, range: Range | undefined, options: FormattingOptions): Edit[] {\n\tlet initialIndentLevel: number;\n\tlet formatText: string;\n\tlet formatTextStart: number;\n\tlet rangeStart: number;\n\tlet rangeEnd: number;\n\tif (range) {\n\t\trangeStart = range.offset;\n\t\trangeEnd = rangeStart + range.length;\n\n\t\tformatTextStart = rangeStart;\n\t\twhile (formatTextStart > 0 && !isEOL(documentText, formatTextStart - 1)) {\n\t\t\tformatTextStart--;\n\t\t}\n\t\tlet endOffset = rangeEnd;\n\t\twhile (endOffset < documentText.length && !isEOL(documentText, endOffset)) {\n\t\t\tendOffset++;\n\t\t}\n\t\tformatText = documentText.substring(formatTextStart, endOffset);\n\t\tinitialIndentLevel = computeIndentLevel(formatText, options);\n\t} else {\n\t\tformatText = documentText;\n\t\tinitialIndentLevel = 0;\n\t\tformatTextStart = 0;\n\t\trangeStart = 0;\n\t\trangeEnd = documentText.length;\n\t}\n\tconst eol = getEOL(options, documentText);\n\n\tlet lineBreak = false;\n\tlet indentLevel = 0;\n\tlet indentValue: string;\n\tif (options.insertSpaces) {\n\t\tindentValue = repeat(' ', options.tabSize || 4);\n\t} else {\n\t\tindentValue = '\\t';\n\t}\n\n\tconst scanner = createScanner(formatText, false);\n\tlet hasError = false;\n\n\tfunction newLineAndIndent(): string {\n\t\treturn eol + repeat(indentValue, initialIndentLevel + indentLevel);\n\t}\n\tfunction scanNext(): SyntaxKind {\n\t\tlet token = scanner.scan();\n\t\tlineBreak = false;\n\t\twhile (token === SyntaxKind.Trivia || token === SyntaxKind.LineBreakTrivia) {\n\t\t\tlineBreak = lineBreak || (token === SyntaxKind.LineBreakTrivia);\n\t\t\ttoken = scanner.scan();\n\t\t}\n\t\thasError = token === SyntaxKind.Unknown || scanner.getTokenError() !== ScanError.None;\n\t\treturn token;\n\t}\n\tconst editOperations: Edit[] = [];\n\tfunction addEdit(text: string, startOffset: number, endOffset: number) {\n\t\tif (!hasError && startOffset < rangeEnd && endOffset > rangeStart && documentText.substring(startOffset, endOffset) !== text) {\n\t\t\teditOperations.push({ offset: startOffset, length: endOffset - startOffset, content: text });\n\t\t}\n\t}\n\n\tlet firstToken = scanNext();\n\n\tif (firstToken !== SyntaxKind.EOF) {\n\t\tconst firstTokenStart = scanner.getTokenOffset() + formatTextStart;\n\t\tconst initialIndent = repeat(indentValue, initialIndentLevel);\n\t\taddEdit(initialIndent, formatTextStart, firstTokenStart);\n\t}\n\n\twhile (firstToken !== SyntaxKind.EOF) {\n\t\tlet firstTokenEnd = scanner.getTokenOffset() + scanner.getTokenLength() + formatTextStart;\n\t\tlet secondToken = scanNext();\n\n\t\tlet replaceContent = '';\n\t\twhile (!lineBreak && (secondToken === SyntaxKind.LineCommentTrivia || secondToken === SyntaxKind.BlockCommentTrivia)) {\n\t\t\t// comments on the same line: keep them on the same line, but ignore them otherwise\n\t\t\tconst commentTokenStart = scanner.getTokenOffset() + formatTextStart;\n\t\t\taddEdit(' ', firstTokenEnd, commentTokenStart);\n\t\t\tfirstTokenEnd = scanner.getTokenOffset() + scanner.getTokenLength() + formatTextStart;\n\t\t\treplaceContent = secondToken === SyntaxKind.LineCommentTrivia ? newLineAndIndent() : '';\n\t\t\tsecondToken = scanNext();\n\t\t}\n\n\t\tif (secondToken === SyntaxKind.CloseBraceToken) {\n\t\t\tif (firstToken !== SyntaxKind.OpenBraceToken) {\n\t\t\t\tindentLevel--;\n\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t}\n\t\t} else if (secondToken === SyntaxKind.CloseBracketToken) {\n\t\t\tif (firstToken !== SyntaxKind.OpenBracketToken) {\n\t\t\t\tindentLevel--;\n\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t}\n\t\t} else {\n\t\t\tswitch (firstToken) {\n\t\t\t\tcase SyntaxKind.OpenBracketToken:\n\t\t\t\tcase SyntaxKind.OpenBraceToken:\n\t\t\t\t\tindentLevel++;\n\t\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.CommaToken:\n\t\t\t\tcase SyntaxKind.LineCommentTrivia:\n\t\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.BlockCommentTrivia:\n\t\t\t\t\tif (lineBreak) {\n\t\t\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// symbol following comment on the same line: keep on same line, separate with ' '\n\t\t\t\t\t\treplaceContent = ' ';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.ColonToken:\n\t\t\t\t\treplaceContent = ' ';\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.StringLiteral:\n\t\t\t\t\tif (secondToken === SyntaxKind.ColonToken) {\n\t\t\t\t\t\treplaceContent = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t// fall through\n\t\t\t\tcase SyntaxKind.NullKeyword:\n\t\t\t\tcase SyntaxKind.TrueKeyword:\n\t\t\t\tcase SyntaxKind.FalseKeyword:\n\t\t\t\tcase SyntaxKind.NumericLiteral:\n\t\t\t\tcase SyntaxKind.CloseBraceToken:\n\t\t\t\tcase SyntaxKind.CloseBracketToken:\n\t\t\t\t\tif (secondToken === SyntaxKind.LineCommentTrivia || secondToken === SyntaxKind.BlockCommentTrivia) {\n\t\t\t\t\t\treplaceContent = ' ';\n\t\t\t\t\t} else if (secondToken !== SyntaxKind.CommaToken && secondToken !== SyntaxKind.EOF) {\n\t\t\t\t\t\thasError = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.Unknown:\n\t\t\t\t\thasError = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (lineBreak && (secondToken === SyntaxKind.LineCommentTrivia || secondToken === SyntaxKind.BlockCommentTrivia)) {\n\t\t\t\treplaceContent = newLineAndIndent();\n\t\t\t}\n\n\t\t}\n\t\tconst secondTokenStart = scanner.getTokenOffset() + formatTextStart;\n\t\taddEdit(replaceContent, firstTokenEnd, secondTokenStart);\n\t\tfirstToken = secondToken;\n\t}\n\treturn editOperations;\n}\n\nfunction repeat(s: string, count: number): string {\n\tlet result = '';\n\tfor (let i = 0; i < count; i++) {\n\t\tresult += s;\n\t}\n\treturn result;\n}\n\nfunction computeIndentLevel(content: string, options: FormattingOptions): number {\n\tlet i = 0;\n\tlet nChars = 0;\n\tconst tabSize = options.tabSize || 4;\n\twhile (i < content.length) {\n\t\tconst ch = content.charAt(i);\n\t\tif (ch === ' ') {\n\t\t\tnChars++;\n\t\t} else if (ch === '\\t') {\n\t\t\tnChars += tabSize;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t\ti++;\n\t}\n\treturn Math.floor(nChars / tabSize);\n}\n\nfunction getEOL(options: FormattingOptions, text: string): string {\n\tfor (let i = 0; i < text.length; i++) {\n\t\tconst ch = text.charAt(i);\n\t\tif (ch === '\\r') {\n\t\t\tif (i + 1 < text.length && text.charAt(i + 1) === '\\n') {\n\t\t\t\treturn '\\r\\n';\n\t\t\t}\n\t\t\treturn '\\r';\n\t\t} else if (ch === '\\n') {\n\t\t\treturn '\\n';\n\t\t}\n\t}\n\treturn (options && options.eol) || '\\n';\n}\n\nexport function isEOL(text: string, offset: number) {\n\treturn '\\r\\n'.indexOf(text.charAt(offset)) !== -1;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ParseError, Node, JSONPath, Segment, parseTree, findNodeAtLocation } from './json';\nimport { Edit, format, isEOL, FormattingOptions } from './jsonFormatter';\n\n\nexport function removeProperty(text: string, path: JSONPath, formattingOptions: FormattingOptions): Edit[] {\n\treturn setProperty(text, path, undefined, formattingOptions);\n}\n\nexport function setProperty(text: string, originalPath: JSONPath, value: any, formattingOptions: FormattingOptions, getInsertionIndex?: (properties: string[]) => number): Edit[] {\n\tconst path = originalPath.slice();\n\tconst errors: ParseError[] = [];\n\tconst root = parseTree(text, errors);\n\tlet parent: Node | undefined = undefined;\n\n\tlet lastSegment: Segment | undefined = undefined;\n\twhile (path.length > 0) {\n\t\tlastSegment = path.pop();\n\t\tparent = findNodeAtLocation(root, path);\n\t\tif (parent === undefined && value !== undefined) {\n\t\t\tif (typeof lastSegment === 'string') {\n\t\t\t\tvalue = { [lastSegment]: value };\n\t\t\t} else {\n\t\t\t\tvalue = [value];\n\t\t\t}\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!parent) {\n\t\t// empty document\n\t\tif (value === undefined) { // delete\n\t\t\tthrow new Error('Can not delete in empty document');\n\t\t}\n\t\treturn withFormatting(text, { offset: root ? root.offset : 0, length: root ? root.length : 0, content: JSON.stringify(value) }, formattingOptions);\n\t} else if (parent.type === 'object' && typeof lastSegment === 'string' && Array.isArray(parent.children)) {\n\t\tconst existing = findNodeAtLocation(parent, [lastSegment]);\n\t\tif (existing !== undefined) {\n\t\t\tif (value === undefined) { // delete\n\t\t\t\tif (!existing.parent) {\n\t\t\t\t\tthrow new Error('Malformed AST');\n\t\t\t\t}\n\t\t\t\tconst propertyIndex = parent.children.indexOf(existing.parent);\n\t\t\t\tlet removeBegin: number;\n\t\t\t\tlet removeEnd = existing.parent.offset + existing.parent.length;\n\t\t\t\tif (propertyIndex > 0) {\n\t\t\t\t\t// remove the comma of the previous node\n\t\t\t\t\tconst previous = parent.children[propertyIndex - 1];\n\t\t\t\t\tremoveBegin = previous.offset + previous.length;\n\t\t\t\t} else {\n\t\t\t\t\tremoveBegin = parent.offset + 1;\n\t\t\t\t\tif (parent.children.length > 1) {\n\t\t\t\t\t\t// remove the comma of the next node\n\t\t\t\t\t\tconst next = parent.children[1];\n\t\t\t\t\t\tremoveEnd = next.offset;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn withFormatting(text, { offset: removeBegin, length: removeEnd - removeBegin, content: '' }, formattingOptions);\n\t\t\t} else {\n\t\t\t\t// set value of existing property\n\t\t\t\treturn withFormatting(text, { offset: existing.offset, length: existing.length, content: JSON.stringify(value) }, formattingOptions);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === undefined) { // delete\n\t\t\t\treturn []; // property does not exist, nothing to do\n\t\t\t}\n\t\t\tconst newProperty = `${JSON.stringify(lastSegment)}: ${JSON.stringify(value)}`;\n\t\t\tconst index = getInsertionIndex ? getInsertionIndex(parent.children.map(p => p.children![0].value)) : parent.children.length;\n\t\t\tlet edit: Edit;\n\t\t\tif (index > 0) {\n\t\t\t\tconst previous = parent.children[index - 1];\n\t\t\t\tedit = { offset: previous.offset + previous.length, length: 0, content: ',' + newProperty };\n\t\t\t} else if (parent.children.length === 0) {\n\t\t\t\tedit = { offset: parent.offset + 1, length: 0, content: newProperty };\n\t\t\t} else {\n\t\t\t\tedit = { offset: parent.offset + 1, length: 0, content: newProperty + ',' };\n\t\t\t}\n\t\t\treturn withFormatting(text, edit, formattingOptions);\n\t\t}\n\t} else if (parent.type === 'array' && typeof lastSegment === 'number' && Array.isArray(parent.children)) {\n\t\tconst insertIndex = lastSegment;\n\t\tif (insertIndex === -1) {\n\t\t\t// Insert\n\t\t\tconst newProperty = `${JSON.stringify(value)}`;\n\t\t\tlet edit: Edit;\n\t\t\tif (parent.children.length === 0) {\n\t\t\t\tedit = { offset: parent.offset + 1, length: 0, content: newProperty };\n\t\t\t} else {\n\t\t\t\tconst previous = parent.children[parent.children.length - 1];\n\t\t\t\tedit = { offset: previous.offset + previous.length, length: 0, content: ',' + newProperty };\n\t\t\t}\n\t\t\treturn withFormatting(text, edit, formattingOptions);\n\t\t} else {\n\t\t\tif (value === undefined && parent.children.length >= 0) {\n\t\t\t\t//Removal\n\t\t\t\tconst removalIndex = lastSegment;\n\t\t\t\tconst toRemove = parent.children[removalIndex];\n\t\t\t\tlet edit: Edit;\n\t\t\t\tif (parent.children.length === 1) {\n\t\t\t\t\t// only item\n\t\t\t\t\tedit = { offset: parent.offset + 1, length: parent.length - 2, content: '' };\n\t\t\t\t} else if (parent.children.length - 1 === removalIndex) {\n\t\t\t\t\t// last item\n\t\t\t\t\tconst previous = parent.children[removalIndex - 1];\n\t\t\t\t\tconst offset = previous.offset + previous.length;\n\t\t\t\t\tconst parentEndOffset = parent.offset + parent.length;\n\t\t\t\t\tedit = { offset, length: parentEndOffset - 2 - offset, content: '' };\n\t\t\t\t} else {\n\t\t\t\t\tedit = { offset: toRemove.offset, length: parent.children[removalIndex + 1].offset - toRemove.offset, content: '' };\n\t\t\t\t}\n\t\t\t\treturn withFormatting(text, edit, formattingOptions);\n\t\t\t} else {\n\t\t\t\tthrow new Error('Array modification not supported yet');\n\t\t\t}\n\t\t}\n\t} else {\n\t\tthrow new Error(`Can not add ${typeof lastSegment !== 'number' ? 'index' : 'property'} to parent of type ${parent.type}`);\n\t}\n}\n\nfunction withFormatting(text: string, edit: Edit, formattingOptions: FormattingOptions): Edit[] {\n\t// apply the edit\n\tlet newText = applyEdit(text, edit);\n\n\t// format the new text\n\tlet begin = edit.offset;\n\tlet end = edit.offset + edit.content.length;\n\tif (edit.length === 0 || edit.content.length === 0) { // insert or remove\n\t\twhile (begin > 0 && !isEOL(newText, begin - 1)) {\n\t\t\tbegin--;\n\t\t}\n\t\twhile (end < newText.length && !isEOL(newText, end)) {\n\t\t\tend++;\n\t\t}\n\t}\n\n\tconst edits = format(newText, { offset: begin, length: end - begin }, formattingOptions);\n\n\t// apply the formatting edits and track the begin and end offsets of the changes\n\tfor (let i = edits.length - 1; i >= 0; i--) {\n\t\tconst edit = edits[i];\n\t\tnewText = applyEdit(newText, edit);\n\t\tbegin = Math.min(begin, edit.offset);\n\t\tend = Math.max(end, edit.offset + edit.length);\n\t\tend += edit.content.length - edit.length;\n\t}\n\t// create a single edit with all changes\n\tconst editLength = text.length - (newText.length - end) - begin;\n\treturn [{ offset: begin, length: editLength, content: newText.substring(begin, end) }];\n}\n\nexport function applyEdit(text: string, edit: Edit): string {\n\treturn text.substring(0, edit.offset) + edit.content + text.substring(edit.offset + edit.length);\n}\n\nexport function isWS(text: string, offset: number) {\n\treturn '\\r\\n \\t'.indexOf(text.charAt(offset)) !== -1;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { OperatingSystem } from 'vs/base/common/platform';\nimport { illegalArgument } from 'vs/base/common/errors';\n\n/**\n * Virtual Key Codes, the value does not hold any inherent meaning.\n * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\n * But these are \"more general\", as they should work across browsers & OS`s.\n */\nexport const enum KeyCode {\n\t/**\n\t * Placed first to cover the 0 value of the enum.\n\t */\n\tUnknown = 0,\n\n\tBackspace = 1,\n\tTab = 2,\n\tEnter = 3,\n\tShift = 4,\n\tCtrl = 5,\n\tAlt = 6,\n\tPauseBreak = 7,\n\tCapsLock = 8,\n\tEscape = 9,\n\tSpace = 10,\n\tPageUp = 11,\n\tPageDown = 12,\n\tEnd = 13,\n\tHome = 14,\n\tLeftArrow = 15,\n\tUpArrow = 16,\n\tRightArrow = 17,\n\tDownArrow = 18,\n\tInsert = 19,\n\tDelete = 20,\n\n\tKEY_0 = 21,\n\tKEY_1 = 22,\n\tKEY_2 = 23,\n\tKEY_3 = 24,\n\tKEY_4 = 25,\n\tKEY_5 = 26,\n\tKEY_6 = 27,\n\tKEY_7 = 28,\n\tKEY_8 = 29,\n\tKEY_9 = 30,\n\n\tKEY_A = 31,\n\tKEY_B = 32,\n\tKEY_C = 33,\n\tKEY_D = 34,\n\tKEY_E = 35,\n\tKEY_F = 36,\n\tKEY_G = 37,\n\tKEY_H = 38,\n\tKEY_I = 39,\n\tKEY_J = 40,\n\tKEY_K = 41,\n\tKEY_L = 42,\n\tKEY_M = 43,\n\tKEY_N = 44,\n\tKEY_O = 45,\n\tKEY_P = 46,\n\tKEY_Q = 47,\n\tKEY_R = 48,\n\tKEY_S = 49,\n\tKEY_T = 50,\n\tKEY_U = 51,\n\tKEY_V = 52,\n\tKEY_W = 53,\n\tKEY_X = 54,\n\tKEY_Y = 55,\n\tKEY_Z = 56,\n\n\tMeta = 57,\n\tContextMenu = 58,\n\n\tF1 = 59,\n\tF2 = 60,\n\tF3 = 61,\n\tF4 = 62,\n\tF5 = 63,\n\tF6 = 64,\n\tF7 = 65,\n\tF8 = 66,\n\tF9 = 67,\n\tF10 = 68,\n\tF11 = 69,\n\tF12 = 70,\n\tF13 = 71,\n\tF14 = 72,\n\tF15 = 73,\n\tF16 = 74,\n\tF17 = 75,\n\tF18 = 76,\n\tF19 = 77,\n\n\tNumLock = 78,\n\tScrollLock = 79,\n\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ';:' key\n\t */\n\tUS_SEMICOLON = 80,\n\t/**\n\t * For any country/region, the '+' key\n\t * For the US standard keyboard, the '=+' key\n\t */\n\tUS_EQUAL = 81,\n\t/**\n\t * For any country/region, the ',' key\n\t * For the US standard keyboard, the ',<' key\n\t */\n\tUS_COMMA = 82,\n\t/**\n\t * For any country/region, the '-' key\n\t * For the US standard keyboard, the '-_' key\n\t */\n\tUS_MINUS = 83,\n\t/**\n\t * For any country/region, the '.' key\n\t * For the US standard keyboard, the '.>' key\n\t */\n\tUS_DOT = 84,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '/?' key\n\t */\n\tUS_SLASH = 85,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '`~' key\n\t */\n\tUS_BACKTICK = 86,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '[{' key\n\t */\n\tUS_OPEN_SQUARE_BRACKET = 87,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '\\|' key\n\t */\n\tUS_BACKSLASH = 88,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ']}' key\n\t */\n\tUS_CLOSE_SQUARE_BRACKET = 89,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ''\"' key\n\t */\n\tUS_QUOTE = 90,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t */\n\tOEM_8 = 91,\n\t/**\n\t * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\n\t */\n\tOEM_102 = 92,\n\n\tNUMPAD_0 = 93, // VK_NUMPAD0, 0x60, Numeric keypad 0 key\n\tNUMPAD_1 = 94, // VK_NUMPAD1, 0x61, Numeric keypad 1 key\n\tNUMPAD_2 = 95, // VK_NUMPAD2, 0x62, Numeric keypad 2 key\n\tNUMPAD_3 = 96, // VK_NUMPAD3, 0x63, Numeric keypad 3 key\n\tNUMPAD_4 = 97, // VK_NUMPAD4, 0x64, Numeric keypad 4 key\n\tNUMPAD_5 = 98, // VK_NUMPAD5, 0x65, Numeric keypad 5 key\n\tNUMPAD_6 = 99, // VK_NUMPAD6, 0x66, Numeric keypad 6 key\n\tNUMPAD_7 = 100, // VK_NUMPAD7, 0x67, Numeric keypad 7 key\n\tNUMPAD_8 = 101, // VK_NUMPAD8, 0x68, Numeric keypad 8 key\n\tNUMPAD_9 = 102, // VK_NUMPAD9, 0x69, Numeric keypad 9 key\n\n\tNUMPAD_MULTIPLY = 103,\t// VK_MULTIPLY, 0x6A, Multiply key\n\tNUMPAD_ADD = 104,\t\t// VK_ADD, 0x6B, Add key\n\tNUMPAD_SEPARATOR = 105,\t// VK_SEPARATOR, 0x6C, Separator key\n\tNUMPAD_SUBTRACT = 106,\t// VK_SUBTRACT, 0x6D, Subtract key\n\tNUMPAD_DECIMAL = 107,\t// VK_DECIMAL, 0x6E, Decimal key\n\tNUMPAD_DIVIDE = 108,\t// VK_DIVIDE, 0x6F,\n\n\t/**\n\t * Cover all key codes when IME is processing input.\n\t */\n\tKEY_IN_COMPOSITION = 109,\n\n\tABNT_C1 = 110, // Brazilian (ABNT) Keyboard\n\tABNT_C2 = 111, // Brazilian (ABNT) Keyboard\n\n\t/**\n\t * Placed last to cover the length of the enum.\n\t * Please do not depend on this value!\n\t */\n\tMAX_VALUE\n}\n\nclass KeyCodeStrMap {\n\n\tprivate _keyCodeToStr: string[];\n\tprivate _strToKeyCode: { [str: string]: KeyCode; };\n\n\tconstructor() {\n\t\tthis._keyCodeToStr = [];\n\t\tthis._strToKeyCode = Object.create(null);\n\t}\n\n\tdefine(keyCode: KeyCode, str: string): void {\n\t\tthis._keyCodeToStr[keyCode] = str;\n\t\tthis._strToKeyCode[str.toLowerCase()] = keyCode;\n\t}\n\n\tkeyCodeToStr(keyCode: KeyCode): string {\n\t\treturn this._keyCodeToStr[keyCode];\n\t}\n\n\tstrToKeyCode(str: string): KeyCode {\n\t\treturn this._strToKeyCode[str.toLowerCase()] || KeyCode.Unknown;\n\t}\n}\n\nconst uiMap = new KeyCodeStrMap();\nconst userSettingsUSMap = new KeyCodeStrMap();\nconst userSettingsGeneralMap = new KeyCodeStrMap();\n\n(function () {\n\n\tfunction define(keyCode: KeyCode, uiLabel: string, usUserSettingsLabel: string = uiLabel, generalUserSettingsLabel: string = usUserSettingsLabel): void {\n\t\tuiMap.define(keyCode, uiLabel);\n\t\tuserSettingsUSMap.define(keyCode, usUserSettingsLabel);\n\t\tuserSettingsGeneralMap.define(keyCode, generalUserSettingsLabel);\n\t}\n\n\tdefine(KeyCode.Unknown, 'unknown');\n\n\tdefine(KeyCode.Backspace, 'Backspace');\n\tdefine(KeyCode.Tab, 'Tab');\n\tdefine(KeyCode.Enter, 'Enter');\n\tdefine(KeyCode.Shift, 'Shift');\n\tdefine(KeyCode.Ctrl, 'Ctrl');\n\tdefine(KeyCode.Alt, 'Alt');\n\tdefine(KeyCode.PauseBreak, 'PauseBreak');\n\tdefine(KeyCode.CapsLock, 'CapsLock');\n\tdefine(KeyCode.Escape, 'Escape');\n\tdefine(KeyCode.Space, 'Space');\n\tdefine(KeyCode.PageUp, 'PageUp');\n\tdefine(KeyCode.PageDown, 'PageDown');\n\tdefine(KeyCode.End, 'End');\n\tdefine(KeyCode.Home, 'Home');\n\n\tdefine(KeyCode.LeftArrow, 'LeftArrow', 'Left');\n\tdefine(KeyCode.UpArrow, 'UpArrow', 'Up');\n\tdefine(KeyCode.RightArrow, 'RightArrow', 'Right');\n\tdefine(KeyCode.DownArrow, 'DownArrow', 'Down');\n\tdefine(KeyCode.Insert, 'Insert');\n\tdefine(KeyCode.Delete, 'Delete');\n\n\tdefine(KeyCode.KEY_0, '0');\n\tdefine(KeyCode.KEY_1, '1');\n\tdefine(KeyCode.KEY_2, '2');\n\tdefine(KeyCode.KEY_3, '3');\n\tdefine(KeyCode.KEY_4, '4');\n\tdefine(KeyCode.KEY_5, '5');\n\tdefine(KeyCode.KEY_6, '6');\n\tdefine(KeyCode.KEY_7, '7');\n\tdefine(KeyCode.KEY_8, '8');\n\tdefine(KeyCode.KEY_9, '9');\n\n\tdefine(KeyCode.KEY_A, 'A');\n\tdefine(KeyCode.KEY_B, 'B');\n\tdefine(KeyCode.KEY_C, 'C');\n\tdefine(KeyCode.KEY_D, 'D');\n\tdefine(KeyCode.KEY_E, 'E');\n\tdefine(KeyCode.KEY_F, 'F');\n\tdefine(KeyCode.KEY_G, 'G');\n\tdefine(KeyCode.KEY_H, 'H');\n\tdefine(KeyCode.KEY_I, 'I');\n\tdefine(KeyCode.KEY_J, 'J');\n\tdefine(KeyCode.KEY_K, 'K');\n\tdefine(KeyCode.KEY_L, 'L');\n\tdefine(KeyCode.KEY_M, 'M');\n\tdefine(KeyCode.KEY_N, 'N');\n\tdefine(KeyCode.KEY_O, 'O');\n\tdefine(KeyCode.KEY_P, 'P');\n\tdefine(KeyCode.KEY_Q, 'Q');\n\tdefine(KeyCode.KEY_R, 'R');\n\tdefine(KeyCode.KEY_S, 'S');\n\tdefine(KeyCode.KEY_T, 'T');\n\tdefine(KeyCode.KEY_U, 'U');\n\tdefine(KeyCode.KEY_V, 'V');\n\tdefine(KeyCode.KEY_W, 'W');\n\tdefine(KeyCode.KEY_X, 'X');\n\tdefine(KeyCode.KEY_Y, 'Y');\n\tdefine(KeyCode.KEY_Z, 'Z');\n\n\tdefine(KeyCode.Meta, 'Meta');\n\tdefine(KeyCode.ContextMenu, 'ContextMenu');\n\n\tdefine(KeyCode.F1, 'F1');\n\tdefine(KeyCode.F2, 'F2');\n\tdefine(KeyCode.F3, 'F3');\n\tdefine(KeyCode.F4, 'F4');\n\tdefine(KeyCode.F5, 'F5');\n\tdefine(KeyCode.F6, 'F6');\n\tdefine(KeyCode.F7, 'F7');\n\tdefine(KeyCode.F8, 'F8');\n\tdefine(KeyCode.F9, 'F9');\n\tdefine(KeyCode.F10, 'F10');\n\tdefine(KeyCode.F11, 'F11');\n\tdefine(KeyCode.F12, 'F12');\n\tdefine(KeyCode.F13, 'F13');\n\tdefine(KeyCode.F14, 'F14');\n\tdefine(KeyCode.F15, 'F15');\n\tdefine(KeyCode.F16, 'F16');\n\tdefine(KeyCode.F17, 'F17');\n\tdefine(KeyCode.F18, 'F18');\n\tdefine(KeyCode.F19, 'F19');\n\n\tdefine(KeyCode.NumLock, 'NumLock');\n\tdefine(KeyCode.ScrollLock, 'ScrollLock');\n\n\tdefine(KeyCode.US_SEMICOLON, ';', ';', 'OEM_1');\n\tdefine(KeyCode.US_EQUAL, '=', '=', 'OEM_PLUS');\n\tdefine(KeyCode.US_COMMA, ',', ',', 'OEM_COMMA');\n\tdefine(KeyCode.US_MINUS, '-', '-', 'OEM_MINUS');\n\tdefine(KeyCode.US_DOT, '.', '.', 'OEM_PERIOD');\n\tdefine(KeyCode.US_SLASH, '/', '/', 'OEM_2');\n\tdefine(KeyCode.US_BACKTICK, '`', '`', 'OEM_3');\n\tdefine(KeyCode.ABNT_C1, 'ABNT_C1');\n\tdefine(KeyCode.ABNT_C2, 'ABNT_C2');\n\tdefine(KeyCode.US_OPEN_SQUARE_BRACKET, '[', '[', 'OEM_4');\n\tdefine(KeyCode.US_BACKSLASH, '\\\\', '\\\\', 'OEM_5');\n\tdefine(KeyCode.US_CLOSE_SQUARE_BRACKET, ']', ']', 'OEM_6');\n\tdefine(KeyCode.US_QUOTE, '\\'', '\\'', 'OEM_7');\n\tdefine(KeyCode.OEM_8, 'OEM_8');\n\tdefine(KeyCode.OEM_102, 'OEM_102');\n\n\tdefine(KeyCode.NUMPAD_0, 'NumPad0');\n\tdefine(KeyCode.NUMPAD_1, 'NumPad1');\n\tdefine(KeyCode.NUMPAD_2, 'NumPad2');\n\tdefine(KeyCode.NUMPAD_3, 'NumPad3');\n\tdefine(KeyCode.NUMPAD_4, 'NumPad4');\n\tdefine(KeyCode.NUMPAD_5, 'NumPad5');\n\tdefine(KeyCode.NUMPAD_6, 'NumPad6');\n\tdefine(KeyCode.NUMPAD_7, 'NumPad7');\n\tdefine(KeyCode.NUMPAD_8, 'NumPad8');\n\tdefine(KeyCode.NUMPAD_9, 'NumPad9');\n\n\tdefine(KeyCode.NUMPAD_MULTIPLY, 'NumPad_Multiply');\n\tdefine(KeyCode.NUMPAD_ADD, 'NumPad_Add');\n\tdefine(KeyCode.NUMPAD_SEPARATOR, 'NumPad_Separator');\n\tdefine(KeyCode.NUMPAD_SUBTRACT, 'NumPad_Subtract');\n\tdefine(KeyCode.NUMPAD_DECIMAL, 'NumPad_Decimal');\n\tdefine(KeyCode.NUMPAD_DIVIDE, 'NumPad_Divide');\n\n})();\n\nexport namespace KeyCodeUtils {\n\texport function toString(keyCode: KeyCode): string {\n\t\treturn uiMap.keyCodeToStr(keyCode);\n\t}\n\texport function fromString(key: string): KeyCode {\n\t\treturn uiMap.strToKeyCode(key);\n\t}\n\n\texport function toUserSettingsUS(keyCode: KeyCode): string {\n\t\treturn userSettingsUSMap.keyCodeToStr(keyCode);\n\t}\n\texport function toUserSettingsGeneral(keyCode: KeyCode): string {\n\t\treturn userSettingsGeneralMap.keyCodeToStr(keyCode);\n\t}\n\texport function fromUserSettings(key: string): KeyCode {\n\t\treturn userSettingsUSMap.strToKeyCode(key) || userSettingsGeneralMap.strToKeyCode(key);\n\t}\n}\n\n/**\n * Binary encoding strategy:\n * ```\n *    1111 11\n *    5432 1098 7654 3210\n *    ---- CSAW KKKK KKKK\n *  C = bit 11 = ctrlCmd flag\n *  S = bit 10 = shift flag\n *  A = bit 9 = alt flag\n *  W = bit 8 = winCtrl flag\n *  K = bits 0-7 = key code\n * ```\n */\nconst enum BinaryKeybindingsMask {\n\tCtrlCmd = (1 << 11) >>> 0,\n\tShift = (1 << 10) >>> 0,\n\tAlt = (1 << 9) >>> 0,\n\tWinCtrl = (1 << 8) >>> 0,\n\tKeyCode = 0x000000FF\n}\n\nexport const enum KeyMod {\n\tCtrlCmd = (1 << 11) >>> 0,\n\tShift = (1 << 10) >>> 0,\n\tAlt = (1 << 9) >>> 0,\n\tWinCtrl = (1 << 8) >>> 0,\n}\n\nexport function KeyChord(firstPart: number, secondPart: number): number {\n\tconst chordPart = ((secondPart & 0x0000FFFF) << 16) >>> 0;\n\treturn (firstPart | chordPart) >>> 0;\n}\n\nexport function createKeybinding(keybinding: number, OS: OperatingSystem): Keybinding | null {\n\tif (keybinding === 0) {\n\t\treturn null;\n\t}\n\tconst firstPart = (keybinding & 0x0000FFFF) >>> 0;\n\tconst chordPart = (keybinding & 0xFFFF0000) >>> 16;\n\tif (chordPart !== 0) {\n\t\treturn new ChordKeybinding([\n\t\t\tcreateSimpleKeybinding(firstPart, OS),\n\t\t\tcreateSimpleKeybinding(chordPart, OS)\n\t\t]);\n\t}\n\treturn new ChordKeybinding([createSimpleKeybinding(firstPart, OS)]);\n}\n\nexport function createSimpleKeybinding(keybinding: number, OS: OperatingSystem): SimpleKeybinding {\n\n\tconst ctrlCmd = (keybinding & BinaryKeybindingsMask.CtrlCmd ? true : false);\n\tconst winCtrl = (keybinding & BinaryKeybindingsMask.WinCtrl ? true : false);\n\n\tconst ctrlKey = (OS === OperatingSystem.Macintosh ? winCtrl : ctrlCmd);\n\tconst shiftKey = (keybinding & BinaryKeybindingsMask.Shift ? true : false);\n\tconst altKey = (keybinding & BinaryKeybindingsMask.Alt ? true : false);\n\tconst metaKey = (OS === OperatingSystem.Macintosh ? ctrlCmd : winCtrl);\n\tconst keyCode = (keybinding & BinaryKeybindingsMask.KeyCode);\n\n\treturn new SimpleKeybinding(ctrlKey, shiftKey, altKey, metaKey, keyCode);\n}\n\nexport class SimpleKeybinding {\n\tpublic readonly ctrlKey: boolean;\n\tpublic readonly shiftKey: boolean;\n\tpublic readonly altKey: boolean;\n\tpublic readonly metaKey: boolean;\n\tpublic readonly keyCode: KeyCode;\n\n\tconstructor(ctrlKey: boolean, shiftKey: boolean, altKey: boolean, metaKey: boolean, keyCode: KeyCode) {\n\t\tthis.ctrlKey = ctrlKey;\n\t\tthis.shiftKey = shiftKey;\n\t\tthis.altKey = altKey;\n\t\tthis.metaKey = metaKey;\n\t\tthis.keyCode = keyCode;\n\t}\n\n\tpublic equals(other: SimpleKeybinding): boolean {\n\t\treturn (\n\t\t\tthis.ctrlKey === other.ctrlKey\n\t\t\t&& this.shiftKey === other.shiftKey\n\t\t\t&& this.altKey === other.altKey\n\t\t\t&& this.metaKey === other.metaKey\n\t\t\t&& this.keyCode === other.keyCode\n\t\t);\n\t}\n\n\tpublic getHashCode(): string {\n\t\tconst ctrl = this.ctrlKey ? '1' : '0';\n\t\tconst shift = this.shiftKey ? '1' : '0';\n\t\tconst alt = this.altKey ? '1' : '0';\n\t\tconst meta = this.metaKey ? '1' : '0';\n\t\treturn `${ctrl}${shift}${alt}${meta}${this.keyCode}`;\n\t}\n\n\tpublic isModifierKey(): boolean {\n\t\treturn (\n\t\t\tthis.keyCode === KeyCode.Unknown\n\t\t\t|| this.keyCode === KeyCode.Ctrl\n\t\t\t|| this.keyCode === KeyCode.Meta\n\t\t\t|| this.keyCode === KeyCode.Alt\n\t\t\t|| this.keyCode === KeyCode.Shift\n\t\t);\n\t}\n\n\tpublic toChord(): ChordKeybinding {\n\t\treturn new ChordKeybinding([this]);\n\t}\n\n\t/**\n\t * Does this keybinding refer to the key code of a modifier and it also has the modifier flag?\n\t */\n\tpublic isDuplicateModifierCase(): boolean {\n\t\treturn (\n\t\t\t(this.ctrlKey && this.keyCode === KeyCode.Ctrl)\n\t\t\t|| (this.shiftKey && this.keyCode === KeyCode.Shift)\n\t\t\t|| (this.altKey && this.keyCode === KeyCode.Alt)\n\t\t\t|| (this.metaKey && this.keyCode === KeyCode.Meta)\n\t\t);\n\t}\n}\n\nexport class ChordKeybinding {\n\tpublic readonly parts: SimpleKeybinding[];\n\n\tconstructor(parts: SimpleKeybinding[]) {\n\t\tif (parts.length === 0) {\n\t\t\tthrow illegalArgument(`parts`);\n\t\t}\n\t\tthis.parts = parts;\n\t}\n\n\tpublic getHashCode(): string {\n\t\tlet result = '';\n\t\tfor (let i = 0, len = this.parts.length; i < len; i++) {\n\t\t\tif (i !== 0) {\n\t\t\t\tresult += ';';\n\t\t\t}\n\t\t\tresult += this.parts[i].getHashCode();\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic equals(other: ChordKeybinding | null): boolean {\n\t\tif (other === null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.parts.length !== other.parts.length) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (let i = 0; i < this.parts.length; i++) {\n\t\t\tif (!this.parts[i].equals(other.parts[i])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n}\n\nexport type Keybinding = ChordKeybinding;\n\nexport class ResolvedKeybindingPart {\n\treadonly ctrlKey: boolean;\n\treadonly shiftKey: boolean;\n\treadonly altKey: boolean;\n\treadonly metaKey: boolean;\n\n\treadonly keyLabel: string | null;\n\treadonly keyAriaLabel: string | null;\n\n\tconstructor(ctrlKey: boolean, shiftKey: boolean, altKey: boolean, metaKey: boolean, kbLabel: string | null, kbAriaLabel: string | null) {\n\t\tthis.ctrlKey = ctrlKey;\n\t\tthis.shiftKey = shiftKey;\n\t\tthis.altKey = altKey;\n\t\tthis.metaKey = metaKey;\n\t\tthis.keyLabel = kbLabel;\n\t\tthis.keyAriaLabel = kbAriaLabel;\n\t}\n}\n\n/**\n * A resolved keybinding. Can be a simple keybinding or a chord keybinding.\n */\nexport abstract class ResolvedKeybinding {\n\t/**\n\t * This prints the binding in a format suitable for displaying in the UI.\n\t */\n\tpublic abstract getLabel(): string | null;\n\t/**\n\t * This prints the binding in a format suitable for ARIA.\n\t */\n\tpublic abstract getAriaLabel(): string | null;\n\t/**\n\t * This prints the binding in a format suitable for electron's accelerators.\n\t * See https://github.com/electron/electron/blob/master/docs/api/accelerator.md\n\t */\n\tpublic abstract getElectronAccelerator(): string | null;\n\t/**\n\t * This prints the binding in a format suitable for user settings.\n\t */\n\tpublic abstract getUserSettingsLabel(): string | null;\n\t/**\n\t * Is the user settings label reflecting the label?\n\t */\n\tpublic abstract isWYSIWYG(): boolean;\n\n\t/**\n\t * Is the binding a chord?\n\t */\n\tpublic abstract isChord(): boolean;\n\n\t/**\n\t * Returns the parts that comprise of the keybinding.\n\t * Simple keybindings return one element.\n\t */\n\tpublic abstract getParts(): ResolvedKeybindingPart[];\n\n\t/**\n\t * Returns the parts that should be used for dispatching.\n\t */\n\tpublic abstract getDispatchParts(): (string | null)[];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { once } from 'vs/base/common/functional';\n\nexport interface IDisposable {\n\tdispose(): void;\n}\n\nexport function isDisposable<E extends object>(thing: E): thing is E & IDisposable {\n\treturn typeof (<IDisposable><any>thing).dispose === 'function'\n\t\t&& (<IDisposable><any>thing).dispose.length === 0;\n}\n\nexport function dispose<T extends IDisposable>(disposable: T): T;\nexport function dispose<T extends IDisposable>(...disposables: Array<T | undefined>): T[];\nexport function dispose<T extends IDisposable>(disposables: T[]): T[];\nexport function dispose<T extends IDisposable>(first: T | T[], ...rest: T[]): T | T[] | undefined {\n\tif (Array.isArray(first)) {\n\t\tfirst.forEach(d => d && d.dispose());\n\t\treturn [];\n\t} else if (rest.length === 0) {\n\t\tif (first) {\n\t\t\tfirst.dispose();\n\t\t\treturn first;\n\t\t}\n\t\treturn undefined;\n\t} else {\n\t\tdispose(first);\n\t\tdispose(rest);\n\t\treturn [];\n\t}\n}\n\nexport function combinedDisposable(disposables: IDisposable[]): IDisposable {\n\treturn { dispose: () => dispose(disposables) };\n}\n\nexport function toDisposable(fn: () => void): IDisposable {\n\treturn { dispose() { fn(); } };\n}\n\nexport abstract class Disposable implements IDisposable {\n\n\tstatic None = Object.freeze<IDisposable>({ dispose() { } });\n\n\tprotected _toDispose: IDisposable[] = [];\n\tprotected get toDispose(): IDisposable[] { return this._toDispose; }\n\n\tprivate _lifecycle_disposable_isDisposed = false;\n\n\tpublic dispose(): void {\n\t\tthis._lifecycle_disposable_isDisposed = true;\n\t\tthis._toDispose = dispose(this._toDispose);\n\t}\n\n\tprotected _register<T extends IDisposable>(t: T): T {\n\t\tif (this._lifecycle_disposable_isDisposed) {\n\t\t\tconsole.warn('Registering disposable on object that has already been disposed.');\n\t\t\tt.dispose();\n\t\t} else {\n\t\t\tthis._toDispose.push(t);\n\t\t}\n\n\t\treturn t;\n\t}\n}\n\nexport interface IReference<T> extends IDisposable {\n\treadonly object: T;\n}\n\nexport abstract class ReferenceCollection<T> {\n\n\tprivate references: { [key: string]: { readonly object: T; counter: number; } } = Object.create(null);\n\n\tconstructor() { }\n\n\tacquire(key: string): IReference<T> {\n\t\tlet reference = this.references[key];\n\n\t\tif (!reference) {\n\t\t\treference = this.references[key] = { counter: 0, object: this.createReferencedObject(key) };\n\t\t}\n\n\t\tconst { object } = reference;\n\t\tconst dispose = once(() => {\n\t\t\tif (--reference.counter === 0) {\n\t\t\t\tthis.destroyReferencedObject(key, reference.object);\n\t\t\t\tdelete this.references[key];\n\t\t\t}\n\t\t});\n\n\t\treference.counter++;\n\n\t\treturn { object, dispose };\n\t}\n\n\tprotected abstract createReferencedObject(key: string): T;\n\tprotected abstract destroyReferencedObject(key: string, object: T): void;\n}\n\nexport class ImmortalReference<T> implements IReference<T> {\n\tconstructor(public object: T) { }\n\tdispose(): void { /* noop */ }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Iterator, IteratorResult, FIN } from 'vs/base/common/iterator';\n\nclass Node<E> {\n\telement: E;\n\tnext: Node<E> | undefined;\n\tprev: Node<E> | undefined;\n\n\tconstructor(element: E) {\n\t\tthis.element = element;\n\t}\n}\n\nexport class LinkedList<E> {\n\n\tprivate _first: Node<E> | undefined;\n\tprivate _last: Node<E> | undefined;\n\tprivate _size: number = 0;\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn !this._first;\n\t}\n\n\tclear(): void {\n\t\tthis._first = undefined;\n\t\tthis._last = undefined;\n\t\tthis._size = 0;\n\t}\n\n\tunshift(element: E): () => void {\n\t\treturn this._insert(element, false);\n\t}\n\n\tpush(element: E): () => void {\n\t\treturn this._insert(element, true);\n\t}\n\n\tprivate _insert(element: E, atTheEnd: boolean): () => void {\n\t\tconst newNode = new Node(element);\n\t\tif (!this._first) {\n\t\t\tthis._first = newNode;\n\t\t\tthis._last = newNode;\n\n\t\t} else if (atTheEnd) {\n\t\t\t// push\n\t\t\tconst oldLast = this._last!;\n\t\t\tthis._last = newNode;\n\t\t\tnewNode.prev = oldLast;\n\t\t\toldLast.next = newNode;\n\n\t\t} else {\n\t\t\t// unshift\n\t\t\tconst oldFirst = this._first;\n\t\t\tthis._first = newNode;\n\t\t\tnewNode.next = oldFirst;\n\t\t\toldFirst.prev = newNode;\n\t\t}\n\t\tthis._size += 1;\n\t\treturn this._remove.bind(this, newNode);\n\t}\n\n\n\tshift(): E | undefined {\n\t\tif (!this._first) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tconst res = this._first.element;\n\t\t\tthis._remove(this._first);\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tpop(): E | undefined {\n\t\tif (!this._last) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tconst res = this._last.element;\n\t\t\tthis._remove(this._last);\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tprivate _remove(node: Node<E>): void {\n\t\tlet candidate: Node<E> | undefined = this._first;\n\t\twhile (candidate instanceof Node) {\n\t\t\tif (candidate !== node) {\n\t\t\t\tcandidate = candidate.next;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (candidate.prev && candidate.next) {\n\t\t\t\t// middle\n\t\t\t\tconst anchor = candidate.prev;\n\t\t\t\tanchor.next = candidate.next;\n\t\t\t\tcandidate.next.prev = anchor;\n\n\t\t\t} else if (!candidate.prev && !candidate.next) {\n\t\t\t\t// only node\n\t\t\t\tthis._first = undefined;\n\t\t\t\tthis._last = undefined;\n\n\t\t\t} else if (!candidate.next) {\n\t\t\t\t// last\n\t\t\t\tthis._last = this._last!.prev!;\n\t\t\t\tthis._last.next = undefined;\n\n\t\t\t} else if (!candidate.prev) {\n\t\t\t\t// first\n\t\t\t\tthis._first = this._first!.next!;\n\t\t\t\tthis._first.prev = undefined;\n\t\t\t}\n\n\t\t\t// done\n\t\t\tthis._size -= 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\titerator(): Iterator<E> {\n\t\tlet element: { done: false; value: E; };\n\t\tlet node = this._first;\n\t\treturn {\n\t\t\tnext(): IteratorResult<E> {\n\t\t\t\tif (!node) {\n\t\t\t\t\treturn FIN;\n\t\t\t\t}\n\n\t\t\t\tif (!element) {\n\t\t\t\t\telement = { done: false, value: node.element };\n\t\t\t\t} else {\n\t\t\t\t\telement.value = node.element;\n\t\t\t\t}\n\t\t\t\tnode = node.next;\n\t\t\t\treturn element;\n\t\t\t}\n\t\t};\n\t}\n\n\ttoArray(): E[] {\n\t\tconst result: E[] = [];\n\t\tfor (let node = this._first; node instanceof Node; node = node.next) {\n\t\t\tresult.push(node.element);\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { once as onceFn } from 'vs/base/common/functional';\nimport { combinedDisposable, Disposable, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { LinkedList } from 'vs/base/common/linkedList';\n\n/**\n * To an event a function with one or zero parameters\n * can be subscribed. The event is the subscriber function itself.\n */\nexport interface Event<T> {\n\t(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[]): IDisposable;\n}\n\nexport namespace Event {\n\tconst _disposable = { dispose() { } };\n\texport const None: Event<any> = function () { return _disposable; };\n\n\t/**\n\t * Given an event, returns another event which only fires once.\n\t */\n\texport function once<T>(event: Event<T>): Event<T> {\n\t\treturn (listener, thisArgs = null, disposables?) => {\n\t\t\t// we need this, in case the event fires during the listener call\n\t\t\tlet didFire = false;\n\t\t\tlet result: IDisposable;\n\t\t\tresult = event(e => {\n\t\t\t\tif (didFire) {\n\t\t\t\t\treturn;\n\t\t\t\t} else if (result) {\n\t\t\t\t\tresult.dispose();\n\t\t\t\t} else {\n\t\t\t\t\tdidFire = true;\n\t\t\t\t}\n\n\t\t\t\treturn listener.call(thisArgs, e);\n\t\t\t}, null, disposables);\n\n\t\t\tif (didFire) {\n\t\t\t\tresult.dispose();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\t/**\n\t * Given an event and a `map` function, returns another event which maps each element\n\t * throught the mapping function.\n\t */\n\texport function map<I, O>(event: Event<I>, map: (i: I) => O): Event<O> {\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(i => listener.call(thisArgs, map(i)), null, disposables));\n\t}\n\n\t/**\n\t * Given an event and an `each` function, returns another identical event and calls\n\t * the `each` function per each element.\n\t */\n\texport function forEach<I>(event: Event<I>, each: (i: I) => void): Event<I> {\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(i => { each(i); listener.call(thisArgs, i); }, null, disposables));\n\t}\n\n\t/**\n\t * Given an event and a `filter` function, returns another event which emits those\n\t * elements for which the `filter` function returns `true`.\n\t */\n\texport function filter<T>(event: Event<T>, filter: (e: T) => boolean): Event<T>;\n\texport function filter<T, R>(event: Event<T | R>, filter: (e: T | R) => e is R): Event<R>;\n\texport function filter<T>(event: Event<T>, filter: (e: T) => boolean): Event<T> {\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(e => filter(e) && listener.call(thisArgs, e), null, disposables));\n\t}\n\n\t/**\n\t * Given an event, returns the same event but typed as `Event<void>`.\n\t */\n\texport function signal<T>(event: Event<T>): Event<void> {\n\t\treturn event as Event<any> as Event<void>;\n\t}\n\n\t/**\n\t * Given a collection of events, returns a single event which emits\n\t * whenever any of the provided events emit.\n\t */\n\texport function any<T>(...events: Event<T>[]): Event<T> {\n\t\treturn (listener, thisArgs = null, disposables?) => combinedDisposable(events.map(event => event(e => listener.call(thisArgs, e), null, disposables)));\n\t}\n\n\t/**\n\t * Given an event and a `merge` function, returns another event which maps each element\n\t * and the cummulative result throught the `merge` function. Similar to `map`, but with memory.\n\t */\n\texport function reduce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, initial?: O): Event<O> {\n\t\tlet output: O | undefined = initial;\n\n\t\treturn map<I, O>(event, e => {\n\t\t\toutput = merge(output, e);\n\t\t\treturn output;\n\t\t});\n\t}\n\n\t/**\n\t * Given a chain of event processing functions (filter, map, etc), each\n\t * function will be invoked per event & per listener. Snapshotting an event\n\t * chain allows each function to be invoked just once per event.\n\t */\n\texport function snapshot<T>(event: Event<T>): Event<T> {\n\t\tlet listener: IDisposable;\n\t\tconst emitter = new Emitter<T>({\n\t\t\tonFirstListenerAdd() {\n\t\t\t\tlistener = event(emitter.fire, emitter);\n\t\t\t},\n\t\t\tonLastListenerRemove() {\n\t\t\t\tlistener.dispose();\n\t\t\t}\n\t\t});\n\n\t\treturn emitter.event;\n\t}\n\n\t/**\n\t * Debounces the provided event, given a `merge` function.\n\t *\n\t * @param event The input event.\n\t * @param merge The reducing function.\n\t * @param delay The debouncing delay in millis.\n\t * @param leading Whether the event should fire in the leading phase of the timeout.\n\t * @param leakWarningThreshold The leak warning threshold override.\n\t */\n\texport function debounce<T>(event: Event<T>, merge: (last: T, event: T) => T, delay?: number, leading?: boolean, leakWarningThreshold?: number): Event<T>;\n\texport function debounce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, delay?: number, leading?: boolean, leakWarningThreshold?: number): Event<O>;\n\texport function debounce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, delay: number = 100, leading = false, leakWarningThreshold?: number): Event<O> {\n\n\t\tlet subscription: IDisposable;\n\t\tlet output: O | undefined = undefined;\n\t\tlet handle: any = undefined;\n\t\tlet numDebouncedCalls = 0;\n\n\t\tconst emitter = new Emitter<O>({\n\t\t\tleakWarningThreshold,\n\t\t\tonFirstListenerAdd() {\n\t\t\t\tsubscription = event(cur => {\n\t\t\t\t\tnumDebouncedCalls++;\n\t\t\t\t\toutput = merge(output, cur);\n\n\t\t\t\t\tif (leading && !handle) {\n\t\t\t\t\t\temitter.fire(output);\n\t\t\t\t\t}\n\n\t\t\t\t\tclearTimeout(handle);\n\t\t\t\t\thandle = setTimeout(() => {\n\t\t\t\t\t\tconst _output = output;\n\t\t\t\t\t\toutput = undefined;\n\t\t\t\t\t\thandle = undefined;\n\t\t\t\t\t\tif (!leading || numDebouncedCalls > 1) {\n\t\t\t\t\t\t\temitter.fire(_output!);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnumDebouncedCalls = 0;\n\t\t\t\t\t}, delay);\n\t\t\t\t});\n\t\t\t},\n\t\t\tonLastListenerRemove() {\n\t\t\t\tsubscription.dispose();\n\t\t\t}\n\t\t});\n\n\t\treturn emitter.event;\n\t}\n\n\t/**\n\t * Given an event, it returns another event which fires only once and as soon as\n\t * the input event emits. The event data is the number of millis it took for the\n\t * event to fire.\n\t */\n\texport function stopwatch<T>(event: Event<T>): Event<number> {\n\t\tconst start = new Date().getTime();\n\t\treturn map(once(event), _ => new Date().getTime() - start);\n\t}\n\n\t/**\n\t * Given an event, it returns another event which fires only when the event\n\t * element changes.\n\t */\n\texport function latch<T>(event: Event<T>): Event<T> {\n\t\tlet firstCall = true;\n\t\tlet cache: T;\n\n\t\treturn filter(event, value => {\n\t\t\tconst shouldEmit = firstCall || value !== cache;\n\t\t\tfirstCall = false;\n\t\t\tcache = value;\n\t\t\treturn shouldEmit;\n\t\t});\n\t}\n\n\t/**\n\t * Buffers the provided event until a first listener comes\n\t * along, at which point fire all the events at once and\n\t * pipe the event from then on.\n\t *\n\t * ```typescript\n\t * const emitter = new Emitter<number>();\n\t * const event = emitter.event;\n\t * const bufferedEvent = buffer(event);\n\t *\n\t * emitter.fire(1);\n\t * emitter.fire(2);\n\t * emitter.fire(3);\n\t * // nothing...\n\t *\n\t * const listener = bufferedEvent(num => console.log(num));\n\t * // 1, 2, 3\n\t *\n\t * emitter.fire(4);\n\t * // 4\n\t * ```\n\t */\n\texport function buffer<T>(event: Event<T>, nextTick = false, _buffer: T[] = []): Event<T> {\n\t\tlet buffer: T[] | null = _buffer.slice();\n\n\t\tlet listener: IDisposable | null = event(e => {\n\t\t\tif (buffer) {\n\t\t\t\tbuffer.push(e);\n\t\t\t} else {\n\t\t\t\temitter.fire(e);\n\t\t\t}\n\t\t});\n\n\t\tconst flush = () => {\n\t\t\tif (buffer) {\n\t\t\t\tbuffer.forEach(e => emitter.fire(e));\n\t\t\t}\n\t\t\tbuffer = null;\n\t\t};\n\n\t\tconst emitter = new Emitter<T>({\n\t\t\tonFirstListenerAdd() {\n\t\t\t\tif (!listener) {\n\t\t\t\t\tlistener = event(e => emitter.fire(e));\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonFirstListenerDidAdd() {\n\t\t\t\tif (buffer) {\n\t\t\t\t\tif (nextTick) {\n\t\t\t\t\t\tsetTimeout(flush);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tflush();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonLastListenerRemove() {\n\t\t\t\tif (listener) {\n\t\t\t\t\tlistener.dispose();\n\t\t\t\t}\n\t\t\t\tlistener = null;\n\t\t\t}\n\t\t});\n\n\t\treturn emitter.event;\n\t}\n\n\t/**\n\t * Similar to `buffer` but it buffers indefinitely and repeats\n\t * the buffered events to every new listener.\n\t */\n\texport function echo<T>(event: Event<T>, nextTick = false, buffer: T[] = []): Event<T> {\n\t\tbuffer = buffer.slice();\n\n\t\tevent(e => {\n\t\t\tbuffer.push(e);\n\t\t\temitter.fire(e);\n\t\t});\n\n\t\tconst flush = (listener: (e: T) => any, thisArgs?: any) => buffer.forEach(e => listener.call(thisArgs, e));\n\n\t\tconst emitter = new Emitter<T>({\n\t\t\tonListenerDidAdd(emitter: Emitter<T>, listener: (e: T) => any, thisArgs?: any) {\n\t\t\t\tif (nextTick) {\n\t\t\t\t\tsetTimeout(() => flush(listener, thisArgs));\n\t\t\t\t} else {\n\t\t\t\t\tflush(listener, thisArgs);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn emitter.event;\n\t}\n\n\texport interface IChainableEvent<T> {\n\t\tevent: Event<T>;\n\t\tmap<O>(fn: (i: T) => O): IChainableEvent<O>;\n\t\tforEach(fn: (i: T) => void): IChainableEvent<T>;\n\t\tfilter(fn: (e: T) => boolean): IChainableEvent<T>;\n\t\treduce<R>(merge: (last: R | undefined, event: T) => R, initial?: R): IChainableEvent<R>;\n\t\tlatch(): IChainableEvent<T>;\n\t\ton(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[]): IDisposable;\n\t\tonce(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[]): IDisposable;\n\t}\n\n\tclass ChainableEvent<T> implements IChainableEvent<T> {\n\n\t\tconstructor(readonly event: Event<T>) { }\n\n\t\tmap<O>(fn: (i: T) => O): IChainableEvent<O> {\n\t\t\treturn new ChainableEvent(map(this.event, fn));\n\t\t}\n\n\t\tforEach(fn: (i: T) => void): IChainableEvent<T> {\n\t\t\treturn new ChainableEvent(forEach(this.event, fn));\n\t\t}\n\n\t\tfilter(fn: (e: T) => boolean): IChainableEvent<T> {\n\t\t\treturn new ChainableEvent(filter(this.event, fn));\n\t\t}\n\n\t\treduce<R>(merge: (last: R | undefined, event: T) => R, initial?: R): IChainableEvent<R> {\n\t\t\treturn new ChainableEvent(reduce(this.event, merge, initial));\n\t\t}\n\n\t\tlatch(): IChainableEvent<T> {\n\t\t\treturn new ChainableEvent(latch(this.event));\n\t\t}\n\n\t\ton(listener: (e: T) => any, thisArgs: any, disposables: IDisposable[]) {\n\t\t\treturn this.event(listener, thisArgs, disposables);\n\t\t}\n\n\t\tonce(listener: (e: T) => any, thisArgs: any, disposables: IDisposable[]) {\n\t\t\treturn once(this.event)(listener, thisArgs, disposables);\n\t\t}\n\t}\n\n\texport function chain<T>(event: Event<T>): IChainableEvent<T> {\n\t\treturn new ChainableEvent(event);\n\t}\n\n\texport interface NodeEventEmitter {\n\t\ton(event: string | symbol, listener: Function): this;\n\t\tremoveListener(event: string | symbol, listener: Function): this;\n\t}\n\n\texport function fromNodeEventEmitter<T>(emitter: NodeEventEmitter, eventName: string, map: (...args: any[]) => T = id => id): Event<T> {\n\t\tconst fn = (...args: any[]) => result.fire(map(...args));\n\t\tconst onFirstListenerAdd = () => emitter.on(eventName, fn);\n\t\tconst onLastListenerRemove = () => emitter.removeListener(eventName, fn);\n\t\tconst result = new Emitter<T>({ onFirstListenerAdd, onLastListenerRemove });\n\n\t\treturn result.event;\n\t}\n\n\texport function fromPromise<T = any>(promise: Promise<T>): Event<undefined> {\n\t\tconst emitter = new Emitter<undefined>();\n\t\tlet shouldEmit = false;\n\n\t\tpromise\n\t\t\t.then(undefined, () => null)\n\t\t\t.then(() => {\n\t\t\t\tif (!shouldEmit) {\n\t\t\t\t\tsetTimeout(() => emitter.fire(undefined), 0);\n\t\t\t\t} else {\n\t\t\t\t\temitter.fire(undefined);\n\t\t\t\t}\n\t\t\t});\n\n\t\tshouldEmit = true;\n\t\treturn emitter.event;\n\t}\n\n\texport function toPromise<T>(event: Event<T>): Promise<T> {\n\t\treturn new Promise(c => once(event)(c));\n\t}\n}\n\ntype Listener<T> = [(e: T) => void, any] | ((e: T) => void);\n\nexport interface EmitterOptions {\n\tonFirstListenerAdd?: Function;\n\tonFirstListenerDidAdd?: Function;\n\tonListenerDidAdd?: Function;\n\tonLastListenerRemove?: Function;\n\tleakWarningThreshold?: number;\n}\n\nlet _globalLeakWarningThreshold = -1;\nexport function setGlobalLeakWarningThreshold(n: number): IDisposable {\n\tconst oldValue = _globalLeakWarningThreshold;\n\t_globalLeakWarningThreshold = n;\n\treturn {\n\t\tdispose() {\n\t\t\t_globalLeakWarningThreshold = oldValue;\n\t\t}\n\t};\n}\n\nclass LeakageMonitor {\n\n\tprivate _stacks: Map<string, number> | undefined;\n\tprivate _warnCountdown: number = 0;\n\n\tconstructor(\n\t\treadonly customThreshold?: number,\n\t\treadonly name: string = Math.random().toString(18).slice(2, 5),\n\t) { }\n\n\tdispose(): void {\n\t\tif (this._stacks) {\n\t\t\tthis._stacks.clear();\n\t\t}\n\t}\n\n\tcheck(listenerCount: number): undefined | (() => void) {\n\n\t\tlet threshold = _globalLeakWarningThreshold;\n\t\tif (typeof this.customThreshold === 'number') {\n\t\t\tthreshold = this.customThreshold;\n\t\t}\n\n\t\tif (threshold <= 0 || listenerCount < threshold) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!this._stacks) {\n\t\t\tthis._stacks = new Map();\n\t\t}\n\t\tconst stack = new Error().stack!.split('\\n').slice(3).join('\\n');\n\t\tconst count = (this._stacks.get(stack) || 0);\n\t\tthis._stacks.set(stack, count + 1);\n\t\tthis._warnCountdown -= 1;\n\n\t\tif (this._warnCountdown <= 0) {\n\t\t\t// only warn on first exceed and then every time the limit\n\t\t\t// is exceeded by 50% again\n\t\t\tthis._warnCountdown = threshold * 0.5;\n\n\t\t\t// find most frequent listener and print warning\n\t\t\tlet topStack: string;\n\t\t\tlet topCount: number = 0;\n\t\t\tthis._stacks.forEach((count, stack) => {\n\t\t\t\tif (!topStack || topCount < count) {\n\t\t\t\t\ttopStack = stack;\n\t\t\t\t\ttopCount = count;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconsole.warn(`[${this.name}] potential listener LEAK detected, having ${listenerCount} listeners already. MOST frequent listener (${topCount}):`);\n\t\t\tconsole.warn(topStack!);\n\t\t}\n\n\t\treturn () => {\n\t\t\tconst count = (this._stacks!.get(stack) || 0);\n\t\t\tthis._stacks!.set(stack, count - 1);\n\t\t};\n\t}\n}\n\n/**\n * The Emitter can be used to expose an Event to the public\n * to fire it from the insides.\n * Sample:\n\tclass Document {\n\n\t\tprivate _onDidChange = new Emitter<(value:string)=>any>();\n\n\t\tpublic onDidChange = this._onDidChange.event;\n\n\t\t// getter-style\n\t\t// get onDidChange(): Event<(value:string)=>any> {\n\t\t// \treturn this._onDidChange.event;\n\t\t// }\n\n\t\tprivate _doIt() {\n\t\t\t//...\n\t\t\tthis._onDidChange.fire(value);\n\t\t}\n\t}\n */\nexport class Emitter<T> {\n\n\tprivate static readonly _noop = function () { };\n\n\tprivate readonly _options?: EmitterOptions;\n\tprivate readonly _leakageMon?: LeakageMonitor;\n\tprivate _disposed: boolean = false;\n\tprivate _event?: Event<T>;\n\tprivate _deliveryQueue: [Listener<T>, T][];\n\tprotected _listeners?: LinkedList<Listener<T>>;\n\n\tconstructor(options?: EmitterOptions) {\n\t\tthis._options = options;\n\t\tthis._leakageMon = _globalLeakWarningThreshold > 0\n\t\t\t? new LeakageMonitor(this._options && this._options.leakWarningThreshold)\n\t\t\t: undefined;\n\t}\n\n\t/**\n\t * For the public to allow to subscribe\n\t * to events from this Emitter\n\t */\n\tget event(): Event<T> {\n\t\tif (!this._event) {\n\t\t\tthis._event = (listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[]) => {\n\t\t\t\tif (!this._listeners) {\n\t\t\t\t\tthis._listeners = new LinkedList();\n\t\t\t\t}\n\n\t\t\t\tconst firstListener = this._listeners.isEmpty();\n\n\t\t\t\tif (firstListener && this._options && this._options.onFirstListenerAdd) {\n\t\t\t\t\tthis._options.onFirstListenerAdd(this);\n\t\t\t\t}\n\n\t\t\t\tconst remove = this._listeners.push(!thisArgs ? listener : [listener, thisArgs]);\n\n\t\t\t\tif (firstListener && this._options && this._options.onFirstListenerDidAdd) {\n\t\t\t\t\tthis._options.onFirstListenerDidAdd(this);\n\t\t\t\t}\n\n\t\t\t\tif (this._options && this._options.onListenerDidAdd) {\n\t\t\t\t\tthis._options.onListenerDidAdd(this, listener, thisArgs);\n\t\t\t\t}\n\n\t\t\t\t// check and record this emitter for potential leakage\n\t\t\t\tlet removeMonitor: (() => void) | undefined;\n\t\t\t\tif (this._leakageMon) {\n\t\t\t\t\tremoveMonitor = this._leakageMon.check(this._listeners.size);\n\t\t\t\t}\n\n\t\t\t\tlet result: IDisposable;\n\t\t\t\tresult = {\n\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\tif (removeMonitor) {\n\t\t\t\t\t\t\tremoveMonitor();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.dispose = Emitter._noop;\n\t\t\t\t\t\tif (!this._disposed) {\n\t\t\t\t\t\t\tremove();\n\t\t\t\t\t\t\tif (this._options && this._options.onLastListenerRemove) {\n\t\t\t\t\t\t\t\tconst hasListeners = (this._listeners && !this._listeners.isEmpty());\n\t\t\t\t\t\t\t\tif (!hasListeners) {\n\t\t\t\t\t\t\t\t\tthis._options.onLastListenerRemove(this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (Array.isArray(disposables)) {\n\t\t\t\t\tdisposables.push(result);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\t\treturn this._event;\n\t}\n\n\t/**\n\t * To be kept private to fire an event to\n\t * subscribers\n\t */\n\tfire(event: T): void {\n\t\tif (this._listeners) {\n\t\t\t// put all [listener,event]-pairs into delivery queue\n\t\t\t// then emit all event. an inner/nested event might be\n\t\t\t// the driver of this\n\n\t\t\tif (!this._deliveryQueue) {\n\t\t\t\tthis._deliveryQueue = [];\n\t\t\t}\n\n\t\t\tfor (let iter = this._listeners.iterator(), e = iter.next(); !e.done; e = iter.next()) {\n\t\t\t\tthis._deliveryQueue.push([e.value, event]);\n\t\t\t}\n\n\t\t\twhile (this._deliveryQueue.length > 0) {\n\t\t\t\tconst [listener, event] = this._deliveryQueue.shift()!;\n\t\t\t\ttry {\n\t\t\t\t\tif (typeof listener === 'function') {\n\t\t\t\t\t\tlistener.call(undefined, event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlistener[0].call(listener[1], event);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tonUnexpectedError(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose() {\n\t\tif (this._listeners) {\n\t\t\tthis._listeners = undefined;\n\t\t}\n\t\tif (this._deliveryQueue) {\n\t\t\tthis._deliveryQueue.length = 0;\n\t\t}\n\t\tif (this._leakageMon) {\n\t\t\tthis._leakageMon.dispose();\n\t\t}\n\t\tthis._disposed = true;\n\t}\n}\n\nexport interface IWaitUntil {\n\twaitUntil(thenable: Promise<any>): void;\n}\n\nexport class AsyncEmitter<T extends IWaitUntil> extends Emitter<T> {\n\n\tprivate _asyncDeliveryQueue: [Listener<T>, T, Promise<any>[]][];\n\n\tasync fireAsync(eventFn: (thenables: Promise<any>[], listener: Function) => T): Promise<void> {\n\t\tif (!this._listeners) {\n\t\t\treturn;\n\t\t}\n\n\t\t// put all [listener,event]-pairs into delivery queue\n\t\t// then emit all event. an inner/nested event might be\n\t\t// the driver of this\n\t\tif (!this._asyncDeliveryQueue) {\n\t\t\tthis._asyncDeliveryQueue = [];\n\t\t}\n\n\t\tfor (let iter = this._listeners.iterator(), e = iter.next(); !e.done; e = iter.next()) {\n\t\t\tconst thenables: Promise<void>[] = [];\n\t\t\tthis._asyncDeliveryQueue.push([e.value, eventFn(thenables, typeof e.value === 'function' ? e.value : e.value[0]), thenables]);\n\t\t}\n\n\t\twhile (this._asyncDeliveryQueue.length > 0) {\n\t\t\tconst [listener, event, thenables] = this._asyncDeliveryQueue.shift()!;\n\t\t\ttry {\n\t\t\t\tif (typeof listener === 'function') {\n\t\t\t\t\tlistener.call(undefined, event);\n\t\t\t\t} else {\n\t\t\t\t\tlistener[0].call(listener[1], event);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tonUnexpectedError(e);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// freeze thenables-collection to enforce sync-calls to\n\t\t\t// wait until and then wait for all thenables to resolve\n\t\t\tObject.freeze(thenables);\n\t\t\tawait Promise.all(thenables);\n\t\t}\n\t}\n}\n\nexport class EventMultiplexer<T> implements IDisposable {\n\n\tprivate readonly emitter: Emitter<T>;\n\tprivate hasListeners = false;\n\tprivate events: { event: Event<T>; listener: IDisposable | null; }[] = [];\n\n\tconstructor() {\n\t\tthis.emitter = new Emitter<T>({\n\t\t\tonFirstListenerAdd: () => this.onFirstListenerAdd(),\n\t\t\tonLastListenerRemove: () => this.onLastListenerRemove()\n\t\t});\n\t}\n\n\tget event(): Event<T> {\n\t\treturn this.emitter.event;\n\t}\n\n\tadd(event: Event<T>): IDisposable {\n\t\tconst e = { event: event, listener: null };\n\t\tthis.events.push(e);\n\n\t\tif (this.hasListeners) {\n\t\t\tthis.hook(e);\n\t\t}\n\n\t\tconst dispose = () => {\n\t\t\tif (this.hasListeners) {\n\t\t\t\tthis.unhook(e);\n\t\t\t}\n\n\t\t\tconst idx = this.events.indexOf(e);\n\t\t\tthis.events.splice(idx, 1);\n\t\t};\n\n\t\treturn toDisposable(onceFn(dispose));\n\t}\n\n\tprivate onFirstListenerAdd(): void {\n\t\tthis.hasListeners = true;\n\t\tthis.events.forEach(e => this.hook(e));\n\t}\n\n\tprivate onLastListenerRemove(): void {\n\t\tthis.hasListeners = false;\n\t\tthis.events.forEach(e => this.unhook(e));\n\t}\n\n\tprivate hook(e: { event: Event<T>; listener: IDisposable | null; }): void {\n\t\te.listener = e.event(r => this.emitter.fire(r));\n\t}\n\n\tprivate unhook(e: { event: Event<T>; listener: IDisposable | null; }): void {\n\t\tif (e.listener) {\n\t\t\te.listener.dispose();\n\t\t}\n\t\te.listener = null;\n\t}\n\n\tdispose(): void {\n\t\tthis.emitter.dispose();\n\t}\n}\n\n/**\n * The EventBufferer is useful in situations in which you want\n * to delay firing your events during some code.\n * You can wrap that code and be sure that the event will not\n * be fired during that wrap.\n *\n * ```\n * const emitter: Emitter;\n * const delayer = new EventDelayer();\n * const delayedEvent = delayer.wrapEvent(emitter.event);\n *\n * delayedEvent(console.log);\n *\n * delayer.bufferEvents(() => {\n *   emitter.fire(); // event will not be fired yet\n * });\n *\n * // event will only be fired at this point\n * ```\n */\nexport class EventBufferer {\n\n\tprivate buffers: Function[][] = [];\n\n\twrapEvent<T>(event: Event<T>): Event<T> {\n\t\treturn (listener, thisArgs?, disposables?) => {\n\t\t\treturn event(i => {\n\t\t\t\tconst buffer = this.buffers[this.buffers.length - 1];\n\n\t\t\t\tif (buffer) {\n\t\t\t\t\tbuffer.push(() => listener.call(thisArgs, i));\n\t\t\t\t} else {\n\t\t\t\t\tlistener.call(thisArgs, i);\n\t\t\t\t}\n\t\t\t}, undefined, disposables);\n\t\t};\n\t}\n\n\tbufferEvents<R = void>(fn: () => R): R {\n\t\tconst buffer: Array<() => R> = [];\n\t\tthis.buffers.push(buffer);\n\t\tconst r = fn();\n\t\tthis.buffers.pop();\n\t\tbuffer.forEach(flush => flush());\n\t\treturn r;\n\t}\n}\n\n/**\n * A Relay is an event forwarder which functions as a replugabble event pipe.\n * Once created, you can connect an input event to it and it will simply forward\n * events from that input event through its own `event` property. The `input`\n * can be changed at any point in time.\n */\nexport class Relay<T> implements IDisposable {\n\n\tprivate listening = false;\n\tprivate inputEvent: Event<T> = Event.None;\n\tprivate inputEventListener: IDisposable = Disposable.None;\n\n\tprivate emitter = new Emitter<T>({\n\t\tonFirstListenerDidAdd: () => {\n\t\t\tthis.listening = true;\n\t\t\tthis.inputEventListener = this.inputEvent(this.emitter.fire, this.emitter);\n\t\t},\n\t\tonLastListenerRemove: () => {\n\t\t\tthis.listening = false;\n\t\t\tthis.inputEventListener.dispose();\n\t\t}\n\t});\n\n\treadonly event: Event<T> = this.emitter.event;\n\n\tset input(event: Event<T>) {\n\t\tthis.inputEvent = event;\n\n\t\tif (this.listening) {\n\t\t\tthis.inputEventListener.dispose();\n\t\t\tthis.inputEventListener = event(this.emitter.fire, this.emitter);\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.inputEventListener.dispose();\n\t\tthis.emitter.dispose();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IDisposable } from 'vs/base/common/lifecycle';\n\nclass WindowManager {\n\n\tpublic static readonly INSTANCE = new WindowManager();\n\n\t// --- Zoom Level\n\tprivate _zoomLevel: number = 0;\n\tprivate _lastZoomLevelChangeTime: number = 0;\n\tprivate readonly _onDidChangeZoomLevel = new Emitter<number>();\n\n\tpublic readonly onDidChangeZoomLevel: Event<number> = this._onDidChangeZoomLevel.event;\n\tpublic getZoomLevel(): number {\n\t\treturn this._zoomLevel;\n\t}\n\tpublic getTimeSinceLastZoomLevelChanged(): number {\n\t\treturn Date.now() - this._lastZoomLevelChangeTime;\n\t}\n\tpublic setZoomLevel(zoomLevel: number, isTrusted: boolean): void {\n\t\tif (this._zoomLevel === zoomLevel) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._zoomLevel = zoomLevel;\n\t\t// See https://github.com/Microsoft/vscode/issues/26151\n\t\tthis._lastZoomLevelChangeTime = isTrusted ? 0 : Date.now();\n\t\tthis._onDidChangeZoomLevel.fire(this._zoomLevel);\n\t}\n\n\t// --- Zoom Factor\n\tprivate _zoomFactor: number = 1;\n\n\tpublic getZoomFactor(): number {\n\t\treturn this._zoomFactor;\n\t}\n\tpublic setZoomFactor(zoomFactor: number): void {\n\t\tthis._zoomFactor = zoomFactor;\n\t}\n\n\t// --- Pixel Ratio\n\tpublic getPixelRatio(): number {\n\t\tlet ctx = document.createElement('canvas').getContext('2d');\n\t\tlet dpr = window.devicePixelRatio || 1;\n\t\tlet bsr = (<any>ctx).webkitBackingStorePixelRatio ||\n\t\t\t(<any>ctx).mozBackingStorePixelRatio ||\n\t\t\t(<any>ctx).msBackingStorePixelRatio ||\n\t\t\t(<any>ctx).oBackingStorePixelRatio ||\n\t\t\t(<any>ctx).backingStorePixelRatio || 1;\n\t\treturn dpr / bsr;\n\t}\n\n\t// --- Fullscreen\n\tprivate _fullscreen: boolean;\n\tprivate readonly _onDidChangeFullscreen = new Emitter<void>();\n\n\tpublic readonly onDidChangeFullscreen: Event<void> = this._onDidChangeFullscreen.event;\n\tpublic setFullscreen(fullscreen: boolean): void {\n\t\tif (this._fullscreen === fullscreen) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fullscreen = fullscreen;\n\t\tthis._onDidChangeFullscreen.fire();\n\t}\n\tpublic isFullscreen(): boolean {\n\t\treturn this._fullscreen;\n\t}\n}\n\n/** A zoom index, e.g. 1, 2, 3 */\nexport function setZoomLevel(zoomLevel: number, isTrusted: boolean): void {\n\tWindowManager.INSTANCE.setZoomLevel(zoomLevel, isTrusted);\n}\nexport function getZoomLevel(): number {\n\treturn WindowManager.INSTANCE.getZoomLevel();\n}\n/** Returns the time (in ms) since the zoom level was changed */\nexport function getTimeSinceLastZoomLevelChanged(): number {\n\treturn WindowManager.INSTANCE.getTimeSinceLastZoomLevelChanged();\n}\nexport function onDidChangeZoomLevel(callback: (zoomLevel: number) => void): IDisposable {\n\treturn WindowManager.INSTANCE.onDidChangeZoomLevel(callback);\n}\n\n/** The zoom scale for an index, e.g. 1, 1.2, 1.4 */\nexport function getZoomFactor(): number {\n\treturn WindowManager.INSTANCE.getZoomFactor();\n}\nexport function setZoomFactor(zoomFactor: number): void {\n\tWindowManager.INSTANCE.setZoomFactor(zoomFactor);\n}\n\nexport function getPixelRatio(): number {\n\treturn WindowManager.INSTANCE.getPixelRatio();\n}\n\nexport function setFullscreen(fullscreen: boolean): void {\n\tWindowManager.INSTANCE.setFullscreen(fullscreen);\n}\nexport function isFullscreen(): boolean {\n\treturn WindowManager.INSTANCE.isFullscreen();\n}\nexport const onDidChangeFullscreen = WindowManager.INSTANCE.onDidChangeFullscreen;\n\nconst userAgent = navigator.userAgent;\n\nexport const isIE = (userAgent.indexOf('Trident') >= 0);\nexport const isEdge = (userAgent.indexOf('Edge/') >= 0);\nexport const isEdgeOrIE = isIE || isEdge;\n\nexport const isOpera = (userAgent.indexOf('Opera') >= 0);\nexport const isFirefox = (userAgent.indexOf('Firefox') >= 0);\nexport const isWebKit = (userAgent.indexOf('AppleWebKit') >= 0);\nexport const isChrome = (userAgent.indexOf('Chrome') >= 0);\nexport const isSafari = (!isChrome && (userAgent.indexOf('Safari') >= 0));\nexport const isWebkitWebView = (!isChrome && !isSafari && isWebKit);\nexport const isIPad = (userAgent.indexOf('iPad') >= 0);\nexport const isEdgeWebView = isEdge && (userAgent.indexOf('WebView/') >= 0);\n\nexport function hasClipboardSupport() {\n\tif (isIE) {\n\t\treturn false;\n\t}\n\n\tif (isEdge) {\n\t\tlet index = userAgent.indexOf('Edge/');\n\t\tlet version = parseInt(userAgent.substring(index + 5, userAgent.indexOf('.', index)), 10);\n\n\t\tif (!version || (version >= 12 && version <= 16)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, Emitter } from 'vs/base/common/event';\n\nexport type EventHandler = HTMLElement | HTMLDocument | Window;\n\nexport interface IDomEvent {\n\t<K extends keyof HTMLElementEventMap>(element: EventHandler, type: K, useCapture?: boolean): Event<HTMLElementEventMap[K]>;\n\t(element: EventHandler, type: string, useCapture?: boolean): Event<any>;\n}\n\nexport const domEvent: IDomEvent = (element: EventHandler, type: string, useCapture?: boolean) => {\n\tconst fn = e => emitter.fire(e);\n\tconst emitter = new Emitter<any>({\n\t\tonFirstListenerAdd: () => {\n\t\t\telement.addEventListener(type, fn, useCapture);\n\t\t},\n\t\tonLastListenerRemove: () => {\n\t\t\telement.removeEventListener(type, fn, useCapture);\n\t\t}\n\t});\n\n\treturn emitter.event;\n};\n\nexport interface CancellableEvent {\n\tpreventDefault();\n\tstopPropagation();\n}\n\nexport function stop<T extends CancellableEvent>(event: Event<T>): Event<T> {\n\treturn Event.map(event, e => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\treturn e;\n\t});\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IDisposable } from 'vs/base/common/lifecycle';\n\nexport interface CancellationToken {\n\treadonly isCancellationRequested: boolean;\n\t/**\n\t * An event emitted when cancellation is requested\n\t * @event\n\t */\n\treadonly onCancellationRequested: Event<any>;\n}\n\nconst shortcutEvent = Object.freeze(function (callback, context?): IDisposable {\n\tconst handle = setTimeout(callback.bind(context), 0);\n\treturn { dispose() { clearTimeout(handle); } };\n} as Event<any>);\n\nexport namespace CancellationToken {\n\n\texport function isCancellationToken(thing: any): thing is CancellationToken {\n\t\tif (thing === CancellationToken.None || thing === CancellationToken.Cancelled) {\n\t\t\treturn true;\n\t\t}\n\t\tif (thing instanceof MutableToken) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing || typeof thing !== 'object') {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (thing as CancellationToken).isCancellationRequested === 'boolean'\n\t\t\t&& typeof (thing as CancellationToken).onCancellationRequested === 'function';\n\t}\n\n\n\texport const None: CancellationToken = Object.freeze({\n\t\tisCancellationRequested: false,\n\t\tonCancellationRequested: Event.None\n\t});\n\n\texport const Cancelled: CancellationToken = Object.freeze({\n\t\tisCancellationRequested: true,\n\t\tonCancellationRequested: shortcutEvent\n\t});\n}\n\nclass MutableToken implements CancellationToken {\n\n\tprivate _isCancelled: boolean = false;\n\tprivate _emitter: Emitter<any> | null = null;\n\n\tpublic cancel() {\n\t\tif (!this._isCancelled) {\n\t\t\tthis._isCancelled = true;\n\t\t\tif (this._emitter) {\n\t\t\t\tthis._emitter.fire(undefined);\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t}\n\t}\n\n\tget isCancellationRequested(): boolean {\n\t\treturn this._isCancelled;\n\t}\n\n\tget onCancellationRequested(): Event<any> {\n\t\tif (this._isCancelled) {\n\t\t\treturn shortcutEvent;\n\t\t}\n\t\tif (!this._emitter) {\n\t\t\tthis._emitter = new Emitter<any>();\n\t\t}\n\t\treturn this._emitter.event;\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this._emitter) {\n\t\t\tthis._emitter.dispose();\n\t\t\tthis._emitter = null;\n\t\t}\n\t}\n}\n\nexport class CancellationTokenSource {\n\n\tprivate _token: CancellationToken;\n\n\tget token(): CancellationToken {\n\t\tif (!this._token) {\n\t\t\t// be lazy and create the token only when\n\t\t\t// actually needed\n\t\t\tthis._token = new MutableToken();\n\t\t}\n\t\treturn this._token;\n\t}\n\n\tcancel(): void {\n\t\tif (!this._token) {\n\t\t\t// save an object by returning the default\n\t\t\t// cancelled token when cancellation happens\n\t\t\t// before someone asks for the token\n\t\t\tthis._token = CancellationToken.Cancelled;\n\n\t\t} else if (this._token instanceof MutableToken) {\n\t\t\t// actually cancel\n\t\t\tthis._token.cancel();\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tif (!this._token) {\n\t\t\t// ensure to initialize with an empty token if we had none\n\t\t\tthis._token = CancellationToken.None;\n\n\t\t} else if (this._token instanceof MutableToken) {\n\t\t\t// actually dispose\n\t\t\tthis._token.dispose();\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport * as errors from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\n\nexport function isThenable<T>(obj: any): obj is Promise<T> {\n\treturn obj && typeof (<Promise<any>>obj).then === 'function';\n}\n\nexport interface CancelablePromise<T> extends Promise<T> {\n\tcancel(): void;\n}\n\nexport function createCancelablePromise<T>(callback: (token: CancellationToken) => Promise<T>): CancelablePromise<T> {\n\tconst source = new CancellationTokenSource();\n\n\tconst thenable = callback(source.token);\n\tconst promise = new Promise<T>((resolve, reject) => {\n\t\tsource.token.onCancellationRequested(() => {\n\t\t\treject(errors.canceled());\n\t\t});\n\t\tPromise.resolve(thenable).then(value => {\n\t\t\tsource.dispose();\n\t\t\tresolve(value);\n\t\t}, err => {\n\t\t\tsource.dispose();\n\t\t\treject(err);\n\t\t});\n\t});\n\n\treturn new class implements CancelablePromise<T> {\n\t\tcancel() {\n\t\t\tsource.cancel();\n\t\t}\n\t\tthen<TResult1 = T, TResult2 = never>(resolve?: ((value: T) => TResult1 | Promise<TResult1>) | undefined | null, reject?: ((reason: any) => TResult2 | Promise<TResult2>) | undefined | null): Promise<TResult1 | TResult2> {\n\t\t\treturn promise.then(resolve, reject);\n\t\t}\n\t\tcatch<TResult = never>(reject?: ((reason: any) => TResult | Promise<TResult>) | undefined | null): Promise<T | TResult> {\n\t\t\treturn this.then(undefined, reject);\n\t\t}\n\t\tfinally(onfinally?: (() => void) | undefined | null): Promise<T> {\n\t\t\treturn promise.finally(onfinally);\n\t\t}\n\t};\n}\n\nexport function asPromise<T>(callback: () => T | Thenable<T>): Promise<T> {\n\treturn new Promise<T>((resolve, reject) => {\n\t\tconst item = callback();\n\t\tif (isThenable<T>(item)) {\n\t\t\titem.then(resolve, reject);\n\t\t} else {\n\t\t\tresolve(item);\n\t\t}\n\t});\n}\n\nexport interface ITask<T> {\n\t(): T;\n}\n\n/**\n * A helper to prevent accumulation of sequential async tasks.\n *\n * Imagine a mail man with the sole task of delivering letters. As soon as\n * a letter submitted for delivery, he drives to the destination, delivers it\n * and returns to his base. Imagine that during the trip, N more letters were submitted.\n * When the mail man returns, he picks those N letters and delivers them all in a\n * single trip. Even though N+1 submissions occurred, only 2 deliveries were made.\n *\n * The throttler implements this via the queue() method, by providing it a task\n * factory. Following the example:\n *\n * \t\tconst throttler = new Throttler();\n * \t\tconst letters = [];\n *\n * \t\tfunction deliver() {\n * \t\t\tconst lettersToDeliver = letters;\n * \t\t\tletters = [];\n * \t\t\treturn makeTheTrip(lettersToDeliver);\n * \t\t}\n *\n * \t\tfunction onLetterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tthrottler.queue(deliver);\n * \t\t}\n */\nexport class Throttler {\n\n\tprivate activePromise: Promise<any> | null;\n\tprivate queuedPromise: Promise<any> | null;\n\tprivate queuedPromiseFactory: ITask<Promise<any>> | null;\n\n\tconstructor() {\n\t\tthis.activePromise = null;\n\t\tthis.queuedPromise = null;\n\t\tthis.queuedPromiseFactory = null;\n\t}\n\n\tqueue<T>(promiseFactory: ITask<Promise<T>>): Promise<T> {\n\t\tif (this.activePromise) {\n\t\t\tthis.queuedPromiseFactory = promiseFactory;\n\n\t\t\tif (!this.queuedPromise) {\n\t\t\t\tconst onComplete = () => {\n\t\t\t\t\tthis.queuedPromise = null;\n\n\t\t\t\t\tconst result = this.queue(this.queuedPromiseFactory!);\n\t\t\t\t\tthis.queuedPromiseFactory = null;\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\n\t\t\t\tthis.queuedPromise = new Promise(c => {\n\t\t\t\t\tthis.activePromise!.then(onComplete, onComplete).then(c);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new Promise((c, e) => {\n\t\t\t\tthis.queuedPromise!.then(c, e);\n\t\t\t});\n\t\t}\n\n\t\tthis.activePromise = promiseFactory();\n\n\t\treturn new Promise((c, e) => {\n\t\t\tthis.activePromise!.then((result: any) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\tc(result);\n\t\t\t}, (err: any) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\te(err);\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport class Sequencer {\n\n\tprivate current: Promise<any> = Promise.resolve(null);\n\n\tqueue<T>(promiseTask: ITask<Promise<T>>): Promise<T> {\n\t\treturn this.current = this.current.then(() => promiseTask());\n\t}\n}\n\n/**\n * A helper to delay execution of a task that is being requested often.\n *\n * Following the throttler, now imagine the mail man wants to optimize the number of\n * trips proactively. The trip itself can be long, so he decides not to make the trip\n * as soon as a letter is submitted. Instead he waits a while, in case more\n * letters are submitted. After said waiting period, if no letters were submitted, he\n * decides to make the trip. Imagine that N more letters were submitted after the first\n * one, all within a short period of time between each other. Even though N+1\n * submissions occurred, only 1 delivery was made.\n *\n * The delayer offers this behavior via the trigger() method, into which both the task\n * to be executed and the waiting period (delay) must be passed in as arguments. Following\n * the example:\n *\n * \t\tconst delayer = new Delayer(WAITING_PERIOD);\n * \t\tconst letters = [];\n *\n * \t\tfunction letterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tdelayer.trigger(() => { return makeTheTrip(); });\n * \t\t}\n */\nexport class Delayer<T> implements IDisposable {\n\n\tprivate timeout: any;\n\tprivate completionPromise: Promise<any> | null;\n\tprivate doResolve: ((value?: any | Promise<any>) => void) | null;\n\tprivate doReject: (err: any) => void;\n\tprivate task: ITask<T | Promise<T>> | null;\n\n\tconstructor(public defaultDelay: number) {\n\t\tthis.timeout = null;\n\t\tthis.completionPromise = null;\n\t\tthis.doResolve = null;\n\t\tthis.task = null;\n\t}\n\n\ttrigger(task: ITask<T | Promise<T>>, delay: number = this.defaultDelay): Promise<T> {\n\t\tthis.task = task;\n\t\tthis.cancelTimeout();\n\n\t\tif (!this.completionPromise) {\n\t\t\tthis.completionPromise = new Promise((c, e) => {\n\t\t\t\tthis.doResolve = c;\n\t\t\t\tthis.doReject = e;\n\t\t\t}).then(() => {\n\t\t\t\tthis.completionPromise = null;\n\t\t\t\tthis.doResolve = null;\n\t\t\t\tconst task = this.task!;\n\t\t\t\tthis.task = null;\n\n\t\t\t\treturn task();\n\t\t\t});\n\t\t}\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.timeout = null;\n\t\t\tthis.doResolve!(null);\n\t\t}, delay);\n\n\t\treturn this.completionPromise;\n\t}\n\n\tisTriggered(): boolean {\n\t\treturn this.timeout !== null;\n\t}\n\n\tcancel(): void {\n\t\tthis.cancelTimeout();\n\n\t\tif (this.completionPromise) {\n\t\t\tthis.doReject(errors.canceled());\n\t\t\tthis.completionPromise = null;\n\t\t}\n\t}\n\n\tprivate cancelTimeout(): void {\n\t\tif (this.timeout !== null) {\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.timeout = null;\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.cancelTimeout();\n\t}\n}\n\n/**\n * A helper to delay execution of a task that is being requested often, while\n * preventing accumulation of consecutive executions, while the task runs.\n *\n * The mail man is clever and waits for a certain amount of time, before going\n * out to deliver letters. While the mail man is going out, more letters arrive\n * and can only be delivered once he is back. Once he is back the mail man will\n * do one more trip to deliver the letters that have accumulated while he was out.\n */\nexport class ThrottledDelayer<T> {\n\n\tprivate delayer: Delayer<Promise<T>>;\n\tprivate throttler: Throttler;\n\n\tconstructor(defaultDelay: number) {\n\t\tthis.delayer = new Delayer(defaultDelay);\n\t\tthis.throttler = new Throttler();\n\t}\n\n\ttrigger(promiseFactory: ITask<Promise<T>>, delay?: number): Promise<T> {\n\t\treturn this.delayer.trigger(() => this.throttler.queue(promiseFactory), delay) as any as Promise<T>;\n\t}\n\n\tisTriggered(): boolean {\n\t\treturn this.delayer.isTriggered();\n\t}\n\n\tcancel(): void {\n\t\tthis.delayer.cancel();\n\t}\n\n\tdispose(): void {\n\t\tthis.delayer.dispose();\n\t}\n}\n\n/**\n * A barrier that is initially closed and then becomes opened permanently.\n */\nexport class Barrier {\n\n\tprivate _isOpen: boolean;\n\tprivate _promise: Promise<boolean>;\n\tprivate _completePromise: (v: boolean) => void;\n\n\tconstructor() {\n\t\tthis._isOpen = false;\n\t\tthis._promise = new Promise<boolean>((c, e) => {\n\t\t\tthis._completePromise = c;\n\t\t});\n\t}\n\n\tisOpen(): boolean {\n\t\treturn this._isOpen;\n\t}\n\n\topen(): void {\n\t\tthis._isOpen = true;\n\t\tthis._completePromise(true);\n\t}\n\n\twait(): Promise<boolean> {\n\t\treturn this._promise;\n\t}\n}\n\nexport function timeout(millis: number): CancelablePromise<void>;\nexport function timeout(millis: number, token: CancellationToken): Promise<void>;\nexport function timeout(millis: number, token?: CancellationToken): CancelablePromise<void> | Promise<void> {\n\tif (!token) {\n\t\treturn createCancelablePromise(token => timeout(millis, token));\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst handle = setTimeout(resolve, millis);\n\t\ttoken.onCancellationRequested(() => {\n\t\t\tclearTimeout(handle);\n\t\t\treject(errors.canceled());\n\t\t});\n\t});\n}\n\nexport function disposableTimeout(handler: () => void, timeout = 0): IDisposable {\n\tconst timer = setTimeout(handler, timeout);\n\treturn toDisposable(() => clearTimeout(timer));\n}\n\nexport function ignoreErrors<T>(promise: Promise<T>): Promise<T | undefined> {\n\treturn promise.then(undefined, _ => undefined);\n}\n\n/**\n * Runs the provided list of promise factories in sequential order. The returned\n * promise will complete to an array of results from each promise.\n */\n\nexport function sequence<T>(promiseFactories: ITask<Promise<T>>[]): Promise<T[]> {\n\tconst results: T[] = [];\n\tlet index = 0;\n\tconst len = promiseFactories.length;\n\n\tfunction next(): Promise<T> | null {\n\t\treturn index < len ? promiseFactories[index++]() : null;\n\t}\n\n\tfunction thenHandler(result: any): Promise<any> {\n\t\tif (result !== undefined && result !== null) {\n\t\t\tresults.push(result);\n\t\t}\n\n\t\tconst n = next();\n\t\tif (n) {\n\t\t\treturn n.then(thenHandler);\n\t\t}\n\n\t\treturn Promise.resolve(results);\n\t}\n\n\treturn Promise.resolve(null).then(thenHandler);\n}\n\nexport function first<T>(promiseFactories: ITask<Promise<T>>[], shouldStop: (t: T) => boolean = t => !!t, defaultValue: T | null = null): Promise<T | null> {\n\tlet index = 0;\n\tconst len = promiseFactories.length;\n\n\tconst loop: () => Promise<T | null> = () => {\n\t\tif (index >= len) {\n\t\t\treturn Promise.resolve(defaultValue);\n\t\t}\n\n\t\tconst factory = promiseFactories[index++];\n\t\tconst promise = Promise.resolve(factory());\n\n\t\treturn promise.then(result => {\n\t\t\tif (shouldStop(result)) {\n\t\t\t\treturn Promise.resolve(result);\n\t\t\t}\n\n\t\t\treturn loop();\n\t\t});\n\t};\n\n\treturn loop();\n}\n\ninterface ILimitedTaskFactory<T> {\n\tfactory: ITask<Promise<T>>;\n\tc: (value?: T | Promise<T>) => void;\n\te: (error?: any) => void;\n}\n\n/**\n * A helper to queue N promises and run them all with a max degree of parallelism. The helper\n * ensures that at any time no more than M promises are running at the same time.\n */\nexport class Limiter<T> {\n\n\tprivate _size = 0;\n\tprivate runningPromises: number;\n\tprivate maxDegreeOfParalellism: number;\n\tprivate outstandingPromises: ILimitedTaskFactory<T>[];\n\tprivate readonly _onFinished: Emitter<void>;\n\n\tconstructor(maxDegreeOfParalellism: number) {\n\t\tthis.maxDegreeOfParalellism = maxDegreeOfParalellism;\n\t\tthis.outstandingPromises = [];\n\t\tthis.runningPromises = 0;\n\t\tthis._onFinished = new Emitter<void>();\n\t}\n\n\tpublic get onFinished(): Event<void> {\n\t\treturn this._onFinished.event;\n\t}\n\n\tpublic get size(): number {\n\t\treturn this._size;\n\t\t// return this.runningPromises + this.outstandingPromises.length;\n\t}\n\n\tqueue(factory: ITask<Promise<T>>): Promise<T> {\n\t\tthis._size++;\n\n\t\treturn new Promise<T>((c, e) => {\n\t\t\tthis.outstandingPromises.push({ factory, c, e });\n\t\t\tthis.consume();\n\t\t});\n\t}\n\n\tprivate consume(): void {\n\t\twhile (this.outstandingPromises.length && this.runningPromises < this.maxDegreeOfParalellism) {\n\t\t\tconst iLimitedTask = this.outstandingPromises.shift()!;\n\t\t\tthis.runningPromises++;\n\n\t\t\tconst promise = iLimitedTask.factory();\n\t\t\tpromise.then(iLimitedTask.c, iLimitedTask.e);\n\t\t\tpromise.then(() => this.consumed(), () => this.consumed());\n\t\t}\n\t}\n\n\tprivate consumed(): void {\n\t\tthis._size--;\n\t\tthis.runningPromises--;\n\n\t\tif (this.outstandingPromises.length > 0) {\n\t\t\tthis.consume();\n\t\t} else {\n\t\t\tthis._onFinished.fire();\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._onFinished.dispose();\n\t}\n}\n\n/**\n * A queue is handles one promise at a time and guarantees that at any time only one promise is executing.\n */\nexport class Queue<T> extends Limiter<T> {\n\n\tconstructor() {\n\t\tsuper(1);\n\t}\n}\n\n/**\n * A helper to organize queues per resource. The ResourceQueue makes sure to manage queues per resource\n * by disposing them once the queue is empty.\n */\nexport class ResourceQueue {\n\tprivate queues: { [path: string]: Queue<void> };\n\n\tconstructor() {\n\t\tthis.queues = Object.create(null);\n\t}\n\n\tpublic queueFor(resource: URI): Queue<void> {\n\t\tconst key = resource.toString();\n\t\tif (!this.queues[key]) {\n\t\t\tconst queue = new Queue<void>();\n\t\t\tqueue.onFinished(() => {\n\t\t\t\tqueue.dispose();\n\t\t\t\tdelete this.queues[key];\n\t\t\t});\n\n\t\t\tthis.queues[key] = queue;\n\t\t}\n\n\t\treturn this.queues[key];\n\t}\n}\n\nexport class TimeoutTimer extends Disposable {\n\tprivate _token: any;\n\n\tconstructor();\n\tconstructor(runner: () => void, timeout: number);\n\tconstructor(runner?: () => void, timeout?: number) {\n\t\tsuper();\n\t\tthis._token = -1;\n\n\t\tif (typeof runner === 'function' && typeof timeout === 'number') {\n\t\t\tthis.setIfNotSet(runner, timeout);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t\tsuper.dispose();\n\t}\n\n\tcancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tclearTimeout(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tcancelAndSet(runner: () => void, timeout: number): void {\n\t\tthis.cancel();\n\t\tthis._token = setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n\n\tsetIfNotSet(runner: () => void, timeout: number): void {\n\t\tif (this._token !== -1) {\n\t\t\t// timer is already set\n\t\t\treturn;\n\t\t}\n\t\tthis._token = setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n}\n\nexport class IntervalTimer extends Disposable {\n\n\tprivate _token: any;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._token = -1;\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t\tsuper.dispose();\n\t}\n\n\tcancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tclearInterval(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tcancelAndSet(runner: () => void, interval: number): void {\n\t\tthis.cancel();\n\t\tthis._token = setInterval(() => {\n\t\t\trunner();\n\t\t}, interval);\n\t}\n}\n\nexport class RunOnceScheduler {\n\n\tprotected runner: ((...args: any[]) => void) | null;\n\n\tprivate timeoutToken: any;\n\tprivate timeout: number;\n\tprivate timeoutHandler: () => void;\n\n\tconstructor(runner: (...args: any[]) => void, timeout: number) {\n\t\tthis.timeoutToken = -1;\n\t\tthis.runner = runner;\n\t\tthis.timeout = timeout;\n\t\tthis.timeoutHandler = this.onTimeout.bind(this);\n\t}\n\n\t/**\n\t * Dispose RunOnceScheduler\n\t */\n\tdispose(): void {\n\t\tthis.cancel();\n\t\tthis.runner = null;\n\t}\n\n\t/**\n\t * Cancel current scheduled runner (if any).\n\t */\n\tcancel(): void {\n\t\tif (this.isScheduled()) {\n\t\t\tclearTimeout(this.timeoutToken);\n\t\t\tthis.timeoutToken = -1;\n\t\t}\n\t}\n\n\t/**\n\t * Cancel previous runner (if any) & schedule a new runner.\n\t */\n\tschedule(delay = this.timeout): void {\n\t\tthis.cancel();\n\t\tthis.timeoutToken = setTimeout(this.timeoutHandler, delay);\n\t}\n\n\t/**\n\t * Returns true if scheduled.\n\t */\n\tisScheduled(): boolean {\n\t\treturn this.timeoutToken !== -1;\n\t}\n\n\tprivate onTimeout() {\n\t\tthis.timeoutToken = -1;\n\t\tif (this.runner) {\n\t\t\tthis.doRun();\n\t\t}\n\t}\n\n\tprotected doRun(): void {\n\t\tif (this.runner) {\n\t\t\tthis.runner();\n\t\t}\n\t}\n}\n\nexport class RunOnceWorker<T> extends RunOnceScheduler {\n\tprivate units: T[] = [];\n\n\tconstructor(runner: (units: T[]) => void, timeout: number) {\n\t\tsuper(runner, timeout);\n\t}\n\n\twork(unit: T): void {\n\t\tthis.units.push(unit);\n\n\t\tif (!this.isScheduled()) {\n\t\t\tthis.schedule();\n\t\t}\n\t}\n\n\tprotected doRun(): void {\n\t\tconst units = this.units;\n\t\tthis.units = [];\n\n\t\tif (this.runner) {\n\t\t\tthis.runner(units);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.units = [];\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport function nfcall(fn: Function, ...args: any[]): Promise<any>;\nexport function nfcall<T>(fn: Function, ...args: any[]): Promise<T>;\nexport function nfcall(fn: Function, ...args: any[]): any {\n\treturn new Promise((c, e) => fn(...args, (err: any, result: any) => err ? e(err) : c(result)));\n}\n\nexport function ninvoke(thisArg: any, fn: Function, ...args: any[]): Promise<any>;\nexport function ninvoke<T>(thisArg: any, fn: Function, ...args: any[]): Promise<T>;\nexport function ninvoke(thisArg: any, fn: Function, ...args: any[]): any {\n\treturn new Promise((resolve, reject) => fn.call(thisArg, ...args, (err: any, result: any) => err ? reject(err) : resolve(result)));\n}\n\n\n//#region -- run on idle tricks ------------\n\nexport interface IdleDeadline {\n\treadonly didTimeout: boolean;\n\ttimeRemaining(): DOMHighResTimeStamp;\n}\n/**\n * Execute the callback the next time the browser is idle\n */\nexport let runWhenIdle: (callback: (idle: IdleDeadline) => void, timeout?: number) => IDisposable;\n\ndeclare function requestIdleCallback(callback: (args: IdleDeadline) => void, options?: { timeout: number }): number;\ndeclare function cancelIdleCallback(handle: number): void;\n\n(function () {\n\tif (typeof requestIdleCallback !== 'function' || typeof cancelIdleCallback !== 'function') {\n\t\tconst dummyIdle: IdleDeadline = Object.freeze({\n\t\t\tdidTimeout: true,\n\t\t\ttimeRemaining() { return 15; }\n\t\t});\n\t\trunWhenIdle = (runner) => {\n\t\t\tconst handle = setTimeout(() => runner(dummyIdle));\n\t\t\tlet disposed = false;\n\t\t\treturn {\n\t\t\t\tdispose() {\n\t\t\t\t\tif (disposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdisposed = true;\n\t\t\t\t\tclearTimeout(handle);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t} else {\n\t\trunWhenIdle = (runner, timeout?) => {\n\t\t\tconst handle: number = requestIdleCallback(runner, typeof timeout === 'number' ? { timeout } : undefined);\n\t\t\tlet disposed = false;\n\t\t\treturn {\n\t\t\t\tdispose() {\n\t\t\t\t\tif (disposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdisposed = true;\n\t\t\t\t\tcancelIdleCallback(handle);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}\n})();\n\n/**\n * An implementation of the \"idle-until-urgent\"-strategy as introduced\n * here: https://philipwalton.com/articles/idle-until-urgent/\n */\nexport class IdleValue<T> {\n\n\tprivate readonly _executor: () => void;\n\tprivate readonly _handle: IDisposable;\n\n\tprivate _didRun: boolean;\n\tprivate _value: T;\n\tprivate _error: any;\n\n\tconstructor(executor: () => T) {\n\t\tthis._executor = () => {\n\t\t\ttry {\n\t\t\t\tthis._value = executor();\n\t\t\t} catch (err) {\n\t\t\t\tthis._error = err;\n\t\t\t} finally {\n\t\t\t\tthis._didRun = true;\n\t\t\t}\n\t\t};\n\t\tthis._handle = runWhenIdle(() => this._executor());\n\t}\n\n\tdispose(): void {\n\t\tthis._handle.dispose();\n\t}\n\n\tgetValue(): T {\n\t\tif (!this._didRun) {\n\t\t\tthis._handle.dispose();\n\t\t\tthis._executor();\n\t\t}\n\t\tif (this._error) {\n\t\t\tthrow this._error;\n\t\t}\n\t\treturn this._value;\n\t}\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport namespace Schemas {\n\n\t/**\n\t * A schema that is used for models that exist in memory\n\t * only and that have no correspondence on a server or such.\n\t */\n\texport const inMemory: string = 'inmemory';\n\n\t/**\n\t * A schema that is used for setting files\n\t */\n\texport const vscode: string = 'vscode';\n\n\t/**\n\t * A schema that is used for internal private files\n\t */\n\texport const internal: string = 'private';\n\n\t/**\n\t * A walk-through document.\n\t */\n\texport const walkThrough: string = 'walkThrough';\n\n\t/**\n\t * An embedded code snippet.\n\t */\n\texport const walkThroughSnippet: string = 'walkThroughSnippet';\n\n\texport const http: string = 'http';\n\n\texport const https: string = 'https';\n\n\texport const file: string = 'file';\n\n\texport const mailto: string = 'mailto';\n\n\texport const untitled: string = 'untitled';\n\n\texport const data: string = 'data';\n\n\texport const command: string = 'command';\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const LANGUAGE_DEFAULT = 'en';\n\nlet _isWindows = false;\nlet _isMacintosh = false;\n// let _isLinux = false;\nlet _isNative = false;\n// let _isWeb = false;\nlet _locale: string | undefined = undefined;\nlet _language: string = LANGUAGE_DEFAULT;\nlet _translationsConfigFile: string | undefined = undefined;\n\ninterface NLSConfig {\n\tlocale: string;\n\tavailableLanguages: { [key: string]: string; };\n\t_translationsConfigFile: string;\n}\n\nexport interface IProcessEnvironment {\n\t[key: string]: string;\n}\n\ninterface INodeProcess {\n\tplatform: string;\n\tenv: IProcessEnvironment;\n\tgetuid(): number;\n\tnextTick: Function;\n\tversions?: {\n\t\telectron?: string;\n\t};\n\ttype?: string;\n}\ndeclare const process: INodeProcess;\ndeclare const global: any;\n\ninterface INavigator {\n\tuserAgent: string;\n\tlanguage: string;\n}\ndeclare const navigator: INavigator;\ndeclare const self: any;\n\nconst isElectronRenderer = (typeof process !== 'undefined' && typeof process.versions !== 'undefined' && typeof process.versions.electron !== 'undefined' && process.type === 'renderer');\n\n// OS detection\nif (typeof navigator === 'object' && !isElectronRenderer) {\n\tconst userAgent = navigator.userAgent;\n\t_isWindows = userAgent.indexOf('Windows') >= 0;\n\t_isMacintosh = userAgent.indexOf('Macintosh') >= 0;\n\t// _isLinux = userAgent.indexOf('Linux') >= 0;\n\t// _isWeb = true;\n\t_locale = navigator.language;\n\t_language = _locale;\n} else if (typeof process === 'object') {\n\t_isWindows = (process.platform === 'win32');\n\t_isMacintosh = (process.platform === 'darwin');\n\t// _isLinux = (process.platform === 'linux');\n\t_locale = LANGUAGE_DEFAULT;\n\t_language = LANGUAGE_DEFAULT;\n\tconst rawNlsConfig = process.env['VSCODE_NLS_CONFIG'];\n\tif (rawNlsConfig) {\n\t\ttry {\n\t\t\tconst nlsConfig: NLSConfig = JSON.parse(rawNlsConfig);\n\t\t\tconst resolved = nlsConfig.availableLanguages['*'];\n\t\t\t_locale = nlsConfig.locale;\n\t\t\t// VSCode's default language is 'en'\n\t\t\t_language = resolved ? resolved : LANGUAGE_DEFAULT;\n\t\t\t_translationsConfigFile = nlsConfig._translationsConfigFile;\n\t\t} catch (e) {\n\t\t}\n\t}\n\t_isNative = true;\n}\n\nexport const enum Platform {\n\tWeb,\n\tMac,\n\tLinux,\n\tWindows\n}\nexport function PlatformToString(platform: Platform) {\n\tswitch (platform) {\n\t\tcase Platform.Web: return 'Web';\n\t\tcase Platform.Mac: return 'Mac';\n\t\tcase Platform.Linux: return 'Linux';\n\t\tcase Platform.Windows: return 'Windows';\n\t}\n}\n\n// let _platform: Platform = Platform.Web;\n// if (_isNative) {\n// \tif (_isMacintosh) {\n// \t\t_platform = Platform.Mac;\n// \t} else if (_isWindows) {\n// \t\t_platform = Platform.Windows;\n// \t} else if (_isLinux) {\n// \t\t_platform = Platform.Linux;\n// \t}\n// }\n\nexport const isRealWindows = _isWindows;\nexport const isWindows = false; // _isWindows;\nexport const isMacintosh = true; // _isMacintosh;\nexport const isLinux = false; // _isLinux;\nexport const isNative = false; // _isNative;\nexport const isWeb = false; // _isWeb;\nexport const platform = 1; // _platform;\n\nexport function isRootUser(): boolean {\n\treturn _isNative && !_isWindows && (process.getuid() === 0);\n}\n\n/**\n * The language used for the user interface. The format of\n * the string is all lower case (e.g. zh-tw for Traditional\n * Chinese)\n */\nexport const language = _language;\n\n/**\n * The OS locale or the locale specified by --locale. The format of\n * the string is all lower case (e.g. zh-tw for Traditional\n * Chinese). The UI is not necessarily shown in the provided locale.\n */\nexport const locale = _locale;\n\n/**\n * The translatios that are available through language packs.\n */\nexport const translationsConfigFile = _translationsConfigFile;\n\nconst _globals = (typeof self === 'object' ? self : typeof global === 'object' ? global : {} as any);\nexport const globals: any = _globals;\n\nlet _setImmediate: ((callback: (...args: any[]) => void) => number) | null = null;\nexport function setImmediate(callback: (...args: any[]) => void): number {\n\tif (_setImmediate === null) {\n\t\tif (globals.setImmediate) {\n\t\t\t_setImmediate = globals.setImmediate.bind(globals);\n\t\t} else if (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\n\t\t\t_setImmediate = process.nextTick.bind(process);\n\t\t} else {\n\t\t\t_setImmediate = globals.setTimeout.bind(globals);\n\t\t}\n\t}\n\treturn _setImmediate!(callback);\n}\n\nexport const enum OperatingSystem {\n\tWindows = 1,\n\tMacintosh = 2,\n\tLinux = 3\n}\nexport const OS = (_isMacintosh ? OperatingSystem.Macintosh : (_isWindows ? OperatingSystem.Windows : OperatingSystem.Linux));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from 'vs/base/browser/browser';\nimport { KeyCode, KeyCodeUtils, KeyMod, SimpleKeybinding } from 'vs/base/common/keyCodes';\nimport * as platform from 'vs/base/common/platform';\n\nlet KEY_CODE_MAP: { [keyCode: number]: KeyCode } = new Array(230);\nlet INVERSE_KEY_CODE_MAP: KeyCode[] = new Array(KeyCode.MAX_VALUE);\n\n(function () {\n\tfor (let i = 0; i < INVERSE_KEY_CODE_MAP.length; i++) {\n\t\tINVERSE_KEY_CODE_MAP[i] = -1;\n\t}\n\n\tfunction define(code: number, keyCode: KeyCode): void {\n\t\tKEY_CODE_MAP[code] = keyCode;\n\t\tINVERSE_KEY_CODE_MAP[keyCode] = code;\n\t}\n\n\tdefine(3, KeyCode.PauseBreak); // VK_CANCEL 0x03 Control-break processing\n\tdefine(8, KeyCode.Backspace);\n\tdefine(9, KeyCode.Tab);\n\tdefine(13, KeyCode.Enter);\n\tdefine(16, KeyCode.Shift);\n\tdefine(17, KeyCode.Ctrl);\n\tdefine(18, KeyCode.Alt);\n\tdefine(19, KeyCode.PauseBreak);\n\tdefine(20, KeyCode.CapsLock);\n\tdefine(27, KeyCode.Escape);\n\tdefine(32, KeyCode.Space);\n\tdefine(33, KeyCode.PageUp);\n\tdefine(34, KeyCode.PageDown);\n\tdefine(35, KeyCode.End);\n\tdefine(36, KeyCode.Home);\n\tdefine(37, KeyCode.LeftArrow);\n\tdefine(38, KeyCode.UpArrow);\n\tdefine(39, KeyCode.RightArrow);\n\tdefine(40, KeyCode.DownArrow);\n\tdefine(45, KeyCode.Insert);\n\tdefine(46, KeyCode.Delete);\n\n\tdefine(48, KeyCode.KEY_0);\n\tdefine(49, KeyCode.KEY_1);\n\tdefine(50, KeyCode.KEY_2);\n\tdefine(51, KeyCode.KEY_3);\n\tdefine(52, KeyCode.KEY_4);\n\tdefine(53, KeyCode.KEY_5);\n\tdefine(54, KeyCode.KEY_6);\n\tdefine(55, KeyCode.KEY_7);\n\tdefine(56, KeyCode.KEY_8);\n\tdefine(57, KeyCode.KEY_9);\n\n\tdefine(65, KeyCode.KEY_A);\n\tdefine(66, KeyCode.KEY_B);\n\tdefine(67, KeyCode.KEY_C);\n\tdefine(68, KeyCode.KEY_D);\n\tdefine(69, KeyCode.KEY_E);\n\tdefine(70, KeyCode.KEY_F);\n\tdefine(71, KeyCode.KEY_G);\n\tdefine(72, KeyCode.KEY_H);\n\tdefine(73, KeyCode.KEY_I);\n\tdefine(74, KeyCode.KEY_J);\n\tdefine(75, KeyCode.KEY_K);\n\tdefine(76, KeyCode.KEY_L);\n\tdefine(77, KeyCode.KEY_M);\n\tdefine(78, KeyCode.KEY_N);\n\tdefine(79, KeyCode.KEY_O);\n\tdefine(80, KeyCode.KEY_P);\n\tdefine(81, KeyCode.KEY_Q);\n\tdefine(82, KeyCode.KEY_R);\n\tdefine(83, KeyCode.KEY_S);\n\tdefine(84, KeyCode.KEY_T);\n\tdefine(85, KeyCode.KEY_U);\n\tdefine(86, KeyCode.KEY_V);\n\tdefine(87, KeyCode.KEY_W);\n\tdefine(88, KeyCode.KEY_X);\n\tdefine(89, KeyCode.KEY_Y);\n\tdefine(90, KeyCode.KEY_Z);\n\n\tdefine(93, KeyCode.ContextMenu);\n\n\tdefine(96, KeyCode.NUMPAD_0);\n\tdefine(97, KeyCode.NUMPAD_1);\n\tdefine(98, KeyCode.NUMPAD_2);\n\tdefine(99, KeyCode.NUMPAD_3);\n\tdefine(100, KeyCode.NUMPAD_4);\n\tdefine(101, KeyCode.NUMPAD_5);\n\tdefine(102, KeyCode.NUMPAD_6);\n\tdefine(103, KeyCode.NUMPAD_7);\n\tdefine(104, KeyCode.NUMPAD_8);\n\tdefine(105, KeyCode.NUMPAD_9);\n\tdefine(106, KeyCode.NUMPAD_MULTIPLY);\n\tdefine(107, KeyCode.NUMPAD_ADD);\n\tdefine(108, KeyCode.NUMPAD_SEPARATOR);\n\tdefine(109, KeyCode.NUMPAD_SUBTRACT);\n\tdefine(110, KeyCode.NUMPAD_DECIMAL);\n\tdefine(111, KeyCode.NUMPAD_DIVIDE);\n\n\tdefine(112, KeyCode.F1);\n\tdefine(113, KeyCode.F2);\n\tdefine(114, KeyCode.F3);\n\tdefine(115, KeyCode.F4);\n\tdefine(116, KeyCode.F5);\n\tdefine(117, KeyCode.F6);\n\tdefine(118, KeyCode.F7);\n\tdefine(119, KeyCode.F8);\n\tdefine(120, KeyCode.F9);\n\tdefine(121, KeyCode.F10);\n\tdefine(122, KeyCode.F11);\n\tdefine(123, KeyCode.F12);\n\tdefine(124, KeyCode.F13);\n\tdefine(125, KeyCode.F14);\n\tdefine(126, KeyCode.F15);\n\tdefine(127, KeyCode.F16);\n\tdefine(128, KeyCode.F17);\n\tdefine(129, KeyCode.F18);\n\tdefine(130, KeyCode.F19);\n\n\tdefine(144, KeyCode.NumLock);\n\tdefine(145, KeyCode.ScrollLock);\n\n\tdefine(186, KeyCode.US_SEMICOLON);\n\tdefine(187, KeyCode.US_EQUAL);\n\tdefine(188, KeyCode.US_COMMA);\n\tdefine(189, KeyCode.US_MINUS);\n\tdefine(190, KeyCode.US_DOT);\n\tdefine(191, KeyCode.US_SLASH);\n\tdefine(192, KeyCode.US_BACKTICK);\n\tdefine(193, KeyCode.ABNT_C1);\n\tdefine(194, KeyCode.ABNT_C2);\n\tdefine(219, KeyCode.US_OPEN_SQUARE_BRACKET);\n\tdefine(220, KeyCode.US_BACKSLASH);\n\tdefine(221, KeyCode.US_CLOSE_SQUARE_BRACKET);\n\tdefine(222, KeyCode.US_QUOTE);\n\tdefine(223, KeyCode.OEM_8);\n\n\tdefine(226, KeyCode.OEM_102);\n\n\t/**\n\t * https://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\n\t * If an Input Method Editor is processing key input and the event is keydown, return 229.\n\t */\n\tdefine(229, KeyCode.KEY_IN_COMPOSITION);\n\n\tif (browser.isIE) {\n\t\tdefine(91, KeyCode.Meta);\n\t} else if (browser.isFirefox) {\n\t\tdefine(59, KeyCode.US_SEMICOLON);\n\t\tdefine(107, KeyCode.US_EQUAL);\n\t\tdefine(109, KeyCode.US_MINUS);\n\t\tif (platform.isMacintosh) {\n\t\t\tdefine(224, KeyCode.Meta);\n\t\t}\n\t} else if (browser.isWebKit) {\n\t\tdefine(91, KeyCode.Meta);\n\t\tif (platform.isMacintosh) {\n\t\t\t// the two meta keys in the Mac have different key codes (91 and 93)\n\t\t\tdefine(93, KeyCode.Meta);\n\t\t} else {\n\t\t\tdefine(92, KeyCode.Meta);\n\t\t}\n\t}\n})();\n\nfunction extractKeyCode(e: KeyboardEvent): KeyCode {\n\tif (e.charCode) {\n\t\t// \"keypress\" events mostly\n\t\tlet char = String.fromCharCode(e.charCode).toUpperCase();\n\t\treturn KeyCodeUtils.fromString(char);\n\t}\n\treturn KEY_CODE_MAP[e.keyCode] || KeyCode.Unknown;\n}\n\nexport function getCodeForKeyCode(keyCode: KeyCode): number {\n\treturn INVERSE_KEY_CODE_MAP[keyCode];\n}\n\nexport interface IKeyboardEvent {\n\n\treadonly _standardKeyboardEventBrand: true;\n\n\treadonly browserEvent: KeyboardEvent;\n\treadonly target: HTMLElement;\n\n\treadonly ctrlKey: boolean;\n\treadonly shiftKey: boolean;\n\treadonly altKey: boolean;\n\treadonly metaKey: boolean;\n\treadonly keyCode: KeyCode;\n\treadonly code: string;\n\n\t/**\n\t * @internal\n\t */\n\ttoKeybinding(): SimpleKeybinding;\n\tequals(keybinding: number): boolean;\n\n\tpreventDefault(): void;\n\tstopPropagation(): void;\n}\n\nconst ctrlKeyMod = (platform.isMacintosh ? KeyMod.WinCtrl : KeyMod.CtrlCmd);\nconst altKeyMod = KeyMod.Alt;\nconst shiftKeyMod = KeyMod.Shift;\nconst metaKeyMod = (platform.isMacintosh ? KeyMod.CtrlCmd : KeyMod.WinCtrl);\n\nexport class StandardKeyboardEvent implements IKeyboardEvent {\n\n\treadonly _standardKeyboardEventBrand = true;\n\n\tpublic readonly browserEvent: KeyboardEvent;\n\tpublic readonly target: HTMLElement;\n\n\tpublic readonly ctrlKey: boolean;\n\tpublic readonly shiftKey: boolean;\n\tpublic readonly altKey: boolean;\n\tpublic readonly metaKey: boolean;\n\tpublic readonly keyCode: KeyCode;\n\tpublic readonly code: string;\n\n\tprivate _asKeybinding: number;\n\tprivate _asRuntimeKeybinding: SimpleKeybinding;\n\n\tconstructor(source: KeyboardEvent) {\n\t\tlet e = source;\n\n\t\tthis.browserEvent = e;\n\t\tthis.target = <HTMLElement>e.target;\n\n\t\tthis.ctrlKey = e.ctrlKey;\n\t\tthis.shiftKey = e.shiftKey;\n\t\tthis.altKey = e.altKey;\n\t\tthis.metaKey = e.metaKey;\n\t\tthis.keyCode = extractKeyCode(e);\n\t\tthis.code = e.code;\n\n\t\t// console.info(e.type + \": keyCode: \" + e.keyCode + \", which: \" + e.which + \", charCode: \" + e.charCode + \", detail: \" + e.detail + \" ====> \" + this.keyCode + ' -- ' + KeyCode[this.keyCode]);\n\n\t\tthis.ctrlKey = this.ctrlKey || this.keyCode === KeyCode.Ctrl;\n\t\tthis.altKey = this.altKey || this.keyCode === KeyCode.Alt;\n\t\tthis.shiftKey = this.shiftKey || this.keyCode === KeyCode.Shift;\n\t\tthis.metaKey = this.metaKey || this.keyCode === KeyCode.Meta;\n\n\t\tthis._asKeybinding = this._computeKeybinding();\n\t\tthis._asRuntimeKeybinding = this._computeRuntimeKeybinding();\n\n\t\t// console.log(`code: ${e.code}, keyCode: ${e.keyCode}, key: ${e.key}`);\n\t}\n\n\tpublic preventDefault(): void {\n\t\tif (this.browserEvent && this.browserEvent.preventDefault) {\n\t\t\tthis.browserEvent.preventDefault();\n\t\t}\n\t}\n\n\tpublic stopPropagation(): void {\n\t\tif (this.browserEvent && this.browserEvent.stopPropagation) {\n\t\t\tthis.browserEvent.stopPropagation();\n\t\t}\n\t}\n\n\tpublic toKeybinding(): SimpleKeybinding {\n\t\treturn this._asRuntimeKeybinding;\n\t}\n\n\tpublic equals(other: number): boolean {\n\t\treturn this._asKeybinding === other;\n\t}\n\n\tprivate _computeKeybinding(): number {\n\t\tlet key = KeyCode.Unknown;\n\t\tif (this.keyCode !== KeyCode.Ctrl && this.keyCode !== KeyCode.Shift && this.keyCode !== KeyCode.Alt && this.keyCode !== KeyCode.Meta) {\n\t\t\tkey = this.keyCode;\n\t\t}\n\n\t\tlet result = 0;\n\t\tif (this.ctrlKey) {\n\t\t\tresult |= ctrlKeyMod;\n\t\t}\n\t\tif (this.altKey) {\n\t\t\tresult |= altKeyMod;\n\t\t}\n\t\tif (this.shiftKey) {\n\t\t\tresult |= shiftKeyMod;\n\t\t}\n\t\tif (this.metaKey) {\n\t\t\tresult |= metaKeyMod;\n\t\t}\n\t\tresult |= key;\n\n\t\treturn result;\n\t}\n\n\tprivate _computeRuntimeKeybinding(): SimpleKeybinding {\n\t\tlet key = KeyCode.Unknown;\n\t\tif (this.keyCode !== KeyCode.Ctrl && this.keyCode !== KeyCode.Shift && this.keyCode !== KeyCode.Alt && this.keyCode !== KeyCode.Meta) {\n\t\t\tkey = this.keyCode;\n\t\t}\n\t\treturn new SimpleKeybinding(this.ctrlKey, this.shiftKey, this.altKey, this.metaKey, key);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from 'vs/base/browser/browser';\nimport { IframeUtils } from 'vs/base/browser/iframe';\nimport * as platform from 'vs/base/common/platform';\n\nexport interface IMouseEvent {\n\treadonly browserEvent: MouseEvent;\n\treadonly leftButton: boolean;\n\treadonly middleButton: boolean;\n\treadonly rightButton: boolean;\n\treadonly target: HTMLElement;\n\treadonly detail: number;\n\treadonly posx: number;\n\treadonly posy: number;\n\treadonly ctrlKey: boolean;\n\treadonly shiftKey: boolean;\n\treadonly altKey: boolean;\n\treadonly metaKey: boolean;\n\treadonly timestamp: number;\n\n\tpreventDefault(): void;\n\tstopPropagation(): void;\n}\n\nexport class StandardMouseEvent implements IMouseEvent {\n\n\tpublic readonly browserEvent: MouseEvent;\n\n\tpublic readonly leftButton: boolean;\n\tpublic readonly middleButton: boolean;\n\tpublic readonly rightButton: boolean;\n\tpublic readonly target: HTMLElement;\n\tpublic detail: number;\n\tpublic readonly posx: number;\n\tpublic readonly posy: number;\n\tpublic readonly ctrlKey: boolean;\n\tpublic readonly shiftKey: boolean;\n\tpublic readonly altKey: boolean;\n\tpublic readonly metaKey: boolean;\n\tpublic readonly timestamp: number;\n\n\tconstructor(e: MouseEvent) {\n\t\tthis.timestamp = Date.now();\n\t\tthis.browserEvent = e;\n\t\tthis.leftButton = e.button === 0;\n\t\tthis.middleButton = e.button === 1;\n\t\tthis.rightButton = e.button === 2;\n\n\t\tthis.target = <HTMLElement>e.target;\n\n\t\tthis.detail = e.detail || 1;\n\t\tif (e.type === 'dblclick') {\n\t\t\tthis.detail = 2;\n\t\t}\n\t\tthis.ctrlKey = e.ctrlKey;\n\t\tthis.shiftKey = e.shiftKey;\n\t\tthis.altKey = e.altKey;\n\t\tthis.metaKey = e.metaKey;\n\n\t\tif (typeof e.pageX === 'number') {\n\t\t\tthis.posx = e.pageX;\n\t\t\tthis.posy = e.pageY;\n\t\t} else {\n\t\t\t// Probably hit by MSGestureEvent\n\t\t\tthis.posx = e.clientX + document.body.scrollLeft + document.documentElement!.scrollLeft;\n\t\t\tthis.posy = e.clientY + document.body.scrollTop + document.documentElement!.scrollTop;\n\t\t}\n\n\t\t// Find the position of the iframe this code is executing in relative to the iframe where the event was captured.\n\t\tlet iframeOffsets = IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(self, e.view);\n\t\tthis.posx -= iframeOffsets.left;\n\t\tthis.posy -= iframeOffsets.top;\n\t}\n\n\tpublic preventDefault(): void {\n\t\tif (this.browserEvent.preventDefault) {\n\t\t\tthis.browserEvent.preventDefault();\n\t\t}\n\t}\n\n\tpublic stopPropagation(): void {\n\t\tif (this.browserEvent.stopPropagation) {\n\t\t\tthis.browserEvent.stopPropagation();\n\t\t}\n\t}\n}\n\nexport interface IDataTransfer {\n\tdropEffect: string;\n\teffectAllowed: string;\n\ttypes: any[];\n\tfiles: any[];\n\n\tsetData(type: string, data: string): void;\n\tsetDragImage(image: any, x: number, y: number): void;\n\n\tgetData(type: string): string;\n\tclearData(types?: string[]): void;\n}\n\nexport class DragMouseEvent extends StandardMouseEvent {\n\n\tpublic readonly dataTransfer: IDataTransfer;\n\n\tconstructor(e: MouseEvent) {\n\t\tsuper(e);\n\t\tthis.dataTransfer = (<any>e).dataTransfer;\n\t}\n\n}\n\nexport interface IMouseWheelEvent extends MouseEvent {\n\treadonly wheelDelta: number;\n}\n\ninterface IWebKitMouseWheelEvent {\n\twheelDeltaY: number;\n\twheelDeltaX: number;\n}\n\ninterface IGeckoMouseWheelEvent {\n\tHORIZONTAL_AXIS: number;\n\tVERTICAL_AXIS: number;\n\taxis: number;\n\tdetail: number;\n}\n\nexport class StandardWheelEvent {\n\n\tpublic readonly browserEvent: IMouseWheelEvent | null;\n\tpublic readonly deltaY: number;\n\tpublic readonly deltaX: number;\n\tpublic readonly target: Node;\n\n\tconstructor(e: IMouseWheelEvent | null, deltaX: number = 0, deltaY: number = 0) {\n\n\t\tthis.browserEvent = e || null;\n\t\tthis.target = e ? (e.target || (<any>e).targetNode || e.srcElement) : null;\n\n\t\tthis.deltaY = deltaY;\n\t\tthis.deltaX = deltaX;\n\n\t\tif (e) {\n\t\t\tlet e1 = <IWebKitMouseWheelEvent><any>e;\n\t\t\tlet e2 = <IGeckoMouseWheelEvent><any>e;\n\n\t\t\t// vertical delta scroll\n\t\t\tif (typeof e1.wheelDeltaY !== 'undefined') {\n\t\t\t\tthis.deltaY = e1.wheelDeltaY / 120;\n\t\t\t} else if (typeof e2.VERTICAL_AXIS !== 'undefined' && e2.axis === e2.VERTICAL_AXIS) {\n\t\t\t\tthis.deltaY = -e2.detail / 3;\n\t\t\t}\n\n\t\t\t// horizontal delta scroll\n\t\t\tif (typeof e1.wheelDeltaX !== 'undefined') {\n\t\t\t\tif (browser.isSafari && platform.isWindows) {\n\t\t\t\t\tthis.deltaX = - (e1.wheelDeltaX / 120);\n\t\t\t\t} else {\n\t\t\t\t\tthis.deltaX = e1.wheelDeltaX / 120;\n\t\t\t\t}\n\t\t\t} else if (typeof e2.HORIZONTAL_AXIS !== 'undefined' && e2.axis === e2.HORIZONTAL_AXIS) {\n\t\t\t\tthis.deltaX = -e.detail / 3;\n\t\t\t}\n\n\t\t\t// Assume a vertical scroll if nothing else worked\n\t\t\tif (this.deltaY === 0 && this.deltaX === 0 && e.wheelDelta) {\n\t\t\t\tthis.deltaY = e.wheelDelta / 120;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic preventDefault(): void {\n\t\tif (this.browserEvent) {\n\t\t\tif (this.browserEvent.preventDefault) {\n\t\t\t\tthis.browserEvent.preventDefault();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic stopPropagation(): void {\n\t\tif (this.browserEvent) {\n\t\t\tif (this.browserEvent.stopPropagation) {\n\t\t\t\tthis.browserEvent.stopPropagation();\n\t\t\t}\n\t\t}\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from 'vs/base/browser/browser';\nimport { domEvent } from 'vs/base/browser/event';\nimport { IKeyboardEvent, StandardKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { IMouseEvent, StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { TimeoutTimer } from 'vs/base/common/async';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, IDisposable, dispose, toDisposable } from 'vs/base/common/lifecycle';\nimport * as platform from 'vs/base/common/platform';\nimport { coalesce } from 'vs/base/common/arrays';\n\nexport function clearNode(node: HTMLElement): void {\n\twhile (node.firstChild) {\n\t\tnode.removeChild(node.firstChild);\n\t}\n}\n\nexport function removeNode(node: HTMLElement): void {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nexport function isInDOM(node: Node | null): boolean {\n\twhile (node) {\n\t\tif (node === document.body) {\n\t\t\treturn true;\n\t\t}\n\t\tnode = node.parentNode;\n\t}\n\treturn false;\n}\n\ninterface IDomClassList {\n\thasClass(node: HTMLElement, className: string): boolean;\n\taddClass(node: HTMLElement, className: string): void;\n\taddClasses(node: HTMLElement, ...classNames: string[]): void;\n\tremoveClass(node: HTMLElement, className: string): void;\n\tremoveClasses(node: HTMLElement, ...classNames: string[]): void;\n\ttoggleClass(node: HTMLElement, className: string, shouldHaveIt?: boolean): void;\n}\n\nconst _manualClassList = new class implements IDomClassList {\n\n\tprivate _lastStart: number;\n\tprivate _lastEnd: number;\n\n\tprivate _findClassName(node: HTMLElement, className: string): void {\n\n\t\tlet classes = node.className;\n\t\tif (!classes) {\n\t\t\tthis._lastStart = -1;\n\t\t\treturn;\n\t\t}\n\n\t\tclassName = className.trim();\n\n\t\tlet classesLen = classes.length,\n\t\t\tclassLen = className.length;\n\n\t\tif (classLen === 0) {\n\t\t\tthis._lastStart = -1;\n\t\t\treturn;\n\t\t}\n\n\t\tif (classesLen < classLen) {\n\t\t\tthis._lastStart = -1;\n\t\t\treturn;\n\t\t}\n\n\t\tif (classes === className) {\n\t\t\tthis._lastStart = 0;\n\t\t\tthis._lastEnd = classesLen;\n\t\t\treturn;\n\t\t}\n\n\t\tlet idx = -1,\n\t\t\tidxEnd: number;\n\n\t\twhile ((idx = classes.indexOf(className, idx + 1)) >= 0) {\n\n\t\t\tidxEnd = idx + classLen;\n\n\t\t\t// a class that is followed by another class\n\t\t\tif ((idx === 0 || classes.charCodeAt(idx - 1) === CharCode.Space) && classes.charCodeAt(idxEnd) === CharCode.Space) {\n\t\t\t\tthis._lastStart = idx;\n\t\t\t\tthis._lastEnd = idxEnd + 1;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// last class\n\t\t\tif (idx > 0 && classes.charCodeAt(idx - 1) === CharCode.Space && idxEnd === classesLen) {\n\t\t\t\tthis._lastStart = idx - 1;\n\t\t\t\tthis._lastEnd = idxEnd;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// equal - duplicate of cmp above\n\t\t\tif (idx === 0 && idxEnd === classesLen) {\n\t\t\t\tthis._lastStart = 0;\n\t\t\t\tthis._lastEnd = idxEnd;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._lastStart = -1;\n\t}\n\n\thasClass(node: HTMLElement, className: string): boolean {\n\t\tthis._findClassName(node, className);\n\t\treturn this._lastStart !== -1;\n\t}\n\n\taddClasses(node: HTMLElement, ...classNames: string[]): void {\n\t\tclassNames.forEach(nameValue => nameValue.split(' ').forEach(name => this.addClass(node, name)));\n\t}\n\n\taddClass(node: HTMLElement, className: string): void {\n\t\tif (!node.className) { // doesn't have it for sure\n\t\t\tnode.className = className;\n\t\t} else {\n\t\t\tthis._findClassName(node, className); // see if it's already there\n\t\t\tif (this._lastStart === -1) {\n\t\t\t\tnode.className = node.className + ' ' + className;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveClass(node: HTMLElement, className: string): void {\n\t\tthis._findClassName(node, className);\n\t\tif (this._lastStart === -1) {\n\t\t\treturn; // Prevent styles invalidation if not necessary\n\t\t} else {\n\t\t\tnode.className = node.className.substring(0, this._lastStart) + node.className.substring(this._lastEnd);\n\t\t}\n\t}\n\n\tremoveClasses(node: HTMLElement, ...classNames: string[]): void {\n\t\tclassNames.forEach(nameValue => nameValue.split(' ').forEach(name => this.removeClass(node, name)));\n\t}\n\n\ttoggleClass(node: HTMLElement, className: string, shouldHaveIt?: boolean): void {\n\t\tthis._findClassName(node, className);\n\t\tif (this._lastStart !== -1 && (shouldHaveIt === undefined || !shouldHaveIt)) {\n\t\t\tthis.removeClass(node, className);\n\t\t}\n\t\tif (this._lastStart === -1 && (shouldHaveIt === undefined || shouldHaveIt)) {\n\t\t\tthis.addClass(node, className);\n\t\t}\n\t}\n};\n\nconst _nativeClassList = new class implements IDomClassList {\n\thasClass(node: HTMLElement, className: string): boolean {\n\t\treturn Boolean(className) && node.classList && node.classList.contains(className);\n\t}\n\n\taddClasses(node: HTMLElement, ...classNames: string[]): void {\n\t\tclassNames.forEach(nameValue => nameValue.split(' ').forEach(name => this.addClass(node, name)));\n\t}\n\n\taddClass(node: HTMLElement, className: string): void {\n\t\tif (className && node.classList) {\n\t\t\tnode.classList.add(className);\n\t\t}\n\t}\n\n\tremoveClass(node: HTMLElement, className: string): void {\n\t\tif (className && node.classList) {\n\t\t\tnode.classList.remove(className);\n\t\t}\n\t}\n\n\tremoveClasses(node: HTMLElement, ...classNames: string[]): void {\n\t\tclassNames.forEach(nameValue => nameValue.split(' ').forEach(name => this.removeClass(node, name)));\n\t}\n\n\ttoggleClass(node: HTMLElement, className: string, shouldHaveIt?: boolean): void {\n\t\tif (node.classList) {\n\t\t\tnode.classList.toggle(className, shouldHaveIt);\n\t\t}\n\t}\n};\n\n// In IE11 there is only partial support for `classList` which makes us keep our\n// custom implementation. Otherwise use the native implementation, see: http://caniuse.com/#search=classlist\nconst _classList: IDomClassList = browser.isIE ? _manualClassList : _nativeClassList;\nexport const hasClass: (node: HTMLElement, className: string) => boolean = _classList.hasClass.bind(_classList);\nexport const addClass: (node: HTMLElement, className: string) => void = _classList.addClass.bind(_classList);\nexport const addClasses: (node: HTMLElement, ...classNames: string[]) => void = _classList.addClasses.bind(_classList);\nexport const removeClass: (node: HTMLElement, className: string) => void = _classList.removeClass.bind(_classList);\nexport const removeClasses: (node: HTMLElement, ...classNames: string[]) => void = _classList.removeClasses.bind(_classList);\nexport const toggleClass: (node: HTMLElement, className: string, shouldHaveIt?: boolean) => void = _classList.toggleClass.bind(_classList);\n\nclass DomListener implements IDisposable {\n\n\tprivate _handler: (e: any) => void;\n\tprivate _node: Element | Window | Document;\n\tprivate readonly _type: string;\n\tprivate readonly _useCapture: boolean;\n\n\tconstructor(node: Element | Window | Document, type: string, handler: (e: any) => void, useCapture?: boolean) {\n\t\tthis._node = node;\n\t\tthis._type = type;\n\t\tthis._handler = handler;\n\t\tthis._useCapture = (useCapture || false);\n\t\tthis._node.addEventListener(this._type, this._handler, this._useCapture);\n\t}\n\n\tpublic dispose(): void {\n\t\tif (!this._handler) {\n\t\t\t// Already disposed\n\t\t\treturn;\n\t\t}\n\n\t\tthis._node.removeEventListener(this._type, this._handler, this._useCapture);\n\n\t\t// Prevent leakers from holding on to the dom or handler func\n\t\tthis._node = null!;\n\t\tthis._handler = null!;\n\t}\n}\n\nexport function addDisposableListener<K extends keyof GlobalEventHandlersEventMap>(node: Element | Window | Document, type: K, handler: (event: GlobalEventHandlersEventMap[K]) => void, useCapture?: boolean): IDisposable;\nexport function addDisposableListener(node: Element | Window | Document, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable;\nexport function addDisposableListener(node: Element | Window | Document, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\treturn new DomListener(node, type, handler, useCapture);\n}\n\nexport interface IAddStandardDisposableListenerSignature {\n\t(node: HTMLElement, type: 'click', handler: (event: IMouseEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'mousedown', handler: (event: IMouseEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keydown', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keypress', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keyup', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable;\n}\nfunction _wrapAsStandardMouseEvent(handler: (e: IMouseEvent) => void): (e: MouseEvent) => void {\n\treturn function (e: MouseEvent) {\n\t\treturn handler(new StandardMouseEvent(e));\n\t};\n}\nfunction _wrapAsStandardKeyboardEvent(handler: (e: IKeyboardEvent) => void): (e: KeyboardEvent) => void {\n\treturn function (e: KeyboardEvent) {\n\t\treturn handler(new StandardKeyboardEvent(e));\n\t};\n}\nexport let addStandardDisposableListener: IAddStandardDisposableListenerSignature = function addStandardDisposableListener(node: HTMLElement, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\tlet wrapHandler = handler;\n\n\tif (type === 'click' || type === 'mousedown') {\n\t\twrapHandler = _wrapAsStandardMouseEvent(handler);\n\t} else if (type === 'keydown' || type === 'keypress' || type === 'keyup') {\n\t\twrapHandler = _wrapAsStandardKeyboardEvent(handler);\n\t}\n\n\treturn addDisposableListener(node, type, wrapHandler, useCapture);\n};\n\nexport function addDisposableNonBubblingMouseOutListener(node: Element, handler: (event: MouseEvent) => void): IDisposable {\n\treturn addDisposableListener(node, 'mouseout', (e: MouseEvent) => {\n\t\t// Mouse out bubbles, so this is an attempt to ignore faux mouse outs coming from children elements\n\t\tlet toElement: Node | null = <Node>(e.relatedTarget || e.target);\n\t\twhile (toElement && toElement !== node) {\n\t\t\ttoElement = toElement.parentNode;\n\t\t}\n\t\tif (toElement === node) {\n\t\t\treturn;\n\t\t}\n\n\t\thandler(e);\n\t});\n}\n\ninterface IRequestAnimationFrame {\n\t(callback: (time: number) => void): number;\n}\nlet _animationFrame: IRequestAnimationFrame | null = null;\nfunction doRequestAnimationFrame(callback: (time: number) => void): number {\n\tif (!_animationFrame) {\n\t\tconst emulatedRequestAnimationFrame = (callback: (time: number) => void): any => {\n\t\t\treturn setTimeout(() => callback(new Date().getTime()), 0);\n\t\t};\n\t\t_animationFrame = (\n\t\t\tself.requestAnimationFrame\n\t\t\t|| (<any>self).msRequestAnimationFrame\n\t\t\t|| (<any>self).webkitRequestAnimationFrame\n\t\t\t|| (<any>self).mozRequestAnimationFrame\n\t\t\t|| (<any>self).oRequestAnimationFrame\n\t\t\t|| emulatedRequestAnimationFrame\n\t\t);\n\t}\n\treturn _animationFrame.call(self, callback);\n}\n\n/**\n * Schedule a callback to be run at the next animation frame.\n * This allows multiple parties to register callbacks that should run at the next animation frame.\n * If currently in an animation frame, `runner` will be executed immediately.\n * @return token that can be used to cancel the scheduled runner (only if `runner` was not executed immediately).\n */\nexport let runAtThisOrScheduleAtNextAnimationFrame: (runner: () => void, priority?: number) => IDisposable;\n/**\n * Schedule a callback to be run at the next animation frame.\n * This allows multiple parties to register callbacks that should run at the next animation frame.\n * If currently in an animation frame, `runner` will be executed at the next animation frame.\n * @return token that can be used to cancel the scheduled runner.\n */\nexport let scheduleAtNextAnimationFrame: (runner: () => void, priority?: number) => IDisposable;\n\nclass AnimationFrameQueueItem implements IDisposable {\n\n\tprivate _runner: () => void;\n\tpublic priority: number;\n\tprivate _canceled: boolean;\n\n\tconstructor(runner: () => void, priority: number = 0) {\n\t\tthis._runner = runner;\n\t\tthis.priority = priority;\n\t\tthis._canceled = false;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._canceled = true;\n\t}\n\n\tpublic execute(): void {\n\t\tif (this._canceled) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis._runner();\n\t\t} catch (e) {\n\t\t\tonUnexpectedError(e);\n\t\t}\n\t}\n\n\t// Sort by priority (largest to lowest)\n\tpublic static sort(a: AnimationFrameQueueItem, b: AnimationFrameQueueItem): number {\n\t\treturn b.priority - a.priority;\n\t}\n}\n\n(function () {\n\t/**\n\t * The runners scheduled at the next animation frame\n\t */\n\tlet NEXT_QUEUE: AnimationFrameQueueItem[] = [];\n\t/**\n\t * The runners scheduled at the current animation frame\n\t */\n\tlet CURRENT_QUEUE: AnimationFrameQueueItem[] | null = null;\n\t/**\n\t * A flag to keep track if the native requestAnimationFrame was already called\n\t */\n\tlet animFrameRequested = false;\n\t/**\n\t * A flag to indicate if currently handling a native requestAnimationFrame callback\n\t */\n\tlet inAnimationFrameRunner = false;\n\n\tlet animationFrameRunner = () => {\n\t\tanimFrameRequested = false;\n\n\t\tCURRENT_QUEUE = NEXT_QUEUE;\n\t\tNEXT_QUEUE = [];\n\n\t\tinAnimationFrameRunner = true;\n\t\twhile (CURRENT_QUEUE.length > 0) {\n\t\t\tCURRENT_QUEUE.sort(AnimationFrameQueueItem.sort);\n\t\t\tlet top = CURRENT_QUEUE.shift()!;\n\t\t\ttop.execute();\n\t\t}\n\t\tinAnimationFrameRunner = false;\n\t};\n\n\tscheduleAtNextAnimationFrame = (runner: () => void, priority: number = 0) => {\n\t\tlet item = new AnimationFrameQueueItem(runner, priority);\n\t\tNEXT_QUEUE.push(item);\n\n\t\tif (!animFrameRequested) {\n\t\t\tanimFrameRequested = true;\n\t\t\tdoRequestAnimationFrame(animationFrameRunner);\n\t\t}\n\n\t\treturn item;\n\t};\n\n\trunAtThisOrScheduleAtNextAnimationFrame = (runner: () => void, priority?: number) => {\n\t\tif (inAnimationFrameRunner) {\n\t\t\tlet item = new AnimationFrameQueueItem(runner, priority);\n\t\t\tCURRENT_QUEUE!.push(item);\n\t\t\treturn item;\n\t\t} else {\n\t\t\treturn scheduleAtNextAnimationFrame(runner, priority);\n\t\t}\n\t};\n})();\n\nexport function measure(callback: () => void): IDisposable {\n\treturn scheduleAtNextAnimationFrame(callback, 10000 /* must be early */);\n}\n\nexport function modify(callback: () => void): IDisposable {\n\treturn scheduleAtNextAnimationFrame(callback, -10000 /* must be late */);\n}\n\n/**\n * Add a throttled listener. `handler` is fired at most every 16ms or with the next animation frame (if browser supports it).\n */\nexport interface IEventMerger<R, E> {\n\t(lastEvent: R | null, currentEvent: E): R;\n}\n\nexport interface DOMEvent {\n\tpreventDefault(): void;\n\tstopPropagation(): void;\n}\n\nconst MINIMUM_TIME_MS = 16;\nconst DEFAULT_EVENT_MERGER: IEventMerger<DOMEvent, DOMEvent> = function (lastEvent: DOMEvent, currentEvent: DOMEvent) {\n\treturn currentEvent;\n};\n\nclass TimeoutThrottledDomListener<R, E extends DOMEvent> extends Disposable {\n\n\tconstructor(node: any, type: string, handler: (event: R) => void, eventMerger: IEventMerger<R, E> = <any>DEFAULT_EVENT_MERGER, minimumTimeMs: number = MINIMUM_TIME_MS) {\n\t\tsuper();\n\n\t\tlet lastEvent: R | null = null;\n\t\tlet lastHandlerTime = 0;\n\t\tlet timeout = this._register(new TimeoutTimer());\n\n\t\tlet invokeHandler = () => {\n\t\t\tlastHandlerTime = (new Date()).getTime();\n\t\t\thandler(<R>lastEvent);\n\t\t\tlastEvent = null;\n\t\t};\n\n\t\tthis._register(addDisposableListener(node, type, (e) => {\n\n\t\t\tlastEvent = eventMerger(lastEvent, e);\n\t\t\tlet elapsedTime = (new Date()).getTime() - lastHandlerTime;\n\n\t\t\tif (elapsedTime >= minimumTimeMs) {\n\t\t\t\ttimeout.cancel();\n\t\t\t\tinvokeHandler();\n\t\t\t} else {\n\t\t\t\ttimeout.setIfNotSet(invokeHandler, minimumTimeMs - elapsedTime);\n\t\t\t}\n\t\t}));\n\t}\n}\n\nexport function addDisposableThrottledListener<R, E extends DOMEvent = DOMEvent>(node: any, type: string, handler: (event: R) => void, eventMerger?: IEventMerger<R, E>, minimumTimeMs?: number): IDisposable {\n\treturn new TimeoutThrottledDomListener<R, E>(node, type, handler, eventMerger, minimumTimeMs);\n}\n\nexport function getComputedStyle(el: HTMLElement): CSSStyleDeclaration {\n\treturn document.defaultView!.getComputedStyle(el, null);\n}\n\n// Adapted from WinJS\n// Converts a CSS positioning string for the specified element to pixels.\nconst convertToPixels: (element: HTMLElement, value: string) => number = (function () {\n\treturn function (element: HTMLElement, value: string): number {\n\t\treturn parseFloat(value) || 0;\n\t};\n})();\n\nfunction getDimension(element: HTMLElement, cssPropertyName: string, jsPropertyName: string): number {\n\tlet computedStyle: CSSStyleDeclaration = getComputedStyle(element);\n\tlet value = '0';\n\tif (computedStyle) {\n\t\tif (computedStyle.getPropertyValue) {\n\t\t\tvalue = computedStyle.getPropertyValue(cssPropertyName);\n\t\t} else {\n\t\t\t// IE8\n\t\t\tvalue = (<any>computedStyle).getAttribute(jsPropertyName);\n\t\t}\n\t}\n\treturn convertToPixels(element, value);\n}\n\nexport function getClientArea(element: HTMLElement): Dimension {\n\n\t// Try with DOM clientWidth / clientHeight\n\tif (element !== document.body) {\n\t\treturn new Dimension(element.clientWidth, element.clientHeight);\n\t}\n\n\t// Try innerWidth / innerHeight\n\tif (window.innerWidth && window.innerHeight) {\n\t\treturn new Dimension(window.innerWidth, window.innerHeight);\n\t}\n\n\t// Try with document.body.clientWidth / document.body.clientHeight\n\tif (document.body && document.body.clientWidth && document.body.clientHeight) {\n\t\treturn new Dimension(document.body.clientWidth, document.body.clientHeight);\n\t}\n\n\t// Try with document.documentElement.clientWidth / document.documentElement.clientHeight\n\tif (document.documentElement && document.documentElement.clientWidth && document.documentElement.clientHeight) {\n\t\treturn new Dimension(document.documentElement.clientWidth, document.documentElement.clientHeight);\n\t}\n\n\tthrow new Error('Unable to figure out browser width and height');\n}\n\nconst sizeUtils = {\n\n\tgetBorderLeftWidth: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'border-left-width', 'borderLeftWidth');\n\t},\n\tgetBorderRightWidth: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'border-right-width', 'borderRightWidth');\n\t},\n\tgetBorderTopWidth: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'border-top-width', 'borderTopWidth');\n\t},\n\tgetBorderBottomWidth: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'border-bottom-width', 'borderBottomWidth');\n\t},\n\n\tgetPaddingLeft: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'padding-left', 'paddingLeft');\n\t},\n\tgetPaddingRight: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'padding-right', 'paddingRight');\n\t},\n\tgetPaddingTop: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'padding-top', 'paddingTop');\n\t},\n\tgetPaddingBottom: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'padding-bottom', 'paddingBottom');\n\t},\n\n\tgetMarginLeft: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'margin-left', 'marginLeft');\n\t},\n\tgetMarginTop: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'margin-top', 'marginTop');\n\t},\n\tgetMarginRight: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'margin-right', 'marginRight');\n\t},\n\tgetMarginBottom: function (element: HTMLElement): number {\n\t\treturn getDimension(element, 'margin-bottom', 'marginBottom');\n\t},\n\t__commaSentinel: false\n};\n\n// ----------------------------------------------------------------------------------------\n// Position & Dimension\n\nexport class Dimension {\n\tpublic width: number;\n\tpublic height: number;\n\n\tconstructor(width: number, height: number) {\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t}\n\n\tstatic equals(a: Dimension | undefined, b: Dimension | undefined): boolean {\n\t\tif (a === b) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\treturn a.width === b.width && a.height === b.height;\n\t}\n}\n\nexport function getTopLeftOffset(element: HTMLElement): { left: number; top: number; } {\n\t// Adapted from WinJS.Utilities.getPosition\n\t// and added borders to the mix\n\n\tlet offsetParent = element.offsetParent, top = element.offsetTop, left = element.offsetLeft;\n\n\twhile ((element = <HTMLElement>element.parentNode) !== null && element !== document.body && element !== document.documentElement) {\n\t\ttop -= element.scrollTop;\n\t\tlet c = getComputedStyle(element);\n\t\tif (c) {\n\t\t\tleft -= c.direction !== 'rtl' ? element.scrollLeft : -element.scrollLeft;\n\t\t}\n\n\t\tif (element === offsetParent) {\n\t\t\tleft += sizeUtils.getBorderLeftWidth(element);\n\t\t\ttop += sizeUtils.getBorderTopWidth(element);\n\t\t\ttop += element.offsetTop;\n\t\t\tleft += element.offsetLeft;\n\t\t\toffsetParent = element.offsetParent;\n\t\t}\n\t}\n\n\treturn {\n\t\tleft: left,\n\t\ttop: top\n\t};\n}\n\nexport interface IDomNodePagePosition {\n\tleft: number;\n\ttop: number;\n\twidth: number;\n\theight: number;\n}\n\nexport function size(element: HTMLElement, width: number | null, height: number | null): void {\n\tif (typeof width === 'number') {\n\t\telement.style.width = `${width}px`;\n\t}\n\n\tif (typeof height === 'number') {\n\t\telement.style.height = `${height}px`;\n\t}\n}\n\nexport function position(element: HTMLElement, top: number, right?: number, bottom?: number, left?: number, position: string = 'absolute'): void {\n\tif (typeof top === 'number') {\n\t\telement.style.top = `${top}px`;\n\t}\n\n\tif (typeof right === 'number') {\n\t\telement.style.right = `${right}px`;\n\t}\n\n\tif (typeof bottom === 'number') {\n\t\telement.style.bottom = `${bottom}px`;\n\t}\n\n\tif (typeof left === 'number') {\n\t\telement.style.left = `${left}px`;\n\t}\n\n\telement.style.position = position;\n}\n\n/**\n * Returns the position of a dom node relative to the entire page.\n */\nexport function getDomNodePagePosition(domNode: HTMLElement): IDomNodePagePosition {\n\tlet bb = domNode.getBoundingClientRect();\n\treturn {\n\t\tleft: bb.left + StandardWindow.scrollX,\n\t\ttop: bb.top + StandardWindow.scrollY,\n\t\twidth: bb.width,\n\t\theight: bb.height\n\t};\n}\n\nexport interface IStandardWindow {\n\treadonly scrollX: number;\n\treadonly scrollY: number;\n}\n\nexport const StandardWindow: IStandardWindow = new class implements IStandardWindow {\n\tget scrollX(): number {\n\t\tif (typeof window.scrollX === 'number') {\n\t\t\t// modern browsers\n\t\t\treturn window.scrollX;\n\t\t} else {\n\t\t\treturn document.body.scrollLeft + document.documentElement!.scrollLeft;\n\t\t}\n\t}\n\n\tget scrollY(): number {\n\t\tif (typeof window.scrollY === 'number') {\n\t\t\t// modern browsers\n\t\t\treturn window.scrollY;\n\t\t} else {\n\t\t\treturn document.body.scrollTop + document.documentElement!.scrollTop;\n\t\t}\n\t}\n};\n\n// Adapted from WinJS\n// Gets the width of the element, including margins.\nexport function getTotalWidth(element: HTMLElement): number {\n\tlet margin = sizeUtils.getMarginLeft(element) + sizeUtils.getMarginRight(element);\n\treturn element.offsetWidth + margin;\n}\n\nexport function getContentWidth(element: HTMLElement): number {\n\tlet border = sizeUtils.getBorderLeftWidth(element) + sizeUtils.getBorderRightWidth(element);\n\tlet padding = sizeUtils.getPaddingLeft(element) + sizeUtils.getPaddingRight(element);\n\treturn element.offsetWidth - border - padding;\n}\n\nexport function getTotalScrollWidth(element: HTMLElement): number {\n\tlet margin = sizeUtils.getMarginLeft(element) + sizeUtils.getMarginRight(element);\n\treturn element.scrollWidth + margin;\n}\n\n// Adapted from WinJS\n// Gets the height of the content of the specified element. The content height does not include borders or padding.\nexport function getContentHeight(element: HTMLElement): number {\n\tlet border = sizeUtils.getBorderTopWidth(element) + sizeUtils.getBorderBottomWidth(element);\n\tlet padding = sizeUtils.getPaddingTop(element) + sizeUtils.getPaddingBottom(element);\n\treturn element.offsetHeight - border - padding;\n}\n\n// Adapted from WinJS\n// Gets the height of the element, including its margins.\nexport function getTotalHeight(element: HTMLElement): number {\n\tlet margin = sizeUtils.getMarginTop(element) + sizeUtils.getMarginBottom(element);\n\treturn element.offsetHeight + margin;\n}\n\n// Gets the left coordinate of the specified element relative to the specified parent.\nfunction getRelativeLeft(element: HTMLElement, parent: HTMLElement): number {\n\tif (element === null) {\n\t\treturn 0;\n\t}\n\n\tlet elementPosition = getTopLeftOffset(element);\n\tlet parentPosition = getTopLeftOffset(parent);\n\treturn elementPosition.left - parentPosition.left;\n}\n\nexport function getLargestChildWidth(parent: HTMLElement, children: HTMLElement[]): number {\n\tlet childWidths = children.map((child) => {\n\t\treturn Math.max(getTotalScrollWidth(child), getTotalWidth(child)) + getRelativeLeft(child, parent) || 0;\n\t});\n\tlet maxWidth = Math.max(...childWidths);\n\treturn maxWidth;\n}\n\n// ----------------------------------------------------------------------------------------\n\nexport function isAncestor(testChild: Node | null, testAncestor: Node | null): boolean {\n\twhile (testChild) {\n\t\tif (testChild === testAncestor) {\n\t\t\treturn true;\n\t\t}\n\t\ttestChild = testChild.parentNode;\n\t}\n\n\treturn false;\n}\n\nexport function findParentWithClass(node: HTMLElement, clazz: string, stopAtClazzOrNode?: string | HTMLElement): HTMLElement | null {\n\twhile (node) {\n\t\tif (hasClass(node, clazz)) {\n\t\t\treturn node;\n\t\t}\n\n\t\tif (stopAtClazzOrNode) {\n\t\t\tif (typeof stopAtClazzOrNode === 'string') {\n\t\t\t\tif (hasClass(node, stopAtClazzOrNode)) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (node === stopAtClazzOrNode) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnode = <HTMLElement>node.parentNode;\n\t}\n\n\treturn null;\n}\n\nexport function createStyleSheet(container: HTMLElement = document.getElementsByTagName('head')[0]): HTMLStyleElement {\n\tlet style = document.createElement('style');\n\tstyle.type = 'text/css';\n\tstyle.media = 'screen';\n\tcontainer.appendChild(style);\n\treturn style;\n}\n\nlet _sharedStyleSheet: HTMLStyleElement | null = null;\nfunction getSharedStyleSheet(): HTMLStyleElement {\n\tif (!_sharedStyleSheet) {\n\t\t_sharedStyleSheet = createStyleSheet();\n\t}\n\treturn _sharedStyleSheet;\n}\n\nfunction getDynamicStyleSheetRules(style: any) {\n\tif (style && style.sheet && style.sheet.rules) {\n\t\t// Chrome, IE\n\t\treturn style.sheet.rules;\n\t}\n\tif (style && style.sheet && style.sheet.cssRules) {\n\t\t// FF\n\t\treturn style.sheet.cssRules;\n\t}\n\treturn [];\n}\n\nexport function createCSSRule(selector: string, cssText: string, style: HTMLStyleElement = getSharedStyleSheet()): void {\n\tif (!style || !cssText) {\n\t\treturn;\n\t}\n\n\t(<CSSStyleSheet>style.sheet).insertRule(selector + '{' + cssText + '}', 0);\n}\n\nexport function removeCSSRulesContainingSelector(ruleName: string, style: HTMLStyleElement = getSharedStyleSheet()): void {\n\tif (!style) {\n\t\treturn;\n\t}\n\n\tlet rules = getDynamicStyleSheetRules(style);\n\tlet toDelete: number[] = [];\n\tfor (let i = 0; i < rules.length; i++) {\n\t\tlet rule = rules[i];\n\t\tif (rule.selectorText.indexOf(ruleName) !== -1) {\n\t\t\ttoDelete.push(i);\n\t\t}\n\t}\n\n\tfor (let i = toDelete.length - 1; i >= 0; i--) {\n\t\t(<any>style.sheet).deleteRule(toDelete[i]);\n\t}\n}\n\nexport function isHTMLElement(o: any): o is HTMLElement {\n\tif (typeof HTMLElement === 'object') {\n\t\treturn o instanceof HTMLElement;\n\t}\n\treturn o && typeof o === 'object' && o.nodeType === 1 && typeof o.nodeName === 'string';\n}\n\nexport const EventType = {\n\t// Mouse\n\tCLICK: 'click' as 'click',\n\tDBLCLICK: 'dblclick' as 'dblclick',\n\tMOUSE_UP: 'mouseup' as 'mouseup',\n\tMOUSE_DOWN: 'mousedown' as 'mousedown',\n\tMOUSE_OVER: 'mouseover' as 'mouseover',\n\tMOUSE_MOVE: 'mousemove' as 'mousemove',\n\tMOUSE_OUT: 'mouseout' as 'mouseout',\n\tMOUSE_ENTER: 'mouseenter' as 'mouseenter',\n\tMOUSE_LEAVE: 'mouseleave' as 'mouseleave',\n\tCONTEXT_MENU: 'contextmenu' as 'contextmenu',\n\tWHEEL: 'wheel' as 'wheel',\n\t// Keyboard\n\tKEY_DOWN: 'keydown' as 'keydown',\n\tKEY_PRESS: 'keypress' as 'keypress',\n\tKEY_UP: 'keyup' as 'keyup',\n\t// HTML Document\n\tLOAD: 'load' as 'load',\n\tUNLOAD: 'unload' as 'unload',\n\tABORT: 'abort' as 'abort',\n\tERROR: 'error' as 'error',\n\tRESIZE: 'resize' as 'resize',\n\tSCROLL: 'scroll' as 'scroll',\n\t// Form\n\tSELECT: 'select' as 'select',\n\tCHANGE: 'change' as 'change',\n\tSUBMIT: 'submit' as 'submit',\n\tRESET: 'reset' as 'reset',\n\tFOCUS: 'focus' as 'focus',\n\tFOCUS_IN: 'focusin' as 'focusin',\n\tFOCUS_OUT: 'focusout' as 'focusout',\n\tBLUR: 'blur' as 'blur',\n\tINPUT: 'input' as 'input',\n\t// Local Storage\n\tSTORAGE: 'storage' as 'storage',\n\t// Drag\n\tDRAG_START: 'dragstart' as 'dragstart',\n\tDRAG: 'drag' as 'drag',\n\tDRAG_ENTER: 'dragenter' as 'dragenter',\n\tDRAG_LEAVE: 'dragleave' as 'dragleave',\n\tDRAG_OVER: 'dragover' as 'dragover',\n\tDROP: 'drop' as 'drop',\n\tDRAG_END: 'dragend' as 'dragend',\n\t// Animation\n\tANIMATION_START: browser.isWebKit ? 'webkitAnimationStart' : 'animationstart',\n\tANIMATION_END: browser.isWebKit ? 'webkitAnimationEnd' : 'animationend',\n\tANIMATION_ITERATION: browser.isWebKit ? 'webkitAnimationIteration' : 'animationiteration'\n};\n\nexport interface EventLike {\n\tpreventDefault(): void;\n\tstopPropagation(): void;\n}\n\nexport const EventHelper = {\n\tstop: function (e: EventLike, cancelBubble?: boolean) {\n\t\tif (e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t} else {\n\t\t\t// IE8\n\t\t\t(<any>e).returnValue = false;\n\t\t}\n\n\t\tif (cancelBubble) {\n\t\t\tif (e.stopPropagation) {\n\t\t\t\te.stopPropagation();\n\t\t\t} else {\n\t\t\t\t// IE8\n\t\t\t\t(<any>e).cancelBubble = true;\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport interface IFocusTracker {\n\tonDidFocus: Event<void>;\n\tonDidBlur: Event<void>;\n\tdispose(): void;\n}\n\nexport function saveParentsScrollTop(node: Element): number[] {\n\tlet r: number[] = [];\n\tfor (let i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\n\t\tr[i] = node.scrollTop;\n\t\tnode = <Element>node.parentNode;\n\t}\n\treturn r;\n}\n\nexport function restoreParentsScrollTop(node: Element, state: number[]): void {\n\tfor (let i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\n\t\tif (node.scrollTop !== state[i]) {\n\t\t\tnode.scrollTop = state[i];\n\t\t}\n\t\tnode = <Element>node.parentNode;\n\t}\n}\n\nclass FocusTracker implements IFocusTracker {\n\n\tprivate _onDidFocus = new Emitter<void>();\n\treadonly onDidFocus: Event<void> = this._onDidFocus.event;\n\n\tprivate _onDidBlur = new Emitter<void>();\n\treadonly onDidBlur: Event<void> = this._onDidBlur.event;\n\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(element: HTMLElement | Window) {\n\t\tlet hasFocus = isAncestor(document.activeElement, <HTMLElement>element);\n\t\tlet loosingFocus = false;\n\n\t\tlet onFocus = () => {\n\t\t\tloosingFocus = false;\n\t\t\tif (!hasFocus) {\n\t\t\t\thasFocus = true;\n\t\t\t\tthis._onDidFocus.fire();\n\t\t\t}\n\t\t};\n\n\t\tlet onBlur = () => {\n\t\t\tif (hasFocus) {\n\t\t\t\tloosingFocus = true;\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tif (loosingFocus) {\n\t\t\t\t\t\tloosingFocus = false;\n\t\t\t\t\t\thasFocus = false;\n\t\t\t\t\t\tthis._onDidBlur.fire();\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t};\n\n\t\tdomEvent(element, EventType.FOCUS, true)(onFocus, null, this.disposables);\n\t\tdomEvent(element, EventType.BLUR, true)(onBlur, null, this.disposables);\n\t}\n\n\tdispose(): void {\n\t\tthis.disposables = dispose(this.disposables);\n\t\tthis._onDidFocus.dispose();\n\t\tthis._onDidBlur.dispose();\n\t}\n}\n\nexport function trackFocus(element: HTMLElement | Window): IFocusTracker {\n\treturn new FocusTracker(element);\n}\n\nexport function append<T extends Node>(parent: HTMLElement, ...children: T[]): T {\n\tchildren.forEach(child => parent.appendChild(child));\n\treturn children[children.length - 1];\n}\n\nexport function prepend<T extends Node>(parent: HTMLElement, child: T): T {\n\tparent.insertBefore(child, parent.firstChild);\n\treturn child;\n}\n\nconst SELECTOR_REGEX = /([\\w\\-]+)?(#([\\w\\-]+))?((.([\\w\\-]+))*)/;\n\nexport function $<T extends HTMLElement>(description: string, attrs?: { [key: string]: any; }, ...children: Array<Node | string>): T {\n\tlet match = SELECTOR_REGEX.exec(description);\n\n\tif (!match) {\n\t\tthrow new Error('Bad use of emmet');\n\t}\n\n\tlet result = document.createElement(match[1] || 'div');\n\n\tif (match[3]) {\n\t\tresult.id = match[3];\n\t}\n\tif (match[4]) {\n\t\tresult.className = match[4].replace(/\\./g, ' ').trim();\n\t}\n\n\tattrs = attrs || {};\n\tObject.keys(attrs).forEach(name => {\n\t\tconst value = attrs![name];\n\t\tif (/^on\\w+$/.test(name)) {\n\t\t\t(<any>result)[name] = value;\n\t\t} else if (name === 'selected') {\n\t\t\tif (value) {\n\t\t\t\tresult.setAttribute(name, 'true');\n\t\t\t}\n\n\t\t} else {\n\t\t\tresult.setAttribute(name, value);\n\t\t}\n\t});\n\n\tcoalesce(children)\n\t\t.forEach(child => {\n\t\t\tif (child instanceof Node) {\n\t\t\t\tresult.appendChild(child);\n\t\t\t} else {\n\t\t\t\tresult.appendChild(document.createTextNode(child as string));\n\t\t\t}\n\t\t});\n\n\treturn result as T;\n}\n\nexport function join(nodes: Node[], separator: Node | string): Node[] {\n\tconst result: Node[] = [];\n\n\tnodes.forEach((node, index) => {\n\t\tif (index > 0) {\n\t\t\tif (separator instanceof Node) {\n\t\t\t\tresult.push(separator.cloneNode());\n\t\t\t} else {\n\t\t\t\tresult.push(document.createTextNode(separator));\n\t\t\t}\n\t\t}\n\n\t\tresult.push(node);\n\t});\n\n\treturn result;\n}\n\nexport function show(...elements: HTMLElement[]): void {\n\tfor (let element of elements) {\n\t\telement.style.display = '';\n\t\telement.removeAttribute('aria-hidden');\n\t}\n}\n\nexport function hide(...elements: HTMLElement[]): void {\n\tfor (let element of elements) {\n\t\telement.style.display = 'none';\n\t\telement.setAttribute('aria-hidden', 'true');\n\t}\n}\n\nfunction findParentWithAttribute(node: Node | null, attribute: string): HTMLElement | null {\n\twhile (node) {\n\t\tif (node instanceof HTMLElement && node.hasAttribute(attribute)) {\n\t\t\treturn node;\n\t\t}\n\n\t\tnode = node.parentNode;\n\t}\n\n\treturn null;\n}\n\nexport function removeTabIndexAndUpdateFocus(node: HTMLElement): void {\n\tif (!node || !node.hasAttribute('tabIndex')) {\n\t\treturn;\n\t}\n\n\t// If we are the currently focused element and tabIndex is removed,\n\t// standard DOM behavior is to move focus to the <body> element. We\n\t// typically never want that, rather put focus to the closest element\n\t// in the hierarchy of the parent DOM nodes.\n\tif (document.activeElement === node) {\n\t\tlet parentFocusable = findParentWithAttribute(node.parentElement, 'tabIndex');\n\t\tif (parentFocusable) {\n\t\t\tparentFocusable.focus();\n\t\t}\n\t}\n\n\tnode.removeAttribute('tabindex');\n}\n\nexport function getElementsByTagName(tag: string): HTMLElement[] {\n\treturn Array.prototype.slice.call(document.getElementsByTagName(tag), 0);\n}\n\nexport function finalHandler<T extends DOMEvent>(fn: (event: T) => any): (event: T) => any {\n\treturn e => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tfn(e);\n\t};\n}\n\nexport function domContentLoaded(): Promise<any> {\n\treturn new Promise<any>(resolve => {\n\t\tconst readyState = document.readyState;\n\t\tif (readyState === 'complete' || (document && document.body !== null)) {\n\t\t\tplatform.setImmediate(resolve);\n\t\t} else {\n\t\t\twindow.addEventListener('DOMContentLoaded', resolve, false);\n\t\t}\n\t});\n}\n\n/**\n * Find a value usable for a dom node size such that the likelihood that it would be\n * displayed with constant screen pixels size is as high as possible.\n *\n * e.g. We would desire for the cursors to be 2px (CSS px) wide. Under a devicePixelRatio\n * of 1.25, the cursor will be 2.5 screen pixels wide. Depending on how the dom node aligns/\"snaps\"\n * with the screen pixels, it will sometimes be rendered with 2 screen pixels, and sometimes with 3 screen pixels.\n */\nexport function computeScreenAwareSize(cssPx: number): number {\n\tconst screenPx = window.devicePixelRatio * cssPx;\n\treturn Math.max(1, Math.floor(screenPx)) / window.devicePixelRatio;\n}\n\n/**\n * See https://github.com/Microsoft/monaco-editor/issues/601\n * To protect against malicious code in the linked site, particularly phishing attempts,\n * the window.opener should be set to null to prevent the linked site from having access\n * to change the location of the current page.\n * See https://mathiasbynens.github.io/rel-noopener/\n */\nexport function windowOpenNoOpener(url: string): void {\n\tif (platform.isNative || browser.isEdgeWebView) {\n\t\t// In VSCode, window.open() always returns null...\n\t\t// The same is true for a WebView (see https://github.com/Microsoft/monaco-editor/issues/628)\n\t\twindow.open(url);\n\t} else {\n\t\tlet newTab = window.open();\n\t\tif (newTab) {\n\t\t\t(newTab as any).opener = null;\n\t\t\tnewTab.location.href = url;\n\t\t}\n\t}\n}\n\nexport function animate(fn: () => void): IDisposable {\n\tconst step = () => {\n\t\tfn();\n\t\tstepDisposable = scheduleAtNextAnimationFrame(step);\n\t};\n\n\tlet stepDisposable = scheduleAtNextAnimationFrame(step);\n\treturn toDisposable(() => stepDisposable.dispose());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport { IDisposable, Disposable } from 'vs/base/common/lifecycle';\nimport * as DomUtils from 'vs/base/browser/dom';\nimport { memoize } from 'vs/base/common/decorators';\n\nexport namespace EventType {\n\texport const Tap = '-monaco-gesturetap';\n\texport const Change = '-monaco-gesturechange';\n\texport const Start = '-monaco-gesturestart';\n\texport const End = '-monaco-gesturesend';\n\texport const Contextmenu = '-monaco-gesturecontextmenu';\n}\n\ninterface TouchData {\n\tid: number;\n\tinitialTarget: EventTarget;\n\tinitialTimeStamp: number;\n\tinitialPageX: number;\n\tinitialPageY: number;\n\trollingTimestamps: number[];\n\trollingPageX: number[];\n\trollingPageY: number[];\n}\n\nexport interface GestureEvent extends MouseEvent {\n\tinitialTarget: EventTarget | undefined;\n\ttranslationX: number;\n\ttranslationY: number;\n\tpageX: number;\n\tpageY: number;\n}\n\ninterface Touch {\n\tidentifier: number;\n\tscreenX: number;\n\tscreenY: number;\n\tclientX: number;\n\tclientY: number;\n\tpageX: number;\n\tpageY: number;\n\tradiusX: number;\n\tradiusY: number;\n\trotationAngle: number;\n\tforce: number;\n\ttarget: Element;\n}\n\ninterface TouchList {\n\t[i: number]: Touch;\n\tlength: number;\n\titem(index: number): Touch;\n\tidentifiedTouch(id: number): Touch;\n}\n\ninterface TouchEvent extends Event {\n\ttouches: TouchList;\n\ttargetTouches: TouchList;\n\tchangedTouches: TouchList;\n}\n\nexport class Gesture extends Disposable {\n\n\tprivate static readonly SCROLL_FRICTION = -0.005;\n\tprivate static INSTANCE: Gesture;\n\tprivate static HOLD_DELAY = 700;\n\n\tprivate dispatched: boolean;\n\tprivate targets: HTMLElement[];\n\tprivate handle: IDisposable | null;\n\n\tprivate activeTouches: { [id: number]: TouchData; };\n\n\tprivate constructor() {\n\t\tsuper();\n\n\t\tthis.activeTouches = {};\n\t\tthis.handle = null;\n\t\tthis.targets = [];\n\t\tthis._register(DomUtils.addDisposableListener(document, 'touchstart', (e: TouchEvent) => this.onTouchStart(e)));\n\t\tthis._register(DomUtils.addDisposableListener(document, 'touchend', (e: TouchEvent) => this.onTouchEnd(e)));\n\t\tthis._register(DomUtils.addDisposableListener(document, 'touchmove', (e: TouchEvent) => this.onTouchMove(e)));\n\t}\n\n\tpublic static addTarget(element: HTMLElement): void {\n\t\tif (!Gesture.isTouchDevice()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!Gesture.INSTANCE) {\n\t\t\tGesture.INSTANCE = new Gesture();\n\t\t}\n\n\t\tGesture.INSTANCE.targets.push(element);\n\t}\n\n\t@memoize\n\tprivate static isTouchDevice(): boolean {\n\t\treturn 'ontouchstart' in window as any || navigator.maxTouchPoints > 0 || window.navigator.msMaxTouchPoints > 0;\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this.handle) {\n\t\t\tthis.handle.dispose();\n\t\t\tthis.handle = null;\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n\n\tprivate onTouchStart(e: TouchEvent): void {\n\t\tlet timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\n\n\t\tif (this.handle) {\n\t\t\tthis.handle.dispose();\n\t\t\tthis.handle = null;\n\t\t}\n\n\t\tfor (let i = 0, len = e.targetTouches.length; i < len; i++) {\n\t\t\tlet touch = e.targetTouches.item(i);\n\n\t\t\tthis.activeTouches[touch.identifier] = {\n\t\t\t\tid: touch.identifier,\n\t\t\t\tinitialTarget: touch.target,\n\t\t\t\tinitialTimeStamp: timestamp,\n\t\t\t\tinitialPageX: touch.pageX,\n\t\t\t\tinitialPageY: touch.pageY,\n\t\t\t\trollingTimestamps: [timestamp],\n\t\t\t\trollingPageX: [touch.pageX],\n\t\t\t\trollingPageY: [touch.pageY]\n\t\t\t};\n\n\t\t\tlet evt = this.newGestureEvent(EventType.Start, touch.target);\n\t\t\tevt.pageX = touch.pageX;\n\t\t\tevt.pageY = touch.pageY;\n\t\t\tthis.dispatchEvent(evt);\n\t\t}\n\n\t\tif (this.dispatched) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatched = false;\n\t\t}\n\t}\n\n\tprivate onTouchEnd(e: TouchEvent): void {\n\t\tlet timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\n\n\t\tlet activeTouchCount = Object.keys(this.activeTouches).length;\n\n\t\tfor (let i = 0, len = e.changedTouches.length; i < len; i++) {\n\n\t\t\tlet touch = e.changedTouches.item(i);\n\n\t\t\tif (!this.activeTouches.hasOwnProperty(String(touch.identifier))) {\n\t\t\t\tconsole.warn('move of an UNKNOWN touch', touch);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet data = this.activeTouches[touch.identifier],\n\t\t\t\tholdTime = Date.now() - data.initialTimeStamp;\n\n\t\t\tif (holdTime < Gesture.HOLD_DELAY\n\t\t\t\t&& Math.abs(data.initialPageX - arrays.tail(data.rollingPageX)) < 30\n\t\t\t\t&& Math.abs(data.initialPageY - arrays.tail(data.rollingPageY)) < 30) {\n\n\t\t\t\tlet evt = this.newGestureEvent(EventType.Tap, data.initialTarget);\n\t\t\t\tevt.pageX = arrays.tail(data.rollingPageX);\n\t\t\t\tevt.pageY = arrays.tail(data.rollingPageY);\n\t\t\t\tthis.dispatchEvent(evt);\n\n\t\t\t} else if (holdTime >= Gesture.HOLD_DELAY\n\t\t\t\t&& Math.abs(data.initialPageX - arrays.tail(data.rollingPageX)) < 30\n\t\t\t\t&& Math.abs(data.initialPageY - arrays.tail(data.rollingPageY)) < 30) {\n\n\t\t\t\tlet evt = this.newGestureEvent(EventType.Contextmenu, data.initialTarget);\n\t\t\t\tevt.pageX = arrays.tail(data.rollingPageX);\n\t\t\t\tevt.pageY = arrays.tail(data.rollingPageY);\n\t\t\t\tthis.dispatchEvent(evt);\n\n\t\t\t} else if (activeTouchCount === 1) {\n\t\t\t\tlet finalX = arrays.tail(data.rollingPageX);\n\t\t\t\tlet finalY = arrays.tail(data.rollingPageY);\n\n\t\t\t\tlet deltaT = arrays.tail(data.rollingTimestamps) - data.rollingTimestamps[0];\n\t\t\t\tlet deltaX = finalX - data.rollingPageX[0];\n\t\t\t\tlet deltaY = finalY - data.rollingPageY[0];\n\n\t\t\t\t// We need to get all the dispatch targets on the start of the inertia event\n\t\t\t\tconst dispatchTo = this.targets.filter(t => data.initialTarget instanceof Node && t.contains(data.initialTarget));\n\t\t\t\tthis.inertia(dispatchTo, timestamp,\t\t// time now\n\t\t\t\t\tMath.abs(deltaX) / deltaT,\t// speed\n\t\t\t\t\tdeltaX > 0 ? 1 : -1,\t\t// x direction\n\t\t\t\t\tfinalX,\t\t\t\t\t\t// x now\n\t\t\t\t\tMath.abs(deltaY) / deltaT,  // y speed\n\t\t\t\t\tdeltaY > 0 ? 1 : -1,\t\t// y direction\n\t\t\t\t\tfinalY\t\t\t\t\t\t// y now\n\t\t\t\t);\n\t\t\t}\n\n\n\t\t\tthis.dispatchEvent(this.newGestureEvent(EventType.End, data.initialTarget));\n\t\t\t// forget about this touch\n\t\t\tdelete this.activeTouches[touch.identifier];\n\t\t}\n\n\t\tif (this.dispatched) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatched = false;\n\t\t}\n\t}\n\n\tprivate newGestureEvent(type: string, intialTarget?: EventTarget): GestureEvent {\n\t\tlet event = <GestureEvent>(<any>document.createEvent('CustomEvent'));\n\t\tevent.initEvent(type, false, true);\n\t\tevent.initialTarget = intialTarget;\n\t\treturn event;\n\t}\n\n\tprivate dispatchEvent(event: GestureEvent): void {\n\t\tthis.targets.forEach(target => {\n\t\t\tif (event.initialTarget instanceof Node && target.contains(event.initialTarget)) {\n\t\t\t\ttarget.dispatchEvent(event);\n\t\t\t\tthis.dispatched = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate inertia(dispatchTo: EventTarget[], t1: number, vX: number, dirX: number, x: number, vY: number, dirY: number, y: number): void {\n\t\tthis.handle = DomUtils.scheduleAtNextAnimationFrame(() => {\n\t\t\tlet now = Date.now();\n\n\t\t\t// velocity: old speed + accel_over_time\n\t\t\tlet deltaT = now - t1,\n\t\t\t\tdelta_pos_x = 0, delta_pos_y = 0,\n\t\t\t\tstopped = true;\n\n\t\t\tvX += Gesture.SCROLL_FRICTION * deltaT;\n\t\t\tvY += Gesture.SCROLL_FRICTION * deltaT;\n\n\t\t\tif (vX > 0) {\n\t\t\t\tstopped = false;\n\t\t\t\tdelta_pos_x = dirX * vX * deltaT;\n\t\t\t}\n\n\t\t\tif (vY > 0) {\n\t\t\t\tstopped = false;\n\t\t\t\tdelta_pos_y = dirY * vY * deltaT;\n\t\t\t}\n\n\t\t\t// dispatch translation event\n\t\t\tlet evt = this.newGestureEvent(EventType.Change);\n\t\t\tevt.translationX = delta_pos_x;\n\t\t\tevt.translationY = delta_pos_y;\n\t\t\tdispatchTo.forEach(d => d.dispatchEvent(evt));\n\n\t\t\tif (!stopped) {\n\t\t\t\tthis.inertia(dispatchTo, now, vX, dirX, x + delta_pos_x, vY, dirY, y + delta_pos_y);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate onTouchMove(e: TouchEvent): void {\n\t\tlet timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\n\n\t\tfor (let i = 0, len = e.changedTouches.length; i < len; i++) {\n\n\t\t\tlet touch = e.changedTouches.item(i);\n\n\t\t\tif (!this.activeTouches.hasOwnProperty(String(touch.identifier))) {\n\t\t\t\tconsole.warn('end of an UNKNOWN touch', touch);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet data = this.activeTouches[touch.identifier];\n\n\t\t\tlet evt = this.newGestureEvent(EventType.Change, data.initialTarget);\n\t\t\tevt.translationX = touch.pageX - arrays.tail(data.rollingPageX);\n\t\t\tevt.translationY = touch.pageY - arrays.tail(data.rollingPageY);\n\t\t\tevt.pageX = touch.pageX;\n\t\t\tevt.pageY = touch.pageY;\n\t\t\tthis.dispatchEvent(evt);\n\n\t\t\t// only keep a few data points, to average the final speed\n\t\t\tif (data.rollingPageX.length > 3) {\n\t\t\t\tdata.rollingPageX.shift();\n\t\t\t\tdata.rollingPageY.shift();\n\t\t\t\tdata.rollingTimestamps.shift();\n\t\t\t}\n\n\t\t\tdata.rollingPageX.push(touch.pageX);\n\t\t\tdata.rollingPageY.push(touch.pageY);\n\t\t\tdata.rollingTimestamps.push(timestamp);\n\t\t}\n\n\t\tif (this.dispatched) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatched = false;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isWindows, isMacintosh, setImmediate } from 'vs/base/common/platform';\n\ninterface IProcess {\n\tplatform: string;\n\tenv: object;\n\n\tcwd(): string;\n\tnextTick(callback: (...args: any[]) => void): number;\n}\n\ndeclare const process: IProcess;\nconst safeProcess: IProcess = (typeof process === 'undefined') ? {\n\tcwd(): string { return '/'; },\n\tenv: Object.create(null),\n\tget platform(): string { return isWindows ? 'win32' : isMacintosh ? 'darwin' : 'linux'; },\n\tnextTick(callback: (...args: any[]) => void): number { return setImmediate(callback); }\n} : process;\n\nexport const cwd = safeProcess.cwd;\nexport const env = safeProcess.env;\nexport const platform = safeProcess.platform;\nexport const nextTick = safeProcess.nextTick;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// NOTE: VSCode's copy of nodejs path library to be usable in common (non-node) namespace\n// Copied from: https://github.com/nodejs/node/tree/43dd49c9782848c25e5b03448c8a0f923f13c158\n\n/**\n * Copyright Joyent, Inc. and other Node contributors.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to permit\n * persons to whom the Software is furnished to do so, subject to the\n * following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n * NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n * USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport * as process from 'vs/base/common/process';\n\nconst CHAR_UPPERCASE_A = 65;/* A */\nconst CHAR_LOWERCASE_A = 97; /* a */\nconst CHAR_UPPERCASE_Z = 90; /* Z */\nconst CHAR_LOWERCASE_Z = 122; /* z */\nconst CHAR_DOT = 46; /* . */\nconst CHAR_FORWARD_SLASH = 47; /* / */\nconst CHAR_BACKWARD_SLASH = 92; /* \\ */\nconst CHAR_COLON = 58; /* : */\nconst CHAR_QUESTION_MARK = 63; /* ? */\n\nclass ErrorInvalidArgType extends Error {\n\tcode: 'ERR_INVALID_ARG_TYPE';\n\tconstructor(name: string, expected: string, actual: string) {\n\t\t// determiner: 'must be' or 'must not be'\n\t\tlet determiner;\n\t\tif (typeof expected === 'string' && expected.indexOf('not ') === 0) {\n\t\t\tdeterminer = 'must not be';\n\t\t\texpected = expected.replace(/^not /, '');\n\t\t} else {\n\t\t\tdeterminer = 'must be';\n\t\t}\n\n\t\tlet msg;\n\t\tconst type = name.indexOf('.') !== -1 ? 'property' : 'argument';\n\t\tmsg = `The \"${name}\" ${type} ${determiner} of type ${expected}`;\n\n\t\tmsg += `. Received type ${typeof actual}`;\n\t\tsuper(msg);\n\t}\n}\n\nfunction validateString(value: string, name) {\n\tif (typeof value !== 'string') {\n\t\tthrow new ErrorInvalidArgType(name, 'string', value);\n\t}\n}\n\nfunction isPathSeparator(code) {\n\treturn code === CHAR_FORWARD_SLASH || code === CHAR_BACKWARD_SLASH;\n}\n\nfunction isPosixPathSeparator(code) {\n\treturn code === CHAR_FORWARD_SLASH;\n}\n\nfunction isWindowsDeviceRoot(code) {\n\treturn code >= CHAR_UPPERCASE_A && code <= CHAR_UPPERCASE_Z ||\n\t\tcode >= CHAR_LOWERCASE_A && code <= CHAR_LOWERCASE_Z;\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeString(path, allowAboveRoot, separator, isPathSeparator) {\n\tlet res = '';\n\tlet lastSegmentLength = 0;\n\tlet lastSlash = -1;\n\tlet dots = 0;\n\tlet code;\n\tfor (let i = 0; i <= path.length; ++i) {\n\t\tif (i < path.length) {\n\t\t\tcode = path.charCodeAt(i);\n\t\t}\n\t\telse if (isPathSeparator(code)) {\n\t\t\tbreak;\n\t\t}\n\t\telse {\n\t\t\tcode = CHAR_FORWARD_SLASH;\n\t\t}\n\n\t\tif (isPathSeparator(code)) {\n\t\t\tif (lastSlash === i - 1 || dots === 1) {\n\t\t\t\t// NOOP\n\t\t\t} else if (lastSlash !== i - 1 && dots === 2) {\n\t\t\t\tif (res.length < 2 || lastSegmentLength !== 2 ||\n\t\t\t\t\tres.charCodeAt(res.length - 1) !== CHAR_DOT ||\n\t\t\t\t\tres.charCodeAt(res.length - 2) !== CHAR_DOT) {\n\t\t\t\t\tif (res.length > 2) {\n\t\t\t\t\t\tconst lastSlashIndex = res.lastIndexOf(separator);\n\t\t\t\t\t\tif (lastSlashIndex === -1) {\n\t\t\t\t\t\t\tres = '';\n\t\t\t\t\t\t\tlastSegmentLength = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tres = res.slice(0, lastSlashIndex);\n\t\t\t\t\t\t\tlastSegmentLength = res.length - 1 - res.lastIndexOf(separator);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlastSlash = i;\n\t\t\t\t\t\tdots = 0;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if (res.length === 2 || res.length === 1) {\n\t\t\t\t\t\tres = '';\n\t\t\t\t\t\tlastSegmentLength = 0;\n\t\t\t\t\t\tlastSlash = i;\n\t\t\t\t\t\tdots = 0;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (allowAboveRoot) {\n\t\t\t\t\tif (res.length > 0) {\n\t\t\t\t\t\tres += `${separator}..`;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tres = '..';\n\t\t\t\t\t}\n\t\t\t\t\tlastSegmentLength = 2;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (res.length > 0) {\n\t\t\t\t\tres += separator + path.slice(lastSlash + 1, i);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tres = path.slice(lastSlash + 1, i);\n\t\t\t\t}\n\t\t\t\tlastSegmentLength = i - lastSlash - 1;\n\t\t\t}\n\t\t\tlastSlash = i;\n\t\t\tdots = 0;\n\t\t} else if (code === CHAR_DOT && dots !== -1) {\n\t\t\t++dots;\n\t\t} else {\n\t\t\tdots = -1;\n\t\t}\n\t}\n\treturn res;\n}\n\nfunction _format(sep, pathObject) {\n\tconst dir = pathObject.dir || pathObject.root;\n\tconst base = pathObject.base ||\n\t\t((pathObject.name || '') + (pathObject.ext || ''));\n\tif (!dir) {\n\t\treturn base;\n\t}\n\tif (dir === pathObject.root) {\n\t\treturn dir + base;\n\t}\n\treturn dir + sep + base;\n}\n\ninterface ParsedPath {\n\troot: string;\n\tdir: string;\n\tbase: string;\n\text: string;\n\tname: string;\n}\n\ninterface IPath {\n\tnormalize(path: string): string;\n\tisAbsolute(path: string): boolean;\n\tjoin(...paths: string[]): string;\n\tresolve(...pathSegments: string[]): string;\n\trelative(from: string, to: string): string;\n\tdirname(path: string): string;\n\tbasename(path: string, ext?: string): string;\n\textname(path: string): string;\n\tformat(pathObject): string;\n\tparse(path: string): ParsedPath;\n\ttoNamespacedPath(path: string): string;\n\tsep: '\\\\' | '/';\n\tdelimiter: string;\n\twin32: IPath | null;\n\tposix: IPath | null;\n}\n\nexport const win32: IPath = {\n\t// path.resolve([from ...], to)\n\tresolve(...pathSegments: string[]): string {\n\t\tlet resolvedDevice = '';\n\t\tlet resolvedTail = '';\n\t\tlet resolvedAbsolute = false;\n\n\t\tfor (let i = pathSegments.length - 1; i >= -1; i--) {\n\t\t\tlet path;\n\t\t\tif (i >= 0) {\n\t\t\t\tpath = pathSegments[i];\n\t\t\t} else if (!resolvedDevice) {\n\t\t\t\tpath = process.cwd();\n\t\t\t} else {\n\t\t\t\t// Windows has the concept of drive-specific current working\n\t\t\t\t// directories. If we've resolved a drive letter but not yet an\n\t\t\t\t// absolute path, get cwd for that drive, or the process cwd if\n\t\t\t\t// the drive cwd is not available. We're sure the device is not\n\t\t\t\t// a UNC path at this points, because UNC paths are always absolute.\n\t\t\t\tpath = process.env['=' + resolvedDevice] || process.cwd();\n\n\t\t\t\t// Verify that a cwd was found and that it actually points\n\t\t\t\t// to our drive. If not, default to the drive's root.\n\t\t\t\tif (path === undefined ||\n\t\t\t\t\tpath.slice(0, 3).toLowerCase() !==\n\t\t\t\t\tresolvedDevice.toLowerCase() + '\\\\') {\n\t\t\t\t\tpath = resolvedDevice + '\\\\';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvalidateString(path, 'path');\n\n\t\t\t// Skip empty entries\n\t\t\tif (path.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst len = path.length;\n\t\t\tlet rootEnd = 0;\n\t\t\tlet device = '';\n\t\t\tlet isAbsolute = false;\n\t\t\tconst code = path.charCodeAt(0);\n\n\t\t\t// Try to match a root\n\t\t\tif (len > 1) {\n\t\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t\t// Possible UNC root\n\n\t\t\t\t\t// If we started with a separator, we know we at least have an\n\t\t\t\t\t// absolute path of some kind (UNC or otherwise)\n\t\t\t\t\tisAbsolute = true;\n\n\t\t\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t\t\t\t// Matched double path separator at beginning\n\t\t\t\t\t\tlet j = 2;\n\t\t\t\t\t\tlet last = j;\n\t\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t\tconst firstPart = path.slice(last, j);\n\t\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t\t// Match 1 or more path separators\n\t\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\t\tif (!isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (j === len) {\n\t\t\t\t\t\t\t\t\t// We matched a UNC root only\n\n\t\t\t\t\t\t\t\t\tdevice = '\\\\\\\\' + firstPart + '\\\\' + path.slice(last);\n\t\t\t\t\t\t\t\t\trootEnd = j;\n\t\t\t\t\t\t\t\t} else if (j !== last) {\n\t\t\t\t\t\t\t\t\t// We matched a UNC root with leftovers\n\n\t\t\t\t\t\t\t\t\tdevice = '\\\\\\\\' + firstPart + '\\\\' + path.slice(last, j);\n\t\t\t\t\t\t\t\t\trootEnd = j;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trootEnd = 1;\n\t\t\t\t\t}\n\t\t\t\t} else if (isWindowsDeviceRoot(code)) {\n\t\t\t\t\t// Possible device root\n\n\t\t\t\t\tif (path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\t\t\tdevice = path.slice(0, 2);\n\t\t\t\t\t\trootEnd = 2;\n\t\t\t\t\t\tif (len > 2) {\n\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t\t\t\t\t// Treat separator following drive name as an absolute path\n\t\t\t\t\t\t\t\t// indicator\n\t\t\t\t\t\t\t\tisAbsolute = true;\n\t\t\t\t\t\t\t\trootEnd = 3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (isPathSeparator(code)) {\n\t\t\t\t// `path` contains just a path separator\n\t\t\t\trootEnd = 1;\n\t\t\t\tisAbsolute = true;\n\t\t\t}\n\n\t\t\tif (device.length > 0 &&\n\t\t\t\tresolvedDevice.length > 0 &&\n\t\t\t\tdevice.toLowerCase() !== resolvedDevice.toLowerCase()) {\n\t\t\t\t// This path points to another device so it is not applicable\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (resolvedDevice.length === 0 && device.length > 0) {\n\t\t\t\tresolvedDevice = device;\n\t\t\t}\n\t\t\tif (!resolvedAbsolute) {\n\t\t\t\tresolvedTail = path.slice(rootEnd) + '\\\\' + resolvedTail;\n\t\t\t\tresolvedAbsolute = isAbsolute;\n\t\t\t}\n\n\t\t\tif (resolvedDevice.length > 0 && resolvedAbsolute) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// At this point the path should be resolved to a full absolute path,\n\t\t// but handle relative paths to be safe (might happen when process.cwd()\n\t\t// fails)\n\n\t\t// Normalize the tail path\n\t\tresolvedTail = normalizeString(resolvedTail, !resolvedAbsolute, '\\\\',\n\t\t\tisPathSeparator);\n\n\t\treturn (resolvedDevice + (resolvedAbsolute ? '\\\\' : '') + resolvedTail) ||\n\t\t\t'.';\n\t},\n\n\tnormalize(path: string): string {\n\t\tvalidateString(path, 'path');\n\t\tconst len = path.length;\n\t\tif (len === 0) {\n\t\t\treturn '.';\n\t\t}\n\t\tlet rootEnd = 0;\n\t\tlet device;\n\t\tlet isAbsolute = false;\n\t\tconst code = path.charCodeAt(0);\n\n\t\t// Try to match a root\n\t\tif (len > 1) {\n\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t// Possible UNC root\n\n\t\t\t\t// If we started with a separator, we know we at least have an absolute\n\t\t\t\t// path of some kind (UNC or otherwise)\n\t\t\t\tisAbsolute = true;\n\n\t\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t\t\t// Matched double path separator at beginning\n\t\t\t\t\tlet j = 2;\n\t\t\t\t\tlet last = j;\n\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\tconst firstPart = path.slice(last, j);\n\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t// Match 1 or more path separators\n\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\tif (!isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j === len) {\n\t\t\t\t\t\t\t\t// We matched a UNC root only\n\t\t\t\t\t\t\t\t// Return the normalized version of the UNC root since there\n\t\t\t\t\t\t\t\t// is nothing left to process\n\n\t\t\t\t\t\t\t\treturn '\\\\\\\\' + firstPart + '\\\\' + path.slice(last) + '\\\\';\n\t\t\t\t\t\t\t} else if (j !== last) {\n\t\t\t\t\t\t\t\t// We matched a UNC root with leftovers\n\n\t\t\t\t\t\t\t\tdevice = '\\\\\\\\' + firstPart + '\\\\' + path.slice(last, j);\n\t\t\t\t\t\t\t\trootEnd = j;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trootEnd = 1;\n\t\t\t\t}\n\t\t\t} else if (isWindowsDeviceRoot(code)) {\n\t\t\t\t// Possible device root\n\n\t\t\t\tif (path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\t\tdevice = path.slice(0, 2);\n\t\t\t\t\trootEnd = 2;\n\t\t\t\t\tif (len > 2) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t\t\t\t// Treat separator following drive name as an absolute path\n\t\t\t\t\t\t\t// indicator\n\t\t\t\t\t\t\tisAbsolute = true;\n\t\t\t\t\t\t\trootEnd = 3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (isPathSeparator(code)) {\n\t\t\t// `path` contains just a path separator, exit early to avoid unnecessary\n\t\t\t// work\n\t\t\treturn '\\\\';\n\t\t}\n\n\t\tlet tail;\n\t\tif (rootEnd < len) {\n\t\t\ttail = normalizeString(path.slice(rootEnd), !isAbsolute, '\\\\',\n\t\t\t\tisPathSeparator);\n\t\t} else {\n\t\t\ttail = '';\n\t\t}\n\t\tif (tail.length === 0 && !isAbsolute) {\n\t\t\ttail = '.';\n\t\t}\n\t\tif (tail.length > 0 && isPathSeparator(path.charCodeAt(len - 1))) {\n\t\t\ttail += '\\\\';\n\t\t}\n\t\tif (device === undefined) {\n\t\t\tif (isAbsolute) {\n\t\t\t\tif (tail.length > 0) {\n\t\t\t\t\treturn '\\\\' + tail;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn '\\\\';\n\t\t\t\t}\n\t\t\t} else if (tail.length > 0) {\n\t\t\t\treturn tail;\n\t\t\t} else {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t} else if (isAbsolute) {\n\t\t\tif (tail.length > 0) {\n\t\t\t\treturn device + '\\\\' + tail;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn device + '\\\\';\n\t\t\t}\n\t\t} else if (tail.length > 0) {\n\t\t\treturn device + tail;\n\t\t} else {\n\t\t\treturn device;\n\t\t}\n\t},\n\n\tisAbsolute(path: string): boolean {\n\t\tvalidateString(path, 'path');\n\t\tconst len = path.length;\n\t\tif (len === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst code = path.charCodeAt(0);\n\t\tif (isPathSeparator(code)) {\n\t\t\treturn true;\n\t\t} else if (isWindowsDeviceRoot(code)) {\n\t\t\t// Possible device root\n\n\t\t\tif (len > 2 && path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tjoin(...paths: string[]): string {\n\t\tif (paths.length === 0) {\n\t\t\treturn '.';\n\t\t}\n\n\t\tlet joined;\n\t\tlet firstPart;\n\t\tfor (let i = 0; i < paths.length; ++i) {\n\t\t\tconst arg = paths[i];\n\t\t\tvalidateString(arg, 'path');\n\t\t\tif (arg.length > 0) {\n\t\t\t\tif (joined === undefined) {\n\t\t\t\t\tjoined = firstPart = arg;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjoined += '\\\\' + arg;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (joined === undefined) {\n\t\t\treturn '.';\n\t\t}\n\n\t\t// Make sure that the joined path doesn't start with two slashes, because\n\t\t// normalize() will mistake it for an UNC path then.\n\t\t//\n\t\t// This step is skipped when it is very clear that the user actually\n\t\t// intended to point at an UNC path. This is assumed when the first\n\t\t// non-empty string arguments starts with exactly two slashes followed by\n\t\t// at least one more non-slash character.\n\t\t//\n\t\t// Note that for normalize() to treat a path as an UNC path it needs to\n\t\t// have at least 2 components, so we don't filter for that here.\n\t\t// This means that the user can use join to construct UNC paths from\n\t\t// a server name and a share name; for example:\n\t\t//   path.join('//server', 'share') -> '\\\\\\\\server\\\\share\\\\')\n\t\tlet needsReplace = true;\n\t\tlet slashCount = 0;\n\t\tif (isPathSeparator(firstPart.charCodeAt(0))) {\n\t\t\t++slashCount;\n\t\t\tconst firstLen = firstPart.length;\n\t\t\tif (firstLen > 1) {\n\t\t\t\tif (isPathSeparator(firstPart.charCodeAt(1))) {\n\t\t\t\t\t++slashCount;\n\t\t\t\t\tif (firstLen > 2) {\n\t\t\t\t\t\tif (isPathSeparator(firstPart.charCodeAt(2))) {\n\t\t\t\t\t\t\t++slashCount;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// We matched a UNC path in the first part\n\t\t\t\t\t\t\tneedsReplace = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (needsReplace) {\n\t\t\t// Find any more consecutive slashes we need to replace\n\t\t\tfor (; slashCount < joined.length; ++slashCount) {\n\t\t\t\tif (!isPathSeparator(joined.charCodeAt(slashCount))) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Replace the slashes if needed\n\t\t\tif (slashCount >= 2) {\n\t\t\t\tjoined = '\\\\' + joined.slice(slashCount);\n\t\t\t}\n\t\t}\n\n\t\treturn win32.normalize(joined);\n\t},\n\n\n\t// It will solve the relative path from `from` to `to`, for instance:\n\t//  from = 'C:\\\\orandea\\\\test\\\\aaa'\n\t//  to = 'C:\\\\orandea\\\\impl\\\\bbb'\n\t// The output of the function should be: '..\\\\..\\\\impl\\\\bbb'\n\trelative(from: string, to: string): string {\n\t\tvalidateString(from, 'from');\n\t\tvalidateString(to, 'to');\n\n\t\tif (from === to) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst fromOrig = win32.resolve(from);\n\t\tconst toOrig = win32.resolve(to);\n\n\t\tif (fromOrig === toOrig) {\n\t\t\treturn '';\n\t\t}\n\n\t\tfrom = fromOrig.toLowerCase();\n\t\tto = toOrig.toLowerCase();\n\n\t\tif (from === to) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// Trim any leading backslashes\n\t\tlet fromStart = 0;\n\t\tfor (; fromStart < from.length; ++fromStart) {\n\t\t\tif (from.charCodeAt(fromStart) !== CHAR_BACKWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// Trim trailing backslashes (applicable to UNC paths only)\n\t\tlet fromEnd = from.length;\n\t\tfor (; fromEnd - 1 > fromStart; --fromEnd) {\n\t\t\tif (from.charCodeAt(fromEnd - 1) !== CHAR_BACKWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst fromLen = (fromEnd - fromStart);\n\n\t\t// Trim any leading backslashes\n\t\tlet toStart = 0;\n\t\tfor (; toStart < to.length; ++toStart) {\n\t\t\tif (to.charCodeAt(toStart) !== CHAR_BACKWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// Trim trailing backslashes (applicable to UNC paths only)\n\t\tlet toEnd = to.length;\n\t\tfor (; toEnd - 1 > toStart; --toEnd) {\n\t\t\tif (to.charCodeAt(toEnd - 1) !== CHAR_BACKWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst toLen = (toEnd - toStart);\n\n\t\t// Compare paths to find the longest common path from root\n\t\tconst length = (fromLen < toLen ? fromLen : toLen);\n\t\tlet lastCommonSep = -1;\n\t\tlet i = 0;\n\t\tfor (; i <= length; ++i) {\n\t\t\tif (i === length) {\n\t\t\t\tif (toLen > length) {\n\t\t\t\t\tif (to.charCodeAt(toStart + i) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t\t\t// We get here if `from` is the exact base path for `to`.\n\t\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\foo\\\\bar\\\\baz'\n\t\t\t\t\t\treturn toOrig.slice(toStart + i + 1);\n\t\t\t\t\t} else if (i === 2) {\n\t\t\t\t\t\t// We get here if `from` is the device root.\n\t\t\t\t\t\t// For example: from='C:\\\\'; to='C:\\\\foo'\n\t\t\t\t\t\treturn toOrig.slice(toStart + i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (fromLen > length) {\n\t\t\t\t\tif (from.charCodeAt(fromStart + i) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t\t\t// We get here if `to` is the exact base path for `from`.\n\t\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\foo'\n\t\t\t\t\t\tlastCommonSep = i;\n\t\t\t\t\t} else if (i === 2) {\n\t\t\t\t\t\t// We get here if `to` is the device root.\n\t\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\'\n\t\t\t\t\t\tlastCommonSep = 3;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst fromCode = from.charCodeAt(fromStart + i);\n\t\t\tconst toCode = to.charCodeAt(toStart + i);\n\t\t\tif (fromCode !== toCode) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (fromCode === CHAR_BACKWARD_SLASH) {\n\t\t\t\tlastCommonSep = i;\n\t\t\t}\n\t\t}\n\n\t\t// We found a mismatch before the first common path separator was seen, so\n\t\t// return the original `to`.\n\t\tif (i !== length && lastCommonSep === -1) {\n\t\t\treturn toOrig;\n\t\t}\n\n\t\tlet out = '';\n\t\tif (lastCommonSep === -1) {\n\t\t\tlastCommonSep = 0;\n\t\t}\n\t\t// Generate the relative path based on the path difference between `to` and\n\t\t// `from`\n\t\tfor (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n\t\t\tif (i === fromEnd || from.charCodeAt(i) === CHAR_BACKWARD_SLASH) {\n\t\t\t\tif (out.length === 0) {\n\t\t\t\t\tout += '..';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tout += '\\\\..';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Lastly, append the rest of the destination (`to`) path that comes after\n\t\t// the common path parts\n\t\tif (out.length > 0) {\n\t\t\treturn out + toOrig.slice(toStart + lastCommonSep, toEnd);\n\t\t}\n\t\telse {\n\t\t\ttoStart += lastCommonSep;\n\t\t\tif (toOrig.charCodeAt(toStart) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t++toStart;\n\t\t\t}\n\t\t\treturn toOrig.slice(toStart, toEnd);\n\t\t}\n\t},\n\n\ttoNamespacedPath(path: string): string {\n\t\t// Note: this will *probably* throw somewhere.\n\t\tif (typeof path !== 'string') {\n\t\t\treturn path;\n\t\t}\n\n\t\tif (path.length === 0) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst resolvedPath = win32.resolve(path);\n\n\t\tif (resolvedPath.length >= 3) {\n\t\t\tif (resolvedPath.charCodeAt(0) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t// Possible UNC root\n\n\t\t\t\tif (resolvedPath.charCodeAt(1) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t\tconst code = resolvedPath.charCodeAt(2);\n\t\t\t\t\tif (code !== CHAR_QUESTION_MARK && code !== CHAR_DOT) {\n\t\t\t\t\t\t// Matched non-long UNC root, convert the path to a long UNC path\n\t\t\t\t\t\treturn '\\\\\\\\?\\\\UNC\\\\' + resolvedPath.slice(2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (isWindowsDeviceRoot(resolvedPath.charCodeAt(0))) {\n\t\t\t\t// Possible device root\n\n\t\t\t\tif (resolvedPath.charCodeAt(1) === CHAR_COLON &&\n\t\t\t\t\tresolvedPath.charCodeAt(2) === CHAR_BACKWARD_SLASH) {\n\t\t\t\t\t// Matched device root, convert the path to a long UNC path\n\t\t\t\t\treturn '\\\\\\\\?\\\\' + resolvedPath;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn path;\n\t},\n\n\tdirname(path: string): string {\n\t\tvalidateString(path, 'path');\n\t\tconst len = path.length;\n\t\tif (len === 0) {\n\t\t\treturn '.';\n\t\t}\n\t\tlet rootEnd = -1;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tlet offset = 0;\n\t\tconst code = path.charCodeAt(0);\n\n\t\t// Try to match a root\n\t\tif (len > 1) {\n\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t// Possible UNC root\n\n\t\t\t\trootEnd = offset = 1;\n\n\t\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t\t\t// Matched double path separator at beginning\n\t\t\t\t\tlet j = 2;\n\t\t\t\t\tlet last = j;\n\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t// Match 1 or more path separators\n\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\tif (!isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j === len) {\n\t\t\t\t\t\t\t\t// We matched a UNC root only\n\t\t\t\t\t\t\t\treturn path;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j !== last) {\n\t\t\t\t\t\t\t\t// We matched a UNC root with leftovers\n\n\t\t\t\t\t\t\t\t// Offset by 1 to include the separator after the UNC root to\n\t\t\t\t\t\t\t\t// treat it as a \"normal root\" on top of a (UNC) root\n\t\t\t\t\t\t\t\trootEnd = offset = j + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (isWindowsDeviceRoot(code)) {\n\t\t\t\t// Possible device root\n\n\t\t\t\tif (path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\t\trootEnd = offset = 2;\n\t\t\t\t\tif (len > 2) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t\t\t\trootEnd = offset = 3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (isPathSeparator(code)) {\n\t\t\t// `path` contains just a path separator, exit early to avoid\n\t\t\t// unnecessary work\n\t\t\treturn path;\n\t\t}\n\n\t\tfor (let i = len - 1; i >= offset; --i) {\n\t\t\tif (isPathSeparator(path.charCodeAt(i))) {\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tend = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We saw the first non-path separator\n\t\t\t\tmatchedSlash = false;\n\t\t\t}\n\t\t}\n\n\t\tif (end === -1) {\n\t\t\tif (rootEnd === -1) {\n\t\t\t\treturn '.';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tend = rootEnd;\n\t\t\t}\n\t\t}\n\t\treturn path.slice(0, end);\n\t},\n\n\tbasename(path: string, ext?: string): string {\n\t\tif (ext !== undefined) {\n\t\t\tvalidateString(ext, 'ext');\n\t\t}\n\t\tvalidateString(path, 'path');\n\t\tlet start = 0;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tlet i;\n\n\t\t// Check for a drive letter prefix so as not to mistake the following\n\t\t// path separator as an extra separator at the end of the path that can be\n\t\t// disregarded\n\t\tif (path.length >= 2) {\n\t\t\tconst drive = path.charCodeAt(0);\n\t\t\tif (isWindowsDeviceRoot(drive)) {\n\t\t\t\tif (path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\t\tstart = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n\t\t\tif (ext.length === path.length && ext === path) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tlet extIdx = ext.length - 1;\n\t\t\tlet firstNonSlashEnd = -1;\n\t\t\tfor (i = path.length - 1; i >= start; --i) {\n\t\t\t\tconst code = path.charCodeAt(i);\n\t\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\t\tstart = i + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (firstNonSlashEnd === -1) {\n\t\t\t\t\t\t// We saw the first non-path separator, remember this index in case\n\t\t\t\t\t\t// we need it if the extension ends up not matching\n\t\t\t\t\t\tmatchedSlash = false;\n\t\t\t\t\t\tfirstNonSlashEnd = i + 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (extIdx >= 0) {\n\t\t\t\t\t\t// Try to match the explicit extension\n\t\t\t\t\t\tif (code === ext.charCodeAt(extIdx)) {\n\t\t\t\t\t\t\tif (--extIdx === -1) {\n\t\t\t\t\t\t\t\t// We matched the extension, so mark this as the end of our path\n\t\t\t\t\t\t\t\t// component\n\t\t\t\t\t\t\t\tend = i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Extension does not match, so our result is the entire path\n\t\t\t\t\t\t\t// component\n\t\t\t\t\t\t\textIdx = -1;\n\t\t\t\t\t\t\tend = firstNonSlashEnd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (start === end) {\n\t\t\t\tend = firstNonSlashEnd;\n\t\t\t}\n\t\t\telse if (end === -1) {\n\t\t\t\tend = path.length;\n\t\t\t}\n\t\t\treturn path.slice(start, end);\n\t\t} else {\n\t\t\tfor (i = path.length - 1; i >= start; --i) {\n\t\t\t\tif (isPathSeparator(path.charCodeAt(i))) {\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\t\tstart = i + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (end === -1) {\n\t\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t\t// path component\n\t\t\t\t\tmatchedSlash = false;\n\t\t\t\t\tend = i + 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (end === -1) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn path.slice(start, end);\n\t\t}\n\t},\n\n\textname(path: string): string {\n\t\tvalidateString(path, 'path');\n\t\tlet start = 0;\n\t\tlet startDot = -1;\n\t\tlet startPart = 0;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\t// Track the state of characters (if any) we see before our first dot and\n\t\t// after any path separator we find\n\t\tlet preDotState = 0;\n\n\t\t// Check for a drive letter prefix so as not to mistake the following\n\t\t// path separator as an extra separator at the end of the path that can be\n\t\t// disregarded\n\n\t\tif (path.length >= 2 &&\n\t\t\tpath.charCodeAt(1) === CHAR_COLON &&\n\t\t\tisWindowsDeviceRoot(path.charCodeAt(0))) {\n\t\t\tstart = startPart = 2;\n\t\t}\n\n\t\tfor (let i = path.length - 1; i >= start; --i) {\n\t\t\tconst code = path.charCodeAt(i);\n\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tstartPart = i + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (end === -1) {\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t// extension\n\t\t\t\tmatchedSlash = false;\n\t\t\t\tend = i + 1;\n\t\t\t}\n\t\t\tif (code === CHAR_DOT) {\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\n\t\t\t\tif (startDot === -1) {\n\t\t\t\t\tstartDot = i;\n\t\t\t\t}\n\t\t\t\telse if (preDotState !== 1) {\n\t\t\t\t\tpreDotState = 1;\n\t\t\t\t}\n\t\t\t} else if (startDot !== -1) {\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\n\t\t\t\t// have a good chance at having a non-empty extension\n\t\t\t\tpreDotState = -1;\n\t\t\t}\n\t\t}\n\n\t\tif (startDot === -1 ||\n\t\t\tend === -1 ||\n\t\t\t// We saw a non-dot character immediately before the dot\n\t\t\tpreDotState === 0 ||\n\t\t\t// The (right-most) trimmed path component is exactly '..'\n\t\t\t(preDotState === 1 &&\n\t\t\t\tstartDot === end - 1 &&\n\t\t\t\tstartDot === startPart + 1)) {\n\t\t\treturn '';\n\t\t}\n\t\treturn path.slice(startDot, end);\n\t},\n\n\tformat(pathObject): string {\n\t\tif (pathObject === null || typeof pathObject !== 'object') {\n\t\t\tthrow new ErrorInvalidArgType('pathObject', 'Object', pathObject);\n\t\t}\n\n\t\treturn _format('\\\\', pathObject);\n\t},\n\n\n\tparse(path) {\n\t\tvalidateString(path, 'path');\n\n\t\tconst ret = { root: '', dir: '', base: '', ext: '', name: '' };\n\t\tif (path.length === 0) {\n\t\t\treturn ret;\n\t\t}\n\n\t\tconst len = path.length;\n\t\tlet rootEnd = 0;\n\t\tlet code = path.charCodeAt(0);\n\n\t\t// Try to match a root\n\t\tif (len > 1) {\n\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t// Possible UNC root\n\n\t\t\t\trootEnd = 1;\n\t\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t\t\t// Matched double path separator at beginning\n\t\t\t\t\tlet j = 2;\n\t\t\t\t\tlet last = j;\n\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t// Match 1 or more path separators\n\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\tif (!isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j < len && j !== last) {\n\t\t\t\t\t\t\t// Matched!\n\t\t\t\t\t\t\tlast = j;\n\t\t\t\t\t\t\t// Match 1 or more non-path separators\n\t\t\t\t\t\t\tfor (; j < len; ++j) {\n\t\t\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(j))) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j === len) {\n\t\t\t\t\t\t\t\t// We matched a UNC root only\n\n\t\t\t\t\t\t\t\trootEnd = j;\n\t\t\t\t\t\t\t} else if (j !== last) {\n\t\t\t\t\t\t\t\t// We matched a UNC root with leftovers\n\n\t\t\t\t\t\t\t\trootEnd = j + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (isWindowsDeviceRoot(code)) {\n\t\t\t\t// Possible device root\n\n\t\t\t\tif (path.charCodeAt(1) === CHAR_COLON) {\n\t\t\t\t\trootEnd = 2;\n\t\t\t\t\tif (len > 2) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t\t\t\tif (len === 3) {\n\t\t\t\t\t\t\t\t// `path` contains just a drive root, exit early to avoid\n\t\t\t\t\t\t\t\t// unnecessary work\n\t\t\t\t\t\t\t\tret.root = ret.dir = path;\n\t\t\t\t\t\t\t\treturn ret;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trootEnd = 3;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// `path` contains just a drive root, exit early to avoid\n\t\t\t\t\t\t// unnecessary work\n\t\t\t\t\t\tret.root = ret.dir = path;\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (isPathSeparator(code)) {\n\t\t\t// `path` contains just a path separator, exit early to avoid\n\t\t\t// unnecessary work\n\t\t\tret.root = ret.dir = path;\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (rootEnd > 0) {\n\t\t\tret.root = path.slice(0, rootEnd);\n\t\t}\n\n\t\tlet startDot = -1;\n\t\tlet startPart = rootEnd;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tlet i = path.length - 1;\n\n\t\t// Track the state of characters (if any) we see before our first dot and\n\t\t// after any path separator we find\n\t\tlet preDotState = 0;\n\n\t\t// Get non-dir info\n\t\tfor (; i >= rootEnd; --i) {\n\t\t\tcode = path.charCodeAt(i);\n\t\t\tif (isPathSeparator(code)) {\n\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tstartPart = i + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (end === -1) {\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t// extension\n\t\t\t\tmatchedSlash = false;\n\t\t\t\tend = i + 1;\n\t\t\t}\n\t\t\tif (code === CHAR_DOT) {\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\n\t\t\t\tif (startDot === -1) {\n\t\t\t\t\tstartDot = i;\n\t\t\t\t}\n\t\t\t\telse if (preDotState !== 1) {\n\t\t\t\t\tpreDotState = 1;\n\t\t\t\t}\n\t\t\t} else if (startDot !== -1) {\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\n\t\t\t\t// have a good chance at having a non-empty extension\n\t\t\t\tpreDotState = -1;\n\t\t\t}\n\t\t}\n\n\t\tif (startDot === -1 ||\n\t\t\tend === -1 ||\n\t\t\t// We saw a non-dot character immediately before the dot\n\t\t\tpreDotState === 0 ||\n\t\t\t// The (right-most) trimmed path component is exactly '..'\n\t\t\t(preDotState === 1 &&\n\t\t\t\tstartDot === end - 1 &&\n\t\t\t\tstartDot === startPart + 1)) {\n\t\t\tif (end !== -1) {\n\t\t\t\tret.base = ret.name = path.slice(startPart, end);\n\t\t\t}\n\t\t} else {\n\t\t\tret.name = path.slice(startPart, startDot);\n\t\t\tret.base = path.slice(startPart, end);\n\t\t\tret.ext = path.slice(startDot, end);\n\t\t}\n\n\t\t// If the directory is the root, use the entire root as the `dir` including\n\t\t// the trailing slash if any (`C:\\abc` -> `C:\\`). Otherwise, strip out the\n\t\t// trailing slash (`C:\\abc\\def` -> `C:\\abc`).\n\t\tif (startPart > 0 && startPart !== rootEnd) {\n\t\t\tret.dir = path.slice(0, startPart - 1);\n\t\t}\n\t\telse {\n\t\t\tret.dir = ret.root;\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tsep: '\\\\',\n\tdelimiter: ';',\n\twin32: null,\n\tposix: null\n};\n\nexport const posix: IPath = {\n\t// path.resolve([from ...], to)\n\tresolve(...pathSegments: string[]): string {\n\t\tlet resolvedPath = '';\n\t\tlet resolvedAbsolute = false;\n\n\t\tfor (let i = pathSegments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n\t\t\tlet path;\n\t\t\tif (i >= 0) {\n\t\t\t\tpath = pathSegments[i];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpath = process.cwd();\n\t\t\t}\n\n\t\t\tvalidateString(path, 'path');\n\n\t\t\t// Skip empty entries\n\t\t\tif (path.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tresolvedPath = path + '/' + resolvedPath;\n\t\t\tresolvedAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n\t\t}\n\n\t\t// At this point the path should be resolved to a full absolute path, but\n\t\t// handle relative paths to be safe (might happen when process.cwd() fails)\n\n\t\t// Normalize the path\n\t\tresolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/',\n\t\t\tisPosixPathSeparator);\n\n\t\tif (resolvedAbsolute) {\n\t\t\tif (resolvedPath.length > 0) {\n\t\t\t\treturn '/' + resolvedPath;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '/';\n\t\t\t}\n\t\t} else if (resolvedPath.length > 0) {\n\t\t\treturn resolvedPath;\n\t\t} else {\n\t\t\treturn '.';\n\t\t}\n\t},\n\n\tnormalize(path: string): string {\n\t\tvalidateString(path, 'path');\n\n\t\tif (path.length === 0) {\n\t\t\treturn '.';\n\t\t}\n\n\t\tconst isAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n\t\tconst trailingSeparator =\n\t\t\tpath.charCodeAt(path.length - 1) === CHAR_FORWARD_SLASH;\n\n\t\t// Normalize the path\n\t\tpath = normalizeString(path, !isAbsolute, '/', isPosixPathSeparator);\n\n\t\tif (path.length === 0 && !isAbsolute) {\n\t\t\tpath = '.';\n\t\t}\n\t\tif (path.length > 0 && trailingSeparator) {\n\t\t\tpath += '/';\n\t\t}\n\n\t\tif (isAbsolute) {\n\t\t\treturn '/' + path;\n\t\t}\n\t\treturn path;\n\t},\n\n\tisAbsolute(path: string): boolean {\n\t\tvalidateString(path, 'path');\n\t\treturn path.length > 0 && path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n\t},\n\n\tjoin(...paths: string[]): string {\n\t\tif (paths.length === 0) {\n\t\t\treturn '.';\n\t\t}\n\t\tlet joined;\n\t\tfor (let i = 0; i < paths.length; ++i) {\n\t\t\tconst arg = arguments[i];\n\t\t\tvalidateString(arg, 'path');\n\t\t\tif (arg.length > 0) {\n\t\t\t\tif (joined === undefined) {\n\t\t\t\t\tjoined = arg;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjoined += '/' + arg;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (joined === undefined) {\n\t\t\treturn '.';\n\t\t}\n\t\treturn posix.normalize(joined);\n\t},\n\n\trelative(from: string, to: string): string {\n\t\tvalidateString(from, 'from');\n\t\tvalidateString(to, 'to');\n\n\t\tif (from === to) {\n\t\t\treturn '';\n\t\t}\n\n\t\tfrom = posix.resolve(from);\n\t\tto = posix.resolve(to);\n\n\t\tif (from === to) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// Trim any leading backslashes\n\t\tlet fromStart = 1;\n\t\tfor (; fromStart < from.length; ++fromStart) {\n\t\t\tif (from.charCodeAt(fromStart) !== CHAR_FORWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst fromEnd = from.length;\n\t\tconst fromLen = (fromEnd - fromStart);\n\n\t\t// Trim any leading backslashes\n\t\tlet toStart = 1;\n\t\tfor (; toStart < to.length; ++toStart) {\n\t\t\tif (to.charCodeAt(toStart) !== CHAR_FORWARD_SLASH) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst toEnd = to.length;\n\t\tconst toLen = (toEnd - toStart);\n\n\t\t// Compare paths to find the longest common path from root\n\t\tconst length = (fromLen < toLen ? fromLen : toLen);\n\t\tlet lastCommonSep = -1;\n\t\tlet i = 0;\n\t\tfor (; i <= length; ++i) {\n\t\t\tif (i === length) {\n\t\t\t\tif (toLen > length) {\n\t\t\t\t\tif (to.charCodeAt(toStart + i) === CHAR_FORWARD_SLASH) {\n\t\t\t\t\t\t// We get here if `from` is the exact base path for `to`.\n\t\t\t\t\t\t// For example: from='/foo/bar'; to='/foo/bar/baz'\n\t\t\t\t\t\treturn to.slice(toStart + i + 1);\n\t\t\t\t\t} else if (i === 0) {\n\t\t\t\t\t\t// We get here if `from` is the root\n\t\t\t\t\t\t// For example: from='/'; to='/foo'\n\t\t\t\t\t\treturn to.slice(toStart + i);\n\t\t\t\t\t}\n\t\t\t\t} else if (fromLen > length) {\n\t\t\t\t\tif (from.charCodeAt(fromStart + i) === CHAR_FORWARD_SLASH) {\n\t\t\t\t\t\t// We get here if `to` is the exact base path for `from`.\n\t\t\t\t\t\t// For example: from='/foo/bar/baz'; to='/foo/bar'\n\t\t\t\t\t\tlastCommonSep = i;\n\t\t\t\t\t} else if (i === 0) {\n\t\t\t\t\t\t// We get here if `to` is the root.\n\t\t\t\t\t\t// For example: from='/foo'; to='/'\n\t\t\t\t\t\tlastCommonSep = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst fromCode = from.charCodeAt(fromStart + i);\n\t\t\tconst toCode = to.charCodeAt(toStart + i);\n\t\t\tif (fromCode !== toCode) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (fromCode === CHAR_FORWARD_SLASH) {\n\t\t\t\tlastCommonSep = i;\n\t\t\t}\n\t\t}\n\n\t\tlet out = '';\n\t\t// Generate the relative path based on the path difference between `to`\n\t\t// and `from`\n\t\tfor (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n\t\t\tif (i === fromEnd || from.charCodeAt(i) === CHAR_FORWARD_SLASH) {\n\t\t\t\tif (out.length === 0) {\n\t\t\t\t\tout += '..';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tout += '/..';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Lastly, append the rest of the destination (`to`) path that comes after\n\t\t// the common path parts\n\t\tif (out.length > 0) {\n\t\t\treturn out + to.slice(toStart + lastCommonSep);\n\t\t}\n\t\telse {\n\t\t\ttoStart += lastCommonSep;\n\t\t\tif (to.charCodeAt(toStart) === CHAR_FORWARD_SLASH) {\n\t\t\t\t++toStart;\n\t\t\t}\n\t\t\treturn to.slice(toStart);\n\t\t}\n\t},\n\n\ttoNamespacedPath(path: string): string {\n\t\t// Non-op on posix systems\n\t\treturn path;\n\t},\n\n\tdirname(path: string): string {\n\t\tvalidateString(path, 'path');\n\t\tif (path.length === 0) {\n\t\t\treturn '.';\n\t\t}\n\t\tconst hasRoot = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tfor (let i = path.length - 1; i >= 1; --i) {\n\t\t\tif (path.charCodeAt(i) === CHAR_FORWARD_SLASH) {\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tend = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We saw the first non-path separator\n\t\t\t\tmatchedSlash = false;\n\t\t\t}\n\t\t}\n\n\t\tif (end === -1) {\n\t\t\treturn hasRoot ? '/' : '.';\n\t\t}\n\t\tif (hasRoot && end === 1) {\n\t\t\treturn '//';\n\t\t}\n\t\treturn path.slice(0, end);\n\t},\n\n\tbasename(path: string, ext?: string): string {\n\t\tif (ext !== undefined) {\n\t\t\tvalidateString(ext, 'ext');\n\t\t}\n\t\tvalidateString(path, 'path');\n\n\t\tlet start = 0;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tlet i;\n\n\t\tif (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n\t\t\tif (ext.length === path.length && ext === path) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tlet extIdx = ext.length - 1;\n\t\t\tlet firstNonSlashEnd = -1;\n\t\t\tfor (i = path.length - 1; i >= 0; --i) {\n\t\t\t\tconst code = path.charCodeAt(i);\n\t\t\t\tif (code === CHAR_FORWARD_SLASH) {\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\t\tstart = i + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (firstNonSlashEnd === -1) {\n\t\t\t\t\t\t// We saw the first non-path separator, remember this index in case\n\t\t\t\t\t\t// we need it if the extension ends up not matching\n\t\t\t\t\t\tmatchedSlash = false;\n\t\t\t\t\t\tfirstNonSlashEnd = i + 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (extIdx >= 0) {\n\t\t\t\t\t\t// Try to match the explicit extension\n\t\t\t\t\t\tif (code === ext.charCodeAt(extIdx)) {\n\t\t\t\t\t\t\tif (--extIdx === -1) {\n\t\t\t\t\t\t\t\t// We matched the extension, so mark this as the end of our path\n\t\t\t\t\t\t\t\t// component\n\t\t\t\t\t\t\t\tend = i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Extension does not match, so our result is the entire path\n\t\t\t\t\t\t\t// component\n\t\t\t\t\t\t\textIdx = -1;\n\t\t\t\t\t\t\tend = firstNonSlashEnd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (start === end) {\n\t\t\t\tend = firstNonSlashEnd;\n\t\t\t}\n\t\t\telse if (end === -1) {\n\t\t\t\tend = path.length;\n\t\t\t}\n\t\t\treturn path.slice(start, end);\n\t\t} else {\n\t\t\tfor (i = path.length - 1; i >= 0; --i) {\n\t\t\t\tif (path.charCodeAt(i) === CHAR_FORWARD_SLASH) {\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\t\tstart = i + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (end === -1) {\n\t\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t\t// path component\n\t\t\t\t\tmatchedSlash = false;\n\t\t\t\t\tend = i + 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (end === -1) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn path.slice(start, end);\n\t\t}\n\t},\n\n\textname(path: string): string {\n\t\tvalidateString(path, 'path');\n\t\tlet startDot = -1;\n\t\tlet startPart = 0;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\t// Track the state of characters (if any) we see before our first dot and\n\t\t// after any path separator we find\n\t\tlet preDotState = 0;\n\t\tfor (let i = path.length - 1; i >= 0; --i) {\n\t\t\tconst code = path.charCodeAt(i);\n\t\t\tif (code === CHAR_FORWARD_SLASH) {\n\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tstartPart = i + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (end === -1) {\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t// extension\n\t\t\t\tmatchedSlash = false;\n\t\t\t\tend = i + 1;\n\t\t\t}\n\t\t\tif (code === CHAR_DOT) {\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\n\t\t\t\tif (startDot === -1) {\n\t\t\t\t\tstartDot = i;\n\t\t\t\t}\n\t\t\t\telse if (preDotState !== 1) {\n\t\t\t\t\tpreDotState = 1;\n\t\t\t\t}\n\t\t\t} else if (startDot !== -1) {\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\n\t\t\t\t// have a good chance at having a non-empty extension\n\t\t\t\tpreDotState = -1;\n\t\t\t}\n\t\t}\n\n\t\tif (startDot === -1 ||\n\t\t\tend === -1 ||\n\t\t\t// We saw a non-dot character immediately before the dot\n\t\t\tpreDotState === 0 ||\n\t\t\t// The (right-most) trimmed path component is exactly '..'\n\t\t\t(preDotState === 1 &&\n\t\t\t\tstartDot === end - 1 &&\n\t\t\t\tstartDot === startPart + 1)) {\n\t\t\treturn '';\n\t\t}\n\t\treturn path.slice(startDot, end);\n\t},\n\n\tformat(pathObject): string {\n\t\tif (pathObject === null || typeof pathObject !== 'object') {\n\t\t\tthrow new ErrorInvalidArgType('pathObject', 'Object', pathObject);\n\t\t}\n\n\t\treturn _format('/', pathObject);\n\t},\n\n\tparse(path: string): ParsedPath {\n\t\tvalidateString(path, 'path');\n\n\t\tconst ret = { root: '', dir: '', base: '', ext: '', name: '' };\n\t\tif (path.length === 0) {\n\t\t\treturn ret;\n\t\t}\n\t\tconst isAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n\t\tlet start;\n\t\tif (isAbsolute) {\n\t\t\tret.root = '/';\n\t\t\tstart = 1;\n\t\t} else {\n\t\t\tstart = 0;\n\t\t}\n\t\tlet startDot = -1;\n\t\tlet startPart = 0;\n\t\tlet end = -1;\n\t\tlet matchedSlash = true;\n\t\tlet i = path.length - 1;\n\n\t\t// Track the state of characters (if any) we see before our first dot and\n\t\t// after any path separator we find\n\t\tlet preDotState = 0;\n\n\t\t// Get non-dir info\n\t\tfor (; i >= start; --i) {\n\t\t\tconst code = path.charCodeAt(i);\n\t\t\tif (code === CHAR_FORWARD_SLASH) {\n\t\t\t\t// If we reached a path separator that was not part of a set of path\n\t\t\t\t// separators at the end of the string, stop now\n\t\t\t\tif (!matchedSlash) {\n\t\t\t\t\tstartPart = i + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (end === -1) {\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\n\t\t\t\t// extension\n\t\t\t\tmatchedSlash = false;\n\t\t\t\tend = i + 1;\n\t\t\t}\n\t\t\tif (code === CHAR_DOT) {\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\n\t\t\t\tif (startDot === -1) {\n\t\t\t\t\tstartDot = i;\n\t\t\t\t}\n\t\t\t\telse if (preDotState !== 1) {\n\t\t\t\t\tpreDotState = 1;\n\t\t\t\t}\n\t\t\t} else if (startDot !== -1) {\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\n\t\t\t\t// have a good chance at having a non-empty extension\n\t\t\t\tpreDotState = -1;\n\t\t\t}\n\t\t}\n\n\t\tif (startDot === -1 ||\n\t\t\tend === -1 ||\n\t\t\t// We saw a non-dot character immediately before the dot\n\t\t\tpreDotState === 0 ||\n\t\t\t// The (right-most) trimmed path component is exactly '..'\n\t\t\t(preDotState === 1 &&\n\t\t\t\tstartDot === end - 1 &&\n\t\t\t\tstartDot === startPart + 1)) {\n\t\t\tif (end !== -1) {\n\t\t\t\tif (startPart === 0 && isAbsolute) {\n\t\t\t\t\tret.base = ret.name = path.slice(1, end);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tret.base = ret.name = path.slice(startPart, end);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (startPart === 0 && isAbsolute) {\n\t\t\t\tret.name = path.slice(1, startDot);\n\t\t\t\tret.base = path.slice(1, end);\n\t\t\t} else {\n\t\t\t\tret.name = path.slice(startPart, startDot);\n\t\t\t\tret.base = path.slice(startPart, end);\n\t\t\t}\n\t\t\tret.ext = path.slice(startDot, end);\n\t\t}\n\n\t\tif (startPart > 0) {\n\t\t\tret.dir = path.slice(0, startPart - 1);\n\t\t}\n\t\telse if (isAbsolute) {\n\t\t\tret.dir = '/';\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tsep: '/',\n\tdelimiter: ':',\n\twin32: null,\n\tposix: null\n};\n\nposix.win32 = win32.win32 = win32;\nposix.posix = win32.posix = posix;\n\nexport const normalize = (process.platform === 'win32' ? win32.normalize : posix.normalize);\nexport const isAbsolute = (process.platform === 'win32' ? win32.isAbsolute : posix.isAbsolute);\nexport const join = (process.platform === 'win32' ? win32.join : posix.join);\nexport const resolve = (process.platform === 'win32' ? win32.resolve : posix.resolve);\nexport const relative = (process.platform === 'win32' ? win32.relative : posix.relative);\nexport const dirname = (process.platform === 'win32' ? win32.dirname : posix.dirname);\nexport const basename = (process.platform === 'win32' ? win32.basename : posix.basename);\nexport const extname = (process.platform === 'win32' ? win32.extname : posix.extname);\nexport const format = (process.platform === 'win32' ? win32.format : posix.format);\nexport const parse = (process.platform === 'win32' ? win32.parse : posix.parse);\nexport const toNamespacedPath = (process.platform === 'win32' ? win32.toNamespacedPath : posix.toNamespacedPath);\nexport const sep = (process.platform === 'win32' ? win32.sep : posix.sep);\nexport const delimiter = (process.platform === 'win32' ? win32.delimiter : posix.delimiter);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\n\n/**\n * The empty string.\n */\nexport const empty = '';\n\nexport function isFalsyOrWhitespace(str: string | undefined): boolean {\n\tif (!str || typeof str !== 'string') {\n\t\treturn true;\n\t}\n\treturn str.trim().length === 0;\n}\n\n/**\n * @returns the provided number with the given number of preceding zeros.\n */\nexport function pad(n: number, l: number, char: string = '0'): string {\n\tconst str = '' + n;\n\tconst r = [str];\n\n\tfor (let i = str.length; i < l; i++) {\n\t\tr.push(char);\n\t}\n\n\treturn r.reverse().join('');\n}\n\nconst _formatRegexp = /{(\\d+)}/g;\n\n/**\n * Helper to produce a string with a variable number of arguments. Insert variable segments\n * into the string using the {n} notation where N is the index of the argument following the string.\n * @param value string to which formatting is applied\n * @param args replacements for {n}-entries\n */\nexport function format(value: string, ...args: any[]): string {\n\tif (args.length === 0) {\n\t\treturn value;\n\t}\n\treturn value.replace(_formatRegexp, function (match, group) {\n\t\tconst idx = parseInt(group, 10);\n\t\treturn isNaN(idx) || idx < 0 || idx >= args.length ?\n\t\t\tmatch :\n\t\t\targs[idx];\n\t});\n}\n\n/**\n * Converts HTML characters inside the string to use entities instead. Makes the string safe from\n * being used e.g. in HTMLElement.innerHTML.\n */\nexport function escape(html: string): string {\n\treturn html.replace(/[<>&]/g, function (match) {\n\t\tswitch (match) {\n\t\t\tcase '<': return '&lt;';\n\t\t\tcase '>': return '&gt;';\n\t\t\tcase '&': return '&amp;';\n\t\t\tdefault: return match;\n\t\t}\n\t});\n}\n\n/**\n * Escapes regular expression characters in a given string\n */\nexport function escapeRegExpCharacters(value: string): string {\n\treturn value.replace(/[\\-\\\\\\{\\}\\*\\+\\?\\|\\^\\$\\.\\[\\]\\(\\)\\#]/g, '\\\\$&');\n}\n\n/**\n * Removes all occurrences of needle from the beginning and end of haystack.\n * @param haystack string to trim\n * @param needle the thing to trim (default is a blank)\n */\nexport function trim(haystack: string, needle: string = ' '): string {\n\tconst trimmed = ltrim(haystack, needle);\n\treturn rtrim(trimmed, needle);\n}\n\n/**\n * Removes all occurrences of needle from the beginning of haystack.\n * @param haystack string to trim\n * @param needle the thing to trim\n */\nexport function ltrim(haystack: string, needle: string): string {\n\tif (!haystack || !needle) {\n\t\treturn haystack;\n\t}\n\n\tconst needleLen = needle.length;\n\tif (needleLen === 0 || haystack.length === 0) {\n\t\treturn haystack;\n\t}\n\n\tlet offset = 0;\n\n\twhile (haystack.indexOf(needle, offset) === offset) {\n\t\toffset = offset + needleLen;\n\t}\n\treturn haystack.substring(offset);\n}\n\n/**\n * Removes all occurrences of needle from the end of haystack.\n * @param haystack string to trim\n * @param needle the thing to trim\n */\nexport function rtrim(haystack: string, needle: string): string {\n\tif (!haystack || !needle) {\n\t\treturn haystack;\n\t}\n\n\tconst needleLen = needle.length,\n\t\thaystackLen = haystack.length;\n\n\tif (needleLen === 0 || haystackLen === 0) {\n\t\treturn haystack;\n\t}\n\n\tlet offset = haystackLen,\n\t\tidx = -1;\n\n\twhile (true) {\n\t\tidx = haystack.lastIndexOf(needle, offset - 1);\n\t\tif (idx === -1 || idx + needleLen !== offset) {\n\t\t\tbreak;\n\t\t}\n\t\tif (idx === 0) {\n\t\t\treturn '';\n\t\t}\n\t\toffset = idx;\n\t}\n\n\treturn haystack.substring(0, offset);\n}\n\nexport function convertSimple2RegExpPattern(pattern: string): string {\n\treturn pattern.replace(/[\\-\\\\\\{\\}\\+\\?\\|\\^\\$\\.\\,\\[\\]\\(\\)\\#\\s]/g, '\\\\$&').replace(/[\\*]/g, '.*');\n}\n\nexport function stripWildcards(pattern: string): string {\n\treturn pattern.replace(/\\*/g, '');\n}\n\n/**\n * Determines if haystack starts with needle.\n */\nexport function startsWith(haystack: string, needle: string): boolean {\n\tif (haystack.length < needle.length) {\n\t\treturn false;\n\t}\n\n\tif (haystack === needle) {\n\t\treturn true;\n\t}\n\n\tfor (let i = 0; i < needle.length; i++) {\n\t\tif (haystack[i] !== needle[i]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\n/**\n * Determines if haystack ends with needle.\n */\nexport function endsWith(haystack: string, needle: string): boolean {\n\tconst diff = haystack.length - needle.length;\n\tif (diff > 0) {\n\t\treturn haystack.indexOf(needle, diff) === diff;\n\t} else if (diff === 0) {\n\t\treturn haystack === needle;\n\t} else {\n\t\treturn false;\n\t}\n}\n\nexport interface RegExpOptions {\n\tmatchCase?: boolean;\n\twholeWord?: boolean;\n\tmultiline?: boolean;\n\tglobal?: boolean;\n\tunicode?: boolean;\n}\n\nexport function createRegExp(searchString: string, isRegex: boolean, options: RegExpOptions = {}): RegExp {\n\tif (!searchString) {\n\t\tthrow new Error('Cannot create regex from empty string');\n\t}\n\tif (!isRegex) {\n\t\tsearchString = escapeRegExpCharacters(searchString);\n\t}\n\tif (options.wholeWord) {\n\t\tif (!/\\B/.test(searchString.charAt(0))) {\n\t\t\tsearchString = '\\\\b' + searchString;\n\t\t}\n\t\tif (!/\\B/.test(searchString.charAt(searchString.length - 1))) {\n\t\t\tsearchString = searchString + '\\\\b';\n\t\t}\n\t}\n\tlet modifiers = '';\n\tif (options.global) {\n\t\tmodifiers += 'g';\n\t}\n\tif (!options.matchCase) {\n\t\tmodifiers += 'i';\n\t}\n\tif (options.multiline) {\n\t\tmodifiers += 'm';\n\t}\n\tif (options.unicode) {\n\t\tmodifiers += 'u';\n\t}\n\n\treturn new RegExp(searchString, modifiers);\n}\n\nexport function regExpLeadsToEndlessLoop(regexp: RegExp): boolean {\n\t// Exit early if it's one of these special cases which are meant to match\n\t// against an empty string\n\tif (regexp.source === '^' || regexp.source === '^$' || regexp.source === '$' || regexp.source === '^\\\\s*$') {\n\t\treturn false;\n\t}\n\n\t// We check against an empty string. If the regular expression doesn't advance\n\t// (e.g. ends in an endless loop) it will match an empty string.\n\tconst match = regexp.exec('');\n\treturn !!(match && <any>regexp.lastIndex === 0);\n}\n\nexport function regExpContainsBackreference(regexpValue: string): boolean {\n\treturn !!regexpValue.match(/([^\\\\]|^)(\\\\\\\\)*\\\\\\d+/);\n}\n\nexport function regExpFlags(regexp: RegExp): string {\n\treturn (regexp.global ? 'g' : '')\n\t\t+ (regexp.ignoreCase ? 'i' : '')\n\t\t+ (regexp.multiline ? 'm' : '')\n\t\t+ ((regexp as any).unicode ? 'u' : '');\n}\n\n/**\n * Returns first index of the string that is not whitespace.\n * If string is empty or contains only whitespaces, returns -1\n */\nexport function firstNonWhitespaceIndex(str: string): number {\n\tfor (let i = 0, len = str.length; i < len; i++) {\n\t\tconst chCode = str.charCodeAt(i);\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * Returns the leading whitespace of the string.\n * If the string contains only whitespaces, returns entire string\n */\nexport function getLeadingWhitespace(str: string, start: number = 0, end: number = str.length): string {\n\tfor (let i = start; i < end; i++) {\n\t\tconst chCode = str.charCodeAt(i);\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\n\t\t\treturn str.substring(start, i);\n\t\t}\n\t}\n\treturn str.substring(start, end);\n}\n\n/**\n * Returns last index of the string that is not whitespace.\n * If string is empty or contains only whitespaces, returns -1\n */\nexport function lastNonWhitespaceIndex(str: string, startIndex: number = str.length - 1): number {\n\tfor (let i = startIndex; i >= 0; i--) {\n\t\tconst chCode = str.charCodeAt(i);\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\nexport function compare(a: string, b: string): number {\n\tif (a < b) {\n\t\treturn -1;\n\t} else if (a > b) {\n\t\treturn 1;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nexport function compareIgnoreCase(a: string, b: string): number {\n\tconst len = Math.min(a.length, b.length);\n\tfor (let i = 0; i < len; i++) {\n\t\tlet codeA = a.charCodeAt(i);\n\t\tlet codeB = b.charCodeAt(i);\n\n\t\tif (codeA === codeB) {\n\t\t\t// equal\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (isUpperAsciiLetter(codeA)) {\n\t\t\tcodeA += 32;\n\t\t}\n\n\t\tif (isUpperAsciiLetter(codeB)) {\n\t\t\tcodeB += 32;\n\t\t}\n\n\t\tconst diff = codeA - codeB;\n\n\t\tif (diff === 0) {\n\t\t\t// equal -> ignoreCase\n\t\t\tcontinue;\n\n\t\t} else if (isLowerAsciiLetter(codeA) && isLowerAsciiLetter(codeB)) {\n\t\t\t//\n\t\t\treturn diff;\n\n\t\t} else {\n\t\t\treturn compare(a.toLowerCase(), b.toLowerCase());\n\t\t}\n\t}\n\n\tif (a.length < b.length) {\n\t\treturn -1;\n\t} else if (a.length > b.length) {\n\t\treturn 1;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nexport function isLowerAsciiLetter(code: number): boolean {\n\treturn code >= CharCode.a && code <= CharCode.z;\n}\n\nexport function isUpperAsciiLetter(code: number): boolean {\n\treturn code >= CharCode.A && code <= CharCode.Z;\n}\n\nfunction isAsciiLetter(code: number): boolean {\n\treturn isLowerAsciiLetter(code) || isUpperAsciiLetter(code);\n}\n\nexport function equalsIgnoreCase(a: string, b: string): boolean {\n\tconst len1 = a ? a.length : 0;\n\tconst len2 = b ? b.length : 0;\n\n\tif (len1 !== len2) {\n\t\treturn false;\n\t}\n\n\treturn doEqualsIgnoreCase(a, b);\n}\n\nfunction doEqualsIgnoreCase(a: string, b: string, stopAt = a.length): boolean {\n\tif (typeof a !== 'string' || typeof b !== 'string') {\n\t\treturn false;\n\t}\n\n\tfor (let i = 0; i < stopAt; i++) {\n\t\tconst codeA = a.charCodeAt(i);\n\t\tconst codeB = b.charCodeAt(i);\n\n\t\tif (codeA === codeB) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// a-z A-Z\n\t\tif (isAsciiLetter(codeA) && isAsciiLetter(codeB)) {\n\t\t\tconst diff = Math.abs(codeA - codeB);\n\t\t\tif (diff !== 0 && diff !== 32) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Any other charcode\n\t\telse {\n\t\t\tif (String.fromCharCode(codeA).toLowerCase() !== String.fromCharCode(codeB).toLowerCase()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function startsWithIgnoreCase(str: string, candidate: string): boolean {\n\tconst candidateLength = candidate.length;\n\tif (candidate.length > str.length) {\n\t\treturn false;\n\t}\n\n\treturn doEqualsIgnoreCase(str, candidate, candidateLength);\n}\n\n/**\n * @returns the length of the common prefix of the two strings.\n */\nexport function commonPrefixLength(a: string, b: string): number {\n\n\tlet i: number,\n\t\tlen = Math.min(a.length, b.length);\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (a.charCodeAt(i) !== b.charCodeAt(i)) {\n\t\t\treturn i;\n\t\t}\n\t}\n\n\treturn len;\n}\n\n/**\n * @returns the length of the common suffix of the two strings.\n */\nexport function commonSuffixLength(a: string, b: string): number {\n\n\tlet i: number,\n\t\tlen = Math.min(a.length, b.length);\n\n\tconst aLastIndex = a.length - 1;\n\tconst bLastIndex = b.length - 1;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (a.charCodeAt(aLastIndex - i) !== b.charCodeAt(bLastIndex - i)) {\n\t\t\treturn i;\n\t\t}\n\t}\n\n\treturn len;\n}\n\nfunction substrEquals(a: string, aStart: number, aEnd: number, b: string, bStart: number, bEnd: number): boolean {\n\twhile (aStart < aEnd && bStart < bEnd) {\n\t\tif (a[aStart] !== b[bStart]) {\n\t\t\treturn false;\n\t\t}\n\t\taStart += 1;\n\t\tbStart += 1;\n\t}\n\treturn true;\n}\n\n/**\n * Return the overlap between the suffix of `a` and the prefix of `b`.\n * For instance `overlap(\"foobar\", \"arr, I'm a pirate\") === 2`.\n */\nexport function overlap(a: string, b: string): number {\n\tconst aEnd = a.length;\n\tlet bEnd = b.length;\n\tlet aStart = aEnd - bEnd;\n\n\tif (aStart === 0) {\n\t\treturn a === b ? aEnd : 0;\n\t} else if (aStart < 0) {\n\t\tbEnd += aStart;\n\t\taStart = 0;\n\t}\n\n\twhile (aStart < aEnd && bEnd > 0) {\n\t\tif (substrEquals(a, aStart, aEnd, b, 0, bEnd)) {\n\t\t\treturn bEnd;\n\t\t}\n\t\tbEnd -= 1;\n\t\taStart += 1;\n\t}\n\treturn 0;\n}\n\n// --- unicode\n// http://en.wikipedia.org/wiki/Surrogate_pair\n// Returns the code point starting at a specified index in a string\n// Code points U+0000 to U+D7FF and U+E000 to U+FFFF are represented on a single character\n// Code points U+10000 to U+10FFFF are represented on two consecutive characters\n//export function getUnicodePoint(str:string, index:number, len:number):number {\n//\tconst chrCode = str.charCodeAt(index);\n//\tif (0xD800 <= chrCode && chrCode <= 0xDBFF && index + 1 < len) {\n//\t\tconst nextChrCode = str.charCodeAt(index + 1);\n//\t\tif (0xDC00 <= nextChrCode && nextChrCode <= 0xDFFF) {\n//\t\t\treturn (chrCode - 0xD800) << 10 + (nextChrCode - 0xDC00) + 0x10000;\n//\t\t}\n//\t}\n//\treturn chrCode;\n//}\nexport function isHighSurrogate(charCode: number): boolean {\n\treturn (0xD800 <= charCode && charCode <= 0xDBFF);\n}\n\nexport function isLowSurrogate(charCode: number): boolean {\n\treturn (0xDC00 <= charCode && charCode <= 0xDFFF);\n}\n\n/**\n * Generated using https://github.com/alexandrudima/unicode-utils/blob/master/generate-rtl-test.js\n */\nconst CONTAINS_RTL = /(?:[\\u05BE\\u05C0\\u05C3\\u05C6\\u05D0-\\u05F4\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1-\\u07EA\\u07F4\\u07F5\\u07FA-\\u0815\\u081A\\u0824\\u0828\\u0830-\\u0858\\u085E-\\u08BD\\u200F\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFD3D\\uFD50-\\uFDFC\\uFE70-\\uFEFC]|\\uD802[\\uDC00-\\uDD1B\\uDD20-\\uDE00\\uDE10-\\uDE33\\uDE40-\\uDEE4\\uDEEB-\\uDF35\\uDF40-\\uDFFF]|\\uD803[\\uDC00-\\uDCFF]|\\uD83A[\\uDC00-\\uDCCF\\uDD00-\\uDD43\\uDD50-\\uDFFF]|\\uD83B[\\uDC00-\\uDEBB])/;\n\n/**\n * Returns true if `str` contains any Unicode character that is classified as \"R\" or \"AL\".\n */\nexport function containsRTL(str: string): boolean {\n\treturn CONTAINS_RTL.test(str);\n}\n\n/**\n * Generated using https://github.com/alexandrudima/unicode-utils/blob/master/generate-emoji-test.js\n */\nconst CONTAINS_EMOJI = /(?:[\\u231A\\u231B\\u23F0\\u23F3\\u2600-\\u27BF\\u2B50\\u2B55]|\\uD83C[\\uDDE6-\\uDDFF\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDE4F\\uDE80-\\uDEF8]|\\uD83E[\\uDD00-\\uDDE6])/;\n\nexport function containsEmoji(str: string): boolean {\n\treturn CONTAINS_EMOJI.test(str);\n}\n\nconst IS_BASIC_ASCII = /^[\\t\\n\\r\\x20-\\x7E]*$/;\n/**\n * Returns true if `str` contains only basic ASCII characters in the range 32 - 126 (including 32 and 126) or \\n, \\r, \\t\n */\nexport function isBasicASCII(str: string): boolean {\n\treturn IS_BASIC_ASCII.test(str);\n}\n\nexport function containsFullWidthCharacter(str: string): boolean {\n\tfor (let i = 0, len = str.length; i < len; i++) {\n\t\tif (isFullWidthCharacter(str.charCodeAt(i))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport function isFullWidthCharacter(charCode: number): boolean {\n\t// Do a cheap trick to better support wrapping of wide characters, treat them as 2 columns\n\t// http://jrgraphix.net/research/unicode_blocks.php\n\t//          2E80  2EFF   CJK Radicals Supplement\n\t//          2F00  2FDF   Kangxi Radicals\n\t//          2FF0  2FFF   Ideographic Description Characters\n\t//          3000  303F   CJK Symbols and Punctuation\n\t//          3040  309F   Hiragana\n\t//          30A0  30FF   Katakana\n\t//          3100  312F   Bopomofo\n\t//          3130  318F   Hangul Compatibility Jamo\n\t//          3190  319F   Kanbun\n\t//          31A0  31BF   Bopomofo Extended\n\t//          31F0  31FF   Katakana Phonetic Extensions\n\t//          3200  32FF   Enclosed CJK Letters and Months\n\t//          3300  33FF   CJK Compatibility\n\t//          3400  4DBF   CJK Unified Ideographs Extension A\n\t//          4DC0  4DFF   Yijing Hexagram Symbols\n\t//          4E00  9FFF   CJK Unified Ideographs\n\t//          A000  A48F   Yi Syllables\n\t//          A490  A4CF   Yi Radicals\n\t//          AC00  D7AF   Hangul Syllables\n\t// [IGNORE] D800  DB7F   High Surrogates\n\t// [IGNORE] DB80  DBFF   High Private Use Surrogates\n\t// [IGNORE] DC00  DFFF   Low Surrogates\n\t// [IGNORE] E000  F8FF   Private Use Area\n\t//          F900  FAFF   CJK Compatibility Ideographs\n\t// [IGNORE] FB00  FB4F   Alphabetic Presentation Forms\n\t// [IGNORE] FB50  FDFF   Arabic Presentation Forms-A\n\t// [IGNORE] FE00  FE0F   Variation Selectors\n\t// [IGNORE] FE20  FE2F   Combining Half Marks\n\t// [IGNORE] FE30  FE4F   CJK Compatibility Forms\n\t// [IGNORE] FE50  FE6F   Small Form Variants\n\t// [IGNORE] FE70  FEFF   Arabic Presentation Forms-B\n\t//          FF00  FFEF   Halfwidth and Fullwidth Forms\n\t//               [https://en.wikipedia.org/wiki/Halfwidth_and_fullwidth_forms]\n\t//               of which FF01 - FF5E fullwidth ASCII of 21 to 7E\n\t// [IGNORE]    and FF65 - FFDC halfwidth of Katakana and Hangul\n\t// [IGNORE] FFF0  FFFF   Specials\n\tcharCode = +charCode; // @perf\n\treturn (\n\t\t(charCode >= 0x2E80 && charCode <= 0xD7AF)\n\t\t|| (charCode >= 0xF900 && charCode <= 0xFAFF)\n\t\t|| (charCode >= 0xFF01 && charCode <= 0xFF5E)\n\t);\n}\n\n/**\n * Given a string and a max length returns a shorted version. Shorting\n * happens at favorable positions - such as whitespace or punctuation characters.\n */\nexport function lcut(text: string, n: number) {\n\tif (text.length < n) {\n\t\treturn text;\n\t}\n\n\tconst re = /\\b/g;\n\tlet i = 0;\n\twhile (re.test(text)) {\n\t\tif (text.length - re.lastIndex < n) {\n\t\t\tbreak;\n\t\t}\n\n\t\ti = re.lastIndex;\n\t\tre.lastIndex += 1;\n\t}\n\n\treturn text.substring(i).replace(/^\\s/, empty);\n}\n\n// Escape codes\n// http://en.wikipedia.org/wiki/ANSI_escape_code\nconst EL = /\\x1B\\x5B[12]?K/g; // Erase in line\nconst COLOR_START = /\\x1b\\[\\d+m/g; // Color\nconst COLOR_END = /\\x1b\\[0?m/g; // Color\n\nexport function removeAnsiEscapeCodes(str: string): string {\n\tif (str) {\n\t\tstr = str.replace(EL, '');\n\t\tstr = str.replace(COLOR_START, '');\n\t\tstr = str.replace(COLOR_END, '');\n\t}\n\n\treturn str;\n}\n\nexport const removeAccents: (str: string) => string = (function () {\n\tif (typeof (String.prototype as any).normalize !== 'function') {\n\t\t//  no ES6 features...\n\t\treturn function (str: string) { return str; };\n\t} else {\n\t\t// transform into NFD form and remove accents\n\t\t// see: https://stackoverflow.com/questions/990904/remove-accents-diacritics-in-a-string-in-javascript/37511463#37511463\n\t\tconst regex = /[\\u0300-\\u036f]/g;\n\t\treturn function (str: string) {\n\t\t\treturn (str as any).normalize('NFD').replace(regex, empty);\n\t\t};\n\t}\n})();\n\n\n// -- UTF-8 BOM\n\nexport const UTF8_BOM_CHARACTER = String.fromCharCode(CharCode.UTF8_BOM);\n\nexport function startsWithUTF8BOM(str: string): boolean {\n\treturn !!(str && str.length > 0 && str.charCodeAt(0) === CharCode.UTF8_BOM);\n}\n\nexport function stripUTF8BOM(str: string): string {\n\treturn startsWithUTF8BOM(str) ? str.substr(1) : str;\n}\n\nexport function safeBtoa(str: string): string {\n\treturn btoa(encodeURIComponent(str)); // we use encodeURIComponent because btoa fails for non Latin 1 values\n}\n\nexport function repeat(s: string, count: number): string {\n\tlet result = '';\n\tfor (let i = 0; i < count; i++) {\n\t\tresult += s;\n\t}\n\treturn result;\n}\n\n/**\n * Checks if the characters of the provided query string are included in the\n * target string. The characters do not have to be contiguous within the string.\n */\nexport function fuzzyContains(target: string, query: string): boolean {\n\tif (!target || !query) {\n\t\treturn false; // return early if target or query are undefined\n\t}\n\n\tif (target.length < query.length) {\n\t\treturn false; // impossible for query to be contained in target\n\t}\n\n\tconst queryLen = query.length;\n\tconst targetLower = target.toLowerCase();\n\n\tlet index = 0;\n\tlet lastIndexOf = -1;\n\twhile (index < queryLen) {\n\t\tconst indexOf = targetLower.indexOf(query[index], lastIndexOf + 1);\n\t\tif (indexOf < 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlastIndexOf = indexOf;\n\n\t\tindex++;\n\t}\n\n\treturn true;\n}\n\nexport function containsUppercaseCharacter(target: string, ignoreEscapedChars = false): boolean {\n\tif (!target) {\n\t\treturn false;\n\t}\n\n\tif (ignoreEscapedChars) {\n\t\ttarget = target.replace(/\\\\./g, '');\n\t}\n\n\treturn target.toLowerCase() !== target;\n}\n\nexport function uppercaseFirstLetter(str: string): string {\n\treturn str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nexport function getNLines(str: string, n = 1): string {\n\tif (n === 0) {\n\t\treturn '';\n\t}\n\n\tlet idx = -1;\n\tdo {\n\t\tidx = str.indexOf('\\n', idx + 1);\n\t\tn--;\n\t} while (n > 0 && idx >= 0);\n\n\treturn idx >= 0 ?\n\t\tstr.substr(0, idx) :\n\t\tstr;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { pad } from './strings';\n\nexport function toLocalISOString(date: Date): string {\n\treturn date.getFullYear() +\n\t\t'-' + pad(date.getMonth() + 1, 2) +\n\t\t'-' + pad(date.getDate(), 2) +\n\t\t'T' + pad(date.getHours(), 2) +\n\t\t':' + pad(date.getMinutes(), 2) +\n\t\t':' + pad(date.getSeconds(), 2) +\n\t\t'.' + (date.getMilliseconds() / 1000).toFixed(3).slice(2, 5) +\n\t\t'Z';\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isWindows } from 'vs/base/common/platform';\nimport { startsWithIgnoreCase, equalsIgnoreCase } from 'vs/base/common/strings';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { sep, posix } from 'vs/base/common/path';\n\nfunction isPathSeparator(code: number) {\n\treturn code === CharCode.Slash || code === CharCode.Backslash;\n}\n\n/**\n * Takes a Windows OS path and changes backward slashes to forward slashes.\n * This should only be done for OS paths from Windows (or user provided paths potentially from Windows).\n * Using it on a Linux or MaxOS path might change it.\n */\nexport function toSlashes(osPath: string) {\n\treturn osPath.replace(/[\\\\/]/g, posix.sep);\n}\n\n/**\n * Computes the _root_ this path, like `getRoot('c:\\files') === c:\\`,\n * `getRoot('files:///files/path') === files:///`,\n * or `getRoot('\\\\server\\shares\\path') === \\\\server\\shares\\`\n */\nexport function getRoot(path: string, sep: string = posix.sep): string {\n\n\tif (!path) {\n\t\treturn '';\n\t}\n\n\tconst len = path.length;\n\tconst firstLetter = path.charCodeAt(0);\n\tif (isPathSeparator(firstLetter)) {\n\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t// UNC candidate \\\\localhost\\shares\\ddd\n\t\t\t//               ^^^^^^^^^^^^^^^^^^^\n\t\t\tif (!isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\tlet pos = 3;\n\t\t\t\tconst start = pos;\n\t\t\t\tfor (; pos < len; pos++) {\n\t\t\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (start !== pos && !isPathSeparator(path.charCodeAt(pos + 1))) {\n\t\t\t\t\tpos += 1;\n\t\t\t\t\tfor (; pos < len; pos++) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\t\t\t\treturn path.slice(0, pos + 1) // consume this separator\n\t\t\t\t\t\t\t\t.replace(/[\\\\/]/g, sep);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// /user/far\n\t\t// ^\n\t\treturn sep;\n\n\t} else if (isWindowsDriveLetter(firstLetter)) {\n\t\t// check for windows drive letter c:\\ or c:\n\n\t\tif (path.charCodeAt(1) === CharCode.Colon) {\n\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t// C:\\fff\n\t\t\t\t// ^^^\n\t\t\t\treturn path.slice(0, 2) + sep;\n\t\t\t} else {\n\t\t\t\t// C:\n\t\t\t\t// ^^\n\t\t\t\treturn path.slice(0, 2);\n\t\t\t}\n\t\t}\n\t}\n\n\t// check for URI\n\t// scheme://authority/path\n\t// ^^^^^^^^^^^^^^^^^^^\n\tlet pos = path.indexOf('://');\n\tif (pos !== -1) {\n\t\tpos += 3; // 3 -> \"://\".length\n\t\tfor (; pos < len; pos++) {\n\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\treturn path.slice(0, pos + 1); // consume this separator\n\t\t\t}\n\t\t}\n\t}\n\n\treturn '';\n}\n\n/**\n * Check if the path follows this pattern: `\\\\hostname\\sharename`.\n *\n * @see https://msdn.microsoft.com/en-us/library/gg465305.aspx\n * @return A boolean indication if the path is a UNC path, on none-windows\n * always false.\n */\nexport function isUNC(path: string): boolean {\n\tif (!isWindows) {\n\t\t// UNC is a windows concept\n\t\treturn false;\n\t}\n\n\tif (!path || path.length < 5) {\n\t\t// at least \\\\a\\b\n\t\treturn false;\n\t}\n\n\tlet code = path.charCodeAt(0);\n\tif (code !== CharCode.Backslash) {\n\t\treturn false;\n\t}\n\tcode = path.charCodeAt(1);\n\tif (code !== CharCode.Backslash) {\n\t\treturn false;\n\t}\n\tlet pos = 2;\n\tconst start = pos;\n\tfor (; pos < path.length; pos++) {\n\t\tcode = path.charCodeAt(pos);\n\t\tif (code === CharCode.Backslash) {\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (start === pos) {\n\t\treturn false;\n\t}\n\tcode = path.charCodeAt(pos + 1);\n\tif (isNaN(code) || code === CharCode.Backslash) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n// Reference: https://en.wikipedia.org/wiki/Filename\nconst INVALID_FILE_CHARS = isWindows ? /[\\\\/:\\*\\?\"<>\\|]/g : /[\\\\/]/g;\nconst WINDOWS_FORBIDDEN_NAMES = /^(con|prn|aux|clock\\$|nul|lpt[0-9]|com[0-9])$/i;\nexport function isValidBasename(name: string | null | undefined): boolean {\n\tif (!name || name.length === 0 || /^\\s+$/.test(name)) {\n\t\treturn false; // require a name that is not just whitespace\n\t}\n\n\tINVALID_FILE_CHARS.lastIndex = 0; // the holy grail of software development\n\tif (INVALID_FILE_CHARS.test(name)) {\n\t\treturn false; // check for certain invalid file characters\n\t}\n\n\tif (isWindows && WINDOWS_FORBIDDEN_NAMES.test(name)) {\n\t\treturn false; // check for certain invalid file names\n\t}\n\n\tif (name === '.' || name === '..') {\n\t\treturn false; // check for reserved values\n\t}\n\n\tif (isWindows && name[name.length - 1] === '.') {\n\t\treturn false; // Windows: file cannot end with a \".\"\n\t}\n\n\tif (isWindows && name.length !== name.trim().length) {\n\t\treturn false; // Windows: file cannot end with a whitespace\n\t}\n\n\tif (name.length > 255) {\n\t\treturn false; // most file systems do not allow files > 255 lenth\n\t}\n\n\treturn true;\n}\n\nexport function isEqual(pathA: string, pathB: string, ignoreCase?: boolean): boolean {\n\tconst identityEquals = (pathA === pathB);\n\tif (!ignoreCase || identityEquals) {\n\t\treturn identityEquals;\n\t}\n\n\tif (!pathA || !pathB) {\n\t\treturn false;\n\t}\n\n\treturn equalsIgnoreCase(pathA, pathB);\n}\n\nexport function isEqualOrParent(path: string, candidate: string, ignoreCase?: boolean, separator = sep): boolean {\n\tif (path === candidate) {\n\t\treturn true;\n\t}\n\n\tif (!path || !candidate) {\n\t\treturn false;\n\t}\n\n\tif (candidate.length > path.length) {\n\t\treturn false;\n\t}\n\n\tif (ignoreCase) {\n\t\tconst beginsWith = startsWithIgnoreCase(path, candidate);\n\t\tif (!beginsWith) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (candidate.length === path.length) {\n\t\t\treturn true; // same path, different casing\n\t\t}\n\n\t\tlet sepOffset = candidate.length;\n\t\tif (candidate.charAt(candidate.length - 1) === separator) {\n\t\t\tsepOffset--; // adjust the expected sep offset in case our candidate already ends in separator character\n\t\t}\n\n\t\treturn path.charAt(sepOffset) === separator;\n\t}\n\n\tif (candidate.charAt(candidate.length - 1) !== separator) {\n\t\tcandidate += separator;\n\t}\n\n\treturn path.indexOf(candidate) === 0;\n}\n\nexport function isWindowsDriveLetter(char0: number): boolean {\n\treturn char0 >= CharCode.A && char0 <= CharCode.Z || char0 >= CharCode.a && char0 <= CharCode.z;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nconst _typeof = {\n\tnumber: 'number',\n\tstring: 'string',\n\tundefined: 'undefined',\n\tobject: 'object',\n\tfunction: 'function'\n};\n\n/**\n * @returns whether the provided parameter is a JavaScript Array or not.\n */\nexport function isArray(array: any): array is any[] {\n\tif (Array.isArray) {\n\t\treturn Array.isArray(array);\n\t}\n\n\tif (array && typeof (array.length) === _typeof.number && array.constructor === Array) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * @returns whether the provided parameter is a JavaScript String or not.\n */\nexport function isString(str: any): str is string {\n\tif (typeof (str) === _typeof.string || str instanceof String) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * @returns whether the provided parameter is a JavaScript Array and each element in the array is a string.\n */\nexport function isStringArray(value: any): value is string[] {\n\treturn isArray(value) && (<any[]>value).every(elem => isString(elem));\n}\n\n/**\n *\n * @returns whether the provided parameter is of type `object` but **not**\n *\t`null`, an `array`, a `regexp`, nor a `date`.\n */\nexport function isObject(obj: any): obj is Object {\n\t// The method can't do a type cast since there are type (like strings) which\n\t// are subclasses of any put not positvely matched by the function. Hence type\n\t// narrowing results in wrong results.\n\treturn typeof obj === _typeof.object\n\t\t&& obj !== null\n\t\t&& !Array.isArray(obj)\n\t\t&& !(obj instanceof RegExp)\n\t\t&& !(obj instanceof Date);\n}\n\n/**\n * In **contrast** to just checking `typeof` this will return `false` for `NaN`.\n * @returns whether the provided parameter is a JavaScript Number or not.\n */\nexport function isNumber(obj: any): obj is number {\n\tif ((typeof (obj) === _typeof.number || obj instanceof Number) && !isNaN(obj)) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * @returns whether the provided parameter is a JavaScript Boolean or not.\n */\nexport function isBoolean(obj: any): obj is boolean {\n\treturn obj === true || obj === false;\n}\n\n/**\n * @returns whether the provided parameter is undefined.\n */\nexport function isUndefined(obj: any): obj is undefined {\n\treturn typeof (obj) === _typeof.undefined;\n}\n\n/**\n * @returns whether the provided parameter is undefined or null.\n */\nexport function isUndefinedOrNull(obj: any): obj is undefined | null {\n\treturn isUndefined(obj) || obj === null;\n}\n\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * @returns whether the provided parameter is an empty JavaScript Object or not.\n */\nexport function isEmptyObject(obj: any): obj is any {\n\tif (!isObject(obj)) {\n\t\treturn false;\n\t}\n\n\tfor (let key in obj) {\n\t\tif (hasOwnProperty.call(obj, key)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\n/**\n * @returns whether the provided parameter is a JavaScript Function or not.\n */\nexport function isFunction(obj: any): obj is Function {\n\treturn typeof obj === _typeof.function;\n}\n\n/**\n * @returns whether the provided parameters is are JavaScript Function or not.\n */\nexport function areFunctions(...objects: any[]): boolean {\n\treturn objects.length > 0 && objects.every(isFunction);\n}\n\nexport type TypeConstraint = string | Function;\n\nexport function validateConstraints(args: any[], constraints: Array<TypeConstraint | undefined>): void {\n\tconst len = Math.min(args.length, constraints.length);\n\tfor (let i = 0; i < len; i++) {\n\t\tvalidateConstraint(args[i], constraints[i]);\n\t}\n}\n\nexport function validateConstraint(arg: any, constraint: TypeConstraint | undefined): void {\n\n\tif (isString(constraint)) {\n\t\tif (typeof arg !== constraint) {\n\t\t\tthrow new Error(`argument does not match constraint: typeof ${constraint}`);\n\t\t}\n\t} else if (isFunction(constraint)) {\n\t\ttry {\n\t\t\tif (arg instanceof constraint) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} catch{\n\t\t\t// ignore\n\t\t}\n\t\tif (!isUndefinedOrNull(arg) && arg.constructor === constraint) {\n\t\t\treturn;\n\t\t}\n\t\tif (constraint.length === 1 && constraint.call(undefined, arg) === true) {\n\t\t\treturn;\n\t\t}\n\t\tthrow new Error(`argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true`);\n\t}\n}\n\n/**\n * Creates a new object of the provided class and will call the constructor with\n * any additional argument supplied.\n */\nexport function create(ctor: Function, ...args: any[]): any {\n\tif (isNativeClass(ctor)) {\n\t\treturn new (ctor as any)(...args);\n\t} else {\n\t\tconst obj = Object.create(ctor.prototype);\n\t\tctor.apply(obj, args);\n\t\treturn obj;\n\t}\n}\n\n// https://stackoverflow.com/a/32235645/1499159\nfunction isNativeClass(thing): boolean {\n\treturn typeof thing === 'function'\n\t\t&& thing.hasOwnProperty('prototype')\n\t\t&& !thing.hasOwnProperty('arguments');\n}\n\nexport function getAllPropertyNames(obj: object): string[] {\n\tlet res: string[] = [];\n\tlet proto = Object.getPrototypeOf(obj);\n\twhile (Object.prototype !== proto) {\n\t\tres = res.concat(Object.getOwnPropertyNames(proto));\n\t\tproto = Object.getPrototypeOf(proto);\n\t}\n\treturn res;\n}\n\n/**\n * Converts null to undefined, passes all other values through.\n */\nexport function withNullAsUndefined<T>(x: T | null): T | undefined {\n\treturn x === null ? undefined : x;\n}\n\n/**\n * Converts undefined to null, passes all other values through.\n */\nexport function withUndefinedAsNull<T>(x: T | undefined): T | null {\n\treturn typeof x === 'undefined' ? null : x;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isObject, isUndefinedOrNull, isArray } from 'vs/base/common/types';\n\nexport function deepClone<T>(obj: T): T {\n\tif (!obj || typeof obj !== 'object') {\n\t\treturn obj;\n\t}\n\tif (obj instanceof RegExp) {\n\t\t// See https://github.com/Microsoft/TypeScript/issues/10990\n\t\treturn obj as any;\n\t}\n\tconst result: any = Array.isArray(obj) ? [] : {};\n\tObject.keys(obj).forEach((key: string) => {\n\t\tif (obj[key] && typeof obj[key] === 'object') {\n\t\t\tresult[key] = deepClone(obj[key]);\n\t\t} else {\n\t\t\tresult[key] = obj[key];\n\t\t}\n\t});\n\treturn result;\n}\n\nexport function deepFreeze<T>(obj: T): T {\n\tif (!obj || typeof obj !== 'object') {\n\t\treturn obj;\n\t}\n\tconst stack: any[] = [obj];\n\twhile (stack.length > 0) {\n\t\tconst obj = stack.shift();\n\t\tObject.freeze(obj);\n\t\tfor (const key in obj) {\n\t\t\tif (_hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst prop = obj[key];\n\t\t\t\tif (typeof prop === 'object' && !Object.isFrozen(prop)) {\n\t\t\t\t\tstack.push(prop);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn obj;\n}\n\nconst _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport function cloneAndChange(obj: any, changer: (orig: any) => any): any {\n\treturn _cloneAndChange(obj, changer, new Set());\n}\n\nfunction _cloneAndChange(obj: any, changer: (orig: any) => any, seen: Set<any>): any {\n\tif (isUndefinedOrNull(obj)) {\n\t\treturn obj;\n\t}\n\n\tconst changed = changer(obj);\n\tif (typeof changed !== 'undefined') {\n\t\treturn changed;\n\t}\n\n\tif (isArray(obj)) {\n\t\tconst r1: any[] = [];\n\t\tfor (const e of obj) {\n\t\t\tr1.push(_cloneAndChange(e, changer, seen));\n\t\t}\n\t\treturn r1;\n\t}\n\n\tif (isObject(obj)) {\n\t\tif (seen.has(obj)) {\n\t\t\tthrow new Error('Cannot clone recursive data-structure');\n\t\t}\n\t\tseen.add(obj);\n\t\tconst r2 = {};\n\t\tfor (let i2 in obj) {\n\t\t\tif (_hasOwnProperty.call(obj, i2)) {\n\t\t\t\t(r2 as any)[i2] = _cloneAndChange(obj[i2], changer, seen);\n\t\t\t}\n\t\t}\n\t\tseen.delete(obj);\n\t\treturn r2;\n\t}\n\n\treturn obj;\n}\n\n/**\n * Copies all properties of source into destination. The optional parameter \"overwrite\" allows to control\n * if existing properties on the destination should be overwritten or not. Defaults to true (overwrite).\n */\nexport function mixin(destination: any, source: any, overwrite: boolean = true): any {\n\tif (!isObject(destination)) {\n\t\treturn source;\n\t}\n\n\tif (isObject(source)) {\n\t\tObject.keys(source).forEach(key => {\n\t\t\tif (key in destination) {\n\t\t\t\tif (overwrite) {\n\t\t\t\t\tif (isObject(destination[key]) && isObject(source[key])) {\n\t\t\t\t\t\tmixin(destination[key], source[key], overwrite);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdestination[key] = source[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdestination[key] = source[key];\n\t\t\t}\n\t\t});\n\t}\n\treturn destination;\n}\n\nexport function assign<T>(destination: T): T;\nexport function assign<T, U>(destination: T, u: U): T & U;\nexport function assign<T, U, V>(destination: T, u: U, v: V): T & U & V;\nexport function assign<T, U, V, W>(destination: T, u: U, v: V, w: W): T & U & V & W;\nexport function assign(destination: any, ...sources: any[]): any {\n\tsources.forEach(source => Object.keys(source).forEach(key => destination[key] = source[key]));\n\treturn destination;\n}\n\nexport function equals(one: any, other: any): boolean {\n\tif (one === other) {\n\t\treturn true;\n\t}\n\tif (one === null || one === undefined || other === null || other === undefined) {\n\t\treturn false;\n\t}\n\tif (typeof one !== typeof other) {\n\t\treturn false;\n\t}\n\tif (typeof one !== 'object') {\n\t\treturn false;\n\t}\n\tif ((Array.isArray(one)) !== (Array.isArray(other))) {\n\t\treturn false;\n\t}\n\n\tlet i: number;\n\tlet key: string;\n\n\tif (Array.isArray(one)) {\n\t\tif (one.length !== other.length) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (i = 0; i < one.length; i++) {\n\t\t\tif (!equals(one[i], other[i])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconst oneKeys: string[] = [];\n\n\t\tfor (key in one) {\n\t\t\toneKeys.push(key);\n\t\t}\n\t\toneKeys.sort();\n\t\tconst otherKeys: string[] = [];\n\t\tfor (key in other) {\n\t\t\totherKeys.push(key);\n\t\t}\n\t\totherKeys.sort();\n\t\tif (!equals(oneKeys, otherKeys)) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (i = 0; i < oneKeys.length; i++) {\n\t\t\tif (!equals(one[oneKeys[i]], other[oneKeys[i]])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction arrayToHash(array: string[]): { [name: string]: true } {\n\tconst result: any = {};\n\tfor (const e of array) {\n\t\tresult[e] = true;\n\t}\n\treturn result;\n}\n\n/**\n * Given an array of strings, returns a function which, given a string\n * returns true or false whether the string is in that array.\n */\nexport function createKeywordMatcher(arr: string[], caseInsensitive: boolean = false): (str: string) => boolean {\n\tif (caseInsensitive) {\n\t\tarr = arr.map(function (x) { return x.toLowerCase(); });\n\t}\n\tconst hash = arrayToHash(arr);\n\tif (caseInsensitive) {\n\t\treturn function (word) {\n\t\t\treturn hash[word.toLowerCase()] !== undefined && hash.hasOwnProperty(word.toLowerCase());\n\t\t};\n\t} else {\n\t\treturn function (word) {\n\t\t\treturn hash[word] !== undefined && hash.hasOwnProperty(word);\n\t\t};\n\t}\n}\n\n/**\n * Calls JSON.Stringify with a replacer to break apart any circular references.\n * This prevents JSON.stringify from throwing the exception\n *  \"Uncaught TypeError: Converting circular structure to JSON\"\n */\nexport function safeStringify(obj: any): string {\n\tconst seen: any[] = [];\n\treturn JSON.stringify(obj, (key, value) => {\n\t\tif (isObject(value) || Array.isArray(value)) {\n\t\t\tif (seen.indexOf(value) !== -1) {\n\t\t\t\treturn '[Circular]';\n\t\t\t} else {\n\t\t\t\tseen.push(value);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t});\n}\n\nexport function getOrDefault<T, R>(obj: T, fn: (obj: T) => R | undefined, defaultValue: R): R {\n\tconst result = fn(obj);\n\treturn typeof result === 'undefined' ? defaultValue : result;\n}\n\ntype obj = { [key: string]: any; };\n/**\n * Returns an object that has keys for each value that is different in the base object. Keys\n * that do not exist in the target but in the base object are not considered.\n *\n * Note: This is not a deep-diffing method, so the values are strictly taken into the resulting\n * object if they differ.\n *\n * @param base the object to diff against\n * @param obj the object to use for diffing\n */\nexport function distinct(base: obj, target: obj): obj {\n\tconst result = Object.create(null);\n\n\tif (!base || !target) {\n\t\treturn result;\n\t}\n\n\tconst targetKeys = Object.keys(target);\n\ttargetKeys.forEach(k => {\n\t\tconst baseValue = base[k];\n\t\tconst targetValue = target[k];\n\n\t\tif (!equals(baseValue, targetValue)) {\n\t\t\tresult[k] = targetValue;\n\t\t}\n\t});\n\n\treturn result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isWindows } from 'vs/base/common/platform';\nimport { CharCode } from 'vs/base/common/charCode';\n\nconst _schemePattern = /^\\w[\\w\\d+.-]*$/;\nconst _singleSlashStart = /^\\//;\nconst _doubleSlashStart = /^\\/\\//;\n\nlet _throwOnMissingSchema: boolean = true;\n\n/**\n * @internal\n */\nexport function setUriThrowOnMissingScheme(value: boolean): boolean {\n\tconst old = _throwOnMissingSchema;\n\t_throwOnMissingSchema = value;\n\treturn old;\n}\n\nfunction _validateUri(ret: URI, _strict?: boolean): void {\n\n\t// scheme, must be set\n\tif (!ret.scheme) {\n\t\tif (_strict || _throwOnMissingSchema) {\n\t\t\t// console.error(`[UriError]: Scheme is missing: {scheme: \"\", authority: \"${ret.authority}\", path: \"${ret.path}\", query: \"${ret.query}\", fragment: \"${ret.fragment}\"}`);\n\t\t} else {\n\t\t\tconsole.warn(`[UriError]: Scheme is missing: {scheme: \"\", authority: \"${ret.authority}\", path: \"${ret.path}\", query: \"${ret.query}\", fragment: \"${ret.fragment}\"}`);\n\t\t}\n\t}\n\n\t// scheme, https://tools.ietf.org/html/rfc3986#section-3.1\n\t// ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\n\tif (ret.scheme && !_schemePattern.test(ret.scheme)) {\n\t\tthrow new Error('[UriError]: Scheme contains illegal characters.');\n\t}\n\n\t// path, http://tools.ietf.org/html/rfc3986#section-3.3\n\t// If a URI contains an authority component, then the path component\n\t// must either be empty or begin with a slash (\"/\") character.  If a URI\n\t// does not contain an authority component, then the path cannot begin\n\t// with two slash characters (\"//\").\n\tif (ret.path) {\n\t\tif (ret.authority) {\n\t\t\tif (!_singleSlashStart.test(ret.path)) {\n\t\t\t\tthrow new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\n\t\t\t}\n\t\t} else {\n\t\t\tif (_doubleSlashStart.test(ret.path)) {\n\t\t\t\tthrow new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\n\t\t\t}\n\t\t}\n\t}\n}\n\n// for a while we allowed uris *without* schemes and this is the migration\n// for them, e.g. an uri without scheme and without strict-mode warns and falls\n// back to the file-scheme. that should cause the least carnage and still be a\n// clear warning\nfunction _schemeFix(scheme: string, _strict: boolean): string {\n\tif (_strict || _throwOnMissingSchema) {\n\t\treturn scheme || _empty;\n\t}\n\tif (!scheme) {\n\t\tconsole.trace('BAD uri lacks scheme, falling back to file-scheme.');\n\t\tscheme = 'file';\n\t}\n\treturn scheme;\n}\n\n// implements a bit of https://tools.ietf.org/html/rfc3986#section-5\nfunction _referenceResolution(scheme: string, path: string): string {\n\n\t// the slash-character is our 'default base' as we don't\n\t// support constructing URIs relative to other URIs. This\n\t// also means that we alter and potentially break paths.\n\t// see https://tools.ietf.org/html/rfc3986#section-5.1.4\n\tswitch (scheme) {\n\t\tcase 'https':\n\t\tcase 'http':\n\t\tcase 'file':\n\t\t\tif (!path) {\n\t\t\t\tpath = _slash;\n\t\t\t} else if (path[0] !== _slash) {\n\t\t\t\tpath = _slash + path;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\treturn path;\n}\n\nconst _empty = '';\nconst _slash = '/';\nconst _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\n\n/**\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\n * This class is a simple parser which creates the basic component parts\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\n * and encoding.\n *\n *       foo://example.com:8042/over/there?name=ferret#nose\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\n *        |           |            |            |        |\n *     scheme     authority       path        query   fragment\n *        |   _____________________|__\n *       / \\ /                        \\\n *       urn:example:animal:ferret:nose\n */\nexport class URI implements UriComponents {\n\n\tstatic isUri(thing: any): thing is URI {\n\t\tif (thing instanceof URI) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<URI>thing).authority === 'string'\n\t\t\t&& typeof (<URI>thing).fragment === 'string'\n\t\t\t&& typeof (<URI>thing).path === 'string'\n\t\t\t&& typeof (<URI>thing).query === 'string'\n\t\t\t&& typeof (<URI>thing).scheme === 'string'\n\t\t\t&& typeof (<URI>thing).fsPath === 'function'\n\t\t\t&& typeof (<URI>thing).with === 'function'\n\t\t\t&& typeof (<URI>thing).toString === 'function';\n\t}\n\n\t/**\n\t * scheme is the 'http' part of 'http://www.msft.com/some/path?query#fragment'.\n\t * The part before the first colon.\n\t */\n\treadonly scheme: string;\n\n\t/**\n\t * authority is the 'www.msft.com' part of 'http://www.msft.com/some/path?query#fragment'.\n\t * The part between the first double slashes and the next slash.\n\t */\n\treadonly authority: string;\n\n\t/**\n\t * path is the '/some/path' part of 'http://www.msft.com/some/path?query#fragment'.\n\t */\n\treadonly path: string;\n\n\t/**\n\t * query is the 'query' part of 'http://www.msft.com/some/path?query#fragment'.\n\t */\n\treadonly query: string;\n\n\t/**\n\t * fragment is the 'fragment' part of 'http://www.msft.com/some/path?query#fragment'.\n\t */\n\treadonly fragment: string;\n\n\t/**\n\t * @internal\n\t */\n\tprotected constructor(scheme: string, authority?: string, path?: string, query?: string, fragment?: string, _strict?: boolean);\n\n\t/**\n\t * @internal\n\t */\n\tprotected constructor(components: UriComponents);\n\n\t/**\n\t * @internal\n\t */\n\tprotected constructor(schemeOrData: string | UriComponents, authority?: string, path?: string, query?: string, fragment?: string, _strict: boolean = false) {\n\n\t\tif (typeof schemeOrData === 'object') {\n\t\t\tthis.scheme = schemeOrData.scheme || _empty;\n\t\t\tthis.authority = schemeOrData.authority || _empty;\n\t\t\tthis.path = schemeOrData.path || _empty;\n\t\t\tthis.query = schemeOrData.query || _empty;\n\t\t\tthis.fragment = schemeOrData.fragment || _empty;\n\t\t\t// no validation because it's this URI\n\t\t\t// that creates uri components.\n\t\t\t// _validateUri(this);\n\t\t} else {\n\t\t\tthis.scheme = _schemeFix(schemeOrData, _strict);\n\t\t\tthis.authority = authority || _empty;\n\t\t\tthis.path = _referenceResolution(this.scheme, path || _empty);\n\t\t\tthis.query = query || _empty;\n\t\t\tthis.fragment = fragment || _empty;\n\n\t\t\t_validateUri(this, _strict);\n\t\t}\n\t}\n\n\t// ---- filesystem path -----------------------\n\n\t/**\n\t * Returns a string representing the corresponding file system path of this URI.\n\t * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\n\t * platform specific path separator.\n\t *\n\t * * Will *not* validate the path for invalid characters and semantics.\n\t * * Will *not* look at the scheme of this URI.\n\t * * The result shall *not* be used for display purposes but for accessing a file on disk.\n\t *\n\t *\n\t * The *difference* to `URI#path` is the use of the platform specific separator and the handling\n\t * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\n\t *\n\t * ```ts\n\t\tconst u = URI.parse('file://server/c$/folder/file.txt')\n\t\tu.authority === 'server'\n\t\tu.path === '/shares/c$/file.txt'\n\t\tu.fsPath === '\\\\server\\c$\\folder\\file.txt'\n\t```\n\t *\n\t * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\n\t * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\n\t * with URIs that represent files on disk (`file` scheme).\n\t */\n\tget fsPath(): string {\n\t\t// if (this.scheme !== 'file') {\n\t\t// \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\n\t\t// }\n\t\treturn _makeFsPath(this);\n\t}\n\n\t// ---- modify to new -------------------------\n\n\tpublic with(change: { scheme?: string; authority?: string | null; path?: string | null; query?: string | null; fragment?: string | null }): URI {\n\n\t\tif (!change) {\n\t\t\treturn this;\n\t\t}\n\n\t\tlet { scheme, authority, path, query, fragment } = change;\n\t\tif (scheme === undefined) {\n\t\t\tscheme = this.scheme;\n\t\t} else if (scheme === null) {\n\t\t\tscheme = _empty;\n\t\t}\n\t\tif (authority === undefined) {\n\t\t\tauthority = this.authority;\n\t\t} else if (authority === null) {\n\t\t\tauthority = _empty;\n\t\t}\n\t\tif (path === undefined) {\n\t\t\tpath = this.path;\n\t\t} else if (path === null) {\n\t\t\tpath = _empty;\n\t\t}\n\t\tif (query === undefined) {\n\t\t\tquery = this.query;\n\t\t} else if (query === null) {\n\t\t\tquery = _empty;\n\t\t}\n\t\tif (fragment === undefined) {\n\t\t\tfragment = this.fragment;\n\t\t} else if (fragment === null) {\n\t\t\tfragment = _empty;\n\t\t}\n\n\t\tif (scheme === this.scheme\n\t\t\t&& authority === this.authority\n\t\t\t&& path === this.path\n\t\t\t&& query === this.query\n\t\t\t&& fragment === this.fragment) {\n\n\t\t\treturn this;\n\t\t}\n\n\t\treturn new _URI(scheme, authority, path, query, fragment);\n\t}\n\n\t// ---- parse & validate ------------------------\n\n\t/**\n\t * Creates a new URI from a string, e.g. `http://www.msft.com/some/path`,\n\t * `file:///usr/home`, or `scheme:with/path`.\n\t *\n\t * @param value A string which represents an URI (see `URI#toString`).\n\t */\n\tpublic static parse(value: string, _strict: boolean = false): URI {\n\t\tconst match = _regexp.exec(value);\n\t\tif (!match) {\n\t\t\treturn new _URI(_empty, _empty, _empty, _empty, _empty);\n\t\t}\n\t\treturn new _URI(\n\t\t\tmatch[2] || _empty,\n\t\t\tdecodeURIComponent(match[4] || _empty),\n\t\t\tdecodeURIComponent(match[5] || _empty),\n\t\t\tdecodeURIComponent(match[7] || _empty),\n\t\t\tdecodeURIComponent(match[9] || _empty),\n\t\t\t_strict\n\t\t);\n\t}\n\n\t/**\n\t * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\n\t * `/usr/home`, or `\\\\server\\share\\some\\path`.\n\t *\n\t * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\n\t * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\n\t * `URI.parse('file://' + path)` because the path might contain characters that are\n\t * interpreted (# and ?). See the following sample:\n\t * ```ts\n\tconst good = URI.file('/coding/c#/project1');\n\tgood.scheme === 'file';\n\tgood.path === '/coding/c#/project1';\n\tgood.fragment === '';\n\tconst bad = URI.parse('file://' + '/coding/c#/project1');\n\tbad.scheme === 'file';\n\tbad.path === '/coding/c'; // path is now broken\n\tbad.fragment === '/project1';\n\t```\n\t *\n\t * @param path A file system path (see `URI#fsPath`)\n\t */\n\tpublic static file(path: string): URI {\n\n\t\tlet authority = _empty;\n\n\t\t// normalize to fwd-slashes on windows,\n\t\t// on other systems bwd-slashes are valid\n\t\t// filename character, eg /f\\oo/ba\\r.txt\n\t\tif (isWindows) {\n\t\t\tpath = path.replace(/\\\\/g, _slash);\n\t\t}\n\n\t\t// check for authority as used in UNC shares\n\t\t// or use the path as given\n\t\tif (path[0] === _slash && path[1] === _slash) {\n\t\t\tconst idx = path.indexOf(_slash, 2);\n\t\t\tif (idx === -1) {\n\t\t\t\tauthority = path.substring(2);\n\t\t\t\tpath = _slash;\n\t\t\t} else {\n\t\t\t\tauthority = path.substring(2, idx);\n\t\t\t\tpath = path.substring(idx) || _slash;\n\t\t\t}\n\t\t}\n\n\t\treturn new _URI('file', authority, path, _empty, _empty);\n\t}\n\n\tpublic static from(components: { scheme: string; authority?: string; path?: string; query?: string; fragment?: string }): URI {\n\t\treturn new _URI(\n\t\t\tcomponents.scheme,\n\t\t\tcomponents.authority,\n\t\t\tcomponents.path,\n\t\t\tcomponents.query,\n\t\t\tcomponents.fragment,\n\t\t);\n\t}\n\n\t// ---- printing/externalize ---------------------------\n\n\t/**\n\t * Creates a string representation for this URI. It's guaranteed that calling\n\t * `URI.parse` with the result of this function creates an URI which is equal\n\t * to this URI.\n\t *\n\t * * The result shall *not* be used for display purposes but for externalization or transport.\n\t * * The result will be encoded using the percentage encoding and encoding happens mostly\n\t * ignore the scheme-specific encoding rules.\n\t *\n\t * @param skipEncoding Do not encode the result, default is `false`\n\t */\n\tpublic toString(skipEncoding: boolean = false): string {\n\t\treturn _asFormatted(this, skipEncoding);\n\t}\n\n\tpublic toJSON(): object {\n\t\treturn this;\n\t}\n\n\tstatic revive(data: UriComponents | any): URI {\n\t\tif (!data) {\n\t\t\treturn data;\n\t\t} else if (data instanceof URI) {\n\t\t\treturn data;\n\t\t} else {\n\t\t\tconst result = new _URI(data);\n\t\t\tresult._fsPath = (<UriState>data).fsPath;\n\t\t\tresult._formatted = (<UriState>data).external;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n\nexport interface UriComponents {\n\tscheme: string;\n\tauthority: string;\n\tpath: string;\n\tquery: string;\n\tfragment: string;\n}\n\ninterface UriState extends UriComponents {\n\t$mid: number;\n\tfsPath: string;\n\texternal: string;\n}\n\n\n// tslint:disable-next-line:class-name\nclass _URI extends URI {\n\n\t_formatted: string | null = null;\n\t_fsPath: string | null = null;\n\n\tget fsPath(): string {\n\t\tif (!this._fsPath) {\n\t\t\tthis._fsPath = _makeFsPath(this);\n\t\t}\n\t\treturn this._fsPath;\n\t}\n\n\tpublic toString(skipEncoding: boolean = false): string {\n\t\tif (!skipEncoding) {\n\t\t\tif (!this._formatted) {\n\t\t\t\tthis._formatted = _asFormatted(this, false);\n\t\t\t}\n\t\t\treturn this._formatted;\n\t\t} else {\n\t\t\t// we don't cache that\n\t\t\treturn _asFormatted(this, true);\n\t\t}\n\t}\n\n\ttoJSON(): object {\n\t\tconst res = <UriState>{\n\t\t\t$mid: 1\n\t\t};\n\t\t// cached state\n\t\tif (this._fsPath) {\n\t\t\tres.fsPath = this._fsPath;\n\t\t}\n\t\tif (this._formatted) {\n\t\t\tres.external = this._formatted;\n\t\t}\n\t\t// uri components\n\t\tif (this.path) {\n\t\t\tres.path = this.path;\n\t\t}\n\t\tif (this.scheme) {\n\t\t\tres.scheme = this.scheme;\n\t\t}\n\t\tif (this.authority) {\n\t\t\tres.authority = this.authority;\n\t\t}\n\t\tif (this.query) {\n\t\t\tres.query = this.query;\n\t\t}\n\t\tif (this.fragment) {\n\t\t\tres.fragment = this.fragment;\n\t\t}\n\t\treturn res;\n\t}\n}\n\n// reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\nconst encodeTable: { [ch: number]: string } = {\n\t[CharCode.Colon]: '%3A', // gen-delims\n\t[CharCode.Slash]: '%2F',\n\t[CharCode.QuestionMark]: '%3F',\n\t[CharCode.Hash]: '%23',\n\t[CharCode.OpenSquareBracket]: '%5B',\n\t[CharCode.CloseSquareBracket]: '%5D',\n\t[CharCode.AtSign]: '%40',\n\n\t[CharCode.ExclamationMark]: '%21', // sub-delims\n\t[CharCode.DollarSign]: '%24',\n\t[CharCode.Ampersand]: '%26',\n\t[CharCode.SingleQuote]: '%27',\n\t[CharCode.OpenParen]: '%28',\n\t[CharCode.CloseParen]: '%29',\n\t[CharCode.Asterisk]: '%2A',\n\t[CharCode.Plus]: '%2B',\n\t[CharCode.Comma]: '%2C',\n\t[CharCode.Semicolon]: '%3B',\n\t[CharCode.Equals]: '%3D',\n\n\t[CharCode.Space]: '%20',\n};\n\nfunction encodeURIComponentFast(uriComponent: string, allowSlash: boolean): string {\n\tlet res: string | undefined = undefined;\n\tlet nativeEncodePos = -1;\n\n\tfor (let pos = 0; pos < uriComponent.length; pos++) {\n\t\tconst code = uriComponent.charCodeAt(pos);\n\n\t\t// unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\n\t\tif (\n\t\t\t(code >= CharCode.a && code <= CharCode.z)\n\t\t\t|| (code >= CharCode.A && code <= CharCode.Z)\n\t\t\t|| (code >= CharCode.Digit0 && code <= CharCode.Digit9)\n\t\t\t|| code === CharCode.Dash\n\t\t\t|| code === CharCode.Period\n\t\t\t|| code === CharCode.Underline\n\t\t\t|| code === CharCode.Tilde\n\t\t\t|| (allowSlash && code === CharCode.Slash)\n\t\t) {\n\t\t\t// check if we are delaying native encode\n\t\t\tif (nativeEncodePos !== -1) {\n\t\t\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n\t\t\t\tnativeEncodePos = -1;\n\t\t\t}\n\t\t\t// check if we write into a new string (by default we try to return the param)\n\t\t\tif (res !== undefined) {\n\t\t\t\tres += uriComponent.charAt(pos);\n\t\t\t}\n\n\t\t} else {\n\t\t\t// encoding needed, we need to allocate a new string\n\t\t\tif (res === undefined) {\n\t\t\t\tres = uriComponent.substr(0, pos);\n\t\t\t}\n\n\t\t\t// check with default table first\n\t\t\tconst escaped = encodeTable[code];\n\t\t\tif (escaped !== undefined) {\n\n\t\t\t\t// check if we are delaying native encode\n\t\t\t\tif (nativeEncodePos !== -1) {\n\t\t\t\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n\t\t\t\t\tnativeEncodePos = -1;\n\t\t\t\t}\n\n\t\t\t\t// append escaped variant to result\n\t\t\t\tres += escaped;\n\n\t\t\t} else if (nativeEncodePos === -1) {\n\t\t\t\t// use native encode only when needed\n\t\t\t\tnativeEncodePos = pos;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (nativeEncodePos !== -1) {\n\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos));\n\t}\n\n\treturn res !== undefined ? res : uriComponent;\n}\n\nfunction encodeURIComponentMinimal(path: string): string {\n\tlet res: string | undefined = undefined;\n\tfor (let pos = 0; pos < path.length; pos++) {\n\t\tconst code = path.charCodeAt(pos);\n\t\tif (code === CharCode.Hash || code === CharCode.QuestionMark) {\n\t\t\tif (res === undefined) {\n\t\t\t\tres = path.substr(0, pos);\n\t\t\t}\n\t\t\tres += encodeTable[code];\n\t\t} else {\n\t\t\tif (res !== undefined) {\n\t\t\t\tres += path[pos];\n\t\t\t}\n\t\t}\n\t}\n\treturn res !== undefined ? res : path;\n}\n\n/**\n * Compute `fsPath` for the given uri\n */\nfunction _makeFsPath(uri: URI): string {\n\n\tlet value: string;\n\tif (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\n\t\t// unc path: file://shares/c$/far/boo\n\t\tvalue = `//${uri.authority}${uri.path}`;\n\t} else if (\n\t\turi.path.charCodeAt(0) === CharCode.Slash\n\t\t&& (uri.path.charCodeAt(1) >= CharCode.A && uri.path.charCodeAt(1) <= CharCode.Z || uri.path.charCodeAt(1) >= CharCode.a && uri.path.charCodeAt(1) <= CharCode.z)\n\t\t&& uri.path.charCodeAt(2) === CharCode.Colon\n\t) {\n\t\t// windows drive letter: file:///c:/far/boo\n\t\tvalue = uri.path[1].toLowerCase() + uri.path.substr(2);\n\t} else {\n\t\t// other path\n\t\tvalue = uri.path;\n\t}\n\tif (isWindows) {\n\t\tvalue = value.replace(/\\//g, '\\\\');\n\t}\n\treturn value;\n}\n\n/**\n * Create the external version of a uri\n */\nfunction _asFormatted(uri: URI, skipEncoding: boolean): string {\n\n\tconst encoder = !skipEncoding\n\t\t? encodeURIComponentFast\n\t\t: encodeURIComponentMinimal;\n\n\tlet res = '';\n\tlet { scheme, authority, path, query, fragment } = uri;\n\tif (scheme) {\n\t\tres += scheme;\n\t\tres += ':';\n\t}\n\tif (authority || scheme === 'file') {\n\t\tres += _slash;\n\t\tres += _slash;\n\t}\n\tif (authority) {\n\t\tlet idx = authority.indexOf('@');\n\t\tif (idx !== -1) {\n\t\t\t// <user>@<auth>\n\t\t\tconst userinfo = authority.substr(0, idx);\n\t\t\tauthority = authority.substr(idx + 1);\n\t\t\tidx = userinfo.indexOf(':');\n\t\t\tif (idx === -1) {\n\t\t\t\tres += encoder(userinfo, false);\n\t\t\t} else {\n\t\t\t\t// <user>:<pass>@<auth>\n\t\t\t\tres += encoder(userinfo.substr(0, idx), false);\n\t\t\t\tres += ':';\n\t\t\t\tres += encoder(userinfo.substr(idx + 1), false);\n\t\t\t}\n\t\t\tres += '@';\n\t\t}\n\t\tauthority = authority.toLowerCase();\n\t\tidx = authority.indexOf(':');\n\t\tif (idx === -1) {\n\t\t\tres += encoder(authority, false);\n\t\t} else {\n\t\t\t// <auth>:<port>\n\t\t\tres += encoder(authority.substr(0, idx), false);\n\t\t\tres += authority.substr(idx);\n\t\t}\n\t}\n\tif (path) {\n\t\t// lower-case windows drive letters in /C:/fff or C:/fff\n\t\tif (path.length >= 3 && path.charCodeAt(0) === CharCode.Slash && path.charCodeAt(2) === CharCode.Colon) {\n\t\t\tconst code = path.charCodeAt(1);\n\t\t\tif (code >= CharCode.A && code <= CharCode.Z) {\n\t\t\t\tpath = `/${String.fromCharCode(code + 32)}:${path.substr(3)}`; // \"/c:\".length === 3\n\t\t\t}\n\t\t} else if (path.length >= 2 && path.charCodeAt(1) === CharCode.Colon) {\n\t\t\tconst code = path.charCodeAt(0);\n\t\t\tif (code >= CharCode.A && code <= CharCode.Z) {\n\t\t\t\tpath = `${String.fromCharCode(code + 32)}:${path.substr(2)}`; // \"/c:\".length === 3\n\t\t\t}\n\t\t}\n\t\t// encode the rest of the path\n\t\tres += encoder(path, true);\n\t}\n\tif (query) {\n\t\tres += '?';\n\t\tres += encoder(query, false);\n\t}\n\tif (fragment) {\n\t\tres += '#';\n\t\tres += !skipEncoding ? encodeURIComponentFast(fragment, false) : fragment;\n\t}\n\treturn res;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\n\nexport function getPathFromAmdModule(requirefn: typeof require, relativePath: string): string {\n\treturn URI.parse(requirefn.toUrl(relativePath)).fsPath;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { Iterator, IteratorResult, FIN } from './iterator';\n\nexport function values<V = any>(set: Set<V>): V[];\nexport function values<K = any, V = any>(map: Map<K, V>): V[];\nexport function values<V>(forEachable: { forEach(callback: (value: V, ...more: any[]) => any): void }): V[] {\n\tconst result: V[] = [];\n\tforEachable.forEach(value => result.push(value));\n\treturn result;\n}\n\nexport function keys<K, V>(map: Map<K, V>): K[] {\n\tconst result: K[] = [];\n\tmap.forEach((value, key) => result.push(key));\n\n\treturn result;\n}\n\nexport function getOrSet<K, V>(map: Map<K, V>, key: K, value: V): V {\n\tlet result = map.get(key);\n\tif (result === undefined) {\n\t\tresult = value;\n\t\tmap.set(key, result);\n\t}\n\n\treturn result;\n}\n\nexport function mapToString<K, V>(map: Map<K, V>): string {\n\tconst entries: string[] = [];\n\tmap.forEach((value, key) => {\n\t\tentries.push(`${key} => ${value}`);\n\t});\n\n\treturn `Map(${map.size}) {${entries.join(', ')}}`;\n}\n\nexport function setToString<K>(set: Set<K>): string {\n\tconst entries: K[] = [];\n\tset.forEach(value => {\n\t\tentries.push(value);\n\t});\n\n\treturn `Set(${set.size}) {${entries.join(', ')}}`;\n}\n\nexport function mapToSerializable(map: Map<string, string>): [string, string][] {\n\tconst serializable: [string, string][] = [];\n\n\tmap.forEach((value, key) => {\n\t\tserializable.push([key, value]);\n\t});\n\n\treturn serializable;\n}\n\nexport function serializableToMap(serializable: [string, string][]): Map<string, string> {\n\tconst items = new Map<string, string>();\n\n\tfor (const [key, value] of serializable) {\n\t\titems.set(key, value);\n\t}\n\n\treturn items;\n}\n\nexport interface IKeyIterator {\n\treset(key: string): this;\n\tnext(): this;\n\n\thasNext(): boolean;\n\tcmp(a: string): number;\n\tvalue(): string;\n}\n\nexport class StringIterator implements IKeyIterator {\n\n\tprivate _value: string = '';\n\tprivate _pos: number = 0;\n\n\treset(key: string): this {\n\t\tthis._value = key;\n\t\tthis._pos = 0;\n\t\treturn this;\n\t}\n\n\tnext(): this {\n\t\tthis._pos += 1;\n\t\treturn this;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._pos < this._value.length - 1;\n\t}\n\n\tcmp(a: string): number {\n\t\tconst aCode = a.charCodeAt(0);\n\t\tconst thisCode = this._value.charCodeAt(this._pos);\n\t\treturn aCode - thisCode;\n\t}\n\n\tvalue(): string {\n\t\treturn this._value[this._pos];\n\t}\n}\n\nexport class PathIterator implements IKeyIterator {\n\n\tprivate _value: string;\n\tprivate _from: number;\n\tprivate _to: number;\n\n\treset(key: string): this {\n\t\tthis._value = key.replace(/\\\\$|\\/$/, '');\n\t\tthis._from = 0;\n\t\tthis._to = 0;\n\t\treturn this.next();\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._to < this._value.length;\n\t}\n\n\tnext(): this {\n\t\t// this._data = key.split(/[\\\\/]/).filter(s => !!s);\n\t\tthis._from = this._to;\n\t\tlet justSeps = true;\n\t\tfor (; this._to < this._value.length; this._to++) {\n\t\t\tconst ch = this._value.charCodeAt(this._to);\n\t\t\tif (ch === CharCode.Slash || ch === CharCode.Backslash) {\n\t\t\t\tif (justSeps) {\n\t\t\t\t\tthis._from++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjustSeps = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tcmp(a: string): number {\n\n\t\tlet aPos = 0;\n\t\tconst aLen = a.length;\n\t\tlet thisPos = this._from;\n\n\t\twhile (aPos < aLen && thisPos < this._to) {\n\t\t\tconst cmp = a.charCodeAt(aPos) - this._value.charCodeAt(thisPos);\n\t\t\tif (cmp !== 0) {\n\t\t\t\treturn cmp;\n\t\t\t}\n\t\t\taPos += 1;\n\t\t\tthisPos += 1;\n\t\t}\n\n\t\tif (aLen === this._to - this._from) {\n\t\t\treturn 0;\n\t\t} else if (aPos < aLen) {\n\t\t\treturn -1;\n\t\t} else {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\tvalue(): string {\n\t\treturn this._value.substring(this._from, this._to);\n\t}\n}\n\nclass TernarySearchTreeNode<E> {\n\tsegment: string;\n\tvalue: E | undefined;\n\tkey: string;\n\tleft: TernarySearchTreeNode<E> | undefined;\n\tmid: TernarySearchTreeNode<E> | undefined;\n\tright: TernarySearchTreeNode<E> | undefined;\n\n\tisEmpty(): boolean {\n\t\treturn !this.left && !this.mid && !this.right && !this.value;\n\t}\n}\n\nexport class TernarySearchTree<E> {\n\n\tstatic forPaths<E>(): TernarySearchTree<E> {\n\t\treturn new TernarySearchTree<E>(new PathIterator());\n\t}\n\n\tstatic forStrings<E>(): TernarySearchTree<E> {\n\t\treturn new TernarySearchTree<E>(new StringIterator());\n\t}\n\n\tprivate _iter: IKeyIterator;\n\tprivate _root: TernarySearchTreeNode<E> | undefined;\n\n\tconstructor(segments: IKeyIterator) {\n\t\tthis._iter = segments;\n\t}\n\n\tclear(): void {\n\t\tthis._root = undefined;\n\t}\n\n\tset(key: string, element: E): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node: TernarySearchTreeNode<E>;\n\n\t\tif (!this._root) {\n\t\t\tthis._root = new TernarySearchTreeNode<E>();\n\t\t\tthis._root.segment = iter.value();\n\t\t}\n\n\t\tnode = this._root;\n\t\twhile (true) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tif (!node.left) {\n\t\t\t\t\tnode.left = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.left.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.left;\n\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tif (!node.right) {\n\t\t\t\t\tnode.right = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.right.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.right;\n\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\tnode.mid = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.mid.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst oldElement = node.value;\n\t\tnode.value = element;\n\t\tnode.key = key;\n\t\treturn oldElement;\n\t}\n\n\tget(key: string): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node ? node.value : undefined;\n\t}\n\n\tdelete(key: string): void {\n\n\t\tconst iter = this._iter.reset(key);\n\t\tconst stack: [-1 | 0 | 1, TernarySearchTreeNode<E>][] = [];\n\t\tlet node = this._root;\n\n\t\t// find and unset node\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tstack.push([1, node]);\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tstack.push([-1, node]);\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tstack.push([0, node]);\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// remove element\n\t\t\t\tnode.value = undefined;\n\n\t\t\t\t// clean up empty nodes\n\t\t\t\twhile (stack.length > 0 && node.isEmpty()) {\n\t\t\t\t\tlet [dir, parent] = stack.pop()!;\n\t\t\t\t\tswitch (dir) {\n\t\t\t\t\t\tcase 1: parent.left = undefined; break;\n\t\t\t\t\t\tcase 0: parent.mid = undefined; break;\n\t\t\t\t\t\tcase -1: parent.right = undefined; break;\n\t\t\t\t\t}\n\t\t\t\t\tnode = parent;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfindSubstr(key: string): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\tlet candidate: E | undefined = undefined;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tcandidate = node.value || candidate;\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node && node.value || candidate;\n\t}\n\n\tfindSuperstr(key: string): Iterator<E> | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// collect\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn this._nodeIterator(node.mid);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate _nodeIterator(node: TernarySearchTreeNode<E>): Iterator<E> {\n\t\tlet res: { done: false; value: E; };\n\t\tlet idx: number;\n\t\tlet data: E[];\n\t\tconst next = (): IteratorResult<E> => {\n\t\t\tif (!data) {\n\t\t\t\t// lazy till first invocation\n\t\t\t\tdata = [];\n\t\t\t\tidx = 0;\n\t\t\t\tthis._forEach(node, value => data.push(value));\n\t\t\t}\n\t\t\tif (idx >= data.length) {\n\t\t\t\treturn FIN;\n\t\t\t}\n\n\t\t\tif (!res) {\n\t\t\t\tres = { done: false, value: data[idx++] };\n\t\t\t} else {\n\t\t\t\tres.value = data[idx++];\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t\treturn { next };\n\t}\n\n\tforEach(callback: (value: E, index: string) => any) {\n\t\tthis._forEach(this._root, callback);\n\t}\n\n\tprivate _forEach(node: TernarySearchTreeNode<E> | undefined, callback: (value: E, index: string) => any) {\n\t\tif (node) {\n\t\t\t// left\n\t\t\tthis._forEach(node.left, callback);\n\n\t\t\t// node\n\t\t\tif (node.value) {\n\t\t\t\t// callback(node.value, this._iter.join(parts));\n\t\t\t\tcallback(node.value, node.key);\n\t\t\t}\n\t\t\t// mid\n\t\t\tthis._forEach(node.mid, callback);\n\n\t\t\t// right\n\t\t\tthis._forEach(node.right, callback);\n\t\t}\n\t}\n}\n\nexport class ResourceMap<T> {\n\n\tprotected readonly map: Map<string, T>;\n\tprotected readonly ignoreCase?: boolean;\n\n\tconstructor() {\n\t\tthis.map = new Map<string, T>();\n\t\tthis.ignoreCase = false; // in the future this should be an uri-comparator\n\t}\n\n\tset(resource: URI, value: T): void {\n\t\tthis.map.set(this.toKey(resource), value);\n\t}\n\n\tget(resource: URI): T | undefined {\n\t\treturn this.map.get(this.toKey(resource));\n\t}\n\n\thas(resource: URI): boolean {\n\t\treturn this.map.has(this.toKey(resource));\n\t}\n\n\tget size(): number {\n\t\treturn this.map.size;\n\t}\n\n\tclear(): void {\n\t\tthis.map.clear();\n\t}\n\n\tdelete(resource: URI): boolean {\n\t\treturn this.map.delete(this.toKey(resource));\n\t}\n\n\tforEach(clb: (value: T) => void): void {\n\t\tthis.map.forEach(clb);\n\t}\n\n\tvalues(): T[] {\n\t\treturn values(this.map);\n\t}\n\n\tprivate toKey(resource: URI): string {\n\t\tlet key = resource.toString();\n\t\tif (this.ignoreCase) {\n\t\t\tkey = key.toLowerCase();\n\t\t}\n\n\t\treturn key;\n\t}\n\n\tkeys(): URI[] {\n\t\treturn keys(this.map).map(k => URI.parse(k));\n\t}\n\n\tclone(): ResourceMap<T> {\n\t\tconst resourceMap = new ResourceMap<T>();\n\n\t\tthis.map.forEach((value, key) => resourceMap.map.set(key, value));\n\n\t\treturn resourceMap;\n\t}\n}\n\n// We should fold BoundedMap and LinkedMap. See https://github.com/Microsoft/vscode/issues/28496\n\ninterface Item<K, V> {\n\tprevious: Item<K, V> | undefined;\n\tnext: Item<K, V> | undefined;\n\tkey: K;\n\tvalue: V;\n}\n\nexport const enum Touch {\n\tNone = 0,\n\tAsOld = 1,\n\tAsNew = 2\n}\n\nexport class LinkedMap<K, V> {\n\n\tprivate _map: Map<K, Item<K, V>>;\n\tprivate _head: Item<K, V> | undefined;\n\tprivate _tail: Item<K, V> | undefined;\n\tprivate _size: number;\n\n\tconstructor() {\n\t\tthis._map = new Map<K, Item<K, V>>();\n\t\tthis._head = undefined;\n\t\tthis._tail = undefined;\n\t\tthis._size = 0;\n\t}\n\n\tclear(): void {\n\t\tthis._map.clear();\n\t\tthis._head = undefined;\n\t\tthis._tail = undefined;\n\t\tthis._size = 0;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn !this._head && !this._tail;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\thas(key: K): boolean {\n\t\treturn this._map.has(key);\n\t}\n\n\tget(key: K, touch: Touch = Touch.None): V | undefined {\n\t\tconst item = this._map.get(key);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (touch !== Touch.None) {\n\t\t\tthis.touch(item, touch);\n\t\t}\n\t\treturn item.value;\n\t}\n\n\tset(key: K, value: V, touch: Touch = Touch.None): void {\n\t\tlet item = this._map.get(key);\n\t\tif (item) {\n\t\t\titem.value = value;\n\t\t\tif (touch !== Touch.None) {\n\t\t\t\tthis.touch(item, touch);\n\t\t\t}\n\t\t} else {\n\t\t\titem = { key, value, next: undefined, previous: undefined };\n\t\t\tswitch (touch) {\n\t\t\t\tcase Touch.None:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Touch.AsOld:\n\t\t\t\t\tthis.addItemFirst(item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Touch.AsNew:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._map.set(key, item);\n\t\t\tthis._size++;\n\t\t}\n\t}\n\n\tdelete(key: K): boolean {\n\t\treturn !!this.remove(key);\n\t}\n\n\tremove(key: K): V | undefined {\n\t\tconst item = this._map.get(key);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tthis._map.delete(key);\n\t\tthis.removeItem(item);\n\t\tthis._size--;\n\t\treturn item.value;\n\t}\n\n\tshift(): V | undefined {\n\t\tif (!this._head && !this._tail) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this._head || !this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t}\n\t\tconst item = this._head;\n\t\tthis._map.delete(item.key);\n\t\tthis.removeItem(item);\n\t\tthis._size--;\n\t\treturn item.value;\n\t}\n\n\tforEach(callbackfn: (value: V, key: K, map: LinkedMap<K, V>) => void, thisArg?: any): void {\n\t\tlet current = this._head;\n\t\twhile (current) {\n\t\t\tif (thisArg) {\n\t\t\t\tcallbackfn.bind(thisArg)(current.value, current.key, this);\n\t\t\t} else {\n\t\t\t\tcallbackfn(current.value, current.key, this);\n\t\t\t}\n\t\t\tcurrent = current.next;\n\t\t}\n\t}\n\n\tvalues(): V[] {\n\t\tconst result: V[] = [];\n\t\tlet current = this._head;\n\t\twhile (current) {\n\t\t\tresult.push(current.value);\n\t\t\tcurrent = current.next;\n\t\t}\n\t\treturn result;\n\t}\n\n\tkeys(): K[] {\n\t\tconst result: K[] = [];\n\t\tlet current = this._head;\n\t\twhile (current) {\n\t\t\tresult.push(current.key);\n\t\t\tcurrent = current.next;\n\t\t}\n\t\treturn result;\n\t}\n\n\t/* VS Code / Monaco editor runs on es5 which has no Symbol.iterator\n\tkeys(): IterableIterator<K> {\n\t\tconst current = this._head;\n\t\tconst iterator: IterableIterator<K> = {\n\t\t\t[Symbol.iterator]() {\n\t\t\t\treturn iterator;\n\t\t\t},\n\t\t\tnext():IteratorResult<K> {\n\t\t\t\tif (current) {\n\t\t\t\t\tconst result = { value: current.key, done: false };\n\t\t\t\t\tcurrent = current.next;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn iterator;\n\t}\n\n\tvalues(): IterableIterator<V> {\n\t\tconst current = this._head;\n\t\tconst iterator: IterableIterator<V> = {\n\t\t\t[Symbol.iterator]() {\n\t\t\t\treturn iterator;\n\t\t\t},\n\t\t\tnext():IteratorResult<V> {\n\t\t\t\tif (current) {\n\t\t\t\t\tconst result = { value: current.value, done: false };\n\t\t\t\t\tcurrent = current.next;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn iterator;\n\t}\n\t*/\n\n\tprotected trimOld(newSize: number) {\n\t\tif (newSize >= this.size) {\n\t\t\treturn;\n\t\t}\n\t\tif (newSize === 0) {\n\t\t\tthis.clear();\n\t\t\treturn;\n\t\t}\n\t\tlet current = this._head;\n\t\tlet currentSize = this.size;\n\t\twhile (current && currentSize > newSize) {\n\t\t\tthis._map.delete(current.key);\n\t\t\tcurrent = current.next;\n\t\t\tcurrentSize--;\n\t\t}\n\t\tthis._head = current;\n\t\tthis._size = currentSize;\n\t\tif (current) {\n\t\t\tcurrent.previous = undefined;\n\t\t}\n\t}\n\n\tprivate addItemFirst(item: Item<K, V>): void {\n\t\t// First time Insert\n\t\tif (!this._head && !this._tail) {\n\t\t\tthis._tail = item;\n\t\t} else if (!this._head) {\n\t\t\tthrow new Error('Invalid list');\n\t\t} else {\n\t\t\titem.next = this._head;\n\t\t\tthis._head.previous = item;\n\t\t}\n\t\tthis._head = item;\n\t}\n\n\tprivate addItemLast(item: Item<K, V>): void {\n\t\t// First time Insert\n\t\tif (!this._head && !this._tail) {\n\t\t\tthis._head = item;\n\t\t} else if (!this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t} else {\n\t\t\titem.previous = this._tail;\n\t\t\tthis._tail.next = item;\n\t\t}\n\t\tthis._tail = item;\n\t}\n\n\tprivate removeItem(item: Item<K, V>): void {\n\t\tif (item === this._head && item === this._tail) {\n\t\t\tthis._head = undefined;\n\t\t\tthis._tail = undefined;\n\t\t}\n\t\telse if (item === this._head) {\n\t\t\t// This can only happend if size === 1 which is handle\n\t\t\t// by the case above.\n\t\t\tif (!item.next) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\titem.next.previous = undefined;\n\t\t\tthis._head = item.next;\n\t\t}\n\t\telse if (item === this._tail) {\n\t\t\t// This can only happend if size === 1 which is handle\n\t\t\t// by the case above.\n\t\t\tif (!item.previous) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\titem.previous.next = undefined;\n\t\t\tthis._tail = item.previous;\n\t\t}\n\t\telse {\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\t\t\tif (!next || !previous) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\tnext.previous = previous;\n\t\t\tprevious.next = next;\n\t\t}\n\t\titem.next = undefined;\n\t\titem.previous = undefined;\n\t}\n\n\tprivate touch(item: Item<K, V>, touch: Touch): void {\n\t\tif (!this._head || !this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t}\n\t\tif ((touch !== Touch.AsOld && touch !== Touch.AsNew)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (touch === Touch.AsOld) {\n\t\t\tif (item === this._head) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\n\t\t\t// Unlink the item\n\t\t\tif (item === this._tail) {\n\t\t\t\t// previous must be defined since item was not head but is tail\n\t\t\t\t// So there are more than on item in the map\n\t\t\t\tprevious!.next = undefined;\n\t\t\t\tthis._tail = previous;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Both next and previous are not undefined since item was neither head nor tail.\n\t\t\t\tnext!.previous = previous;\n\t\t\t\tprevious!.next = next;\n\t\t\t}\n\n\t\t\t// Insert the node at head\n\t\t\titem.previous = undefined;\n\t\t\titem.next = this._head;\n\t\t\tthis._head.previous = item;\n\t\t\tthis._head = item;\n\t\t} else if (touch === Touch.AsNew) {\n\t\t\tif (item === this._tail) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\n\t\t\t// Unlink the item.\n\t\t\tif (item === this._head) {\n\t\t\t\t// next must be defined since item was not tail but is head\n\t\t\t\t// So there are more than on item in the map\n\t\t\t\tnext!.previous = undefined;\n\t\t\t\tthis._head = next;\n\t\t\t} else {\n\t\t\t\t// Both next and previous are not undefined since item was neither head nor tail.\n\t\t\t\tnext!.previous = previous;\n\t\t\t\tprevious!.next = next;\n\t\t\t}\n\t\t\titem.next = undefined;\n\t\t\titem.previous = this._tail;\n\t\t\tthis._tail.next = item;\n\t\t\tthis._tail = item;\n\t\t}\n\t}\n\n\ttoJSON(): [K, V][] {\n\t\tconst data: [K, V][] = [];\n\n\t\tthis.forEach((value, key) => {\n\t\t\tdata.push([key, value]);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tfromJSON(data: [K, V][]): void {\n\t\tthis.clear();\n\n\t\tfor (const [key, value] of data) {\n\t\t\tthis.set(key, value);\n\t\t}\n\t}\n}\n\nexport class LRUCache<K, V> extends LinkedMap<K, V> {\n\n\tprivate _limit: number;\n\tprivate _ratio: number;\n\n\tconstructor(limit: number, ratio: number = 1) {\n\t\tsuper();\n\t\tthis._limit = limit;\n\t\tthis._ratio = Math.min(Math.max(0, ratio), 1);\n\t}\n\n\tget limit(): number {\n\t\treturn this._limit;\n\t}\n\n\tset limit(limit: number) {\n\t\tthis._limit = limit;\n\t\tthis.checkTrim();\n\t}\n\n\tget ratio(): number {\n\t\treturn this._ratio;\n\t}\n\n\tset ratio(ratio: number) {\n\t\tthis._ratio = Math.min(Math.max(0, ratio), 1);\n\t\tthis.checkTrim();\n\t}\n\n\tget(key: K): V | undefined {\n\t\treturn super.get(key, Touch.AsNew);\n\t}\n\n\tpeek(key: K): V | undefined {\n\t\treturn super.get(key, Touch.None);\n\t}\n\n\tset(key: K, value: V): void {\n\t\tsuper.set(key, value, Touch.AsNew);\n\t\tthis.checkTrim();\n\t}\n\n\tprivate checkTrim() {\n\t\tif (this.size > this._limit) {\n\t\t\tthis.trimOld(Math.round(this._limit * this._ratio));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport * as strings from 'vs/base/common/strings';\nimport * as extpath from 'vs/base/common/extpath';\nimport * as paths from 'vs/base/common/path';\nimport { LRUCache } from 'vs/base/common/map';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { isThenable } from 'vs/base/common/async';\n\nexport interface IExpression {\n\t[pattern: string]: boolean | SiblingClause | any;\n}\n\nexport interface IRelativePattern {\n\tbase: string;\n\tpattern: string;\n}\n\nexport function getEmptyExpression(): IExpression {\n\treturn Object.create(null);\n}\n\nexport interface SiblingClause {\n\twhen: string;\n}\n\nconst GLOBSTAR = '**';\nconst GLOB_SPLIT = '/';\nconst PATH_REGEX = '[/\\\\\\\\]';\t\t// any slash or backslash\nconst NO_PATH_REGEX = '[^/\\\\\\\\]';\t// any non-slash and non-backslash\nconst ALL_FORWARD_SLASHES = /\\//g;\n\nfunction starsToRegExp(starCount: number): string {\n\tswitch (starCount) {\n\t\tcase 0:\n\t\t\treturn '';\n\t\tcase 1:\n\t\t\treturn `${NO_PATH_REGEX}*?`; // 1 star matches any number of characters except path separator (/ and \\) - non greedy (?)\n\t\tdefault:\n\t\t\t// Matches:  (Path Sep OR Path Val followed by Path Sep OR Path Sep followed by Path Val) 0-many times\n\t\t\t// Group is non capturing because we don't need to capture at all (?:...)\n\t\t\t// Overall we use non-greedy matching because it could be that we match too much\n\t\t\treturn `(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}|${PATH_REGEX}${NO_PATH_REGEX}+)*?`;\n\t}\n}\n\nexport function splitGlobAware(pattern: string, splitChar: string): string[] {\n\tif (!pattern) {\n\t\treturn [];\n\t}\n\n\tconst segments: string[] = [];\n\n\tlet inBraces = false;\n\tlet inBrackets = false;\n\n\tlet curVal = '';\n\tfor (const char of pattern) {\n\t\tswitch (char) {\n\t\t\tcase splitChar:\n\t\t\t\tif (!inBraces && !inBrackets) {\n\t\t\t\t\tsegments.push(curVal);\n\t\t\t\t\tcurVal = '';\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase '{':\n\t\t\t\tinBraces = true;\n\t\t\t\tbreak;\n\t\t\tcase '}':\n\t\t\t\tinBraces = false;\n\t\t\t\tbreak;\n\t\t\tcase '[':\n\t\t\t\tinBrackets = true;\n\t\t\t\tbreak;\n\t\t\tcase ']':\n\t\t\t\tinBrackets = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcurVal += char;\n\t}\n\n\t// Tail\n\tif (curVal) {\n\t\tsegments.push(curVal);\n\t}\n\n\treturn segments;\n}\n\nfunction parseRegExp(pattern: string): string {\n\tif (!pattern) {\n\t\treturn '';\n\t}\n\n\tlet regEx = '';\n\n\t// Split up into segments for each slash found\n\tconst segments = splitGlobAware(pattern, GLOB_SPLIT);\n\n\t// Special case where we only have globstars\n\tif (segments.every(s => s === GLOBSTAR)) {\n\t\tregEx = '.*';\n\t}\n\n\t// Build regex over segments\n\telse {\n\t\tlet previousSegmentWasGlobStar = false;\n\t\tsegments.forEach((segment, index) => {\n\n\t\t\t// Globstar is special\n\t\t\tif (segment === GLOBSTAR) {\n\n\t\t\t\t// if we have more than one globstar after another, just ignore it\n\t\t\t\tif (!previousSegmentWasGlobStar) {\n\t\t\t\t\tregEx += starsToRegExp(2);\n\t\t\t\t\tpreviousSegmentWasGlobStar = true;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// States\n\t\t\tlet inBraces = false;\n\t\t\tlet braceVal = '';\n\n\t\t\tlet inBrackets = false;\n\t\t\tlet bracketVal = '';\n\n\t\t\tfor (const char of segment) {\n\t\t\t\t// Support brace expansion\n\t\t\t\tif (char !== '}' && inBraces) {\n\t\t\t\t\tbraceVal += char;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Support brackets\n\t\t\t\tif (inBrackets && (char !== ']' || !bracketVal) /* ] is literally only allowed as first character in brackets to match it */) {\n\t\t\t\t\tlet res: string;\n\n\t\t\t\t\t// range operator\n\t\t\t\t\tif (char === '-') {\n\t\t\t\t\t\tres = char;\n\t\t\t\t\t}\n\n\t\t\t\t\t// negation operator (only valid on first index in bracket)\n\t\t\t\t\telse if ((char === '^' || char === '!') && !bracketVal) {\n\t\t\t\t\t\tres = '^';\n\t\t\t\t\t}\n\n\t\t\t\t\t// glob split matching is not allowed within character ranges\n\t\t\t\t\t// see http://man7.org/linux/man-pages/man7/glob.7.html\n\t\t\t\t\telse if (char === GLOB_SPLIT) {\n\t\t\t\t\t\tres = '';\n\t\t\t\t\t}\n\n\t\t\t\t\t// anything else gets escaped\n\t\t\t\t\telse {\n\t\t\t\t\t\tres = strings.escapeRegExpCharacters(char);\n\t\t\t\t\t}\n\n\t\t\t\t\tbracketVal += res;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tswitch (char) {\n\t\t\t\t\tcase '{':\n\t\t\t\t\t\tinBraces = true;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tcase '[':\n\t\t\t\t\t\tinBrackets = true;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tcase '}':\n\t\t\t\t\t\tconst choices = splitGlobAware(braceVal, ',');\n\n\t\t\t\t\t\t// Converts {foo,bar} => [foo|bar]\n\t\t\t\t\t\tconst braceRegExp = `(?:${choices.map(c => parseRegExp(c)).join('|')})`;\n\n\t\t\t\t\t\tregEx += braceRegExp;\n\n\t\t\t\t\t\tinBraces = false;\n\t\t\t\t\t\tbraceVal = '';\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ']':\n\t\t\t\t\t\tregEx += ('[' + bracketVal + ']');\n\n\t\t\t\t\t\tinBrackets = false;\n\t\t\t\t\t\tbracketVal = '';\n\n\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\tcase '?':\n\t\t\t\t\t\tregEx += NO_PATH_REGEX; // 1 ? matches any single character except path separator (/ and \\)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tcase '*':\n\t\t\t\t\t\tregEx += starsToRegExp(1);\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tregEx += strings.escapeRegExpCharacters(char);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tail: Add the slash we had split on if there is more to come and the remaining pattern is not a globstar\n\t\t\t// For example if pattern: some/**/*.js we want the \"/\" after some to be included in the RegEx to prevent\n\t\t\t// a folder called \"something\" to match as well.\n\t\t\t// However, if pattern: some/**, we tolerate that we also match on \"something\" because our globstar behaviour\n\t\t\t// is to match 0-N segments.\n\t\t\tif (index < segments.length - 1 && (segments[index + 1] !== GLOBSTAR || index + 2 < segments.length)) {\n\t\t\t\tregEx += PATH_REGEX;\n\t\t\t}\n\n\t\t\t// reset state\n\t\t\tpreviousSegmentWasGlobStar = false;\n\t\t});\n\t}\n\n\treturn regEx;\n}\n\n// regexes to check for trival glob patterns that just check for String#endsWith\nconst T1 = /^\\*\\*\\/\\*\\.[\\w\\.-]+$/; \t\t\t\t\t\t   \t\t\t// **/*.something\nconst T2 = /^\\*\\*\\/([\\w\\.-]+)\\/?$/; \t\t\t\t\t\t\t   \t\t\t// **/something\nconst T3 = /^{\\*\\*\\/[\\*\\.]?[\\w\\.-]+\\/?(,\\*\\*\\/[\\*\\.]?[\\w\\.-]+\\/?)*}$/; \t// {**/*.something,**/*.else} or {**/package.json,**/project.json}\nconst T3_2 = /^{\\*\\*\\/[\\*\\.]?[\\w\\.-]+(\\/(\\*\\*)?)?(,\\*\\*\\/[\\*\\.]?[\\w\\.-]+(\\/(\\*\\*)?)?)*}$/; \t// Like T3, with optional trailing /**\nconst T4 = /^\\*\\*((\\/[\\w\\.-]+)+)\\/?$/; \t\t\t\t\t\t   \t\t\t// **/something/else\nconst T5 = /^([\\w\\.-]+(\\/[\\w\\.-]+)*)\\/?$/; \t\t\t\t\t\t   \t\t// something/else\n\nexport type ParsedPattern = (path: string, basename?: string) => boolean;\n\n// The ParsedExpression returns a Promise iff hasSibling returns a Promise.\nexport type ParsedExpression = (path: string, basename?: string, hasSibling?: (name: string) => boolean | Promise<boolean>) => string | null | Promise<string | null> /* the matching pattern */;\n\nexport interface IGlobOptions {\n\t/**\n\t * Simplify patterns for use as exclusion filters during tree traversal to skip entire subtrees. Cannot be used outside of a tree traversal.\n\t */\n\ttrimForExclusions?: boolean;\n}\n\ninterface ParsedStringPattern {\n\t(path: string, basename: string): string | null | Promise<string | null> /* the matching pattern */;\n\tbasenames?: string[];\n\tpatterns?: string[];\n\tallBasenames?: string[];\n\tallPaths?: string[];\n}\ninterface ParsedExpressionPattern {\n\t(path: string, basename: string, name?: string, hasSibling?: (name: string) => boolean | Promise<boolean>): string | null | Promise<string | null> /* the matching pattern */;\n\trequiresSiblings?: boolean;\n\tallBasenames?: string[];\n\tallPaths?: string[];\n}\n\nconst CACHE = new LRUCache<string, ParsedStringPattern>(10000); // bounded to 10000 elements\n\nconst FALSE = function () {\n\treturn false;\n};\n\nconst NULL = function (): string | null {\n\treturn null;\n};\n\nfunction parsePattern(arg1: string | IRelativePattern, options: IGlobOptions): ParsedStringPattern {\n\tif (!arg1) {\n\t\treturn NULL;\n\t}\n\n\t// Handle IRelativePattern\n\tlet pattern: string;\n\tif (typeof arg1 !== 'string') {\n\t\tpattern = arg1.pattern;\n\t} else {\n\t\tpattern = arg1;\n\t}\n\n\t// Whitespace trimming\n\tpattern = pattern.trim();\n\n\t// Check cache\n\tconst patternKey = `${pattern}_${!!options.trimForExclusions}`;\n\tlet parsedPattern = CACHE.get(patternKey);\n\tif (parsedPattern) {\n\t\treturn wrapRelativePattern(parsedPattern, arg1);\n\t}\n\n\t// Check for Trivias\n\tlet match: RegExpExecArray | null;\n\tif (T1.test(pattern)) { // common pattern: **/*.txt just need endsWith check\n\t\tconst base = pattern.substr(4); // '**/*'.length === 4\n\t\tparsedPattern = function (path, basename) {\n\t\t\treturn typeof path === 'string' && strings.endsWith(path, base) ? pattern : null;\n\t\t};\n\t} else if (match = T2.exec(trimForExclusions(pattern, options))) { // common pattern: **/some.txt just need basename check\n\t\tparsedPattern = trivia2(match[1], pattern);\n\t} else if ((options.trimForExclusions ? T3_2 : T3).test(pattern)) { // repetition of common patterns (see above) {**/*.txt,**/*.png}\n\t\tparsedPattern = trivia3(pattern, options);\n\t} else if (match = T4.exec(trimForExclusions(pattern, options))) { // common pattern: **/something/else just need endsWith check\n\t\tparsedPattern = trivia4and5(match[1].substr(1), pattern, true);\n\t} else if (match = T5.exec(trimForExclusions(pattern, options))) { // common pattern: something/else just need equals check\n\t\tparsedPattern = trivia4and5(match[1], pattern, false);\n\t}\n\n\t// Otherwise convert to pattern\n\telse {\n\t\tparsedPattern = toRegExp(pattern);\n\t}\n\n\t// Cache\n\tCACHE.set(patternKey, parsedPattern);\n\n\treturn wrapRelativePattern(parsedPattern, arg1);\n}\n\nfunction wrapRelativePattern(parsedPattern: ParsedStringPattern, arg2: string | IRelativePattern): ParsedStringPattern {\n\tif (typeof arg2 === 'string') {\n\t\treturn parsedPattern;\n\t}\n\n\treturn function (path, basename) {\n\t\tif (!extpath.isEqualOrParent(path, arg2.base)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn parsedPattern(paths.relative(arg2.base, path), basename);\n\t};\n}\n\nfunction trimForExclusions(pattern: string, options: IGlobOptions): string {\n\treturn options.trimForExclusions && strings.endsWith(pattern, '/**') ? pattern.substr(0, pattern.length - 2) : pattern; // dropping **, tailing / is dropped later\n}\n\n// common pattern: **/some.txt just need basename check\nfunction trivia2(base: string, originalPattern: string): ParsedStringPattern {\n\tconst slashBase = `/${base}`;\n\tconst backslashBase = `\\\\${base}`;\n\tconst parsedPattern: ParsedStringPattern = function (path, basename) {\n\t\tif (typeof path !== 'string') {\n\t\t\treturn null;\n\t\t}\n\t\tif (basename) {\n\t\t\treturn basename === base ? originalPattern : null;\n\t\t}\n\t\treturn path === base || strings.endsWith(path, slashBase) || strings.endsWith(path, backslashBase) ? originalPattern : null;\n\t};\n\tconst basenames = [base];\n\tparsedPattern.basenames = basenames;\n\tparsedPattern.patterns = [originalPattern];\n\tparsedPattern.allBasenames = basenames;\n\treturn parsedPattern;\n}\n\n// repetition of common patterns (see above) {**/*.txt,**/*.png}\nfunction trivia3(pattern: string, options: IGlobOptions): ParsedStringPattern {\n\tconst parsedPatterns = aggregateBasenameMatches(pattern.slice(1, -1).split(',')\n\t\t.map(pattern => parsePattern(pattern, options))\n\t\t.filter(pattern => pattern !== NULL), pattern);\n\tconst n = parsedPatterns.length;\n\tif (!n) {\n\t\treturn NULL;\n\t}\n\tif (n === 1) {\n\t\treturn <ParsedStringPattern>parsedPatterns[0];\n\t}\n\tconst parsedPattern: ParsedStringPattern = function (path: string, basename: string) {\n\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\t\t\tif ((<ParsedStringPattern>parsedPatterns[i])(path, basename)) {\n\t\t\t\treturn pattern;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\tconst withBasenames = arrays.first(parsedPatterns, pattern => !!(<ParsedStringPattern>pattern).allBasenames);\n\tif (withBasenames) {\n\t\tparsedPattern.allBasenames = (<ParsedStringPattern>withBasenames).allBasenames;\n\t}\n\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, <string[]>[]);\n\tif (allPaths.length) {\n\t\tparsedPattern.allPaths = allPaths;\n\t}\n\treturn parsedPattern;\n}\n\n// common patterns: **/something/else just need endsWith check, something/else just needs and equals check\nfunction trivia4and5(path: string, pattern: string, matchPathEnds: boolean): ParsedStringPattern {\n\tconst nativePath = paths.sep !== paths.posix.sep ? path.replace(ALL_FORWARD_SLASHES, paths.sep) : path;\n\tconst nativePathEnd = paths.sep + nativePath;\n\tconst parsedPattern: ParsedStringPattern = matchPathEnds ? function (path, basename) {\n\t\treturn typeof path === 'string' && (path === nativePath || strings.endsWith(path, nativePathEnd)) ? pattern : null;\n\t} : function (path, basename) {\n\t\treturn typeof path === 'string' && path === nativePath ? pattern : null;\n\t};\n\tparsedPattern.allPaths = [(matchPathEnds ? '*/' : './') + path];\n\treturn parsedPattern;\n}\n\nfunction toRegExp(pattern: string): ParsedStringPattern {\n\ttry {\n\t\tconst regExp = new RegExp(`^${parseRegExp(pattern)}$`);\n\t\treturn function (path: string, basename: string) {\n\t\t\tregExp.lastIndex = 0; // reset RegExp to its initial state to reuse it!\n\t\t\treturn typeof path === 'string' && regExp.test(path) ? pattern : null;\n\t\t};\n\t} catch (error) {\n\t\treturn NULL;\n\t}\n}\n\n/**\n * Simplified glob matching. Supports a subset of glob patterns:\n * - * matches anything inside a path segment\n * - ? matches 1 character inside a path segment\n * - ** matches anything including an empty path segment\n * - simple brace expansion ({js,ts} => js or ts)\n * - character ranges (using [...])\n */\nexport function match(pattern: string | IRelativePattern, path: string): boolean;\nexport function match(expression: IExpression, path: string, hasSibling?: (name: string) => boolean): string /* the matching pattern */;\nexport function match(arg1: string | IExpression | IRelativePattern, path: string, hasSibling?: (name: string) => boolean): any {\n\tif (!arg1 || typeof path !== 'string') {\n\t\treturn false;\n\t}\n\n\treturn parse(<IExpression>arg1)(path, undefined, hasSibling);\n}\n\n/**\n * Simplified glob matching. Supports a subset of glob patterns:\n * - * matches anything inside a path segment\n * - ? matches 1 character inside a path segment\n * - ** matches anything including an empty path segment\n * - simple brace expansion ({js,ts} => js or ts)\n * - character ranges (using [...])\n */\nexport function parse(pattern: string | IRelativePattern, options?: IGlobOptions): ParsedPattern;\nexport function parse(expression: IExpression, options?: IGlobOptions): ParsedExpression;\nexport function parse(arg1: string | IExpression | IRelativePattern, options: IGlobOptions = {}): any {\n\tif (!arg1) {\n\t\treturn FALSE;\n\t}\n\n\t// Glob with String\n\tif (typeof arg1 === 'string' || isRelativePattern(arg1)) {\n\t\tconst parsedPattern = parsePattern(arg1 as string | IRelativePattern, options);\n\t\tif (parsedPattern === NULL) {\n\t\t\treturn FALSE;\n\t\t}\n\t\tconst resultPattern = function (path: string, basename: string) {\n\t\t\treturn !!parsedPattern(path, basename);\n\t\t};\n\t\tif (parsedPattern.allBasenames) {\n\t\t\t(<ParsedStringPattern><any>resultPattern).allBasenames = parsedPattern.allBasenames;\n\t\t}\n\t\tif (parsedPattern.allPaths) {\n\t\t\t(<ParsedStringPattern><any>resultPattern).allPaths = parsedPattern.allPaths;\n\t\t}\n\t\treturn resultPattern;\n\t}\n\n\t// Glob with Expression\n\treturn parsedExpression(<IExpression>arg1, options);\n}\n\nexport function hasSiblingPromiseFn(siblingsFn?: () => Promise<string[]>) {\n\tif (!siblingsFn) {\n\t\treturn undefined;\n\t}\n\n\tlet siblings: Promise<Record<string, true>>;\n\treturn (name: string) => {\n\t\tif (!siblings) {\n\t\t\tsiblings = (siblingsFn() || Promise.resolve([]))\n\t\t\t\t.then(list => list ? listToMap(list) : {});\n\t\t}\n\t\treturn siblings.then(map => !!map[name]);\n\t};\n}\n\nexport function hasSiblingFn(siblingsFn?: () => string[]) {\n\tif (!siblingsFn) {\n\t\treturn undefined;\n\t}\n\n\tlet siblings: Record<string, true>;\n\treturn (name: string) => {\n\t\tif (!siblings) {\n\t\t\tconst list = siblingsFn();\n\t\t\tsiblings = list ? listToMap(list) : {};\n\t\t}\n\t\treturn !!siblings[name];\n\t};\n}\n\nfunction listToMap(list: string[]) {\n\tconst map: Record<string, true> = {};\n\tfor (const key of list) {\n\t\tmap[key] = true;\n\t}\n\treturn map;\n}\n\nexport function isRelativePattern(obj: any): obj is IRelativePattern {\n\tconst rp = obj as IRelativePattern;\n\n\treturn rp && typeof rp.base === 'string' && typeof rp.pattern === 'string';\n}\n\n/**\n * Same as `parse`, but the ParsedExpression is guaranteed to return a Promise\n */\nexport function parseToAsync(expression: IExpression, options?: IGlobOptions): ParsedExpression {\n\tconst parsedExpression = parse(expression, options);\n\treturn (path: string, basename?: string, hasSibling?: (name: string) => boolean | Promise<boolean>): string | null | Promise<string | null> => {\n\t\tconst result = parsedExpression(path, basename, hasSibling);\n\t\treturn isThenable(result) ? result : Promise.resolve(result);\n\t};\n}\n\nexport function getBasenameTerms(patternOrExpression: ParsedPattern | ParsedExpression): string[] {\n\treturn (<ParsedStringPattern>patternOrExpression).allBasenames || [];\n}\n\nexport function getPathTerms(patternOrExpression: ParsedPattern | ParsedExpression): string[] {\n\treturn (<ParsedStringPattern>patternOrExpression).allPaths || [];\n}\n\nfunction parsedExpression(expression: IExpression, options: IGlobOptions): ParsedExpression {\n\tconst parsedPatterns = aggregateBasenameMatches(Object.getOwnPropertyNames(expression)\n\t\t.map(pattern => parseExpressionPattern(pattern, expression[pattern], options))\n\t\t.filter(pattern => pattern !== NULL));\n\n\tconst n = parsedPatterns.length;\n\tif (!n) {\n\t\treturn NULL;\n\t}\n\n\tif (!parsedPatterns.some(parsedPattern => !!(<ParsedExpressionPattern>parsedPattern).requiresSiblings)) {\n\t\tif (n === 1) {\n\t\t\treturn <ParsedStringPattern>parsedPatterns[0];\n\t\t}\n\n\t\tconst resultExpression: ParsedStringPattern = function (path: string, basename: string) {\n\t\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\t\t\t\t// Pattern matches path\n\t\t\t\tconst result = (<ParsedStringPattern>parsedPatterns[i])(path, basename);\n\t\t\t\tif (result) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t};\n\n\t\tconst withBasenames = arrays.first(parsedPatterns, pattern => !!(<ParsedStringPattern>pattern).allBasenames);\n\t\tif (withBasenames) {\n\t\t\tresultExpression.allBasenames = (<ParsedStringPattern>withBasenames).allBasenames;\n\t\t}\n\n\t\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, <string[]>[]);\n\t\tif (allPaths.length) {\n\t\t\tresultExpression.allPaths = allPaths;\n\t\t}\n\n\t\treturn resultExpression;\n\t}\n\n\tconst resultExpression: ParsedStringPattern = function (path: string, basename: string, hasSibling?: (name: string) => boolean | Promise<boolean>) {\n\t\tlet name: string | undefined = undefined;\n\n\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\t\t\t// Pattern matches path\n\t\t\tconst parsedPattern = (<ParsedExpressionPattern>parsedPatterns[i]);\n\t\t\tif (parsedPattern.requiresSiblings && hasSibling) {\n\t\t\t\tif (!basename) {\n\t\t\t\t\tbasename = paths.basename(path);\n\t\t\t\t}\n\t\t\t\tif (!name) {\n\t\t\t\t\tname = basename.substr(0, basename.length - paths.extname(path).length);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst result = parsedPattern(path, basename, name, hasSibling);\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tconst withBasenames = arrays.first(parsedPatterns, pattern => !!(<ParsedStringPattern>pattern).allBasenames);\n\tif (withBasenames) {\n\t\tresultExpression.allBasenames = (<ParsedStringPattern>withBasenames).allBasenames;\n\t}\n\n\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, <string[]>[]);\n\tif (allPaths.length) {\n\t\tresultExpression.allPaths = allPaths;\n\t}\n\n\treturn resultExpression;\n}\n\nfunction parseExpressionPattern(pattern: string, value: any, options: IGlobOptions): (ParsedStringPattern | ParsedExpressionPattern) {\n\tif (value === false) {\n\t\treturn NULL; // pattern is disabled\n\t}\n\n\tconst parsedPattern = parsePattern(pattern, options);\n\tif (parsedPattern === NULL) {\n\t\treturn NULL;\n\t}\n\n\t// Expression Pattern is <boolean>\n\tif (typeof value === 'boolean') {\n\t\treturn parsedPattern;\n\t}\n\n\t// Expression Pattern is <SiblingClause>\n\tif (value) {\n\t\tconst when = (<SiblingClause>value).when;\n\t\tif (typeof when === 'string') {\n\t\t\tconst result: ParsedExpressionPattern = (path: string, basename: string, name: string, hasSibling: (name: string) => boolean | Promise<boolean>) => {\n\t\t\t\tif (!hasSibling || !parsedPattern(path, basename)) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst clausePattern = when.replace('$(basename)', name);\n\t\t\t\tconst matched = hasSibling(clausePattern);\n\t\t\t\treturn isThenable(matched) ?\n\t\t\t\t\tmatched.then(m => m ? pattern : null) :\n\t\t\t\t\tmatched ? pattern : null;\n\t\t\t};\n\t\t\tresult.requiresSiblings = true;\n\t\t\treturn result;\n\t\t}\n\t}\n\n\t// Expression is Anything\n\treturn parsedPattern;\n}\n\nfunction aggregateBasenameMatches(parsedPatterns: Array<ParsedStringPattern | ParsedExpressionPattern>, result?: string): Array<ParsedStringPattern | ParsedExpressionPattern> {\n\tconst basenamePatterns = parsedPatterns.filter(parsedPattern => !!(<ParsedStringPattern>parsedPattern).basenames);\n\tif (basenamePatterns.length < 2) {\n\t\treturn parsedPatterns;\n\t}\n\n\tconst basenames = basenamePatterns.reduce<string[]>((all, current) => {\n\t\tconst basenames = (<ParsedStringPattern>current).basenames;\n\t\treturn basenames ? all.concat(basenames) : all;\n\t}, <string[]>[]);\n\tlet patterns: string[];\n\tif (result) {\n\t\tpatterns = [];\n\t\tfor (let i = 0, n = basenames.length; i < n; i++) {\n\t\t\tpatterns.push(result);\n\t\t}\n\t} else {\n\t\tpatterns = basenamePatterns.reduce((all, current) => {\n\t\t\tconst patterns = (<ParsedStringPattern>current).patterns;\n\t\t\treturn patterns ? all.concat(patterns) : all;\n\t\t}, <string[]>[]);\n\t}\n\tconst aggregate: ParsedStringPattern = function (path, basename) {\n\t\tif (typeof path !== 'string') {\n\t\t\treturn null;\n\t\t}\n\t\tif (!basename) {\n\t\t\tlet i: number;\n\t\t\tfor (i = path.length; i > 0; i--) {\n\t\t\t\tconst ch = path.charCodeAt(i - 1);\n\t\t\t\tif (ch === CharCode.Slash || ch === CharCode.Backslash) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbasename = path.substr(i);\n\t\t}\n\t\tconst index = basenames.indexOf(basename);\n\t\treturn index !== -1 ? patterns[index] : null;\n\t};\n\taggregate.basenames = basenames;\n\taggregate.patterns = patterns;\n\taggregate.allBasenames = basenames;\n\n\tconst aggregatedPatterns = parsedPatterns.filter(parsedPattern => !(<ParsedStringPattern>parsedPattern).basenames);\n\taggregatedPatterns.push(aggregate);\n\treturn aggregatedPatterns;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { LRUCache } from 'vs/base/common/map';\n\n/**\n * The normalize() method returns the Unicode Normalization Form of a given string. The form will be\n * the Normalization Form Canonical Composition.\n *\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize}\n */\nexport const canNormalize = typeof ((<any>'').normalize) === 'function';\n\nconst nfcCache = new LRUCache<string, string>(10000); // bounded to 10000 elements\nexport function normalizeNFC(str: string): string {\n\treturn normalize(str, 'NFC', nfcCache);\n}\n\nconst nfdCache = new LRUCache<string, string>(10000); // bounded to 10000 elements\nexport function normalizeNFD(str: string): string {\n\treturn normalize(str, 'NFD', nfdCache);\n}\n\nconst nonAsciiCharactersPattern = /[^\\u0000-\\u0080]/;\nfunction normalize(str: string, form: string, normalizedCache: LRUCache<string, string>): string {\n\tif (!canNormalize || !str) {\n\t\treturn str;\n\t}\n\n\tconst cached = normalizedCache.get(str);\n\tif (cached) {\n\t\treturn cached;\n\t}\n\n\tlet res: string;\n\tif (nonAsciiCharactersPattern.test(str)) {\n\t\tres = (<any>str).normalize(form);\n\t} else {\n\t\tres = str;\n\t}\n\n\t// Use the cache for fast lookup\n\tnormalizedCache.set(str, res);\n\n\treturn res;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as extpath from 'vs/base/common/extpath';\nimport * as paths from 'vs/base/common/path';\nimport { URI } from 'vs/base/common/uri';\nimport { equalsIgnoreCase } from 'vs/base/common/strings';\nimport { Schemas } from 'vs/base/common/network';\nimport { isLinux, isWindows } from 'vs/base/common/platform';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { ParsedExpression, IExpression, parse } from 'vs/base/common/glob';\nimport { TernarySearchTree } from 'vs/base/common/map';\n\nexport function getComparisonKey(resource: URI): string {\n\treturn hasToIgnoreCase(resource) ? resource.toString().toLowerCase() : resource.toString();\n}\n\nexport function hasToIgnoreCase(resource: URI | undefined): boolean {\n\t// A file scheme resource is in the same platform as code, so ignore case for non linux platforms\n\t// Resource can be from another platform. Lowering the case as an hack. Should come from File system provider\n\treturn resource && resource.scheme === Schemas.file ? !isLinux : true;\n}\n\nexport function basenameOrAuthority(resource: URI): string {\n\treturn basename(resource) || resource.authority;\n}\n\n/**\n * Tests whether a `candidate` URI is a parent or equal of a given `base` URI.\n * @param base A uri which is \"longer\"\n * @param parentCandidate A uri which is \"shorter\" then `base`\n */\nexport function isEqualOrParent(base: URI, parentCandidate: URI, ignoreCase = hasToIgnoreCase(base)): boolean {\n\tif (base.scheme === parentCandidate.scheme) {\n\t\tif (base.scheme === Schemas.file) {\n\t\t\treturn extpath.isEqualOrParent(originalFSPath(base), originalFSPath(parentCandidate), ignoreCase);\n\t\t}\n\t\tif (isEqualAuthority(base.authority, parentCandidate.authority)) {\n\t\t\treturn extpath.isEqualOrParent(base.path, parentCandidate.path, ignoreCase, '/');\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * Tests wheter the two authorities are the same\n */\nexport function isEqualAuthority(a1: string, a2: string) {\n\treturn a1 === a2 || equalsIgnoreCase(a1, a2);\n}\n\nexport function isEqual(first: URI | undefined, second: URI | undefined, ignoreCase = hasToIgnoreCase(first)): boolean {\n\tif (first === second) {\n\t\treturn true;\n\t}\n\n\tif (!first || !second) {\n\t\treturn false;\n\t}\n\n\tif (first.scheme !== second.scheme || !isEqualAuthority(first.authority, second.authority)) {\n\t\treturn false;\n\t}\n\n\tconst p1 = first.path || '/', p2 = second.path || '/';\n\treturn p1 === p2 || ignoreCase && equalsIgnoreCase(p1 || '/', p2 || '/');\n}\n\nexport function basename(resource: URI): string {\n\treturn paths.posix.basename(resource.path);\n}\n\nexport function extname(resource: URI): string {\n\treturn paths.posix.extname(resource.path);\n}\n\n/**\n * Return a URI representing the directory of a URI path.\n *\n * @param resource The input URI.\n * @returns The URI representing the directory of the input URI.\n */\nexport function dirname(resource: URI): URI {\n\tif (resource.path.length === 0) {\n\t\treturn resource;\n\t}\n\tif (resource.scheme === Schemas.file) {\n\t\treturn URI.file(paths.dirname(originalFSPath(resource)));\n\t}\n\tlet dirname = paths.posix.dirname(resource.path);\n\tif (resource.authority && dirname.length && dirname.charCodeAt(0) !== CharCode.Slash) {\n\t\tconsole.error(`dirname(\"${resource.toString})) resulted in a relative path`);\n\t\tdirname = '/'; // If a URI contains an authority component, then the path component must either be empty or begin with a CharCode.Slash (\"/\") character\n\t}\n\treturn resource.with({\n\t\tpath: dirname\n\t});\n}\n\n/**\n * Join a URI path with path fragments and normalizes the resulting path.\n *\n * @param resource The input URI.\n * @param pathFragment The path fragment to add to the URI path.\n * @returns The resulting URI.\n */\nexport function joinPath(resource: URI, ...pathFragment: string[]): URI {\n\tlet joinedPath: string;\n\tif (resource.scheme === Schemas.file) {\n\t\tjoinedPath = URI.file(paths.join(originalFSPath(resource), ...pathFragment)).path;\n\t} else {\n\t\tjoinedPath = paths.posix.join(resource.path || '/', ...pathFragment);\n\t}\n\treturn resource.with({\n\t\tpath: joinedPath\n\t});\n}\n\n/**\n * Normalizes the path part of a URI: Resolves `.` and `..` elements with directory names.\n *\n * @param resource The URI to normalize the path.\n * @returns The URI with the normalized path.\n */\nexport function normalizePath(resource: URI): URI {\n\tif (!resource.path.length) {\n\t\treturn resource;\n\t}\n\tlet normalizedPath: string;\n\tif (resource.scheme === Schemas.file) {\n\t\tnormalizedPath = URI.file(paths.normalize(originalFSPath(resource))).path;\n\t} else {\n\t\tnormalizedPath = paths.posix.normalize(resource.path);\n\t}\n\treturn resource.with({\n\t\tpath: normalizedPath\n\t});\n}\n\n/**\n * Returns the fsPath of an URI where the drive letter is not normalized.\n * See #56403.\n */\nexport function originalFSPath(uri: URI): string {\n\tlet value: string;\n\tconst uriPath = uri.path;\n\tif (uri.authority && uriPath.length > 1 && uri.scheme === 'file') {\n\t\t// unc path: file://shares/c$/far/boo\n\t\tvalue = `//${uri.authority}${uriPath}`;\n\t} else if (\n\t\tisWindows\n\t\t&& uriPath.charCodeAt(0) === CharCode.Slash\n\t\t&& extpath.isWindowsDriveLetter(uriPath.charCodeAt(1))\n\t\t&& uriPath.charCodeAt(2) === CharCode.Colon\n\t) {\n\t\tvalue = uriPath.substr(1);\n\t} else {\n\t\t// other path\n\t\tvalue = uriPath;\n\t}\n\tif (isWindows) {\n\t\tvalue = value.replace(/\\//g, '\\\\');\n\t}\n\treturn value;\n}\n\n/**\n * Returns true if the URI path is absolute.\n */\nexport function isAbsolutePath(resource: URI): boolean {\n\treturn !!resource.path && resource.path[0] === '/';\n}\n\n/**\n * Returns true if the URI path has a trailing path separator\n */\nexport function hasTrailingPathSeparator(resource: URI): boolean {\n\tif (resource.scheme === Schemas.file) {\n\t\tconst fsp = originalFSPath(resource);\n\t\treturn fsp.length > extpath.getRoot(fsp).length && fsp[fsp.length - 1] === paths.sep;\n\t} else {\n\t\tconst p = resource.path;\n\t\treturn p.length > 1 && p.charCodeAt(p.length - 1) === CharCode.Slash; // ignore the slash at offset 0\n\t}\n}\n\n\n/**\n * Removes a trailing path seperator, if theres one.\n * Important: Doesn't remove the first slash, it would make the URI invalid\n */\nexport function removeTrailingPathSeparator(resource: URI): URI {\n\tif (hasTrailingPathSeparator(resource)) {\n\t\treturn resource.with({ path: resource.path.substr(0, resource.path.length - 1) });\n\t}\n\treturn resource;\n}\n\n\n/**\n * Returns a relative path between two URIs. If the URIs don't have the same schema or authority, `undefined` is returned.\n * The returned relative path always uses forward slashes.\n */\nexport function relativePath(from: URI, to: URI): string | undefined {\n\tif (from.scheme !== to.scheme || !isEqualAuthority(from.authority, to.authority)) {\n\t\treturn undefined;\n\t}\n\tif (from.scheme === Schemas.file) {\n\t\tconst relativePath = paths.relative(from.path, to.path);\n\t\treturn isWindows ? extpath.toSlashes(relativePath) : relativePath;\n\t}\n\treturn paths.posix.relative(from.path || '/', to.path || '/');\n}\n\n/**\n * Resolves a absolute or relative path against a base URI.\n */\nexport function resolvePath(base: URI, path: string): URI {\n\tlet resolvedPath: string;\n\tif (base.scheme === Schemas.file) {\n\t\tresolvedPath = URI.file(paths.resolve(originalFSPath(base), path)).path;\n\t} else {\n\t\tresolvedPath = paths.posix.resolve(base.path, path);\n\t}\n\treturn base.with({\n\t\tpath: resolvedPath\n\t});\n}\n\nexport function distinctParents<T>(items: T[], resourceAccessor: (item: T) => URI): T[] {\n\tconst distinctParents: T[] = [];\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst candidateResource = resourceAccessor(items[i]);\n\t\tif (items.some((otherItem, index) => {\n\t\t\tif (index === i) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn isEqualOrParent(candidateResource, resourceAccessor(otherItem));\n\t\t})) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tdistinctParents.push(items[i]);\n\t}\n\n\treturn distinctParents;\n}\n\n/**\n * Data URI related helpers.\n */\nexport namespace DataUri {\n\n\texport const META_DATA_LABEL = 'label';\n\texport const META_DATA_DESCRIPTION = 'description';\n\texport const META_DATA_SIZE = 'size';\n\texport const META_DATA_MIME = 'mime';\n\n\texport function parseMetaData(dataUri: URI): Map<string, string> {\n\t\tconst metadata = new Map<string, string>();\n\n\t\t// Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\n\t\t// the metadata is: size:2313;label:SomeLabel;description:SomeDescription\n\t\tconst meta = dataUri.path.substring(dataUri.path.indexOf(';') + 1, dataUri.path.lastIndexOf(';'));\n\t\tmeta.split(';').forEach(property => {\n\t\t\tconst [key, value] = property.split(':');\n\t\t\tif (key && value) {\n\t\t\t\tmetadata.set(key, value);\n\t\t\t}\n\t\t});\n\n\t\t// Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\n\t\t// the mime is: image/png\n\t\tconst mime = dataUri.path.substring(0, dataUri.path.indexOf(';'));\n\t\tif (mime) {\n\t\t\tmetadata.set(META_DATA_MIME, mime);\n\t\t}\n\n\t\treturn metadata;\n\t}\n}\n\n\nexport class ResourceGlobMatcher {\n\n\tprivate readonly globalExpression: ParsedExpression;\n\tprivate readonly expressionsByRoot: TernarySearchTree<{ root: URI, expression: ParsedExpression }> = TernarySearchTree.forPaths<{ root: URI, expression: ParsedExpression }>();\n\n\tconstructor(\n\t\tglobalExpression: IExpression,\n\t\trootExpressions: { root: URI, expression: IExpression }[]\n\t) {\n\t\tthis.globalExpression = parse(globalExpression);\n\t\tfor (const expression of rootExpressions) {\n\t\t\tthis.expressionsByRoot.set(expression.root.toString(), { root: expression.root, expression: parse(expression.expression) });\n\t\t}\n\t}\n\n\tmatches(resource: URI): boolean {\n\t\tconst rootExpression = this.expressionsByRoot.findSubstr(resource.toString());\n\t\tif (rootExpression) {\n\t\t\tconst path = relativePath(rootExpression.root, resource);\n\t\t\tif (path && !!rootExpression.expression(path)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn !!this.globalExpression(resource.path);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport { sep, posix, normalize } from 'vs/base/common/path';\nimport { endsWith, ltrim, startsWithIgnoreCase, rtrim, startsWith } from 'vs/base/common/strings';\nimport { Schemas } from 'vs/base/common/network';\nimport { isLinux, isWindows, isMacintosh } from 'vs/base/common/platform';\nimport { isEqual, basename } from 'vs/base/common/resources';\nimport { CharCode } from 'vs/base/common/charCode';\n\nexport interface IWorkspaceFolderProvider {\n\tgetWorkspaceFolder(resource: URI): { uri: URI, name?: string } | null;\n\tgetWorkspace(): {\n\t\tfolders: { uri: URI, name?: string }[];\n\t};\n}\n\nexport interface IUserHomeProvider {\n\tuserHome: string;\n}\n\n/**\n * @deprecated use LabelService instead\n */\nexport function getPathLabel(resource: URI | string, userHomeProvider?: IUserHomeProvider, rootProvider?: IWorkspaceFolderProvider): string {\n\tif (typeof resource === 'string') {\n\t\tresource = URI.file(resource);\n\t}\n\n\t// return early if we can resolve a relative path label from the root\n\tif (rootProvider) {\n\t\tconst baseResource = rootProvider.getWorkspaceFolder(resource);\n\t\tif (baseResource) {\n\t\t\tconst hasMultipleRoots = rootProvider.getWorkspace().folders.length > 1;\n\n\t\t\tlet pathLabel: string;\n\t\t\tif (isEqual(baseResource.uri, resource)) {\n\t\t\t\tpathLabel = ''; // no label if paths are identical\n\t\t\t} else {\n\t\t\t\t// TODO: isidor use resources.relative\n\t\t\t\tpathLabel = normalize(ltrim(resource.path.substr(baseResource.uri.path.length), posix.sep)!);\n\t\t\t}\n\n\t\t\tif (hasMultipleRoots) {\n\t\t\t\tconst rootName = (baseResource && baseResource.name) ? baseResource.name : basename(baseResource.uri);\n\t\t\t\tpathLabel = pathLabel ? (rootName + '  ' + pathLabel) : rootName; // always show root basename if there are multiple\n\t\t\t}\n\n\t\t\treturn pathLabel;\n\t\t}\n\t}\n\n\t// return if the resource is neither file:// nor untitled:// and no baseResource was provided\n\tif (resource.scheme !== Schemas.file && resource.scheme !== Schemas.untitled) {\n\t\treturn resource.with({ query: null, fragment: null }).toString(true);\n\t}\n\n\t// convert c:\\something => C:\\something\n\tif (hasDriveLetter(resource.fsPath)) {\n\t\treturn normalize(normalizeDriveLetter(resource.fsPath));\n\t}\n\n\t// normalize and tildify (macOS, Linux only)\n\tlet res = normalize(resource.fsPath);\n\tif (!isWindows && userHomeProvider) {\n\t\tres = tildify(res, userHomeProvider.userHome);\n\t}\n\n\treturn res;\n}\n\nexport function getBaseLabel(resource: URI | string): string;\nexport function getBaseLabel(resource: URI | string | undefined): string | undefined;\nexport function getBaseLabel(resource: URI | string | undefined): string | undefined {\n\tif (!resource) {\n\t\treturn undefined;\n\t}\n\n\tif (typeof resource === 'string') {\n\t\tresource = URI.file(resource);\n\t}\n\n\tconst base = basename(resource) || (resource.scheme === Schemas.file ? resource.fsPath : resource.path) /* can be empty string if '/' is passed in */;\n\n\t// convert c: => C:\n\tif (hasDriveLetter(base)) {\n\t\treturn normalizeDriveLetter(base);\n\t}\n\n\treturn base;\n}\n\nfunction hasDriveLetter(path: string): boolean {\n\treturn !!(isWindows && path && path[1] === ':');\n}\n\nexport function normalizeDriveLetter(path: string): string {\n\tif (hasDriveLetter(path)) {\n\t\treturn path.charAt(0).toUpperCase() + path.slice(1);\n\t}\n\n\treturn path;\n}\n\nlet normalizedUserHomeCached: { original: string; normalized: string } = Object.create(null);\nexport function tildify(path: string, userHome: string): string {\n\tif (isWindows || !path || !userHome) {\n\t\treturn path; // unsupported\n\t}\n\n\t// Keep a normalized user home path as cache to prevent accumulated string creation\n\tlet normalizedUserHome = normalizedUserHomeCached.original === userHome ? normalizedUserHomeCached.normalized : undefined;\n\tif (!normalizedUserHome) {\n\t\tnormalizedUserHome = `${rtrim(userHome, posix.sep)}${posix.sep}`;\n\t\tnormalizedUserHomeCached = { original: userHome, normalized: normalizedUserHome };\n\t}\n\n\t// Linux: case sensitive, macOS: case insensitive\n\tif (isLinux ? startsWith(path, normalizedUserHome) : startsWithIgnoreCase(path, normalizedUserHome)) {\n\t\tpath = `~/${path.substr(normalizedUserHome.length)}`;\n\t}\n\n\treturn path;\n}\n\nexport function untildify(path: string, userHome: string): string {\n\treturn path.replace(/^~($|\\/|\\\\)/, `${userHome}$1`);\n}\n\n/**\n * Shortens the paths but keeps them easy to distinguish.\n * Replaces not important parts with ellipsis.\n * Every shorten path matches only one original path and vice versa.\n *\n * Algorithm for shortening paths is as follows:\n * 1. For every path in list, find unique substring of that path.\n * 2. Unique substring along with ellipsis is shortened path of that path.\n * 3. To find unique substring of path, consider every segment of length from 1 to path.length of path from end of string\n *    and if present segment is not substring to any other paths then present segment is unique path,\n *    else check if it is not present as suffix of any other path and present segment is suffix of path itself,\n *    if it is true take present segment as unique path.\n * 4. Apply ellipsis to unique segment according to whether segment is present at start/in-between/end of path.\n *\n * Example 1\n * 1. consider 2 paths i.e. ['a\\\\b\\\\c\\\\d', 'a\\\\f\\\\b\\\\c\\\\d']\n * 2. find unique path of first path,\n * \ta. 'd' is present in path2 and is suffix of path2, hence not unique of present path.\n * \tb. 'c' is present in path2 and 'c' is not suffix of present path, similarly for 'b' and 'a' also.\n * \tc. 'd\\\\c' is suffix of path2.\n *  d. 'b\\\\c' is not suffix of present path.\n *  e. 'a\\\\b' is not present in path2, hence unique path is 'a\\\\b...'.\n * 3. for path2, 'f' is not present in path1 hence unique is '...\\\\f\\\\...'.\n *\n * Example 2\n * 1. consider 2 paths i.e. ['a\\\\b', 'a\\\\b\\\\c'].\n * \ta. Even if 'b' is present in path2, as 'b' is suffix of path1 and is not suffix of path2, unique path will be '...\\\\b'.\n * 2. for path2, 'c' is not present in path1 hence unique path is '..\\\\c'.\n */\nconst ellipsis = '\\u2026';\nconst unc = '\\\\\\\\';\nconst home = '~';\nexport function shorten(paths: string[]): string[] {\n\tconst shortenedPaths: string[] = new Array(paths.length);\n\n\t// for every path\n\tlet match = false;\n\tfor (let pathIndex = 0; pathIndex < paths.length; pathIndex++) {\n\t\tlet path = paths[pathIndex];\n\n\t\tif (path === '') {\n\t\t\tshortenedPaths[pathIndex] = `.${sep}`;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!path) {\n\t\t\tshortenedPaths[pathIndex] = path;\n\t\t\tcontinue;\n\t\t}\n\n\t\tmatch = true;\n\n\t\t// trim for now and concatenate unc path (e.g. \\\\network) or root path (/etc, ~/etc) later\n\t\tlet prefix = '';\n\t\tif (path.indexOf(unc) === 0) {\n\t\t\tprefix = path.substr(0, path.indexOf(unc) + unc.length);\n\t\t\tpath = path.substr(path.indexOf(unc) + unc.length);\n\t\t} else if (path.indexOf(sep) === 0) {\n\t\t\tprefix = path.substr(0, path.indexOf(sep) + sep.length);\n\t\t\tpath = path.substr(path.indexOf(sep) + sep.length);\n\t\t} else if (path.indexOf(home) === 0) {\n\t\t\tprefix = path.substr(0, path.indexOf(home) + home.length);\n\t\t\tpath = path.substr(path.indexOf(home) + home.length);\n\t\t}\n\n\t\t// pick the first shortest subpath found\n\t\tconst segments: string[] = path.split(sep);\n\t\tfor (let subpathLength = 1; match && subpathLength <= segments.length; subpathLength++) {\n\t\t\tfor (let start = segments.length - subpathLength; match && start >= 0; start--) {\n\t\t\t\tmatch = false;\n\t\t\t\tlet subpath = segments.slice(start, start + subpathLength).join(sep);\n\n\t\t\t\t// that is unique to any other path\n\t\t\t\tfor (let otherPathIndex = 0; !match && otherPathIndex < paths.length; otherPathIndex++) {\n\n\t\t\t\t\t// suffix subpath treated specially as we consider no match 'x' and 'x/...'\n\t\t\t\t\tif (otherPathIndex !== pathIndex && paths[otherPathIndex] && paths[otherPathIndex].indexOf(subpath) > -1) {\n\t\t\t\t\t\tconst isSubpathEnding: boolean = (start + subpathLength === segments.length);\n\n\t\t\t\t\t\t// Adding separator as prefix for subpath, such that 'endsWith(src, trgt)' considers subpath as directory name instead of plain string.\n\t\t\t\t\t\t// prefix is not added when either subpath is root directory or path[otherPathIndex] does not have multiple directories.\n\t\t\t\t\t\tconst subpathWithSep: string = (start > 0 && paths[otherPathIndex].indexOf(sep) > -1) ? sep + subpath : subpath;\n\t\t\t\t\t\tconst isOtherPathEnding: boolean = endsWith(paths[otherPathIndex], subpathWithSep);\n\n\t\t\t\t\t\tmatch = !isSubpathEnding || isOtherPathEnding;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// found unique subpath\n\t\t\t\tif (!match) {\n\t\t\t\t\tlet result = '';\n\n\t\t\t\t\t// preserve disk drive or root prefix\n\t\t\t\t\tif (endsWith(segments[0], ':') || prefix !== '') {\n\t\t\t\t\t\tif (start === 1) {\n\t\t\t\t\t\t\t// extend subpath to include disk drive prefix\n\t\t\t\t\t\t\tstart = 0;\n\t\t\t\t\t\t\tsubpathLength++;\n\t\t\t\t\t\t\tsubpath = segments[0] + sep + subpath;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (start > 0) {\n\t\t\t\t\t\t\tresult = segments[0] + sep;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult = prefix + result;\n\t\t\t\t\t}\n\n\t\t\t\t\t// add ellipsis at the beginning if neeeded\n\t\t\t\t\tif (start > 0) {\n\t\t\t\t\t\tresult = result + ellipsis + sep;\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = result + subpath;\n\n\t\t\t\t\t// add ellipsis at the end if needed\n\t\t\t\t\tif (start + subpathLength < segments.length) {\n\t\t\t\t\t\tresult = result + sep + ellipsis;\n\t\t\t\t\t}\n\n\t\t\t\t\tshortenedPaths[pathIndex] = result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (match) {\n\t\t\tshortenedPaths[pathIndex] = path; // use full path if no unique subpaths found\n\t\t}\n\t}\n\n\treturn shortenedPaths;\n}\n\nexport interface ISeparator {\n\tlabel: string;\n}\n\nenum Type {\n\tTEXT,\n\tVARIABLE,\n\tSEPARATOR\n}\n\ninterface ISegment {\n\tvalue: string;\n\ttype: Type;\n}\n\n/**\n * Helper to insert values for specific template variables into the string. E.g. \"this $(is) a $(template)\" can be\n * passed to this function together with an object that maps \"is\" and \"template\" to strings to have them replaced.\n * @param value string to which templating is applied\n * @param values the values of the templates to use\n */\nexport function template(template: string, values: { [key: string]: string | ISeparator | null } = Object.create(null)): string {\n\tconst segments: ISegment[] = [];\n\n\tlet inVariable = false;\n\tlet curVal = '';\n\tfor (const char of template) {\n\t\t// Beginning of variable\n\t\tif (char === '$' || (inVariable && char === '{')) {\n\t\t\tif (curVal) {\n\t\t\t\tsegments.push({ value: curVal, type: Type.TEXT });\n\t\t\t}\n\n\t\t\tcurVal = '';\n\t\t\tinVariable = true;\n\t\t}\n\n\t\t// End of variable\n\t\telse if (char === '}' && inVariable) {\n\t\t\tconst resolved = values[curVal];\n\n\t\t\t// Variable\n\t\t\tif (typeof resolved === 'string') {\n\t\t\t\tif (resolved.length) {\n\t\t\t\t\tsegments.push({ value: resolved, type: Type.VARIABLE });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Separator\n\t\t\telse if (resolved) {\n\t\t\t\tconst prevSegment = segments[segments.length - 1];\n\t\t\t\tif (!prevSegment || prevSegment.type !== Type.SEPARATOR) {\n\t\t\t\t\tsegments.push({ value: resolved.label, type: Type.SEPARATOR }); // prevent duplicate separators\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcurVal = '';\n\t\t\tinVariable = false;\n\t\t}\n\n\t\t// Text or Variable Name\n\t\telse {\n\t\t\tcurVal += char;\n\t\t}\n\t}\n\n\t// Tail\n\tif (curVal && !inVariable) {\n\t\tsegments.push({ value: curVal, type: Type.TEXT });\n\t}\n\n\treturn segments.filter((segment, index) => {\n\n\t\t// Only keep separator if we have values to the left and right\n\t\tif (segment.type === Type.SEPARATOR) {\n\t\t\tconst left = segments[index - 1];\n\t\t\tconst right = segments[index + 1];\n\n\t\t\treturn [left, right].every(segment => segment && (segment.type === Type.VARIABLE || segment.type === Type.TEXT) && segment.value.length > 0);\n\t\t}\n\n\t\t// accept any TEXT and VARIABLE\n\t\treturn true;\n\t}).map(segment => segment.value).join('');\n}\n\n/**\n * Handles mnemonics for menu items. Depending on OS:\n * - Windows: Supported via & character (replace && with &)\n * -   Linux: Supported via & character (replace && with &)\n * -   macOS: Unsupported (replace && with empty string)\n */\nexport function mnemonicMenuLabel(label: string, forceDisableMnemonics?: boolean): string {\n\tif (isMacintosh || forceDisableMnemonics) {\n\t\treturn label.replace(/\\(&&\\w\\)|&&/g, '').replace(/&/g, isMacintosh ? '&' : '&&');\n\t}\n\n\treturn label.replace(/&&|&/g, m => m === '&' ? '&&' : '&');\n}\n\n/**\n * Handles mnemonics for buttons. Depending on OS:\n * - Windows: Supported via & character (replace && with & and & with && for escaping)\n * -   Linux: Supported via _ character (replace && with _)\n * -   macOS: Unsupported (replace && with empty string)\n */\nexport function mnemonicButtonLabel(label: string): string {\n\tif (isMacintosh) {\n\t\treturn label.replace(/\\(&&\\w\\)|&&/g, '');\n\t}\n\n\tif (isWindows) {\n\t\treturn label.replace(/&&|&/g, m => m === '&' ? '&&' : '&');\n\t}\n\n\treturn label.replace(/&&/g, '_');\n}\n\nexport function unmnemonicLabel(label: string): string {\n\treturn label.replace(/&/g, '&&');\n}\n\n/**\n * Splits a path in name and parent path, supporting both '/' and '\\'\n */\nexport function splitName(fullPath: string): { name: string, parentPath: string } {\n\tfor (let i = fullPath.length - 1; i >= 1; i--) {\n\t\tconst code = fullPath.charCodeAt(i);\n\t\tif (code === CharCode.Slash || code === CharCode.Backslash) {\n\t\t\treturn { parentPath: fullPath.substr(0, i), name: fullPath.substr(i + 1) };\n\t\t}\n\t}\n\treturn { parentPath: '', name: fullPath };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Represents a UUID as defined by rfc4122.\n */\nexport interface UUID {\n\n\t/**\n\t * @returns the canonical representation in sets of hexadecimal numbers separated by dashes.\n\t */\n\tasHex(): string;\n}\n\nclass ValueUUID implements UUID {\n\n\tconstructor(public _value: string) {\n\t\t// empty\n\t}\n\n\tpublic asHex(): string {\n\t\treturn this._value;\n\t}\n}\n\nclass V4UUID extends ValueUUID {\n\n\tprivate static readonly _chars = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\n\n\tprivate static readonly _timeHighBits = ['8', '9', 'a', 'b'];\n\n\tprivate static _oneOf(array: string[]): string {\n\t\treturn array[Math.floor(array.length * Math.random())];\n\t}\n\n\tprivate static _randomHex(): string {\n\t\treturn V4UUID._oneOf(V4UUID._chars);\n\t}\n\n\tconstructor() {\n\t\tsuper([\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\t'-',\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\t'-',\n\t\t\t'4',\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\t'-',\n\t\t\tV4UUID._oneOf(V4UUID._timeHighBits),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\t'-',\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t\tV4UUID._randomHex(),\n\t\t].join(''));\n\t}\n}\n\nexport function v4(): UUID {\n\treturn new V4UUID();\n}\n\nconst _UUIDPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n\nexport function isUUID(value: string): boolean {\n\treturn _UUIDPattern.test(value);\n}\n\n/**\n * Parses a UUID that is of the format xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.\n * @param value A uuid string.\n */\nexport function parse(value: string): UUID {\n\tif (!isUUID(value)) {\n\t\tthrow new Error('invalid uuid');\n\t}\n\n\treturn new ValueUUID(value);\n}\n\nexport function generateUuid(): string {\n\treturn v4().asHex();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\n\n/**\n * Executes the given function (fn) over the given array of items (list) in parallel and returns the resulting errors and results as\n * array to the callback (callback). The resulting errors and results are evaluated by calling the provided callback function.\n */\nexport function parallel<T, E>(list: T[], fn: (item: T, callback: (err: Error | null, result: E | null) => void) => void, callback: (err: Array<Error | null> | null, result: E[]) => void): void {\n\tconst results = new Array(list.length);\n\tconst errors = new Array<Error | null>(list.length);\n\tlet didErrorOccur = false;\n\tlet doneCount = 0;\n\n\tif (list.length === 0) {\n\t\treturn callback(null, []);\n\t}\n\n\tlist.forEach((item, index) => {\n\t\tfn(item, (error, result) => {\n\t\t\tif (error) {\n\t\t\t\tdidErrorOccur = true;\n\t\t\t\tresults[index] = null;\n\t\t\t\terrors[index] = error;\n\t\t\t} else {\n\t\t\t\tresults[index] = result;\n\t\t\t\terrors[index] = null;\n\t\t\t}\n\n\t\t\tif (++doneCount === list.length) {\n\t\t\t\treturn callback(didErrorOccur ? errors : null, results);\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Executes the given function (fn) over the given array of items (param) in sequential order and returns the first occurred error or the result as\n * array to the callback (callback). The resulting errors and results are evaluated by calling the provided callback function. The first param can\n * either be a function that returns an array of results to loop in async fashion or be an array of items already.\n */\nexport function loop<T, E>(param: (callback: (error: Error, result: T[]) => void) => void, fn: (item: T, callback: (error: Error | null, result: E | null) => void, index: number, total: number) => void, callback: (error: Error | null, result: E[] | null) => void): void;\nexport function loop<T, E>(param: T[], fn: (item: T, callback: (error: Error | null, result: E | null) => void, index: number, total: number) => void, callback: (error: Error | null, result: E[] | null) => void): void;\nexport function loop<E>(param: any, fn: (item: any, callback: (error: Error | null, result: E | null) => void, index: number, total: number) => void, callback: (error: Error | null, result: E[] | null) => void): void {\n\n\t// Assert\n\tassert.ok(param, 'Missing first parameter');\n\tassert.ok(typeof (fn) === 'function', 'Second parameter must be a function that is called for each element');\n\tassert.ok(typeof (callback) === 'function', 'Third parameter must be a function that is called on error and success');\n\n\t// Param is function, execute to retrieve array\n\tif (typeof (param) === 'function') {\n\t\ttry {\n\t\t\tparam((error: Error, result: E[]) => {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\tloop(result, fn, callback);\n\t\t\t\t}\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tcallback(error, null);\n\t\t}\n\t}\n\n\t// Expect the param to be an array and loop over it\n\telse {\n\t\tconst results: E[] = [];\n\n\t\tconst looper: (i: number) => void = function (i: number): void {\n\n\t\t\t// Still work to do\n\t\t\tif (i < param.length) {\n\n\t\t\t\t// Execute function on array element\n\t\t\t\ttry {\n\t\t\t\t\tfn(param[i], (error: any, result: E) => {\n\n\t\t\t\t\t\t// A method might only send a boolean value as return value (e.g. fs.exists), support this case gracefully\n\t\t\t\t\t\tif (error === true || error === false) {\n\t\t\t\t\t\t\tresult = error;\n\t\t\t\t\t\t\terror = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Quit looping on error\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tcallback(error, null);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Otherwise push result on stack and continue looping\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (result) { //Could be that provided function is not returning a result\n\t\t\t\t\t\t\t\tresults.push(result);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tprocess.nextTick(() => {\n\t\t\t\t\t\t\t\tlooper(i + 1);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, i, param.length);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Done looping, pass back results too callback function\n\t\t\telse {\n\t\t\t\tcallback(null, results);\n\t\t\t}\n\t\t};\n\n\t\t// Start looping with first element in array\n\t\tlooper(0);\n\t}\n}\n\nfunction Sequence(sequences: { (...param: any[]): void; }[]): void {\n\n\t// Assert\n\tassert.ok(sequences.length > 1, 'Need at least one error handler and one function to process sequence');\n\tsequences.forEach((sequence) => {\n\t\tassert.ok(typeof (sequence) === 'function');\n\t});\n\n\t// Execute in Loop\n\tconst errorHandler = sequences.splice(0, 1)[0]; //Remove error handler\n\tlet sequenceResult: any = null;\n\n\tloop(sequences, (sequence, clb) => {\n\t\tconst sequenceFunction = function (error: any, result: any): void {\n\n\t\t\t// A method might only send a boolean value as return value (e.g. fs.exists), support this case gracefully\n\t\t\tif (error === true || error === false) {\n\t\t\t\tresult = error;\n\t\t\t\terror = null;\n\t\t\t}\n\n\t\t\t// Handle Error and Result\n\t\t\tif (error) {\n\t\t\t\tclb(error, null);\n\t\t\t} else {\n\t\t\t\tsequenceResult = result; //Remember result of sequence\n\t\t\t\tclb(null, null); //Don't pass on result to Looper as we are not aggregating it\n\t\t\t}\n\t\t};\n\n\t\t// We call the sequence function setting \"this\" to be the callback we define here\n\t\t// and we pass in the \"sequenceResult\" as first argument. Doing all this avoids having\n\t\t// to pass in a callback to the sequence because the callback is already \"this\".\n\t\ttry {\n\t\t\tsequence.call(sequenceFunction, sequenceResult);\n\t\t} catch (error) {\n\t\t\tclb(error, null);\n\t\t}\n\t}, (error, result) => {\n\t\tif (error) {\n\t\t\terrorHandler(error);\n\t\t}\n\t});\n}\n\n/**\n * Takes a variable list of functions to execute in sequence. The first function must be the error handler and the\n * following functions can do arbitrary work. \"this\" must be used as callback value for async functions to continue\n * through the sequence:\n * \tsequence(\n * \t\tfunction errorHandler(error) {\n * \t\t\tclb(error, null);\n * \t\t},\n *\n * \t\tfunction doSomethingAsync() {\n * \t\t\tfs.doAsync(path, this);\n * \t\t},\n *\n * \t\tfunction done(result) {\n * \t\t\tclb(null, result);\n * \t\t}\n * \t);\n */\nexport function sequence(errorHandler: (error: Error) => void, ...sequences: Function[]): void;\nexport function sequence(sequences: Function[]): void;\nexport function sequence(sequences: any): void {\n\tSequence((Array.isArray(sequences)) ? sequences : Array.prototype.slice.call(arguments));\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getPathFromAmdModule } from 'vs/base/common/amd';\n\ninterface IPaths {\n\tgetAppDataPath(platform: string): string;\n\tgetDefaultUserDataPath(platform: string): string;\n}\n\nconst pathsPath = getPathFromAmdModule(require, 'paths');\nconst paths = require.__$__nodeRequire<IPaths>(pathsPath);\nexport const getAppDataPath = paths.getAppDataPath;\nexport const getDefaultUserDataPath = paths.getDefaultUserDataPath;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\n\nexport interface ReadResult {\n\tbuffer: Buffer | null;\n\tbytesRead: number;\n}\n\n/**\n * Reads totalBytes from the provided file.\n */\nexport function readExactlyByFile(file: string, totalBytes: number): Promise<ReadResult> {\n\treturn new Promise<ReadResult>((resolve, reject) => {\n\t\tfs.open(file, 'r', null, (err, fd) => {\n\t\t\tif (err) {\n\t\t\t\treturn reject(err);\n\t\t\t}\n\n\t\t\tfunction end(err: Error | null, resultBuffer: Buffer | null, bytesRead: number): void {\n\t\t\t\tfs.close(fd, closeError => {\n\t\t\t\t\tif (closeError) {\n\t\t\t\t\t\treturn reject(closeError);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err && (<any>err).code === 'EISDIR') {\n\t\t\t\t\t\treturn reject(err); // we want to bubble this error up (file is actually a folder)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn resolve({ buffer: resultBuffer, bytesRead });\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst buffer = Buffer.allocUnsafe(totalBytes);\n\t\t\tlet offset = 0;\n\n\t\t\tfunction readChunk(): void {\n\t\t\t\tfs.read(fd, buffer, offset, totalBytes - offset, null, (err, bytesRead) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn end(err, null, 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (bytesRead === 0) {\n\t\t\t\t\t\treturn end(null, buffer, offset);\n\t\t\t\t\t}\n\n\t\t\t\t\toffset += bytesRead;\n\n\t\t\t\t\tif (offset === totalBytes) {\n\t\t\t\t\t\treturn end(null, buffer, offset);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn readChunk();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treadChunk();\n\t\t});\n\t});\n}\n\n/**\n * Reads a file until a matching string is found.\n *\n * @param file The file to read.\n * @param matchingString The string to search for.\n * @param chunkBytes The number of bytes to read each iteration.\n * @param maximumBytesToRead The maximum number of bytes to read before giving up.\n * @param callback The finished callback.\n */\nexport function readToMatchingString(file: string, matchingString: string, chunkBytes: number, maximumBytesToRead: number): Promise<string | null> {\n\treturn new Promise<string | null>((resolve, reject) =>\n\t\tfs.open(file, 'r', null, (err, fd) => {\n\t\t\tif (err) {\n\t\t\t\treturn reject(err);\n\t\t\t}\n\n\t\t\tfunction end(err: Error | null, result: string | null): void {\n\t\t\t\tfs.close(fd, closeError => {\n\t\t\t\t\tif (closeError) {\n\t\t\t\t\t\treturn reject(closeError);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err && (<any>err).code === 'EISDIR') {\n\t\t\t\t\t\treturn reject(err); // we want to bubble this error up (file is actually a folder)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn resolve(result);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst buffer = Buffer.allocUnsafe(maximumBytesToRead);\n\t\t\tlet offset = 0;\n\n\t\t\tfunction readChunk(): void {\n\t\t\t\tfs.read(fd, buffer, offset, chunkBytes, null, (err, bytesRead) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn end(err, null);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (bytesRead === 0) {\n\t\t\t\t\t\treturn end(null, null);\n\t\t\t\t\t}\n\n\t\t\t\t\toffset += bytesRead;\n\n\t\t\t\t\tconst newLineIndex = buffer.indexOf(matchingString);\n\t\t\t\t\tif (newLineIndex >= 0) {\n\t\t\t\t\t\treturn end(null, buffer.toString('utf8').substr(0, newLineIndex));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (offset >= maximumBytesToRead) {\n\t\t\t\t\t\treturn end(new Error(`Could not find ${matchingString} in first ${maximumBytesToRead} bytes of ${file}`), null);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn readChunk();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treadChunk();\n\t\t})\n\t);\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as stream from 'vs/base/node/stream';\nimport * as iconv from 'iconv-lite';\nimport { isLinux, isMacintosh } from 'vs/base/common/platform';\nimport { exec } from 'child_process';\nimport { Readable, Writable } from 'stream';\n\nexport const UTF8 = 'utf8';\nexport const UTF8_with_bom = 'utf8bom';\nexport const UTF16be = 'utf16be';\nexport const UTF16le = 'utf16le';\n\nexport interface IDecodeStreamOptions {\n\tguessEncoding?: boolean;\n\tminBytesRequiredForDetection?: number;\n\toverwriteEncoding?(detectedEncoding: string | null): string;\n}\n\nexport function toDecodeStream(readable: Readable, options: IDecodeStreamOptions): Promise<{ detected: IDetectedEncodingResult, stream: NodeJS.ReadableStream }> {\n\tif (!options.minBytesRequiredForDetection) {\n\t\toptions.minBytesRequiredForDetection = options.guessEncoding ? AUTO_GUESS_BUFFER_MAX_LEN : NO_GUESS_BUFFER_MAX_LEN;\n\t}\n\n\tif (!options.overwriteEncoding) {\n\t\toptions.overwriteEncoding = detected => detected || UTF8;\n\t}\n\n\treturn new Promise<{ detected: IDetectedEncodingResult, stream: NodeJS.ReadableStream }>((resolve, reject) => {\n\n\t\treadable.on('error', reject);\n\n\t\treadable.pipe(new class extends Writable {\n\n\t\t\tprivate _decodeStream: NodeJS.ReadWriteStream;\n\t\t\tprivate _decodeStreamConstruction: Promise<any>;\n\t\t\tprivate _buffer: Buffer[] = [];\n\t\t\tprivate _bytesBuffered = 0;\n\n\t\t\t_write(chunk: any, encoding: string, callback: Function): void {\n\t\t\t\tif (!Buffer.isBuffer(chunk)) {\n\t\t\t\t\tcallback(new Error('data must be a buffer'));\n\t\t\t\t}\n\n\t\t\t\tif (this._decodeStream) {\n\t\t\t\t\t// just a forwarder now\n\t\t\t\t\tthis._decodeStream.write(chunk, callback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._buffer.push(chunk);\n\t\t\t\tthis._bytesBuffered += chunk.length;\n\n\t\t\t\tif (this._decodeStreamConstruction) {\n\t\t\t\t\t// waiting for the decoder to be ready\n\t\t\t\t\tthis._decodeStreamConstruction.then(_ => callback(), err => callback(err));\n\n\t\t\t\t} else if (typeof options.minBytesRequiredForDetection === 'number' && this._bytesBuffered >= options.minBytesRequiredForDetection) {\n\t\t\t\t\t// buffered enough data, create stream and forward data\n\t\t\t\t\tthis._startDecodeStream(callback);\n\n\t\t\t\t} else {\n\t\t\t\t\t// only buffering\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_startDecodeStream(callback: Function): void {\n\n\t\t\t\tthis._decodeStreamConstruction = Promise.resolve(detectEncodingFromBuffer({\n\t\t\t\t\tbuffer: Buffer.concat(this._buffer), bytesRead: this._bytesBuffered\n\t\t\t\t}, options.guessEncoding)).then(detected => {\n\t\t\t\t\tif (options.overwriteEncoding) {\n\t\t\t\t\t\tdetected.encoding = options.overwriteEncoding(detected.encoding);\n\t\t\t\t\t}\n\t\t\t\t\tthis._decodeStream = decodeStream(detected.encoding);\n\t\t\t\t\tfor (const buffer of this._buffer) {\n\t\t\t\t\t\tthis._decodeStream.write(buffer);\n\t\t\t\t\t}\n\t\t\t\t\tcallback();\n\t\t\t\t\tresolve({ detected, stream: this._decodeStream });\n\n\t\t\t\t}, err => {\n\t\t\t\t\tthis.emit('error', err);\n\t\t\t\t\tcallback(err);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_final(callback: (err?: any) => any) {\n\t\t\t\tif (this._decodeStream) {\n\t\t\t\t\t// normal finish\n\t\t\t\t\tthis._decodeStream.end(callback);\n\t\t\t\t} else {\n\t\t\t\t\t// we were still waiting for data...\n\t\t\t\t\tthis._startDecodeStream(() => this._decodeStream.end(callback));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\nexport function bomLength(encoding: string): number {\n\tswitch (encoding) {\n\t\tcase UTF8:\n\t\t\treturn 3;\n\t\tcase UTF16be:\n\t\tcase UTF16le:\n\t\t\treturn 2;\n\t}\n\n\treturn 0;\n}\n\nexport function decode(buffer: Buffer, encoding: string): string {\n\treturn iconv.decode(buffer, toNodeEncoding(encoding));\n}\n\nexport function encode(content: string | Buffer, encoding: string, options?: { addBOM?: boolean }): Buffer {\n\treturn iconv.encode(content, toNodeEncoding(encoding), options);\n}\n\nexport function encodingExists(encoding: string): boolean {\n\treturn iconv.encodingExists(toNodeEncoding(encoding));\n}\n\nexport function decodeStream(encoding: string | null): NodeJS.ReadWriteStream {\n\treturn iconv.decodeStream(toNodeEncoding(encoding));\n}\n\nexport function encodeStream(encoding: string, options?: { addBOM?: boolean }): NodeJS.ReadWriteStream {\n\treturn iconv.encodeStream(toNodeEncoding(encoding), options);\n}\n\nfunction toNodeEncoding(enc: string | null): string {\n\tif (enc === UTF8_with_bom || enc === null) {\n\t\treturn UTF8; // iconv does not distinguish UTF 8 with or without BOM, so we need to help it\n\t}\n\n\treturn enc;\n}\n\nexport function detectEncodingByBOMFromBuffer(buffer: Buffer | null, bytesRead: number): string | null {\n\tif (!buffer || bytesRead < 2) {\n\t\treturn null;\n\t}\n\n\tconst b0 = buffer.readUInt8(0);\n\tconst b1 = buffer.readUInt8(1);\n\n\t// UTF-16 BE\n\tif (b0 === 0xFE && b1 === 0xFF) {\n\t\treturn UTF16be;\n\t}\n\n\t// UTF-16 LE\n\tif (b0 === 0xFF && b1 === 0xFE) {\n\t\treturn UTF16le;\n\t}\n\n\tif (bytesRead < 3) {\n\t\treturn null;\n\t}\n\n\tconst b2 = buffer.readUInt8(2);\n\n\t// UTF-8\n\tif (b0 === 0xEF && b1 === 0xBB && b2 === 0xBF) {\n\t\treturn UTF8;\n\t}\n\n\treturn null;\n}\n\n/**\n * Detects the Byte Order Mark in a given file.\n * If no BOM is detected, null will be passed to callback.\n */\nexport function detectEncodingByBOM(file: string): Promise<string | null> {\n\treturn stream.readExactlyByFile(file, 3).then(({ buffer, bytesRead }) => detectEncodingByBOMFromBuffer(buffer, bytesRead));\n}\n\nconst MINIMUM_THRESHOLD = 0.2;\nconst IGNORE_ENCODINGS = ['ascii', 'utf-8', 'utf-16', 'utf-32'];\n\n/**\n * Guesses the encoding from buffer.\n */\nexport function guessEncodingByBuffer(buffer: Buffer): Promise<string | null> {\n\treturn import('jschardet').then(jschardet => {\n\t\tjschardet.Constants.MINIMUM_THRESHOLD = MINIMUM_THRESHOLD;\n\n\t\tconst guessed = jschardet.detect(buffer);\n\t\tif (!guessed || !guessed.encoding) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst enc = guessed.encoding.toLowerCase();\n\n\t\t// Ignore encodings that cannot guess correctly\n\t\t// (http://chardet.readthedocs.io/en/latest/supported-encodings.html)\n\t\tif (0 <= IGNORE_ENCODINGS.indexOf(enc)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn toIconvLiteEncoding(guessed.encoding);\n\t});\n}\n\nconst JSCHARDET_TO_ICONV_ENCODINGS: { [name: string]: string } = {\n\t'ibm866': 'cp866',\n\t'big5': 'cp950'\n};\n\nfunction toIconvLiteEncoding(encodingName: string): string {\n\tconst normalizedEncodingName = encodingName.replace(/[^a-zA-Z0-9]/g, '').toLowerCase();\n\tconst mapped = JSCHARDET_TO_ICONV_ENCODINGS[normalizedEncodingName];\n\n\treturn mapped || normalizedEncodingName;\n}\n\n/**\n * The encodings that are allowed in a settings file don't match the canonical encoding labels specified by WHATWG.\n * See https://encoding.spec.whatwg.org/#names-and-labels\n * Iconv-lite strips all non-alphanumeric characters, but ripgrep doesn't. For backcompat, allow these labels.\n */\nexport function toCanonicalName(enc: string): string {\n\tswitch (enc) {\n\t\tcase 'shiftjis':\n\t\t\treturn 'shift-jis';\n\t\tcase 'utf16le':\n\t\t\treturn 'utf-16le';\n\t\tcase 'utf16be':\n\t\t\treturn 'utf-16be';\n\t\tcase 'big5hkscs':\n\t\t\treturn 'big5-hkscs';\n\t\tcase 'eucjp':\n\t\t\treturn 'euc-jp';\n\t\tcase 'euckr':\n\t\t\treturn 'euc-kr';\n\t\tcase 'koi8r':\n\t\t\treturn 'koi8-r';\n\t\tcase 'koi8u':\n\t\t\treturn 'koi8-u';\n\t\tcase 'macroman':\n\t\t\treturn 'x-mac-roman';\n\t\tcase 'utf8bom':\n\t\t\treturn 'utf8';\n\t\tdefault:\n\t\t\tconst m = enc.match(/windows(\\d+)/);\n\t\t\tif (m) {\n\t\t\t\treturn 'windows-' + m[1];\n\t\t\t}\n\n\t\t\treturn enc;\n\t}\n}\n\nconst ZERO_BYTE_DETECTION_BUFFER_MAX_LEN = 512; // number of bytes to look at to decide about a file being binary or not\nconst NO_GUESS_BUFFER_MAX_LEN = 512; \t\t\t// when not auto guessing the encoding, small number of bytes are enough\nconst AUTO_GUESS_BUFFER_MAX_LEN = 512 * 8; \t\t// with auto guessing we want a lot more content to be read for guessing\n\nexport interface IDetectedEncodingResult {\n\tencoding: string | null;\n\tseemsBinary: boolean;\n}\n\nexport function detectEncodingFromBuffer(readResult: stream.ReadResult, autoGuessEncoding?: false): IDetectedEncodingResult;\nexport function detectEncodingFromBuffer(readResult: stream.ReadResult, autoGuessEncoding?: boolean): Promise<IDetectedEncodingResult>;\nexport function detectEncodingFromBuffer({ buffer, bytesRead }: stream.ReadResult, autoGuessEncoding?: boolean): Promise<IDetectedEncodingResult> | IDetectedEncodingResult {\n\n\t// Always first check for BOM to find out about encoding\n\tlet encoding = detectEncodingByBOMFromBuffer(buffer, bytesRead);\n\n\t// Detect 0 bytes to see if file is binary or UTF-16 LE/BE\n\t// unless we already know that this file has a UTF-16 encoding\n\tlet seemsBinary = false;\n\tif (encoding !== UTF16be && encoding !== UTF16le && buffer) {\n\t\tlet couldBeUTF16LE = true; // e.g. 0xAA 0x00\n\t\tlet couldBeUTF16BE = true; // e.g. 0x00 0xAA\n\t\tlet containsZeroByte = false;\n\n\t\t// This is a simplified guess to detect UTF-16 BE or LE by just checking if\n\t\t// the first 512 bytes have the 0-byte at a specific location. For UTF-16 LE\n\t\t// this would be the odd byte index and for UTF-16 BE the even one.\n\t\t// Note: this can produce false positives (a binary file that uses a 2-byte\n\t\t// encoding of the same format as UTF-16) and false negatives (a UTF-16 file\n\t\t// that is using 4 bytes to encode a character).\n\t\tfor (let i = 0; i < bytesRead && i < ZERO_BYTE_DETECTION_BUFFER_MAX_LEN; i++) {\n\t\t\tconst isEndian = (i % 2 === 1); // assume 2-byte sequences typical for UTF-16\n\t\t\tconst isZeroByte = (buffer.readInt8(i) === 0);\n\n\t\t\tif (isZeroByte) {\n\t\t\t\tcontainsZeroByte = true;\n\t\t\t}\n\n\t\t\t// UTF-16 LE: expect e.g. 0xAA 0x00\n\t\t\tif (couldBeUTF16LE && (isEndian && !isZeroByte || !isEndian && isZeroByte)) {\n\t\t\t\tcouldBeUTF16LE = false;\n\t\t\t}\n\n\t\t\t// UTF-16 BE: expect e.g. 0x00 0xAA\n\t\t\tif (couldBeUTF16BE && (isEndian && isZeroByte || !isEndian && !isZeroByte)) {\n\t\t\t\tcouldBeUTF16BE = false;\n\t\t\t}\n\n\t\t\t// Return if this is neither UTF16-LE nor UTF16-BE and thus treat as binary\n\t\t\tif (isZeroByte && !couldBeUTF16LE && !couldBeUTF16BE) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Handle case of 0-byte included\n\t\tif (containsZeroByte) {\n\t\t\tif (couldBeUTF16LE) {\n\t\t\t\tencoding = UTF16le;\n\t\t\t} else if (couldBeUTF16BE) {\n\t\t\t\tencoding = UTF16be;\n\t\t\t} else {\n\t\t\t\tseemsBinary = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Auto guess encoding if configured\n\tif (autoGuessEncoding && !seemsBinary && !encoding && buffer) {\n\t\treturn guessEncodingByBuffer(buffer.slice(0, bytesRead)).then(guessedEncoding => {\n\t\t\treturn {\n\t\t\t\tseemsBinary: false,\n\t\t\t\tencoding: guessedEncoding\n\t\t\t};\n\t\t});\n\t}\n\n\treturn { seemsBinary, encoding };\n}\n\n// https://ss64.com/nt/chcp.html\nconst windowsTerminalEncodings = {\n\t'437': 'cp437', // United States\n\t'850': 'cp850', // Multilingual(Latin I)\n\t'852': 'cp852', // Slavic(Latin II)\n\t'855': 'cp855', // Cyrillic(Russian)\n\t'857': 'cp857', // Turkish\n\t'860': 'cp860', // Portuguese\n\t'861': 'cp861', // Icelandic\n\t'863': 'cp863', // Canadian - French\n\t'865': 'cp865', // Nordic\n\t'866': 'cp866', // Russian\n\t'869': 'cp869', // Modern Greek\n\t'936': 'cp936', // Simplified Chinese\n\t'1252': 'cp1252' // West European Latin\n};\n\nexport function resolveTerminalEncoding(verbose?: boolean): Promise<string> {\n\tlet rawEncodingPromise: Promise<string>;\n\n\t// Support a global environment variable to win over other mechanics\n\tconst cliEncodingEnv = process.env['VSCODE_CLI_ENCODING'];\n\tif (cliEncodingEnv) {\n\t\tif (verbose) {\n\t\t\tconsole.log(`Found VSCODE_CLI_ENCODING variable: ${cliEncodingEnv}`);\n\t\t}\n\n\t\trawEncodingPromise = Promise.resolve(cliEncodingEnv);\n\t}\n\n\t// Linux/Mac: use \"locale charmap\" command\n\telse if (isLinux || isMacintosh) {\n\t\trawEncodingPromise = new Promise<string>(resolve => {\n\t\t\tif (verbose) {\n\t\t\t\tconsole.log('Running \"locale charmap\" to detect terminal encoding...');\n\t\t\t}\n\n\t\t\texec('locale charmap', (err, stdout, stderr) => resolve(stdout));\n\t\t});\n\t}\n\n\t// Windows: educated guess\n\telse {\n\t\trawEncodingPromise = new Promise<string>(resolve => {\n\t\t\tif (verbose) {\n\t\t\t\tconsole.log('Running \"chcp\" to detect terminal encoding...');\n\t\t\t}\n\n\t\t\texec('chcp', (err, stdout, stderr) => {\n\t\t\t\tif (stdout) {\n\t\t\t\t\tconst windowsTerminalEncodingKeys = Object.keys(windowsTerminalEncodings);\n\t\t\t\t\tfor (const key of windowsTerminalEncodingKeys) {\n\t\t\t\t\t\tif (stdout.indexOf(key) >= 0) {\n\t\t\t\t\t\t\treturn resolve(windowsTerminalEncodings[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn resolve(undefined);\n\t\t\t});\n\t\t});\n\t}\n\n\treturn rawEncodingPromise.then(rawEncoding => {\n\t\tif (verbose) {\n\t\t\tconsole.log(`Detected raw terminal encoding: ${rawEncoding}`);\n\t\t}\n\n\t\tif (!rawEncoding || rawEncoding.toLowerCase() === 'utf-8' || rawEncoding.toLowerCase() === UTF8) {\n\t\t\treturn UTF8;\n\t\t}\n\n\t\tconst iconvEncoding = toIconvLiteEncoding(rawEncoding);\n\t\tif (iconv.encodingExists(iconvEncoding)) {\n\t\t\treturn iconvEncoding;\n\t\t}\n\n\t\tif (verbose) {\n\t\t\tconsole.log('Unsupported terminal encoding, falling back to UTF-8.');\n\t\t}\n\n\t\treturn UTF8;\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\nimport * as paths from 'vs/base/common/path';\nimport { nfcall } from 'vs/base/common/async';\nimport { normalizeNFC } from 'vs/base/common/normalization';\nimport * as platform from 'vs/base/common/platform';\nimport * as strings from 'vs/base/common/strings';\nimport * as uuid from 'vs/base/common/uuid';\nimport { encode, encodeStream } from 'vs/base/node/encoding';\nimport * as flow from 'vs/base/node/flow';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IDisposable, toDisposable, Disposable } from 'vs/base/common/lifecycle';\n\nconst loop = flow.loop;\n\nexport function readdirSync(path: string): string[] {\n\t// Mac: uses NFD unicode form on disk, but we want NFC\n\t// See also https://github.com/nodejs/node/issues/2165\n\tif (platform.isMacintosh) {\n\t\treturn fs.readdirSync(path).map(c => normalizeNFC(c));\n\t}\n\n\treturn fs.readdirSync(path);\n}\n\nexport function readdir(path: string, callback: (error: Error | null, files: string[]) => void): void {\n\t// Mac: uses NFD unicode form on disk, but we want NFC\n\t// See also https://github.com/nodejs/node/issues/2165\n\tif (platform.isMacintosh) {\n\t\treturn fs.readdir(path, (error, children) => {\n\t\t\tif (error) {\n\t\t\t\treturn callback(error, []);\n\t\t\t}\n\n\t\t\treturn callback(null, children.map(c => normalizeNFC(c)));\n\t\t});\n\t}\n\n\treturn fs.readdir(path, callback);\n}\n\nexport interface IStatAndLink {\n\tstat: fs.Stats;\n\tisSymbolicLink: boolean;\n}\n\nexport function statLink(path: string, callback: (error: Error | null, statAndIsLink: IStatAndLink | null) => void): void {\n\tfs.lstat(path, (error, lstat) => {\n\t\tif (error || lstat.isSymbolicLink()) {\n\t\t\tfs.stat(path, (error, stat) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn callback(error, null);\n\t\t\t\t}\n\n\t\t\t\tcallback(null, { stat, isSymbolicLink: lstat && lstat.isSymbolicLink() });\n\t\t\t});\n\t\t} else {\n\t\t\tcallback(null, { stat: lstat, isSymbolicLink: false });\n\t\t}\n\t});\n}\n\nexport function copy(source: string, target: string, callback: (error: Error | null) => void, copiedSourcesIn?: { [path: string]: boolean }): void {\n\tconst copiedSources = copiedSourcesIn ? copiedSourcesIn : Object.create(null);\n\n\tfs.stat(source, (error, stat) => {\n\t\tif (error) {\n\t\t\treturn callback(error);\n\t\t}\n\n\t\tif (!stat.isDirectory()) {\n\t\t\treturn doCopyFile(source, target, stat.mode & 511, callback);\n\t\t}\n\n\t\tif (copiedSources[source]) {\n\t\t\treturn callback(null); // escape when there are cycles (can happen with symlinks)\n\t\t}\n\n\t\tcopiedSources[source] = true; // remember as copied\n\n\t\tconst proceed = function () {\n\t\t\treaddir(source, (err, files) => {\n\t\t\t\tloop(files, (file: string, clb: (error: Error | null, result: string[]) => void) => {\n\t\t\t\t\tcopy(paths.join(source, file), paths.join(target, file), (error: Error) => clb(error, []), copiedSources);\n\t\t\t\t}, callback);\n\t\t\t});\n\t\t};\n\n\t\tmkdirp(target, stat.mode & 511).then(proceed, proceed);\n\t});\n}\n\nfunction doCopyFile(source: string, target: string, mode: number, callback: (error: Error) => void): void {\n\tconst reader = fs.createReadStream(source);\n\tconst writer = fs.createWriteStream(target, { mode });\n\n\tlet finished = false;\n\tconst finish = (error?: Error) => {\n\t\tif (!finished) {\n\t\t\tfinished = true;\n\n\t\t\t// in error cases, pass to callback\n\t\t\tif (error) {\n\t\t\t\tcallback(error);\n\t\t\t}\n\n\t\t\t// we need to explicitly chmod because of https://github.com/nodejs/node/issues/1104\n\t\t\telse {\n\t\t\t\tfs.chmod(target, mode, callback);\n\t\t\t}\n\t\t}\n\t};\n\n\t// handle errors properly\n\treader.once('error', error => finish(error));\n\twriter.once('error', error => finish(error));\n\n\t// we are done (underlying fd has been closed)\n\twriter.once('close', () => finish());\n\n\t// start piping\n\treader.pipe(writer);\n}\n\nexport function mkdirp(path: string, mode?: number, token?: CancellationToken): Promise<boolean> {\n\tconst mkdir = (): Promise<null> => {\n\t\treturn nfcall(fs.mkdir, path, mode).then(undefined, (mkdirErr: NodeJS.ErrnoException) => {\n\n\t\t\t// ENOENT: a parent folder does not exist yet\n\t\t\tif (mkdirErr.code === 'ENOENT') {\n\t\t\t\treturn Promise.reject(mkdirErr);\n\t\t\t}\n\n\t\t\t// Any other error: check if folder exists and\n\t\t\t// return normally in that case if its a folder\n\t\t\treturn nfcall(fs.stat, path).then((stat: fs.Stats) => {\n\t\t\t\tif (!stat.isDirectory()) {\n\t\t\t\t\treturn Promise.reject(new Error(`'${path}' exists and is not a directory.`));\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}, statErr => {\n\t\t\t\treturn Promise.reject(mkdirErr); // bubble up original mkdir error\n\t\t\t});\n\t\t});\n\t};\n\n\t// stop at root\n\tif (path === paths.dirname(path)) {\n\t\treturn Promise.resolve(true);\n\t}\n\n\t// recursively mkdir\n\treturn mkdir().then(undefined, (err: NodeJS.ErrnoException) => {\n\n\t\t// Respect cancellation\n\t\tif (token && token.isCancellationRequested) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\t// ENOENT: a parent folder does not exist yet, continue\n\t\t// to create the parent folder and then try again.\n\t\tif (err.code === 'ENOENT') {\n\t\t\treturn mkdirp(paths.dirname(path), mode).then(mkdir);\n\t\t}\n\n\t\t// Any other error\n\t\treturn Promise.reject(err);\n\t});\n}\n\n// Deletes the given path by first moving it out of the workspace. This has two benefits. For one, the operation can return fast because\n// after the rename, the contents are out of the workspace although not yet deleted. The greater benefit however is that this operation\n// will fail in case any file is used by another process. fs.unlink() in node will not bail if a file unlinked is used by another process.\n// However, the consequences are bad as outlined in all the related bugs from https://github.com/joyent/node/issues/7164\nexport function del(path: string, tmpFolder: string, callback: (error: Error | null) => void, done?: (error: Error | null) => void): void {\n\tfs.exists(path, exists => {\n\t\tif (!exists) {\n\t\t\treturn callback(null);\n\t\t}\n\n\t\tfs.stat(path, (err, stat) => {\n\t\t\tif (err || !stat) {\n\t\t\t\treturn callback(err);\n\t\t\t}\n\n\t\t\t// Special windows workaround: A file or folder that ends with a \".\" cannot be moved to another place\n\t\t\t// because it is not a valid file name. In this case, we really have to do the deletion without prior move.\n\t\t\tif (path[path.length - 1] === '.' || strings.endsWith(path, './') || strings.endsWith(path, '.\\\\')) {\n\t\t\t\treturn rmRecursive(path, callback);\n\t\t\t}\n\n\t\t\tconst pathInTemp = paths.join(tmpFolder, uuid.generateUuid());\n\t\t\tfs.rename(path, pathInTemp, (error: Error | null) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn rmRecursive(path, callback); // if rename fails, delete without tmp dir\n\t\t\t\t}\n\n\t\t\t\t// Return early since the move succeeded\n\t\t\t\tcallback(null);\n\n\t\t\t\t// do the heavy deletion outside the callers callback\n\t\t\t\trmRecursive(pathInTemp, error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (done) {\n\t\t\t\t\t\tdone(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n}\n\nfunction rmRecursive(path: string, callback: (error: Error | null) => void): void {\n\tif (path === paths.win32.sep || path === paths.posix.sep) {\n\t\treturn callback(new Error('Will not delete root!'));\n\t}\n\n\tfs.exists(path, exists => {\n\t\tif (!exists) {\n\t\t\tcallback(null);\n\t\t} else {\n\t\t\tfs.lstat(path, (err, stat) => {\n\t\t\t\tif (err || !stat) {\n\t\t\t\t\tcallback(err);\n\t\t\t\t} else if (!stat.isDirectory() || stat.isSymbolicLink() /* !!! never recurse into links when deleting !!! */) {\n\t\t\t\t\tconst mode = stat.mode;\n\t\t\t\t\tif (!(mode & 128)) { // 128 === 0200\n\t\t\t\t\t\tfs.chmod(path, mode | 128, (err: Error) => { // 128 === 0200\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tcallback(err);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfs.unlink(path, callback);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfs.unlink(path, callback);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treaddir(path, (err, children) => {\n\t\t\t\t\t\tif (err || !children) {\n\t\t\t\t\t\t\tcallback(err);\n\t\t\t\t\t\t} else if (children.length === 0) {\n\t\t\t\t\t\t\tfs.rmdir(path, callback);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet firstError: Error | null = null;\n\t\t\t\t\t\t\tlet childrenLeft = children.length;\n\t\t\t\t\t\t\tchildren.forEach(child => {\n\t\t\t\t\t\t\t\trmRecursive(paths.join(path, child), (err: Error) => {\n\t\t\t\t\t\t\t\t\tchildrenLeft--;\n\t\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\tfirstError = firstError || err;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (childrenLeft === 0) {\n\t\t\t\t\t\t\t\t\t\tif (firstError) {\n\t\t\t\t\t\t\t\t\t\t\tcallback(firstError);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfs.rmdir(path, callback);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport function delSync(path: string): void {\n\tif (path === paths.win32.sep || path === paths.posix.sep) {\n\t\tthrow new Error('Will not delete root!');\n\t}\n\n\ttry {\n\t\tconst stat = fs.lstatSync(path);\n\t\tif (stat.isDirectory() && !stat.isSymbolicLink()) {\n\t\t\treaddirSync(path).forEach(child => delSync(paths.join(path, child)));\n\t\t\tfs.rmdirSync(path);\n\t\t} else {\n\t\t\tfs.unlinkSync(path);\n\t\t}\n\t} catch (err) {\n\t\tif (err.code === 'ENOENT') {\n\t\t\treturn; // not found\n\t\t}\n\n\t\tthrow err;\n\t}\n}\n\nexport function mv(source: string, target: string, callback: (error: Error | null) => void): void {\n\tif (source === target) {\n\t\treturn callback(null);\n\t}\n\n\tfunction updateMtime(err: Error | null): void {\n\t\tif (err) {\n\t\t\treturn callback(err);\n\t\t}\n\n\t\tfs.stat(target, (error, stat) => {\n\t\t\tif (error) {\n\t\t\t\treturn callback(error);\n\t\t\t}\n\n\t\t\tif (stat.isDirectory()) {\n\t\t\t\treturn callback(null);\n\t\t\t}\n\n\t\t\tfs.open(target, 'a', null, (err: Error, fd: number) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn callback(err);\n\t\t\t\t}\n\n\t\t\t\tfs.futimes(fd, stat.atime, new Date(), (err: Error) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn callback(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tfs.close(fd, callback);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t// Try native rename()\n\tfs.rename(source, target, (err: Error) => {\n\t\tif (!err) {\n\t\t\treturn updateMtime(null);\n\t\t}\n\n\t\t// In two cases we fallback to classic copy and delete:\n\t\t//\n\t\t// 1.) The EXDEV error indicates that source and target are on different devices\n\t\t// In this case, fallback to using a copy() operation as there is no way to\n\t\t// rename() between different devices.\n\t\t//\n\t\t// 2.) The user tries to rename a file/folder that ends with a dot. This is not\n\t\t// really possible to move then, at least on UNC devices.\n\t\tif (err && source.toLowerCase() !== target.toLowerCase() && ((<any>err).code === 'EXDEV') || strings.endsWith(source, '.')) {\n\t\t\treturn copy(source, target, (err: Error) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn callback(err);\n\t\t\t\t}\n\n\t\t\t\trmRecursive(source, updateMtime);\n\t\t\t});\n\t\t}\n\n\t\treturn callback(err);\n\t});\n}\n\nexport interface IWriteFileOptions {\n\tmode?: number;\n\tflag?: string;\n\tencoding?: {\n\t\tcharset: string;\n\t\taddBOM: boolean;\n\t};\n}\n\nlet canFlush = true;\nexport function writeFileAndFlush(path: string, data: string | Buffer | NodeJS.ReadableStream, options: IWriteFileOptions, callback: (error?: Error) => void): void {\n\toptions = ensureOptions(options);\n\n\tif (typeof data === 'string' || Buffer.isBuffer(data)) {\n\t\tdoWriteFileAndFlush(path, data, options, callback);\n\t} else {\n\t\tdoWriteFileStreamAndFlush(path, data, options, callback);\n\t}\n}\n\nfunction doWriteFileStreamAndFlush(path: string, reader: NodeJS.ReadableStream, options: IWriteFileOptions, callback: (error?: Error) => void): void {\n\tif (process.env.isBrowser) {\n\t\tlet content = '';\n\t\tlet chunk = reader.read();\n\t\twhile (chunk !== null) {\n\t\t\tcontent += chunk;\n\t\t\tchunk = reader.read();\n\t\t}\n\t\tfs.writeFile(path, content, 'utf-8', function (error) {\n\t\t\tif (error) {\n\t\t\t\tcallback(error);\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\treturn;\n\t}\n\t// finish only once\n\tlet finished = false;\n\tconst finish = (error?: Error) => {\n\t\tif (!finished) {\n\t\t\tfinished = true;\n\n\t\t\t// in error cases we need to manually close streams\n\t\t\t// if the write stream was successfully opened\n\t\t\tif (error) {\n\t\t\t\tif (isOpen) {\n\t\t\t\t\twriter.once('close', () => callback(error));\n\t\t\t\t\twriter.destroy();\n\t\t\t\t} else {\n\t\t\t\t\tcallback(error);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// otherwise just return without error\n\t\t\telse {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t};\n\n\t// create writer to target. we set autoClose: false because we want to use the streams\n\t// file descriptor to call fs.fdatasync to ensure the data is flushed to disk\n\tconst writer = fs.createWriteStream(path, { mode: options.mode, flags: options.flag, autoClose: false });\n\n\t// Event: 'open'\n\t// Purpose: save the fd for later use and start piping\n\t// Notes: will not be called when there is an error opening the file descriptor!\n\tlet fd: number;\n\tlet isOpen: boolean;\n\twriter.once('open', descriptor => {\n\t\tfd = descriptor;\n\t\tisOpen = true;\n\n\t\t// if an encoding is provided, we need to pipe the stream through\n\t\t// an encoder stream and forward the encoding related options\n\t\tif (options.encoding) {\n\t\t\treader = reader.pipe(encodeStream(options.encoding.charset, { addBOM: options.encoding.addBOM }));\n\t\t}\n\n\t\t// start data piping only when we got a successful open. this ensures that we do\n\t\t// not consume the stream when an error happens and helps to fix this issue:\n\t\t// https://github.com/Microsoft/vscode/issues/42542\n\t\treader.pipe(writer);\n\t});\n\n\t// Event: 'error'\n\t// Purpose: to return the error to the outside and to close the write stream (does not happen automatically)\n\treader.once('error', error => finish(error));\n\twriter.once('error', error => finish(error));\n\n\t// Event: 'finish'\n\t// Purpose: use fs.fdatasync to flush the contents to disk\n\t// Notes: event is called when the writer has finished writing to the underlying resource. we must call writer.close()\n\t// because we have created the WriteStream with autoClose: false\n\twriter.once('finish', () => {\n\n\t\t// flush to disk\n\t\tif (canFlush && isOpen) {\n\t\t\tfs.fdatasync(fd, (syncError: Error) => {\n\n\t\t\t\t// In some exotic setups it is well possible that node fails to sync\n\t\t\t\t// In that case we disable flushing and warn to the console\n\t\t\t\tif (syncError) {\n\t\t\t\t\tconsole.warn('[node.js fs] fdatasync is now disabled for this session because it failed: ', syncError);\n\t\t\t\t\tcanFlush = false;\n\t\t\t\t}\n\n\t\t\t\twriter.destroy();\n\t\t\t});\n\t\t} else {\n\t\t\twriter.destroy();\n\t\t}\n\t});\n\n\t// Event: 'close'\n\t// Purpose: signal we are done to the outside\n\t// Notes: event is called when the writer's filedescriptor is closed\n\twriter.once('close', () => finish());\n}\n\n// Calls fs.writeFile() followed by a fs.sync() call to flush the changes to disk\n// We do this in cases where we want to make sure the data is really on disk and\n// not in some cache.\n//\n// See https://github.com/nodejs/node/blob/v5.10.0/lib/fs.js#L1194\nfunction doWriteFileAndFlush(path: string, data: string | Buffer, options: IWriteFileOptions, callback: (error?: Error) => void): void {\n\tif (options.encoding) {\n\t\tdata = encode(data, options.encoding.charset, { addBOM: options.encoding.addBOM });\n\t}\n\n\tif (!canFlush) {\n\t\treturn fs.writeFile(path, data, { mode: options.mode, flag: options.flag }, callback);\n\t}\n\n\t// Open the file with same flags and mode as fs.writeFile()\n\tfs.open(path, typeof options.flag === 'string' ? options.flag : 'r', options.mode, (openError, fd) => {\n\t\tif (openError) {\n\t\t\treturn callback(openError);\n\t\t}\n\n\t\t// It is valid to pass a fd handle to fs.writeFile() and this will keep the handle open!\n\t\tfs.writeFile(/** Desktop fd */path, data, writeError => {\n\t\t\tif (writeError) {\n\t\t\t\treturn fs.close(fd, () => callback(writeError)); // still need to close the handle on error!\n\t\t\t}\n\n\t\t\t// Flush contents (not metadata) of the file to disk\n\t\t\tfs.fdatasync(fd, (syncError: Error) => {\n\n\t\t\t\t// In some exotic setups it is well possible that node fails to sync\n\t\t\t\t// In that case we disable flushing and warn to the console\n\t\t\t\tif (syncError) {\n\t\t\t\t\tconsole.warn('[node.js fs] fdatasync is now disabled for this session because it failed: ', syncError);\n\t\t\t\t\tcanFlush = false;\n\t\t\t\t}\n\n\t\t\t\treturn fs.close(fd, closeError => callback(closeError));\n\t\t\t});\n\t\t});\n\t});\n}\n\nexport function writeFileAndFlushSync(path: string, data: string | Buffer, options?: IWriteFileOptions): void {\n\toptions = ensureOptions(options);\n\n\tif (options.encoding) {\n\t\tdata = encode(data, options.encoding.charset, { addBOM: options.encoding.addBOM });\n\t}\n\n\tif (!canFlush) {\n\t\treturn fs.writeFileSync(path, data, { mode: options.mode, flag: options.flag });\n\t}\n\n\t// Open the file with same flags and mode as fs.writeFile()\n\tconst fd = fs.openSync(path, typeof options.flag === 'string' ? options.flag : 'r', options.mode);\n\n\ttry {\n\n\t\t// It is valid to pass a fd handle to fs.writeFile() and this will keep the handle open!\n\t\tfs.writeFileSync(path, data);\n\n\t\t// Flush contents (not metadata) of the file to disk\n\t\ttry {\n\t\t\tfs.fdatasyncSync(fd);\n\t\t} catch (syncError) {\n\t\t\tconsole.warn('[node.js fs] fdatasyncSync is now disabled for this session because it failed: ', syncError);\n\t\t\tcanFlush = false;\n\t\t}\n\t} finally {\n\t\tfs.closeSync(fd);\n\t}\n}\n\nfunction ensureOptions(options?: IWriteFileOptions): IWriteFileOptions {\n\tif (!options) {\n\t\treturn { mode: 0o666, flag: 'w' };\n\t}\n\n\tconst ensuredOptions: IWriteFileOptions = { mode: options.mode, flag: options.flag, encoding: options.encoding };\n\n\tif (typeof ensuredOptions.mode !== 'number') {\n\t\tensuredOptions.mode = 0o666;\n\t}\n\n\tif (typeof ensuredOptions.flag !== 'string') {\n\t\tensuredOptions.flag = 'w';\n\t}\n\n\treturn ensuredOptions;\n}\n\n/**\n * Copied from: https://github.com/Microsoft/vscode-node-debug/blob/master/src/node/pathUtilities.ts#L83\n *\n * Given an absolute, normalized, and existing file path 'realcase' returns the exact path that the file has on disk.\n * On a case insensitive file system, the returned path might differ from the original path by character casing.\n * On a case sensitive file system, the returned path will always be identical to the original path.\n * In case of errors, null is returned. But you cannot use this function to verify that a path exists.\n * realcaseSync does not handle '..' or '.' path segments and it does not take the locale into account.\n */\nexport function realcaseSync(path: string): string | null {\n\tconst dir = paths.dirname(path);\n\tif (path === dir) {\t// end recursion\n\t\treturn path;\n\t}\n\n\tconst name = (paths.basename(path) /* can be '' for windows drive letters */ || path).toLowerCase();\n\ttry {\n\t\tconst entries = readdirSync(dir);\n\t\tconst found = entries.filter(e => e.toLowerCase() === name);\t// use a case insensitive search\n\t\tif (found.length === 1) {\n\t\t\t// on a case sensitive filesystem we cannot determine here, whether the file exists or not, hence we need the 'file exists' precondition\n\t\t\tconst prefix = realcaseSync(dir);   // recurse\n\t\t\tif (prefix) {\n\t\t\t\treturn paths.join(prefix, found[0]);\n\t\t\t}\n\t\t} else if (found.length > 1) {\n\t\t\t// must be a case sensitive $filesystem\n\t\t\tconst ix = found.indexOf(name);\n\t\t\tif (ix >= 0) {\t// case sensitive\n\t\t\t\tconst prefix = realcaseSync(dir);   // recurse\n\t\t\t\tif (prefix) {\n\t\t\t\t\treturn paths.join(prefix, found[ix]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\t// silently ignore error\n\t}\n\n\treturn null;\n}\n\nexport function realpathSync(path: string): string {\n\ttry {\n\t\treturn fs.realpathSync(path);\n\t} catch (error) {\n\n\t\t// We hit an error calling fs.realpathSync(). Since fs.realpathSync() is doing some path normalization\n\t\t// we now do a similar normalization and then try again if we can access the path with read\n\t\t// permissions at least. If that succeeds, we return that path.\n\t\t// fs.realpath() is resolving symlinks and that can fail in certain cases. The workaround is\n\t\t// to not resolve links but to simply see if the path is read accessible or not.\n\t\tconst normalizedPath = normalizePath(path);\n\t\tfs.accessSync(normalizedPath, fs.constants.R_OK); // throws in case of an error\n\n\t\treturn normalizedPath;\n\t}\n}\n\nexport function realpath(path: string, callback: (error: Error | null, realpath: string) => void): void {\n\treturn fs.realpath(path, (error, realpath) => {\n\t\tif (!error) {\n\t\t\treturn callback(null, realpath);\n\t\t}\n\n\t\t// We hit an error calling fs.realpath(). Since fs.realpath() is doing some path normalization\n\t\t// we now do a similar normalization and then try again if we can access the path with read\n\t\t// permissions at least. If that succeeds, we return that path.\n\t\t// fs.realpath() is resolving symlinks and that can fail in certain cases. The workaround is\n\t\t// to not resolve links but to simply see if the path is read accessible or not.\n\t\tconst normalizedPath = normalizePath(path);\n\n\t\treturn fs.access(normalizedPath, fs.constants.R_OK, error => {\n\t\t\treturn callback(error, normalizedPath);\n\t\t});\n\t});\n}\n\nfunction normalizePath(path: string): string {\n\treturn strings.rtrim(paths.normalize(path), paths.sep);\n}\n\nexport function watch(path: string, onChange: (type: string, path?: string) => void, onError: (error: string) => void): IDisposable {\n\ttry {\n\t\tconst watcher = fs.watch(path);\n\n\t\twatcher.on('change', (type, raw) => {\n\t\t\tlet file: string | undefined;\n\t\t\tif (raw) { // https://github.com/Microsoft/vscode/issues/38191\n\t\t\t\tfile = raw.toString();\n\t\t\t\tif (platform.isMacintosh) {\n\t\t\t\t\t// Mac: uses NFD unicode form on disk, but we want NFC\n\t\t\t\t\t// See also https://github.com/nodejs/node/issues/2165\n\t\t\t\t\tfile = normalizeNFC(file);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tonChange(type, file);\n\t\t});\n\n\t\twatcher.on('error', (code: number, signal: string) => onError(`Failed to watch ${path} for changes (${code}, ${signal})`));\n\n\t\treturn toDisposable(() => {\n\t\t\twatcher.removeAllListeners();\n\t\t\twatcher.close();\n\t\t});\n\t} catch (error) {\n\t\tfs.exists(path, exists => {\n\t\t\tif (exists) {\n\t\t\t\tonError(`Failed to watch ${path} for changes (${error.toString()})`);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn Disposable.None;\n}\n\nexport function sanitizeFilePath(candidate: string, cwd: string): string {\n\n\t// Special case: allow to open a drive letter without trailing backslash\n\tif (platform.isWindows && strings.endsWith(candidate, ':')) {\n\t\tcandidate += paths.sep;\n\t}\n\n\t// Ensure absolute\n\tif (!paths.isAbsolute(candidate)) {\n\t\tcandidate = paths.join(cwd, candidate);\n\t}\n\n\t// Ensure normalized\n\tcandidate = paths.normalize(candidate);\n\n\t// Ensure no trailing slash/backslash\n\tif (platform.isWindows) {\n\t\tcandidate = strings.rtrim(candidate, paths.sep);\n\n\t\t// Special case: allow to open drive root ('C:\\')\n\t\tif (strings.endsWith(candidate, ':')) {\n\t\t\tcandidate += paths.sep;\n\t\t}\n\n\t} else {\n\t\tcandidate = strings.rtrim(candidate, paths.sep);\n\n\t\t// Special case: allow to open root ('/')\n\t\tif (!candidate) {\n\t\t\tcandidate = paths.sep;\n\t\t}\n\t}\n\n\treturn candidate;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as extfs from 'vs/base/node/extfs';\nimport { join } from 'vs/base/common/path';\nimport { nfcall, Queue } from 'vs/base/common/async';\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport * as platform from 'vs/base/common/platform';\nimport { Event } from 'vs/base/common/event';\n\nexport function readdir(path: string): Promise<string[]> {\n\treturn nfcall(extfs.readdir, path);\n}\n\nexport function exists(path: string): Promise<boolean> {\n\treturn new Promise(c => fs.exists(path, c));\n}\n\nexport function chmod(path: string, mode: number): Promise<boolean> {\n\treturn nfcall(fs.chmod, path, mode);\n}\n\nexport import mkdirp = extfs.mkdirp;\n\nexport function rimraf(path: string): Promise<void> {\n\treturn lstat(path).then(stat => {\n\t\tif (stat.isDirectory() && !stat.isSymbolicLink()) {\n\t\t\treturn readdir(path)\n\t\t\t\t.then(children => Promise.all(children.map(child => rimraf(join(path, child)))))\n\t\t\t\t.then(() => rmdir(path));\n\t\t} else {\n\t\t\treturn unlink(path);\n\t\t}\n\t}, (err: NodeJS.ErrnoException) => {\n\t\tif (err.code === 'ENOENT') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn Promise.reject(err);\n\t});\n}\n\nexport function realpath(path: string): Promise<string> {\n\treturn nfcall(extfs.realpath, path);\n}\n\nexport function stat(path: string): Promise<fs.Stats> {\n\treturn nfcall(fs.stat, path);\n}\n\nexport function statLink(path: string): Promise<{ stat: fs.Stats, isSymbolicLink: boolean }> {\n\treturn nfcall(extfs.statLink, path);\n}\n\nexport function lstat(path: string): Promise<fs.Stats> {\n\treturn nfcall(fs.lstat, path);\n}\n\nexport function rename(oldPath: string, newPath: string): Promise<void> {\n\treturn nfcall(fs.rename, oldPath, newPath);\n}\n\nexport function renameIgnoreError(oldPath: string, newPath: string): Promise<void> {\n\treturn new Promise(resolve => {\n\t\tfs.rename(oldPath, newPath, () => resolve());\n\t});\n}\n\nexport function rmdir(path: string): Promise<void> {\n\treturn nfcall(fs.rmdir, path);\n}\n\nexport function unlink(path: string): Promise<void> {\n\treturn nfcall(fs.unlink, path);\n}\n\nexport function symlink(target: string, path: string, type?: string): Promise<void> {\n\treturn nfcall<void>(fs.symlink, target, path, type);\n}\n\nexport function readlink(path: string): Promise<string> {\n\treturn nfcall<string>(fs.readlink, path);\n}\n\nexport function truncate(path: string, len: number): Promise<void> {\n\treturn nfcall(fs.truncate, path, len);\n}\n\nexport function readFile(path: string): Promise<Buffer>;\nexport function readFile(path: string, encoding: string): Promise<string>;\nexport function readFile(path: string, encoding?: string): Promise<Buffer | string> {\n\treturn nfcall(fs.readFile, path, encoding);\n}\n\n// According to node.js docs (https://nodejs.org/docs/v6.5.0/api/fs.html#fs_fs_writefile_file_data_options_callback)\n// it is not safe to call writeFile() on the same path multiple times without waiting for the callback to return.\n// Therefor we use a Queue on the path that is given to us to sequentialize calls to the same path properly.\nconst writeFilePathQueue: { [path: string]: Queue<void> } = Object.create(null);\n\nexport function writeFile(path: string, data: string, options?: extfs.IWriteFileOptions): Promise<void>;\nexport function writeFile(path: string, data: Buffer, options?: extfs.IWriteFileOptions): Promise<void>;\nexport function writeFile(path: string, data: Uint8Array, options?: extfs.IWriteFileOptions): Promise<void>;\nexport function writeFile(path: string, data: NodeJS.ReadableStream, options?: extfs.IWriteFileOptions): Promise<void>;\nexport function writeFile(path: string, data: any, options?: extfs.IWriteFileOptions): Promise<void>;\nexport function writeFile(path: string, data: any, options?: extfs.IWriteFileOptions): any {\n\tconst queueKey = toQueueKey(path);\n\n\treturn ensureWriteFileQueue(queueKey).queue(() => nfcall(extfs.writeFileAndFlush, path, data, options));\n}\n\nfunction toQueueKey(path: string): string {\n\tlet queueKey = path;\n\tif (platform.isWindows || platform.isMacintosh) {\n\t\tqueueKey = queueKey.toLowerCase(); // accomodate for case insensitive file systems\n\t}\n\n\treturn queueKey;\n}\n\nfunction ensureWriteFileQueue(queueKey: string): Queue<void> {\n\tlet writeFileQueue = writeFilePathQueue[queueKey];\n\tif (!writeFileQueue) {\n\t\twriteFileQueue = new Queue<void>();\n\t\twriteFilePathQueue[queueKey] = writeFileQueue;\n\n\t\tconst onFinish = Event.once(writeFileQueue.onFinished);\n\t\tonFinish(() => {\n\t\t\tdelete writeFilePathQueue[queueKey];\n\t\t\twriteFileQueue.dispose();\n\t\t});\n\t}\n\n\treturn writeFileQueue;\n}\n\n/**\n* Read a dir and return only subfolders\n*/\nexport function readDirsInDir(dirPath: string): Promise<string[]> {\n\treturn readdir(dirPath).then(children => {\n\t\treturn Promise.all(children.map(c => dirExists(join(dirPath, c)))).then(exists => {\n\t\t\treturn children.filter((_, i) => exists[i]);\n\t\t});\n\t});\n}\n\n/**\n* `path` exists and is a directory\n*/\nexport function dirExists(path: string): Promise<boolean> {\n\treturn stat(path).then(stat => stat.isDirectory(), () => false);\n}\n\n/**\n* `path` exists and is a file.\n*/\nexport function fileExists(path: string): Promise<boolean> {\n\treturn stat(path).then(stat => stat.isFile(), () => false);\n}\n\n/**\n * Deletes a path from disk.\n */\nlet _tmpDir: string | null = null;\nfunction getTmpDir(): string {\n\tif (!_tmpDir) {\n\t\t_tmpDir = os.tmpdir();\n\t}\n\treturn _tmpDir;\n}\nexport function del(path: string, tmp = getTmpDir()): Promise<void> {\n\treturn nfcall(extfs.del, path, tmp);\n}\n\nexport function whenDeleted(path: string): Promise<void> {\n\n\t// Complete when wait marker file is deleted\n\treturn new Promise<void>(resolve => {\n\t\tlet running = false;\n\t\tconst interval = setInterval(() => {\n\t\t\tif (!running) {\n\t\t\t\trunning = true;\n\t\t\t\tfs.exists(path, exists => {\n\t\t\t\t\trunning = false;\n\n\t\t\t\t\tif (!exists) {\n\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t\tresolve(undefined);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}, 1000);\n\t});\n}\n\nexport function copy(source: string, target: string): Promise<void> {\n\treturn nfcall(extfs.copy, source, target);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable, toDisposable, combinedDisposable } from 'vs/base/common/lifecycle';\nimport { Event, Emitter, Relay } from 'vs/base/common/event';\nimport { CancelablePromise, createCancelablePromise, timeout } from 'vs/base/common/async';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport * as errors from 'vs/base/common/errors';\n\nexport const enum RequestType {\n\tPromise = 100,\n\tPromiseCancel = 101,\n\tEventListen = 102,\n\tEventDispose = 103\n}\n\ntype IRawPromiseRequest = { type: RequestType.Promise; id: number; channelName: string; name: string; arg: any; };\ntype IRawPromiseCancelRequest = { type: RequestType.PromiseCancel, id: number };\ntype IRawEventListenRequest = { type: RequestType.EventListen; id: number; channelName: string; name: string; arg: any; };\ntype IRawEventDisposeRequest = { type: RequestType.EventDispose, id: number };\ntype IRawRequest = IRawPromiseRequest | IRawPromiseCancelRequest | IRawEventListenRequest | IRawEventDisposeRequest;\n\nexport const enum ResponseType {\n\tInitialize = 200,\n\tPromiseSuccess = 201,\n\tPromiseError = 202,\n\tPromiseErrorObj = 203,\n\tEventFire = 204\n}\n\ntype IRawInitializeResponse = { type: ResponseType.Initialize };\ntype IRawPromiseSuccessResponse = { type: ResponseType.PromiseSuccess; id: number; data: any };\ntype IRawPromiseErrorResponse = { type: ResponseType.PromiseError; id: number; data: { message: string, name: string, stack: string[] | undefined } };\ntype IRawPromiseErrorObjResponse = { type: ResponseType.PromiseErrorObj; id: number; data: any };\ntype IRawEventFireResponse = { type: ResponseType.EventFire; id: number; data: any };\ntype IRawResponse = IRawInitializeResponse | IRawPromiseSuccessResponse | IRawPromiseErrorResponse | IRawPromiseErrorObjResponse | IRawEventFireResponse;\n\ninterface IHandler {\n\t(response: IRawResponse): void;\n}\n\nexport interface IMessagePassingProtocol {\n\tsend(buffer: Buffer): void;\n\tonMessage: Event<Buffer>;\n}\n\nenum State {\n\tUninitialized,\n\tIdle\n}\n\n/**\n * An `IChannel` is an abstraction over a collection of commands.\n * You can `call` several commands on a channel, each taking at\n * most one single argument. A `call` always returns a promise\n * with at most one single return value.\n */\nexport interface IChannel {\n\tcall<T>(command: string, arg?: any, cancellationToken?: CancellationToken): Promise<T>;\n\tlisten<T>(event: string, arg?: any): Event<T>;\n}\n\n/**\n * An `IServerChannel` is the couter part to `IChannel`,\n * on the server-side. You should implement this interface\n * if you'd like to handle remote promises or events.\n */\nexport interface IServerChannel<TContext = string> {\n\tcall<T>(ctx: TContext, command: string, arg?: any, cancellationToken?: CancellationToken): Promise<T>;\n\tlisten<T>(ctx: TContext, event: string, arg?: any): Event<T>;\n}\n\n/**\n * An `IChannelServer` hosts a collection of channels. You are\n * able to register channels onto it, provided a channel name.\n */\nexport interface IChannelServer<TContext = string> {\n\tregisterChannel(channelName: string, channel: IServerChannel<TContext>): void;\n}\n\n/**\n * An `IChannelClient` has access to a collection of channels. You\n * are able to get those channels, given their channel name.\n */\nexport interface IChannelClient {\n\tgetChannel<T extends IChannel>(channelName: string): T;\n}\n\nexport interface Client<TContext> {\n\treadonly ctx: TContext;\n}\n\nexport interface IConnectionHub<TContext> {\n\treadonly connections: Connection<TContext>[];\n\treadonly onDidChangeConnections: Event<Connection<TContext>>;\n}\n\n/**\n * An `IClientRouter` is responsible for routing calls to specific\n * channels, in scenarios in which there are multiple possible\n * channels (each from a separate client) to pick from.\n */\nexport interface IClientRouter<TContext = string> {\n\trouteCall(hub: IConnectionHub<TContext>, command: string, arg?: any, cancellationToken?: CancellationToken): Promise<Client<TContext>>;\n\trouteEvent(hub: IConnectionHub<TContext>, event: string, arg?: any): Promise<Client<TContext>>;\n}\n\n/**\n * Similar to the `IChannelClient`, you can get channels from this\n * collection of channels. The difference being that in the\n * `IRoutingChannelClient`, there are multiple clients providing\n * the same channel. You'll need to pass in an `IClientRouter` in\n * order to pick the right one.\n */\nexport interface IRoutingChannelClient<TContext = string> {\n\tgetChannel<T extends IChannel>(channelName: string, router: IClientRouter<TContext>): T;\n}\n\ninterface IReader {\n\tread(bytes: number): Buffer;\n}\n\ninterface IWriter {\n\twrite(buffer: Buffer): void;\n}\n\nclass BufferReader implements IReader {\n\n\tprivate pos = 0;\n\n\tconstructor(private buffer: Buffer) { }\n\n\tread(bytes: number): Buffer {\n\t\tconst result = this.buffer.slice(this.pos, this.pos + bytes);\n\t\tthis.pos += result.length;\n\t\treturn result;\n\t}\n}\n\nclass BufferWriter implements IWriter {\n\n\tprivate buffers: Buffer[] = [];\n\n\tget buffer(): Buffer {\n\t\treturn Buffer.concat(this.buffers);\n\t}\n\n\twrite(buffer: Buffer): void {\n\t\tthis.buffers.push(buffer);\n\t}\n}\n\nenum DataType {\n\tUndefined = 0,\n\tString = 1,\n\tBuffer = 2,\n\tArray = 3,\n\tObject = 4\n}\n\nfunction createSizeBuffer(size: number): Buffer {\n\tconst result = Buffer.allocUnsafe(4);\n\tresult.writeUInt32BE(size, 0);\n\treturn result;\n}\n\nfunction readSizeBuffer(reader: IReader): number {\n\treturn reader.read(4).readUInt32BE(0);\n}\n\nconst BufferPresets = {\n\tUndefined: Buffer.alloc(1, DataType.Undefined),\n\tString: Buffer.alloc(1, DataType.String),\n\tBuffer: Buffer.alloc(1, DataType.Buffer),\n\tArray: Buffer.alloc(1, DataType.Array),\n\tObject: Buffer.alloc(1, DataType.Object)\n};\n\nfunction serialize(writer: IWriter, data: any): void {\n\tif (typeof data === 'undefined') {\n\t\twriter.write(BufferPresets.Undefined);\n\t} else if (typeof data === 'string') {\n\t\tconst buffer = Buffer.from(data);\n\t\twriter.write(BufferPresets.String);\n\t\twriter.write(createSizeBuffer(buffer.length));\n\t\twriter.write(buffer);\n\t} else if (Buffer.isBuffer(data)) {\n\t\twriter.write(BufferPresets.Buffer);\n\t\twriter.write(createSizeBuffer(data.length));\n\t\twriter.write(data);\n\t} else if (Array.isArray(data)) {\n\t\twriter.write(BufferPresets.Array);\n\t\twriter.write(createSizeBuffer(data.length));\n\n\t\tfor (const el of data) {\n\t\t\tserialize(writer, el);\n\t\t}\n\t} else {\n\t\tconst buffer = Buffer.from(JSON.stringify(data));\n\t\twriter.write(BufferPresets.Object);\n\t\twriter.write(createSizeBuffer(buffer.length));\n\t\twriter.write(buffer);\n\t}\n}\n\nfunction deserialize(reader: IReader): any {\n\tconst type = reader.read(1).readUInt8(0);\n\n\tswitch (type) {\n\t\tcase DataType.Undefined: return undefined;\n\t\tcase DataType.String: return reader.read(readSizeBuffer(reader)).toString();\n\t\tcase DataType.Buffer: return reader.read(readSizeBuffer(reader));\n\t\tcase DataType.Array: {\n\t\t\tconst length = readSizeBuffer(reader);\n\t\t\tconst result: any[] = [];\n\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tresult.push(deserialize(reader));\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t\tcase DataType.Object: return JSON.parse(reader.read(readSizeBuffer(reader)).toString());\n\t}\n}\n\nexport class ChannelServer<TContext = string> implements IChannelServer<TContext>, IDisposable {\n\n\tprivate channels = new Map<string, IServerChannel<TContext>>();\n\tprivate activeRequests = new Map<number, IDisposable>();\n\tprivate protocolListener: IDisposable | null;\n\n\tconstructor(private protocol: IMessagePassingProtocol, private ctx: TContext) {\n\t\tthis.protocolListener = this.protocol.onMessage(msg => this.onRawMessage(msg));\n\t\tthis.sendResponse({ type: ResponseType.Initialize });\n\t}\n\n\tregisterChannel(channelName: string, channel: IServerChannel<TContext>): void {\n\t\tthis.channels.set(channelName, channel);\n\t}\n\n\tprivate sendResponse(response: IRawResponse): void {\n\t\tswitch (response.type) {\n\t\t\tcase ResponseType.Initialize:\n\t\t\t\treturn this.send([response.type]);\n\n\t\t\tcase ResponseType.PromiseSuccess:\n\t\t\tcase ResponseType.PromiseError:\n\t\t\tcase ResponseType.EventFire:\n\t\t\tcase ResponseType.PromiseErrorObj:\n\t\t\t\treturn this.send([response.type, response.id], response.data);\n\t\t}\n\t}\n\n\tprivate send(header: any, body: any = undefined): void {\n\t\tconst writer = new BufferWriter();\n\t\tserialize(writer, header);\n\t\tserialize(writer, body);\n\t\tthis.sendBuffer(writer.buffer);\n\t}\n\n\tprivate sendBuffer(message: Buffer): void {\n\t\ttry {\n\t\t\tthis.protocol.send(message);\n\t\t} catch (err) {\n\t\t\t// noop\n\t\t}\n\t}\n\n\tprivate onRawMessage(message: Buffer): void {\n\t\tconst reader = new BufferReader(message);\n\t\tconst header = deserialize(reader);\n\t\tconst body = deserialize(reader);\n\t\tconst type = header[0] as RequestType;\n\n\t\tswitch (type) {\n\t\t\tcase RequestType.Promise:\n\t\t\t\treturn this.onPromise({ type, id: header[1], channelName: header[2], name: header[3], arg: body });\n\t\t\tcase RequestType.EventListen:\n\t\t\t\treturn this.onEventListen({ type, id: header[1], channelName: header[2], name: header[3], arg: body });\n\t\t\tcase RequestType.PromiseCancel:\n\t\t\t\treturn this.disposeActiveRequest({ type, id: header[1] });\n\t\t\tcase RequestType.EventDispose:\n\t\t\t\treturn this.disposeActiveRequest({ type, id: header[1] });\n\t\t}\n\t}\n\n\tprivate onPromise(request: IRawPromiseRequest): void {\n\t\tconst channel = this.channels.get(request.channelName);\n\t\tif (!channel) {\n\t\t\tthrow new Error('Unknown channel');\n\t\t}\n\t\tconst cancellationTokenSource = new CancellationTokenSource();\n\t\tlet promise: Promise<any>;\n\n\t\ttry {\n\t\t\tpromise = channel.call(this.ctx, request.name, request.arg, cancellationTokenSource.token);\n\t\t} catch (err) {\n\t\t\tpromise = Promise.reject(err);\n\t\t}\n\n\t\tconst id = request.id;\n\n\t\tpromise.then(data => {\n\t\t\tthis.sendResponse(<IRawResponse>{ id, data, type: ResponseType.PromiseSuccess });\n\t\t\tthis.activeRequests.delete(request.id);\n\t\t}, err => {\n\t\t\tif (err instanceof Error) {\n\t\t\t\tthis.sendResponse(<IRawResponse>{\n\t\t\t\t\tid, data: {\n\t\t\t\t\t\tmessage: err.message,\n\t\t\t\t\t\tname: err.name,\n\t\t\t\t\t\tstack: err.stack ? (err.stack.split ? err.stack.split('\\n') : err.stack) : undefined\n\t\t\t\t\t}, type: ResponseType.PromiseError\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.sendResponse(<IRawResponse>{ id, data: err, type: ResponseType.PromiseErrorObj });\n\t\t\t}\n\n\t\t\tthis.activeRequests.delete(request.id);\n\t\t});\n\n\t\tconst disposable = toDisposable(() => cancellationTokenSource.cancel());\n\t\tthis.activeRequests.set(request.id, disposable);\n\t}\n\n\tprivate onEventListen(request: IRawEventListenRequest): void {\n\t\tconst channel = this.channels.get(request.channelName);\n\t\tif (!channel) {\n\t\t\tthrow new Error('Unknown channel');\n\t\t}\n\n\t\tconst id = request.id;\n\t\tconst event = channel.listen(this.ctx, request.name, request.arg);\n\t\tconst disposable = event(data => this.sendResponse(<IRawResponse>{ id, data, type: ResponseType.EventFire }));\n\n\t\tthis.activeRequests.set(request.id, disposable);\n\t}\n\n\tprivate disposeActiveRequest(request: IRawRequest): void {\n\t\tconst disposable = this.activeRequests.get(request.id);\n\n\t\tif (disposable) {\n\t\t\tdisposable.dispose();\n\t\t\tthis.activeRequests.delete(request.id);\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this.protocolListener) {\n\t\t\tthis.protocolListener.dispose();\n\t\t\tthis.protocolListener = null;\n\t\t}\n\t\tthis.activeRequests.forEach(d => d.dispose());\n\t\tthis.activeRequests.clear();\n\t}\n}\n\nexport class ChannelClient implements IChannelClient, IDisposable {\n\n\tprivate state: State = State.Uninitialized;\n\tprivate activeRequests = new Set<IDisposable>();\n\tprivate handlers = new Map<number, IHandler>();\n\tprivate lastRequestId: number = 0;\n\tprivate protocolListener: IDisposable | null;\n\n\tprivate _onDidInitialize = new Emitter<void>();\n\treadonly onDidInitialize = this._onDidInitialize.event;\n\n\tconstructor(private protocol: IMessagePassingProtocol) {\n\t\tthis.protocolListener = this.protocol.onMessage(msg => this.onBuffer(msg));\n\t}\n\n\tgetChannel<T extends IChannel>(channelName: string): T {\n\t\tconst that = this;\n\t\treturn {\n\t\t\tcall(command: string, arg?: any, cancellationToken?: CancellationToken) {\n\t\t\t\treturn that.requestPromise(channelName, command, arg, cancellationToken);\n\t\t\t},\n\t\t\tlisten(event: string, arg: any) {\n\t\t\t\treturn that.requestEvent(channelName, event, arg);\n\t\t\t}\n\t\t} as T;\n\t}\n\n\tprivate requestPromise(channelName: string, name: string, arg?: any, cancellationToken = CancellationToken.None): Promise<any> {\n\t\tconst id = this.lastRequestId++;\n\t\tconst type = RequestType.Promise;\n\t\tconst request: IRawRequest = { id, type, channelName, name, arg };\n\n\t\tif (cancellationToken.isCancellationRequested) {\n\t\t\treturn Promise.reject(errors.canceled());\n\t\t}\n\n\t\tlet disposable: IDisposable;\n\n\t\tconst result = new Promise((c, e) => {\n\t\t\tif (cancellationToken.isCancellationRequested) {\n\t\t\t\treturn e(errors.canceled());\n\t\t\t}\n\n\t\t\tlet uninitializedPromise: CancelablePromise<void> | null = createCancelablePromise(_ => this.whenInitialized());\n\t\t\tuninitializedPromise.then(() => {\n\t\t\t\tuninitializedPromise = null;\n\n\t\t\t\tconst handler: IHandler = response => {\n\t\t\t\t\tswitch (response.type) {\n\t\t\t\t\t\tcase ResponseType.PromiseSuccess:\n\t\t\t\t\t\t\tthis.handlers.delete(id);\n\t\t\t\t\t\t\tc(response.data);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase ResponseType.PromiseError:\n\t\t\t\t\t\t\tthis.handlers.delete(id);\n\t\t\t\t\t\t\tconst error = new Error(response.data.message);\n\t\t\t\t\t\t\t(<any>error).stack = response.data.stack;\n\t\t\t\t\t\t\terror.name = response.data.name;\n\t\t\t\t\t\t\te(error);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase ResponseType.PromiseErrorObj:\n\t\t\t\t\t\t\tthis.handlers.delete(id);\n\t\t\t\t\t\t\te(response.data);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.handlers.set(id, handler);\n\t\t\t\tthis.sendRequest(request);\n\t\t\t});\n\n\t\t\tconst cancel = () => {\n\t\t\t\tif (uninitializedPromise) {\n\t\t\t\t\tuninitializedPromise.cancel();\n\t\t\t\t\tuninitializedPromise = null;\n\t\t\t\t} else {\n\t\t\t\t\tthis.sendRequest({ id, type: RequestType.PromiseCancel });\n\t\t\t\t}\n\n\t\t\t\te(errors.canceled());\n\t\t\t};\n\n\t\t\tconst cancellationTokenListener = cancellationToken.onCancellationRequested(cancel);\n\t\t\tdisposable = combinedDisposable([toDisposable(cancel), cancellationTokenListener]);\n\t\t\tthis.activeRequests.add(disposable);\n\t\t});\n\n\t\treturn result.finally(() => this.activeRequests.delete(disposable));\n\t}\n\n\tprivate requestEvent(channelName: string, name: string, arg?: any): Event<any> {\n\t\tconst id = this.lastRequestId++;\n\t\tconst type = RequestType.EventListen;\n\t\tconst request: IRawRequest = { id, type, channelName, name, arg };\n\n\t\tlet uninitializedPromise: CancelablePromise<void> | null = null;\n\n\t\tconst emitter = new Emitter<any>({\n\t\t\tonFirstListenerAdd: () => {\n\t\t\t\tuninitializedPromise = createCancelablePromise(_ => this.whenInitialized());\n\t\t\t\tuninitializedPromise.then(() => {\n\t\t\t\t\tuninitializedPromise = null;\n\t\t\t\t\tthis.activeRequests.add(emitter);\n\t\t\t\t\tthis.sendRequest(request);\n\t\t\t\t});\n\t\t\t},\n\t\t\tonLastListenerRemove: () => {\n\t\t\t\tif (uninitializedPromise) {\n\t\t\t\t\tuninitializedPromise.cancel();\n\t\t\t\t\tuninitializedPromise = null;\n\t\t\t\t} else {\n\t\t\t\t\tthis.activeRequests.delete(emitter);\n\t\t\t\t\tthis.sendRequest({ id, type: RequestType.EventDispose });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst handler: IHandler = (res: IRawEventFireResponse) => emitter.fire(res.data);\n\t\tthis.handlers.set(id, handler);\n\n\t\treturn emitter.event;\n\t}\n\n\tprivate sendRequest(request: IRawRequest): void {\n\t\tswitch (request.type) {\n\t\t\tcase RequestType.Promise:\n\t\t\tcase RequestType.EventListen:\n\t\t\t\treturn this.send([request.type, request.id, request.channelName, request.name], request.arg);\n\n\t\t\tcase RequestType.PromiseCancel:\n\t\t\tcase RequestType.EventDispose:\n\t\t\t\treturn this.send([request.type, request.id]);\n\t\t}\n\t}\n\n\tprivate send(header: any, body: any = undefined): void {\n\t\tconst writer = new BufferWriter();\n\t\tserialize(writer, header);\n\t\tserialize(writer, body);\n\t\tthis.sendBuffer(writer.buffer);\n\t}\n\n\tprivate sendBuffer(message: Buffer): void {\n\t\ttry {\n\t\t\tthis.protocol.send(message);\n\t\t} catch (err) {\n\t\t\t// noop\n\t\t}\n\t}\n\n\tprivate onBuffer(message: Buffer): void {\n\t\tconst reader = new BufferReader(message);\n\t\tconst header = deserialize(reader);\n\t\tconst body = deserialize(reader);\n\t\tconst type: ResponseType = header[0];\n\n\t\tswitch (type) {\n\t\t\tcase ResponseType.Initialize:\n\t\t\t\treturn this.onResponse({ type: header[0] });\n\n\t\t\tcase ResponseType.PromiseSuccess:\n\t\t\tcase ResponseType.PromiseError:\n\t\t\tcase ResponseType.EventFire:\n\t\t\tcase ResponseType.PromiseErrorObj:\n\t\t\t\treturn this.onResponse({ type: header[0], id: header[1], data: body });\n\t\t}\n\t}\n\n\tprivate onResponse(response: IRawResponse): void {\n\t\tif (response.type === ResponseType.Initialize) {\n\t\t\tthis.state = State.Idle;\n\t\t\tthis._onDidInitialize.fire();\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = this.handlers.get(response.id);\n\n\t\tif (handler) {\n\t\t\thandler(response);\n\t\t}\n\t}\n\n\tprivate whenInitialized(): Promise<void> {\n\t\tif (this.state === State.Idle) {\n\t\t\treturn Promise.resolve();\n\t\t} else {\n\t\t\treturn Event.toPromise(this.onDidInitialize);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tif (this.protocolListener) {\n\t\t\tthis.protocolListener.dispose();\n\t\t\tthis.protocolListener = null;\n\t\t}\n\t\tthis.activeRequests.forEach(p => p.dispose());\n\t\tthis.activeRequests.clear();\n\t}\n}\n\nexport interface ClientConnectionEvent {\n\tprotocol: IMessagePassingProtocol;\n\tonDidClientDisconnect: Event<void>;\n}\n\ninterface Connection<TContext> extends Client<TContext> {\n\treadonly channelClient: ChannelClient;\n}\n\n/**\n * An `IPCServer` is both a channel server and a routing channel\n * client.\n *\n * As the owner of a protocol, you should extend both this\n * and the `IPCClient` classes to get IPC implementations\n * for your protocol.\n */\nexport class IPCServer<TContext = string> implements IChannelServer<TContext>, IRoutingChannelClient<TContext>, IConnectionHub<TContext>, IDisposable {\n\n\tprivate channels = new Map<string, IServerChannel<TContext>>();\n\tprivate _connections = new Set<Connection<TContext>>();\n\n\tprivate _onDidChangeConnections = new Emitter<Connection<TContext>>();\n\treadonly onDidChangeConnections: Event<Connection<TContext>> = this._onDidChangeConnections.event;\n\n\tget connections(): Connection<TContext>[] {\n\t\tconst result: Connection<TContext>[] = [];\n\t\tthis._connections.forEach(ctx => result.push(ctx));\n\t\treturn result;\n\t}\n\n\tconstructor(onDidClientConnect: Event<ClientConnectionEvent>) {\n\t\tonDidClientConnect(({ protocol, onDidClientDisconnect }) => {\n\t\t\tconst onFirstMessage = Event.once(protocol.onMessage);\n\n\t\t\tonFirstMessage(msg => {\n\t\t\t\tconst reader = new BufferReader(msg);\n\t\t\t\tconst ctx = deserialize(reader) as TContext;\n\n\t\t\t\tconst channelServer = new ChannelServer(protocol, ctx);\n\t\t\t\tconst channelClient = new ChannelClient(protocol);\n\n\t\t\t\tthis.channels.forEach((channel, name) => channelServer.registerChannel(name, channel));\n\n\t\t\t\tconst connection: Connection<TContext> = { channelClient, ctx };\n\t\t\t\tthis._connections.add(connection);\n\t\t\t\tthis._onDidChangeConnections.fire(connection);\n\n\t\t\t\tonDidClientDisconnect(() => {\n\t\t\t\t\tchannelServer.dispose();\n\t\t\t\t\tchannelClient.dispose();\n\t\t\t\t\tthis._connections.delete(connection);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetChannel<T extends IChannel>(channelName: string, router: IClientRouter<TContext>): T {\n\t\tconst that = this;\n\n\t\treturn {\n\t\t\tcall(command: string, arg?: any, cancellationToken?: CancellationToken) {\n\t\t\t\tconst channelPromise = router.routeCall(that, command, arg)\n\t\t\t\t\t.then(connection => (connection as Connection<TContext>).channelClient.getChannel(channelName));\n\n\t\t\t\treturn getDelayedChannel(channelPromise)\n\t\t\t\t\t.call(command, arg, cancellationToken);\n\t\t\t},\n\t\t\tlisten(event: string, arg: any) {\n\t\t\t\tconst channelPromise = router.routeEvent(that, event, arg)\n\t\t\t\t\t.then(connection => (connection as Connection<TContext>).channelClient.getChannel(channelName));\n\n\t\t\t\treturn getDelayedChannel(channelPromise)\n\t\t\t\t\t.listen(event, arg);\n\t\t\t}\n\t\t} as T;\n\t}\n\n\tregisterChannel(channelName: string, channel: IServerChannel<TContext>): void {\n\t\tthis.channels.set(channelName, channel);\n\t}\n\n\tdispose(): void {\n\t\tthis.channels.clear();\n\t\tthis._connections.clear();\n\t\tthis._onDidChangeConnections.dispose();\n\t}\n}\n\n/**\n * An `IPCClient` is both a channel client and a channel server.\n *\n * As the owner of a protocol, you should extend both this\n * and the `IPCClient` classes to get IPC implementations\n * for your protocol.\n */\nexport class IPCClient<TContext = string> implements IChannelClient, IChannelServer<TContext>, IDisposable {\n\n\tprivate channelClient: ChannelClient;\n\tprivate channelServer: ChannelServer<TContext>;\n\n\tconstructor(protocol: IMessagePassingProtocol, ctx: TContext) {\n\t\tconst writer = new BufferWriter();\n\t\tserialize(writer, ctx);\n\t\tprotocol.send(writer.buffer);\n\n\t\tthis.channelClient = new ChannelClient(protocol);\n\t\tthis.channelServer = new ChannelServer(protocol, ctx);\n\t}\n\n\tgetChannel<T extends IChannel>(channelName: string): T {\n\t\treturn this.channelClient.getChannel(channelName) as T;\n\t}\n\n\tregisterChannel(channelName: string, channel: IServerChannel<TContext>): void {\n\t\tthis.channelServer.registerChannel(channelName, channel);\n\t}\n\n\tdispose(): void {\n\t\tthis.channelClient.dispose();\n\t\tthis.channelServer.dispose();\n\t}\n}\n\nexport function getDelayedChannel<T extends IChannel>(promise: Promise<T>): T {\n\treturn {\n\t\tcall(command: string, arg?: any, cancellationToken?: CancellationToken): Promise<T> {\n\t\t\treturn promise.then(c => c.call<T>(command, arg, cancellationToken));\n\t\t},\n\n\t\tlisten<T>(event: string, arg?: any): Event<T> {\n\t\t\tconst relay = new Relay<any>();\n\t\t\tpromise.then(c => relay.input = c.listen(event, arg));\n\t\t\treturn relay.event;\n\t\t}\n\t} as T;\n}\n\nexport function getNextTickChannel<T extends IChannel>(channel: T): T {\n\tlet didTick = false;\n\n\treturn {\n\t\tcall<T>(command: string, arg?: any, cancellationToken?: CancellationToken): Promise<T> {\n\t\t\tif (didTick) {\n\t\t\t\treturn channel.call(command, arg, cancellationToken);\n\t\t\t}\n\n\t\t\treturn timeout(0)\n\t\t\t\t.then(() => didTick = true)\n\t\t\t\t.then(() => channel.call<T>(command, arg, cancellationToken));\n\t\t},\n\t\tlisten<T>(event: string, arg?: any): Event<T> {\n\t\t\tif (didTick) {\n\t\t\t\treturn channel.listen<T>(event, arg);\n\t\t\t}\n\n\t\t\tconst relay = new Relay<T>();\n\n\t\t\ttimeout(0)\n\t\t\t\t.then(() => didTick = true)\n\t\t\t\t.then(() => relay.input = channel.listen<T>(event, arg));\n\n\t\t\treturn relay.event;\n\t\t}\n\t} as T;\n}\n\nexport class StaticRouter<TContext = string> implements IClientRouter<TContext> {\n\n\tconstructor(private fn: (ctx: TContext) => boolean | Promise<boolean>) { }\n\n\trouteCall(hub: IConnectionHub<TContext>): Promise<Client<TContext>> {\n\t\treturn this.route(hub);\n\t}\n\n\trouteEvent(hub: IConnectionHub<TContext>): Promise<Client<TContext>> {\n\t\treturn this.route(hub);\n\t}\n\n\tprivate async route(hub: IConnectionHub<TContext>): Promise<Client<TContext>> {\n\t\tfor (const connection of hub.connections) {\n\t\t\tif (await Promise.resolve(this.fn(connection.ctx))) {\n\t\t\t\treturn Promise.resolve(connection);\n\t\t\t}\n\t\t}\n\n\t\tawait Event.toPromise(hub.onDidChangeConnections);\n\t\treturn await this.route(hub);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMessagePassingProtocol } from 'vs/base/parts/ipc/node/ipc';\nimport { Event } from 'vs/base/common/event';\n\nexport interface Sender {\n\tsend(channel: string, msg: Buffer | null): void;\n}\n\nexport class Protocol implements IMessagePassingProtocol {\n\n\tconstructor(private sender: Sender, readonly onMessage: Event<Buffer>) { }\n\n\tsend(message: Buffer): void {\n\t\ttry {\n\t\t\tthis.sender.send('ipc:message', message);\n\t\t} catch (e) {\n\t\t\t// systems are going down\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.sender.send('ipc:disconnect', null);\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { IPCClient } from 'vs/base/parts/ipc/node/ipc';\nimport { Protocol } from 'vs/base/parts/ipc/node/ipc.electron';\nimport { ipcRenderer } from 'electron';\nimport { IDisposable } from 'vs/base/common/lifecycle';\n\nexport class Client extends IPCClient implements IDisposable {\n\n\tprivate protocol: Protocol;\n\n\tprivate static createProtocol(): Protocol {\n\t\tconst onMessage = Event.fromNodeEventEmitter<Buffer>(ipcRenderer, 'ipc:message', (_, message: Buffer) => message);\n\t\tipcRenderer.send('ipc:hello');\n\t\treturn new Protocol(ipcRenderer, onMessage);\n\t}\n\n\tconstructor(id: string) {\n\t\tconst protocol = Client.createProtocol();\n\t\tsuper(protocol, id);\n\t\tthis.protocol = protocol;\n\t}\n\n\tdispose(): void {\n\t\tthis.protocol.dispose();\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Socket, Server as NetServer, createConnection, createServer } from 'net';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IMessagePassingProtocol, ClientConnectionEvent, IPCServer, IPCClient } from 'vs/base/parts/ipc/node/ipc';\nimport { join } from 'vs/base/common/path';\nimport { tmpdir } from 'os';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { IDisposable } from 'vs/base/common/lifecycle';\n\nexport function generateRandomPipeName(): string {\n\tconst randomSuffix = generateUuid();\n\tif (process.platform === 'win32') {\n\t\treturn `\\\\\\\\.\\\\pipe\\\\vscode-ipc-${randomSuffix}-sock`;\n\t} else {\n\t\t// Mac/Unix: use socket file\n\t\treturn join(tmpdir(), `vscode-ipc-${randomSuffix}.sock`);\n\t}\n}\n\nclass ChunkStream {\n\n\tprivate _chunks: Buffer[];\n\tprivate _totalLength: number;\n\n\tpublic get byteLength() {\n\t\treturn this._totalLength;\n\t}\n\n\tconstructor() {\n\t\tthis._chunks = [];\n\t\tthis._totalLength = 0;\n\t}\n\n\tpublic acceptChunk(buff: Buffer) {\n\t\tthis._chunks.push(buff);\n\t\tthis._totalLength += buff.byteLength;\n\t}\n\n\tpublic readUInt32BE(): number {\n\t\tlet tmp = this.read(4);\n\t\treturn tmp.readUInt32BE(0);\n\t}\n\n\tpublic read(byteCount: number): Buffer {\n\t\tif (byteCount === 0) {\n\t\t\treturn Buffer.allocUnsafe(0);\n\t\t}\n\n\t\tif (byteCount > this._totalLength) {\n\t\t\tthrow new Error(`Cannot read so many bytes!`);\n\t\t}\n\n\t\tif (this._chunks[0].byteLength === byteCount) {\n\t\t\t// super fast path, precisely first chunk must be returned\n\t\t\tconst result = this._chunks.shift()!;\n\t\t\tthis._totalLength -= byteCount;\n\t\t\treturn result;\n\t\t}\n\n\t\tif (this._chunks[0].byteLength > byteCount) {\n\t\t\t// fast path, the reading is entirely within the first chunk\n\t\t\tconst result = this._chunks[0].slice(0, byteCount);\n\t\t\tthis._chunks[0] = this._chunks[0].slice(byteCount);\n\t\t\tthis._totalLength -= byteCount;\n\t\t\treturn result;\n\t\t}\n\n\t\tlet result = Buffer.allocUnsafe(byteCount);\n\t\tlet resultOffset = 0;\n\t\twhile (byteCount > 0) {\n\t\t\tconst chunk = this._chunks[0];\n\t\t\tif (chunk.byteLength > byteCount) {\n\t\t\t\t// this chunk will survive\n\t\t\t\tthis._chunks[0] = chunk.slice(byteCount);\n\n\t\t\t\tchunk.copy(result, resultOffset, 0, byteCount);\n\t\t\t\tresultOffset += byteCount;\n\t\t\t\tthis._totalLength -= byteCount;\n\t\t\t\tbyteCount -= byteCount;\n\t\t\t} else {\n\t\t\t\t// this chunk will be entirely read\n\t\t\t\tthis._chunks.shift();\n\n\t\t\t\tchunk.copy(result, resultOffset, 0, chunk.byteLength);\n\t\t\t\tresultOffset += chunk.byteLength;\n\t\t\t\tthis._totalLength -= chunk.byteLength;\n\t\t\t\tbyteCount -= chunk.byteLength;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\n/**\n * A message has the following format:\n *\n * \t\t[bodyLen|message]\n * \t\t[header^|data^^^]\n * \t\t[u32be^^|buffer^]\n */\n\nexport class Protocol implements IDisposable, IMessagePassingProtocol {\n\n\tprivate static readonly _headerLen = 4;\n\n\tprivate _isDisposed: boolean;\n\tprivate _incomingData: ChunkStream;\n\n\tprivate _socketDataListener: (data: Buffer) => void;\n\tprivate _socketEndListener: () => void;\n\tprivate _socketCloseListener: () => void;\n\n\tprivate _onMessage = new Emitter<Buffer>();\n\treadonly onMessage: Event<Buffer> = this._onMessage.event;\n\n\tprivate _onClose = new Emitter<void>();\n\treadonly onClose: Event<void> = this._onClose.event;\n\n\tconstructor(private _socket: Socket) {\n\t\tthis._isDisposed = false;\n\t\tthis._incomingData = new ChunkStream();\n\n\t\tconst state = {\n\t\t\treadHead: true,\n\t\t\tbodyLen: -1,\n\t\t};\n\n\t\tconst acceptChunk = (data: Buffer) => {\n\n\t\t\tthis._incomingData.acceptChunk(data);\n\n\t\t\twhile (this._incomingData.byteLength > 0) {\n\n\t\t\t\tif (state.readHead) {\n\t\t\t\t\t// expecting header -> read header\n\t\t\t\t\tif (this._incomingData.byteLength >= Protocol._headerLen) {\n\t\t\t\t\t\tstate.bodyLen = this._incomingData.readUInt32BE();\n\t\t\t\t\t\tstate.readHead = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!state.readHead) {\n\t\t\t\t\t// expecting body -> read bodyLen-bytes for\n\t\t\t\t\t// the actual message or wait for more data\n\t\t\t\t\tif (this._incomingData.byteLength >= state.bodyLen) {\n\t\t\t\t\t\tconst buffer = this._incomingData.read(state.bodyLen);\n\n\t\t\t\t\t\tstate.bodyLen = -1;\n\t\t\t\t\t\tstate.readHead = true;\n\n\t\t\t\t\t\tthis._onMessage.fire(buffer);\n\n\t\t\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\t\t\t// check if an event listener lead to our disposal\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._socketDataListener = (data: Buffer) => {\n\t\t\tacceptChunk(data);\n\t\t};\n\t\t_socket.on('data', this._socketDataListener);\n\n\t\tthis._socketEndListener = () => {\n\t\t};\n\t\t_socket.on('end', this._socketEndListener);\n\n\t\tthis._socketCloseListener = () => {\n\t\t\tthis._onClose.fire();\n\t\t};\n\t\t_socket.once('close', this._socketCloseListener);\n\t}\n\n\tdispose(): void {\n\t\tthis._isDisposed = true;\n\t\tthis._socket.removeListener('data', this._socketDataListener);\n\t\tthis._socket.removeListener('end', this._socketEndListener);\n\t\tthis._socket.removeListener('close', this._socketCloseListener);\n\t}\n\n\tend(): void {\n\t\tthis._socket.end();\n\t}\n\n\treadEntireBuffer(): Buffer {\n\t\treturn this._incomingData.read(this._incomingData.byteLength);\n\t}\n\n\tsend(buffer: Buffer): void {\n\t\tconst header = Buffer.allocUnsafe(Protocol._headerLen);\n\t\theader.writeUInt32BE(buffer.length, 0, true);\n\t\tthis._writeSoon(header, buffer);\n\t}\n\n\tprivate _writeBuffer = new class {\n\n\t\tprivate _data: Buffer[] = [];\n\t\tprivate _totalLength = 0;\n\n\t\tadd(head: Buffer, body: Buffer): boolean {\n\t\t\tconst wasEmpty = this._totalLength === 0;\n\t\t\tthis._data.push(head, body);\n\t\t\tthis._totalLength += head.length + body.length;\n\t\t\treturn wasEmpty;\n\t\t}\n\n\t\ttake(): Buffer {\n\t\t\tconst ret = Buffer.concat(this._data, this._totalLength);\n\t\t\tthis._data.length = 0;\n\t\t\tthis._totalLength = 0;\n\t\t\treturn ret;\n\t\t}\n\t};\n\n\tprivate _writeSoon(header: Buffer, data: Buffer): void {\n\t\tif (this._writeBuffer.add(header, data)) {\n\t\t\tsetImmediate(() => {\n\t\t\t\t// return early if socket has been destroyed in the meantime\n\t\t\t\tif (this._socket.destroyed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// we ignore the returned value from `write` because we would have to cached the data\n\t\t\t\t// anyways and nodejs is already doing that for us:\n\t\t\t\t// > https://nodejs.org/api/stream.html#stream_writable_write_chunk_encoding_callback\n\t\t\t\t// > However, the false return value is only advisory and the writable stream will unconditionally\n\t\t\t\t// > accept and buffer chunk even if it has not not been allowed to drain.\n\t\t\t\tthis._socket.write(this._writeBuffer.take());\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport class Server extends IPCServer {\n\n\tprivate static toClientConnectionEvent(server: NetServer): Event<ClientConnectionEvent> {\n\t\tconst onConnection = Event.fromNodeEventEmitter<Socket>(server, 'connection');\n\n\t\treturn Event.map(onConnection, socket => ({\n\t\t\tprotocol: new Protocol(socket),\n\t\t\tonDidClientDisconnect: Event.once(Event.fromNodeEventEmitter<void>(socket, 'close'))\n\t\t}));\n\t}\n\n\tprivate server: NetServer | null;\n\n\tconstructor(server: NetServer) {\n\t\tsuper(Server.toClientConnectionEvent(server));\n\t\tthis.server = server;\n\t}\n\n\tdispose(): void {\n\t\tsuper.dispose();\n\t\tif (this.server) {\n\t\t\tthis.server.close();\n\t\t\tthis.server = null;\n\t\t}\n\t}\n}\n\nexport class Client<TContext = string> extends IPCClient<TContext> {\n\n\tstatic fromSocket<TContext = string>(socket: Socket, id: TContext): Client<TContext> {\n\t\treturn new Client(new Protocol(socket), id);\n\t}\n\n\tget onClose(): Event<void> { return this.protocol.onClose; }\n\n\tconstructor(private protocol: Protocol | BufferedProtocol, id: TContext) {\n\t\tsuper(protocol, id);\n\t}\n\n\tdispose(): void {\n\t\tsuper.dispose();\n\t\tthis.protocol.end();\n\t}\n}\n\nexport function serve(port: number): Promise<Server>;\nexport function serve(namedPipe: string): Promise<Server>;\nexport function serve(hook: any): Promise<Server> {\n\treturn new Promise<Server>((c, e) => {\n\t\tconst server = createServer();\n\n\t\tserver.on('error', e);\n\t\tserver.listen(hook, () => {\n\t\t\tserver.removeListener('error', e);\n\t\t\tc(new Server(server));\n\t\t});\n\t});\n}\n\nexport function connect(options: { host: string, port: number }, clientId: string): Promise<Client>;\nexport function connect(port: number, clientId: string): Promise<Client>;\nexport function connect(namedPipe: string, clientId: string): Promise<Client>;\nexport function connect(hook: any, clientId: string): Promise<Client> {\n\treturn new Promise<Client>((c, e) => {\n\t\tconst socket = createConnection(hook, () => {\n\t\t\tsocket.removeListener('error', e);\n\t\t\tc(Client.fromSocket(socket, clientId));\n\t\t});\n\n\t\tsocket.once('error', e);\n\t});\n}\n\n/**\n * Will ensure no messages are lost if there are no event listeners.\n */\nfunction createBufferedEvent<T>(source: Event<T>): Event<T> {\n\tlet emitter: Emitter<T>;\n\tlet hasListeners = false;\n\tlet isDeliveringMessages = false;\n\tlet bufferedMessages: T[] = [];\n\n\tconst deliverMessages = () => {\n\t\tif (isDeliveringMessages) {\n\t\t\treturn;\n\t\t}\n\t\tisDeliveringMessages = true;\n\t\twhile (hasListeners && bufferedMessages.length > 0) {\n\t\t\temitter.fire(bufferedMessages.shift()!);\n\t\t}\n\t\tisDeliveringMessages = false;\n\t};\n\n\tsource((e: T) => {\n\t\tbufferedMessages.push(e);\n\t\tdeliverMessages();\n\t});\n\n\temitter = new Emitter<T>({\n\t\tonFirstListenerAdd: () => {\n\t\t\thasListeners = true;\n\t\t\t// it is important to deliver these messages after this call, but before\n\t\t\t// other messages have a chance to be received (to guarantee in order delivery)\n\t\t\t// that's why we're using here nextTick and not other types of timeouts\n\t\t\tprocess.nextTick(deliverMessages);\n\t\t},\n\t\tonLastListenerRemove: () => {\n\t\t\thasListeners = false;\n\t\t}\n\t});\n\n\treturn emitter.event;\n}\n\n/**\n * Will ensure no messages are lost if there are no event listeners.\n */\nexport class BufferedProtocol implements IMessagePassingProtocol {\n\n\tprivate readonly _actual: Protocol;\n\tpublic readonly onMessage: Event<Buffer>;\n\tpublic readonly onClose: Event<void>;\n\n\tconstructor(actual: Protocol) {\n\t\tthis._actual = actual;\n\t\tthis.onMessage = createBufferedEvent(this._actual.onMessage);\n\t\tthis.onClose = createBufferedEvent(this._actual.onClose);\n\t}\n\n\tpublic send(buffer: Buffer): void {\n\t\tthis._actual.send(buffer);\n\t}\n\n\tpublic end(): void {\n\t\tthis._actual.end();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { assign } from 'vs/base/common/objects';\nimport { IssueType, ISettingSearchResult, IssueReporterExtensionData } from 'vs/platform/issue/common/issue';\n\nexport interface IssueReporterData {\n\tissueType: IssueType;\n\tissueDescription?: string;\n\n\tversionInfo?: any;\n\tsystemInfo?: any;\n\tprocessInfo?: any;\n\tworkspaceInfo?: any;\n\n\tincludeSystemInfo: boolean;\n\tincludeWorkspaceInfo: boolean;\n\tincludeProcessInfo: boolean;\n\tincludeExtensions: boolean;\n\tincludeSearchedExtensions: boolean;\n\tincludeSettingsSearchDetails: boolean;\n\n\tnumberOfThemeExtesions?: number;\n\tallExtensions: IssueReporterExtensionData[];\n\tenabledNonThemeExtesions?: IssueReporterExtensionData[];\n\textensionsDisabled?: boolean;\n\tfileOnExtension?: boolean;\n\tselectedExtension?: IssueReporterExtensionData;\n\tactualSearchResults?: ISettingSearchResult[];\n\tquery?: string;\n\tfilterResultCount?: number;\n}\n\nexport class IssueReporterModel {\n\tprivate readonly _data: IssueReporterData;\n\n\tconstructor(initialData?: Partial<IssueReporterData>) {\n\t\tconst defaultData = {\n\t\t\tissueType: IssueType.Bug,\n\t\t\tincludeSystemInfo: true,\n\t\t\tincludeWorkspaceInfo: true,\n\t\t\tincludeProcessInfo: true,\n\t\t\tincludeExtensions: true,\n\t\t\tincludeSearchedExtensions: true,\n\t\t\tincludeSettingsSearchDetails: true,\n\t\t\tallExtensions: []\n\t\t};\n\n\t\tthis._data = initialData ? assign(defaultData, initialData) : defaultData;\n\t}\n\n\tgetData(): IssueReporterData {\n\t\treturn this._data;\n\t}\n\n\tupdate(newData: Partial<IssueReporterData>): void {\n\t\tassign(this._data, newData);\n\t}\n\n\tserialize(): string {\n\t\treturn `\nIssue Type: <b>${this.getIssueTypeTitle()}</b>\n\n${this._data.issueDescription}\n${this.getExtensionVersion()}\nVS Code version: ${this._data.versionInfo && this._data.versionInfo.vscodeVersion}\nOS version: ${this._data.versionInfo && this._data.versionInfo.os}\n\n${this.getInfos()}\n<!-- generated by issue reporter -->`;\n\t}\n\n\tfileOnExtension(): boolean | undefined {\n\t\tconst fileOnExtensionSupported = this._data.issueType === IssueType.Bug\n\t\t\t|| this._data.issueType === IssueType.PerformanceIssue\n\t\t\t|| this._data.issueType === IssueType.FeatureRequest;\n\n\t\treturn fileOnExtensionSupported && this._data.fileOnExtension;\n\t}\n\n\tprivate getExtensionVersion(): string {\n\t\tif (this.fileOnExtension() && this._data.selectedExtension) {\n\t\t\treturn `\\nExtension version: ${this._data.selectedExtension.version}`;\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tprivate getIssueTypeTitle(): string {\n\t\tif (this._data.issueType === IssueType.Bug) {\n\t\t\treturn 'Bug';\n\t\t} else if (this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\treturn 'Performance Issue';\n\t\t} else if (this._data.issueType === IssueType.SettingsSearchIssue) {\n\t\t\treturn 'Settings Search Issue';\n\t\t} else {\n\t\t\treturn 'Feature Request';\n\t\t}\n\t}\n\n\tprivate getInfos(): string {\n\t\tlet info = '';\n\n\t\tif (this._data.issueType === IssueType.Bug || this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (this._data.includeSystemInfo && this._data.systemInfo) {\n\t\t\t\tinfo += this.generateSystemInfoMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.PerformanceIssue) {\n\n\t\t\tif (this._data.includeProcessInfo) {\n\t\t\t\tinfo += this.generateProcessInfoMd();\n\t\t\t}\n\n\t\t\tif (this._data.includeWorkspaceInfo) {\n\t\t\t\tinfo += this.generateWorkspaceInfoMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.Bug || this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (!this._data.fileOnExtension && this._data.includeExtensions) {\n\t\t\t\tinfo += this.generateExtensionsMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.SettingsSearchIssue) {\n\t\t\tif (this._data.includeSearchedExtensions) {\n\t\t\t\tinfo += this.generateExtensionsMd();\n\t\t\t}\n\n\t\t\tif (this._data.includeSettingsSearchDetails) {\n\t\t\t\tinfo += this.generateSettingSearchResultsMd();\n\t\t\t\tinfo += '\\n' + this.generateSettingsSearchResultDetailsMd();\n\t\t\t}\n\t\t}\n\n\t\treturn info;\n\t}\n\n\tprivate generateSystemInfoMd(): string {\n\t\tlet md = `<details>\n<summary>System Info</summary>\n\n|Item|Value|\n|---|---|\n`;\n\n\t\tObject.keys(this._data.systemInfo).forEach(k => {\n\t\t\tconst data = typeof this._data.systemInfo[k] === 'object'\n\t\t\t\t? Object.keys(this._data.systemInfo[k]).map(key => `${key}: ${this._data.systemInfo[k][key]}`).join('<br>')\n\t\t\t\t: this._data.systemInfo[k];\n\n\t\t\tmd += `|${k}|${data}|\\n`;\n\t\t});\n\n\t\tmd += '\\n</details>';\n\n\t\treturn md;\n\t}\n\n\tprivate generateProcessInfoMd(): string {\n\t\treturn `<details>\n<summary>Process Info</summary>\n\n\\`\\`\\`\n${this._data.processInfo}\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateWorkspaceInfoMd(): string {\n\t\treturn `<details>\n<summary>Workspace Info</summary>\n\n\\`\\`\\`\n${this._data.workspaceInfo};\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateExtensionsMd(): string {\n\t\tif (this._data.extensionsDisabled) {\n\t\t\treturn 'Extensions disabled';\n\t\t}\n\n\t\tconst themeExclusionStr = this._data.numberOfThemeExtesions ? `\\n(${this._data.numberOfThemeExtesions} theme extensions excluded)` : '';\n\n\t\tif (!this._data.enabledNonThemeExtesions) {\n\t\t\treturn 'Extensions: none' + themeExclusionStr;\n\t\t}\n\n\t\tconst tableHeader = `Extension|Author (truncated)|Version\n---|---|---`;\n\t\tconst table = this._data.enabledNonThemeExtesions.map(e => {\n\t\t\treturn `${e.name}|${e.publisher.substr(0, 3)}|${e.version}`;\n\t\t}).join('\\n');\n\n\t\treturn `<details><summary>Extensions (${this._data.enabledNonThemeExtesions.length})</summary>\n\n${tableHeader}\n${table}\n${themeExclusionStr}\n\n</details>`;\n\t}\n\n\tprivate generateSettingsSearchResultDetailsMd(): string {\n\t\treturn `\nQuery: ${this._data.query}\nLiteral matches: ${this._data.filterResultCount}`;\n\t}\n\n\tprivate generateSettingSearchResultsMd(): string {\n\t\tif (!this._data.actualSearchResults) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (!this._data.actualSearchResults.length) {\n\t\t\treturn `No fuzzy results`;\n\t\t}\n\n\t\tconst tableHeader = `Setting|Extension|Score\n---|---|---`;\n\t\tconst table = this._data.actualSearchResults.map(setting => {\n\t\t\treturn `${setting.key}|${setting.extensionId}|${String(setting.score).slice(0, 5)}`;\n\t\t}).join('\\n');\n\n\t\treturn `<details><summary>Results</summary>\n\n${tableHeader}\n${table}\n\n</details>`;\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { endsWith, rtrim } from 'vs/base/common/strings';\n\nexport function normalizeGitHubUrl(url: string): string {\n\t// If the url has a .git suffix, remove it\n\tif (endsWith(url, '.git')) {\n\t\turl = url.substr(0, url.length - 4);\n\t}\n\n\t// Remove trailing slash\n\turl = rtrim(url, '/');\n\n\tif (endsWith(url, '/new')) {\n\t\turl = rtrim(url, '/new');\n\t}\n\n\tif (endsWith(url, '/issues')) {\n\t\turl = rtrim(url, '/issues');\n\t}\n\n\treturn url;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./button';\nimport * as DOM from 'vs/base/browser/dom';\nimport { StandardKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { Color } from 'vs/base/common/color';\nimport { mixin } from 'vs/base/common/objects';\nimport { Event as BaseEvent, Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { Gesture, EventType } from 'vs/base/browser/touch';\n\nexport interface IButtonOptions extends IButtonStyles {\n\ttitle?: boolean;\n}\n\nexport interface IButtonStyles {\n\tbuttonBackground?: Color;\n\tbuttonHoverBackground?: Color;\n\tbuttonForeground?: Color;\n\tbuttonBorder?: Color;\n}\n\nconst defaultOptions: IButtonStyles = {\n\tbuttonBackground: Color.fromHex('#0E639C'),\n\tbuttonHoverBackground: Color.fromHex('#006BB3'),\n\tbuttonForeground: Color.white\n};\n\nexport class Button extends Disposable {\n\n\tprivate _element: HTMLElement;\n\tprivate options: IButtonOptions;\n\n\tprivate buttonBackground: Color | undefined;\n\tprivate buttonHoverBackground: Color | undefined;\n\tprivate buttonForeground: Color | undefined;\n\tprivate buttonBorder: Color | undefined;\n\n\tprivate _onDidClick = this._register(new Emitter<any>());\n\tget onDidClick(): BaseEvent<Event> { return this._onDidClick.event; }\n\n\tprivate focusTracker: DOM.IFocusTracker;\n\n\tconstructor(container: HTMLElement, options?: IButtonOptions) {\n\t\tsuper();\n\n\t\tthis.options = options || Object.create(null);\n\t\tmixin(this.options, defaultOptions, false);\n\n\t\tthis.buttonBackground = this.options.buttonBackground;\n\t\tthis.buttonHoverBackground = this.options.buttonHoverBackground;\n\t\tthis.buttonForeground = this.options.buttonForeground;\n\t\tthis.buttonBorder = this.options.buttonBorder;\n\n\t\tthis._element = document.createElement('a');\n\t\tDOM.addClass(this._element, 'monaco-button');\n\t\tthis._element.tabIndex = 0;\n\t\tthis._element.setAttribute('role', 'button');\n\n\t\tcontainer.appendChild(this._element);\n\n\t\tGesture.addTarget(this._element);\n\n\t\t[DOM.EventType.CLICK, EventType.Tap].forEach(eventType => {\n\t\t\tthis._register(DOM.addDisposableListener(this._element, eventType, e => {\n\t\t\t\tif (!this.enabled) {\n\t\t\t\t\tDOM.EventHelper.stop(e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._onDidClick.fire(e);\n\t\t\t}));\n\t\t});\n\n\t\tthis._register(DOM.addDisposableListener(this._element, DOM.EventType.KEY_DOWN, e => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tlet eventHandled = false;\n\t\t\tif (this.enabled && event.equals(KeyCode.Enter) || event.equals(KeyCode.Space)) {\n\t\t\t\tthis._onDidClick.fire(e);\n\t\t\t\teventHandled = true;\n\t\t\t} else if (event.equals(KeyCode.Escape)) {\n\t\t\t\tthis._element.blur();\n\t\t\t\teventHandled = true;\n\t\t\t}\n\n\t\t\tif (eventHandled) {\n\t\t\t\tDOM.EventHelper.stop(event, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this._element, DOM.EventType.MOUSE_OVER, e => {\n\t\t\tif (!DOM.hasClass(this._element, 'disabled')) {\n\t\t\t\tthis.setHoverBackground();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this._element, DOM.EventType.MOUSE_OUT, e => {\n\t\t\tthis.applyStyles(); // restore standard styles\n\t\t}));\n\n\t\t// Also set hover background when button is focused for feedback\n\t\tthis.focusTracker = this._register(DOM.trackFocus(this._element));\n\t\tthis._register(this.focusTracker.onDidFocus(() => this.setHoverBackground()));\n\t\tthis._register(this.focusTracker.onDidBlur(() => this.applyStyles())); // restore standard styles\n\n\t\tthis.applyStyles();\n\t}\n\n\tprivate setHoverBackground(): void {\n\t\tconst hoverBackground = this.buttonHoverBackground ? this.buttonHoverBackground.toString() : null;\n\t\tif (hoverBackground) {\n\t\t\tthis._element.style.backgroundColor = hoverBackground;\n\t\t}\n\t}\n\n\tstyle(styles: IButtonStyles): void {\n\t\tthis.buttonForeground = styles.buttonForeground;\n\t\tthis.buttonBackground = styles.buttonBackground;\n\t\tthis.buttonHoverBackground = styles.buttonHoverBackground;\n\t\tthis.buttonBorder = styles.buttonBorder;\n\n\t\tthis.applyStyles();\n\t}\n\n\tprivate applyStyles(): void {\n\t\tif (this._element) {\n\t\t\tconst background = this.buttonBackground ? this.buttonBackground.toString() : null;\n\t\t\tconst foreground = this.buttonForeground ? this.buttonForeground.toString() : null;\n\t\t\tconst border = this.buttonBorder ? this.buttonBorder.toString() : null;\n\n\t\t\tthis._element.style.color = foreground;\n\t\t\tthis._element.style.backgroundColor = background;\n\n\t\t\tthis._element.style.borderWidth = border ? '1px' : null;\n\t\t\tthis._element.style.borderStyle = border ? 'solid' : null;\n\t\t\tthis._element.style.borderColor = border;\n\t\t}\n\t}\n\n\tget element(): HTMLElement {\n\t\treturn this._element;\n\t}\n\n\tset label(value: string) {\n\t\tif (!DOM.hasClass(this._element, 'monaco-text-button')) {\n\t\t\tDOM.addClass(this._element, 'monaco-text-button');\n\t\t}\n\t\tthis._element.textContent = value;\n\t\tif (this.options.title) {\n\t\t\tthis._element.title = value;\n\t\t}\n\t}\n\n\tset icon(iconClassName: string) {\n\t\tDOM.addClass(this._element, iconClassName);\n\t}\n\n\tset enabled(value: boolean) {\n\t\tif (value) {\n\t\t\tDOM.removeClass(this._element, 'disabled');\n\t\t\tthis._element.setAttribute('aria-disabled', String(false));\n\t\t\tthis._element.tabIndex = 0;\n\t\t} else {\n\t\t\tDOM.addClass(this._element, 'disabled');\n\t\t\tthis._element.setAttribute('aria-disabled', String(true));\n\t\t\tDOM.removeTabIndexAndUpdateFocus(this._element);\n\t\t}\n\t}\n\n\tget enabled() {\n\t\treturn !DOM.hasClass(this._element, 'disabled');\n\t}\n\n\tfocus(): void {\n\t\tthis._element.focus();\n\t}\n}\n\nexport class ButtonGroup extends Disposable {\n\tprivate _buttons: Button[] = [];\n\n\tconstructor(container: HTMLElement, count: number, options?: IButtonOptions) {\n\t\tsuper();\n\n\t\tthis.create(container, count, options);\n\t}\n\n\tget buttons(): Button[] {\n\t\treturn this._buttons;\n\t}\n\n\tprivate create(container: HTMLElement, count: number, options?: IButtonOptions): void {\n\t\tfor (let index = 0; index < count; index++) {\n\t\t\tconst button = this._register(new Button(container, options));\n\t\t\tthis._buttons.push(button);\n\n\t\t\t// Implement keyboard access in buttons if there are multiple\n\t\t\tif (count > 1) {\n\t\t\t\tthis._register(DOM.addDisposableListener(button.element, DOM.EventType.KEY_DOWN, e => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t\t\tlet eventHandled = true;\n\n\t\t\t\t\t// Next / Previous Button\n\t\t\t\t\tlet buttonIndexToFocus: number | undefined;\n\t\t\t\t\tif (event.equals(KeyCode.LeftArrow)) {\n\t\t\t\t\t\tbuttonIndexToFocus = index > 0 ? index - 1 : this._buttons.length - 1;\n\t\t\t\t\t} else if (event.equals(KeyCode.RightArrow)) {\n\t\t\t\t\t\tbuttonIndexToFocus = index === this._buttons.length - 1 ? 0 : index + 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventHandled = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (eventHandled && typeof buttonIndexToFocus === 'number') {\n\t\t\t\t\t\tthis._buttons[buttonIndexToFocus].focus();\n\t\t\t\t\t\tDOM.EventHelper.stop(e, true);\n\t\t\t\t\t}\n\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./octicons/octicons';\nimport 'vs/css!./octicons/octicons-animations';\nimport { escape } from 'vs/base/common/strings';\n\nfunction expand(text: string): string {\n\treturn text.replace(/\\$\\(((.+?)(~(.*?))?)\\)/g, (_match, _g1, name, _g3, animation) => {\n\t\treturn `<span class=\"octicon octicon-${name} ${animation ? `octicon-animation-${animation}` : ''}\"></span>`;\n\t});\n}\n\nexport function renderOcticons(label: string): string {\n\treturn expand(escape(label));\n}\n\nexport class OcticonLabel {\n\n\tconstructor(\n\t\tprivate readonly _container: HTMLElement\n\t) { }\n\n\tset text(text: string) {\n\t\tthis._container.innerHTML = renderOcticons(text || '');\n\t}\n\n\tset title(title: string) {\n\t\tthis._container.title = title;\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { escape } from 'vs/base/common/strings';\nimport { localize } from 'vs/nls';\n\nexport default (): string => `\n<div id=\"issue-reporter\">\n\t<div id=\"english\" class=\"input-group hidden\">${escape(localize('completeInEnglish', \"Please complete the form in English.\"))}</div>\n\n\t<div class=\"section\">\n\t\t<div class=\"input-group\">\n\t\t\t<label class=\"inline-label\" for=\"issue-type\">${escape(localize('issueTypeLabel', \"This is a\"))}</label>\n\t\t\t<select id=\"issue-type\" class=\"inline-form-control\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</select>\n\t\t</div>\n\n\t\t<div class=\"input-group\" id=\"problem-source\">\n\t\t\t<label class=\"inline-label\" for=\"issue-source\">${escape(localize('issueSourceLabel', \"File on\"))}<span class=\"required-input\">*</span></label>\n\t\t\t<select id=\"issue-source\" class=\"inline-form-control\" required>\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</select>\n\t\t\t<div id=\"problem-source-help-text\" class=\"instructions hidden\">${escape(localize('disableExtensionsLabelText', \"Try to reproduce the problem after {0}. If the problem only reproduces when extensions are active, it is likely an issue with an extension.\"))\n\t\t.replace('{0}', `<span tabIndex=0 role=\"button\" id=\"disableExtensions\" class=\"workbenchCommand\">${escape(localize('disableExtensions', \"disabling all extensions and reloading the window\"))}</span>`)}\n\t\t\t</div>\n\n\t\t\t<div id=\"extension-selection\">\n\t\t\t\t<label class=\"inline-label\" for=\"extension-selector\">${escape(localize('chooseExtension', \"Extension\"))} <span class=\"required-input\">*</span></label>\n\t\t\t\t<select id=\"extension-selector\" class=\"inline-form-control\">\n\t\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"input-group\">\n\t\t\t<label class=\"inline-label\" for=\"issue-title\">${escape(localize('issueTitleLabel', \"Title\"))} <span class=\"required-input\">*</span></label>\n\t\t\t<input id=\"issue-title\" type=\"text\" class=\"inline-form-control\" placeholder=\"${escape(localize('issueTitleRequired', \"Please enter a title.\"))}\" required>\n\t\t\t<div id=\"issue-title-length-validation-error\" class=\"validation-error hidden\" role=\"alert\">${escape(localize('titleLengthValidation', \"The title is too long.\"))}</div>\n\t\t\t<small id=\"similar-issues\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</small>\n\t\t</div>\n\n\t</div>\n\n\t<div class=\"input-group description-section\">\n\t\t<label for=\"description\" id=\"issue-description-label\">\n\t\t\t<!-- To be dynamically filled -->\n\t\t</label>\n\t\t<div class=\"instructions\" id=\"issue-description-subtitle\">\n\t\t\t<!-- To be dynamically filled -->\n\t\t</div>\n\t\t<div class=\"block-info-text\">\n\t\t\t<textarea name=\"description\" id=\"description\" placeholder=\"${escape(localize('details', \"Please enter details.\"))}\" required></textarea>\n\t\t</div>\n\t</div>\n\n\t<div class=\"system-info\" id=\"block-container\">\n\t\t<div class=\"block block-system\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeSystemInfo\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeSystemInfo\">${escape(localize({\n\t\t\tkey: 'sendSystemInfo',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the system information']\n\t\t}, \"Include my system information ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<div class=\"block-info hidden\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"block block-process\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeProcessInfo\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeProcessInfo\">${escape(localize({\n\t\t\tkey: 'sendProcessInfo',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the process info']\n\t\t}, \"Include my currently running processes ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<pre class=\"block-info hidden\">\n\t\t\t\t<code>\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t\t</code>\n\t\t\t</pre>\n\t\t</div>\n\t\t<div class=\"block block-workspace\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeWorkspaceInfo\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeWorkspaceInfo\">${escape(localize({\n\t\t\tkey: 'sendWorkspaceInfo',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the workspace information']\n\t\t}, \"Include my workspace metadata ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<pre id=\"systemInfo\" class=\"block-info hidden\">\n\t\t\t\t<code>\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t\t</code>\n\t\t\t</pre>\n\t\t</div>\n\t\t<div class=\"block block-extensions\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeExtensions\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeExtensions\">${escape(localize({\n\t\t\tkey: 'sendExtensions',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the enabled extensions list']\n\t\t}, \"Include my enabled extensions ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<div id=\"systemInfo\" class=\"block-info hidden\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"block block-searchedExtensions\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeSearchedExtensions\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeSearchedExtensions\">${escape(localize({\n\t\t\tkey: 'sendSearchedExtensions',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the searched extensions']\n\t\t}, \"Send searched extensions ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<div class=\"block-info hidden\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"block block-settingsSearchResults\">\n\t\t\t<input class=\"sendData\" type=\"checkbox\" id=\"includeSettingsSearchDetails\" checked/>\n\t\t\t<label class=\"caption\" for=\"includeSettingsSearchDetails\">${escape(localize({\n\t\t\tkey: 'sendSettingsSearchDetails',\n\t\t\tcomment: ['{0} is either \"show\" or \"hide\" and is a button to toggle the visibililty of the search details']\n\t\t}, \"Send settings search details ({0})\")).replace('{0}', `<a href=\"#\" class=\"showInfo\">${escape(localize('show', \"show\"))}</a>`)}</label>\n\t\t\t<div class=\"block-info hidden\">\n\t\t\t\t<!-- To be dynamically filled -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`;","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as instantiation from './instantiation';\n\nexport class SyncDescriptor<T> {\n\n\treadonly ctor: any;\n\treadonly staticArguments: any[];\n\treadonly supportsDelayedInstantiation: boolean;\n\n\tconstructor(ctor: new (...args: any[]) => T, staticArguments: any[] = [], supportsDelayedInstantiation: boolean = false) {\n\t\tthis.ctor = ctor;\n\t\tthis.staticArguments = staticArguments;\n\t\tthis.supportsDelayedInstantiation = supportsDelayedInstantiation;\n\t}\n}\n\nexport interface CreateSyncFunc {\n\n\t<T>(ctor: instantiation.IConstructorSignature0<T>): SyncDescriptor0<T>;\n\n\t<A1, T>(ctor: instantiation.IConstructorSignature1<A1, T>): SyncDescriptor1<A1, T>;\n\t<A1, T>(ctor: instantiation.IConstructorSignature1<A1, T>, a1: A1): SyncDescriptor0<T>;\n\n\t<A1, A2, T>(ctor: instantiation.IConstructorSignature2<A1, A2, T>): SyncDescriptor2<A1, A2, T>;\n\t<A1, A2, T>(ctor: instantiation.IConstructorSignature2<A1, A2, T>, a1: A1): SyncDescriptor1<A2, T>;\n\t<A1, A2, T>(ctor: instantiation.IConstructorSignature2<A1, A2, T>, a1: A1, a2: A2): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, T>(ctor: instantiation.IConstructorSignature3<A1, A2, A3, T>): SyncDescriptor3<A1, A2, A3, T>;\n\t<A1, A2, A3, T>(ctor: instantiation.IConstructorSignature3<A1, A2, A3, T>, a1: A1): SyncDescriptor2<A2, A3, T>;\n\t<A1, A2, A3, T>(ctor: instantiation.IConstructorSignature3<A1, A2, A3, T>, a1: A1, a2: A2): SyncDescriptor1<A3, T>;\n\t<A1, A2, A3, T>(ctor: instantiation.IConstructorSignature3<A1, A2, A3, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, A4, T>(ctor: instantiation.IConstructorSignature4<A1, A2, A3, A4, T>): SyncDescriptor4<A1, A2, A3, A4, T>;\n\t<A1, A2, A3, A4, T>(ctor: instantiation.IConstructorSignature4<A1, A2, A3, A4, T>, a1: A1): SyncDescriptor3<A2, A3, A4, T>;\n\t<A1, A2, A3, A4, T>(ctor: instantiation.IConstructorSignature4<A1, A2, A3, A4, T>, a1: A1, a2: A2): SyncDescriptor2<A3, A4, T>;\n\t<A1, A2, A3, A4, T>(ctor: instantiation.IConstructorSignature4<A1, A2, A3, A4, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor1<A4, T>;\n\t<A1, A2, A3, A4, T>(ctor: instantiation.IConstructorSignature4<A1, A2, A3, A4, T>, a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>): SyncDescriptor5<A1, A2, A3, A4, A5, T>;\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>, a1: A1): SyncDescriptor4<A2, A3, A4, A5, T>;\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>, a1: A1, a2: A2): SyncDescriptor3<A3, A4, A5, T>;\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor2<A4, A5, T>;\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>, a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor1<A5, T>;\n\t<A1, A2, A3, A4, A5, T>(ctor: instantiation.IConstructorSignature5<A1, A2, A3, A4, A5, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>): SyncDescriptor6<A1, A2, A3, A4, A5, A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1): SyncDescriptor5<A2, A3, A4, A5, A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2): SyncDescriptor4<A3, A4, A5, A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor3<A4, A5, A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor2<A5, A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor1<A6, T>;\n\t<A1, A2, A3, A4, A5, A6, T>(ctor: instantiation.IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>): SyncDescriptor7<A1, A2, A3, A4, A5, A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1): SyncDescriptor6<A2, A3, A4, A5, A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2): SyncDescriptor5<A3, A4, A5, A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor4<A4, A5, A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor3<A5, A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor2<A6, A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor1<A7, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, T>(ctor: instantiation.IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7): SyncDescriptor0<T>;\n\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>): SyncDescriptor8<A1, A2, A3, A4, A5, A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1): SyncDescriptor7<A2, A3, A4, A5, A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2): SyncDescriptor6<A3, A4, A5, A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3): SyncDescriptor5<A4, A5, A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor4<A5, A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor3<A6, A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor2<A7, A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7): SyncDescriptor1<A8, T>;\n\t<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: instantiation.IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7, a8: A8): SyncDescriptor0<T>;\n}\nexport const createSyncDescriptor: CreateSyncFunc = <T>(ctor: any, ...staticArguments: any[]): any => {\n\treturn new SyncDescriptor<T>(ctor, staticArguments);\n};\n\nexport interface SyncDescriptor0<T> {\n\tctor: any;\n\tbind(): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor1<A1, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor2<A1, A2, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor1<A2, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor3<A1, A2, A3, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor2<A2, A3, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor1<A3, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor4<A1, A2, A3, A4, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor3<A2, A3, A4, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor2<A3, A4, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor1<A4, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor5<A1, A2, A3, A4, A5, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor4<A2, A3, A4, A5, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor3<A3, A4, A5, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor2<A4, A5, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor1<A5, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor6<A1, A2, A3, A4, A5, A6, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor5<A2, A3, A4, A5, A6, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor4<A3, A4, A5, A6, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor3<A4, A5, A6, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor2<A5, A6, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor1<A6, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor7<A1, A2, A3, A4, A5, A6, A7, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor6<A2, A3, A4, A5, A6, A7, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor5<A3, A4, A5, A6, A7, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor4<A4, A5, A6, A7, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor3<A5, A6, A7, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor2<A6, A7, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor1<A7, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7): SyncDescriptor0<T>;\n}\nexport interface SyncDescriptor8<A1, A2, A3, A4, A5, A6, A7, A8, T> {\n\tctor: any;\n\tbind(a1: A1): SyncDescriptor7<A2, A3, A4, A5, A6, A7, A8, T>;\n\tbind(a1: A1, a2: A2): SyncDescriptor6<A3, A4, A5, A6, A7, A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3): SyncDescriptor5<A4, A5, A6, A7, A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4): SyncDescriptor4<A5, A6, A7, A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): SyncDescriptor3<A6, A7, A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): SyncDescriptor2<A7, A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7): SyncDescriptor1<A8, T>;\n\tbind(a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7, a8: A8): SyncDescriptor0<T>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isEmptyObject } from 'vs/base/common/types';\nimport { forEach } from 'vs/base/common/collections';\n\nexport interface Node<T> {\n\tdata: T;\n\tincoming: { [key: string]: Node<T> };\n\toutgoing: { [key: string]: Node<T> };\n}\n\nfunction newNode<T>(data: T): Node<T> {\n\treturn {\n\t\tdata: data,\n\t\tincoming: Object.create(null),\n\t\toutgoing: Object.create(null)\n\t};\n}\n\nexport class Graph<T> {\n\n\tprivate _nodes: { [key: string]: Node<T> } = Object.create(null);\n\n\tconstructor(private _hashFn: (element: T) => string) {\n\t\t// empty\n\t}\n\n\troots(): Node<T>[] {\n\t\tconst ret: Node<T>[] = [];\n\t\tforEach(this._nodes, entry => {\n\t\t\tif (isEmptyObject(entry.value.outgoing)) {\n\t\t\t\tret.push(entry.value);\n\t\t\t}\n\t\t});\n\t\treturn ret;\n\t}\n\n\tinsertEdge(from: T, to: T): void {\n\t\tconst fromNode = this.lookupOrInsertNode(from),\n\t\t\ttoNode = this.lookupOrInsertNode(to);\n\n\t\tfromNode.outgoing[this._hashFn(to)] = toNode;\n\t\ttoNode.incoming[this._hashFn(from)] = fromNode;\n\t}\n\n\tremoveNode(data: T): void {\n\t\tconst key = this._hashFn(data);\n\t\tdelete this._nodes[key];\n\t\tforEach(this._nodes, (entry) => {\n\t\t\tdelete entry.value.outgoing[key];\n\t\t\tdelete entry.value.incoming[key];\n\t\t});\n\t}\n\n\tlookupOrInsertNode(data: T): Node<T> {\n\t\tconst key = this._hashFn(data);\n\t\tlet node = this._nodes[key];\n\n\t\tif (!node) {\n\t\t\tnode = newNode(data);\n\t\t\tthis._nodes[key] = node;\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tlookup(data: T): Node<T> {\n\t\treturn this._nodes[this._hashFn(data)];\n\t}\n\n\tisEmpty(): boolean {\n\t\tfor (const _key in this._nodes) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\ttoString(): string {\n\t\tlet data: string[] = [];\n\t\tforEach(this._nodes, entry => {\n\t\t\tdata.push(`${entry.key}, (incoming)[${Object.keys(entry.value.incoming).join(', ')}], (outgoing)[${Object.keys(entry.value.outgoing).join(',')}]`);\n\t\t});\n\t\treturn data.join('\\n');\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServiceCollection } from './serviceCollection';\nimport * as descriptors from './descriptors';\n\n// ------ internal util\n\nexport namespace _util {\n\n\texport const serviceIds = new Map<string, ServiceIdentifier<any>>();\n\n\texport const DI_TARGET = '$di$target';\n\texport const DI_DEPENDENCIES = '$di$dependencies';\n\n\texport function getServiceDependencies(ctor: any): { id: ServiceIdentifier<any>, index: number, optional: boolean }[] {\n\t\treturn ctor[DI_DEPENDENCIES] || [];\n\t}\n}\n\n// --- interfaces ------\n\nexport interface IConstructorSignature0<T> {\n\tnew(...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature1<A1, T> {\n\tnew(first: A1, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature2<A1, A2, T> {\n\tnew(first: A1, second: A2, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature3<A1, A2, A3, T> {\n\tnew(first: A1, second: A2, third: A3, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature4<A1, A2, A3, A4, T> {\n\tnew(first: A1, second: A2, third: A3, fourth: A4, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature5<A1, A2, A3, A4, A5, T> {\n\tnew(first: A1, second: A2, third: A3, fourth: A4, fifth: A5, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature6<A1, A2, A3, A4, A5, A6, T> {\n\tnew(first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T> {\n\tnew(first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6, seventh: A7, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T> {\n\tnew(first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6, seventh: A7, eigth: A8, ...services: { _serviceBrand: any; }[]): T;\n}\n\nexport interface ServicesAccessor {\n\tget<T>(id: ServiceIdentifier<T>, isOptional?: typeof optional): T;\n}\n\nexport const IInstantiationService = createDecorator<IInstantiationService>('instantiationService');\n\nexport interface IInstantiationService {\n\n\t_serviceBrand: any;\n\n\t/**\n\t * Synchronously creates an instance that is denoted by\n\t * the descriptor\n\t */\n\tcreateInstance<T>(descriptor: descriptors.SyncDescriptor0<T>): T;\n\tcreateInstance<A1, T>(descriptor: descriptors.SyncDescriptor1<A1, T>, a1: A1): T;\n\tcreateInstance<A1, A2, T>(descriptor: descriptors.SyncDescriptor2<A1, A2, T>, a1: A1, a2: A2): T;\n\tcreateInstance<A1, A2, A3, T>(descriptor: descriptors.SyncDescriptor3<A1, A2, A3, T>, a1: A1, a2: A2, a3: A3): T;\n\tcreateInstance<A1, A2, A3, A4, T>(descriptor: descriptors.SyncDescriptor4<A1, A2, A3, A4, T>, a1: A1, a2: A2, a3: A3, a4: A4): T;\n\tcreateInstance<A1, A2, A3, A4, A5, T>(descriptor: descriptors.SyncDescriptor5<A1, A2, A3, A4, A5, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, T>(descriptor: descriptors.SyncDescriptor6<A1, A2, A3, A4, A5, A6, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, A7, T>(descriptor: descriptors.SyncDescriptor7<A1, A2, A3, A4, A5, A6, A7, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, A7, A8, T>(descriptor: descriptors.SyncDescriptor8<A1, A2, A3, A4, A5, A6, A7, A8, T>, a1: A1, a2: A2, a3: A3, a4: A4, a5: A5, a6: A6, a7: A7, a8: A8): T;\n\n\tcreateInstance<T>(ctor: IConstructorSignature0<T>): T;\n\tcreateInstance<A1, T>(ctor: IConstructorSignature1<A1, T>, first: A1): T;\n\tcreateInstance<A1, A2, T>(ctor: IConstructorSignature2<A1, A2, T>, first: A1, second: A2): T;\n\tcreateInstance<A1, A2, A3, T>(ctor: IConstructorSignature3<A1, A2, A3, T>, first: A1, second: A2, third: A3): T;\n\tcreateInstance<A1, A2, A3, A4, T>(ctor: IConstructorSignature4<A1, A2, A3, A4, T>, first: A1, second: A2, third: A3, fourth: A4): T;\n\tcreateInstance<A1, A2, A3, A4, A5, T>(ctor: IConstructorSignature5<A1, A2, A3, A4, A5, T>, first: A1, second: A2, third: A3, fourth: A4, fifth: A5): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, T>(ctor: IConstructorSignature6<A1, A2, A3, A4, A5, A6, T>, first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, A7, T>(ctor: IConstructorSignature7<A1, A2, A3, A4, A5, A6, A7, T>, first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6, seventh: A7): T;\n\tcreateInstance<A1, A2, A3, A4, A5, A6, A7, A8, T>(ctor: IConstructorSignature8<A1, A2, A3, A4, A5, A6, A7, A8, T>, first: A1, second: A2, third: A3, fourth: A4, fifth: A5, sixth: A6, seventh: A7, eigth: A8): T;\n\n\t/**\n\t *\n\t */\n\tinvokeFunction<R, TS extends any[]=[]>(fn: (accessor: ServicesAccessor, ...args: TS) => R, ...args: TS): R;\n\n\t/**\n\t * Creates a child of this service which inherts all current services\n\t * and adds/overwrites the given services\n\t */\n\tcreateChild(services: ServiceCollection): IInstantiationService;\n}\n\n\n/**\n * Identifies a service of type T\n */\nexport interface ServiceIdentifier<T> {\n\t(...args: any[]): void;\n\ttype: T;\n}\n\nfunction storeServiceDependency(id: Function, target: Function, index: number, optional: boolean): void {\n\tif (target[_util.DI_TARGET] === target) {\n\t\ttarget[_util.DI_DEPENDENCIES].push({ id, index, optional });\n\t} else {\n\t\ttarget[_util.DI_DEPENDENCIES] = [{ id, index, optional }];\n\t\ttarget[_util.DI_TARGET] = target;\n\t}\n}\n\n/**\n * A *only* valid way to create a {{ServiceIdentifier}}.\n */\nexport function createDecorator<T>(serviceId: string): { (...args: any[]): void; type: T; } {\n\n\tif (_util.serviceIds.has(serviceId)) {\n\t\treturn _util.serviceIds.get(serviceId)!;\n\t}\n\n\tconst id = <any>function (target: Function, key: string, index: number): any {\n\t\tif (arguments.length !== 3) {\n\t\t\tthrow new Error('@IServiceName-decorator can only be used to decorate a parameter');\n\t\t}\n\t\tstoreServiceDependency(id, target, index, false);\n\t};\n\n\tid.toString = () => serviceId;\n\n\t_util.serviceIds.set(serviceId, id);\n\treturn id;\n}\n\n/**\n * Mark a service dependency as optional.\n */\nexport function optional<T>(serviceIdentifier: ServiceIdentifier<T>) {\n\n\treturn function (target: Function, key: string, index: number) {\n\t\tif (arguments.length !== 3) {\n\t\t\tthrow new Error('@optional-decorator can only be used to decorate a parameter');\n\t\t}\n\t\tstoreServiceDependency(serviceIdentifier, target, index, true);\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event as CommonEvent } from 'vs/base/common/event';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IWorkspaceIdentifier, ISingleFolderWorkspaceIdentifier } from 'vs/platform/workspaces/common/workspaces';\nimport { URI } from 'vs/base/common/uri';\nimport { IPath } from 'vs/platform/windows/common/windows';\n\nexport const IHistoryMainService = createDecorator<IHistoryMainService>('historyMainService');\n\nexport interface IRecentlyOpened {\n\tworkspaces: Array<IRecentWorkspace | IRecentFolder>;\n\tfiles: IRecentFile[];\n}\n\nexport type IRecent = IRecentWorkspace | IRecentFolder | IRecentFile;\n\nexport interface IRecentWorkspace {\n\tworkspace: IWorkspaceIdentifier;\n\tlabel?: string;\n}\n\nexport interface IRecentFolder {\n\tfolderUri: ISingleFolderWorkspaceIdentifier;\n\tlabel?: string;\n}\n\nexport interface IRecentFile {\n\tfileUri: URI;\n\tlabel?: string;\n}\n\nexport function isRecentWorkspace(curr: IRecent): curr is IRecentWorkspace {\n\treturn !!curr['workspace'];\n}\n\nexport function isRecentFolder(curr: IRecent): curr is IRecentFolder {\n\treturn !!curr['folderUri'];\n}\n\nexport function isRecentFile(curr: IRecent): curr is IRecentFile {\n\treturn !!curr['fileUri'];\n}\n\n\nexport interface IHistoryMainService {\n\t_serviceBrand: any;\n\n\tonRecentlyOpenedChange: CommonEvent<void>;\n\n\taddRecentlyOpened(recents: IRecent[]): void;\n\tgetRecentlyOpened(currentWorkspace?: IWorkspaceIdentifier, currentFolder?: ISingleFolderWorkspaceIdentifier, currentFiles?: IPath[]): IRecentlyOpened;\n\tremoveFromRecentlyOpened(paths: URI[]): void;\n\tclearRecentlyOpened(): void;\n\n\tupdateWindowsJumpList(): void;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServiceIdentifier } from 'vs/platform/instantiation/common/instantiation';\nimport { SyncDescriptor } from './descriptors';\n\nexport class ServiceCollection {\n\n\tprivate _entries = new Map<ServiceIdentifier<any>, any>();\n\n\tconstructor(...entries: [ServiceIdentifier<any>, any][]) {\n\t\tfor (let [id, service] of entries) {\n\t\t\tthis.set(id, service);\n\t\t}\n\t}\n\n\tset<T>(id: ServiceIdentifier<T>, instanceOrDescriptor: T | SyncDescriptor<T>): T | SyncDescriptor<T> {\n\t\tconst result = this._entries.get(id);\n\t\tthis._entries.set(id, instanceOrDescriptor);\n\t\treturn result;\n\t}\n\n\tforEach(callback: (id: ServiceIdentifier<any>, instanceOrDescriptor: any) => any): void {\n\t\tthis._entries.forEach((value, key) => callback(key, value));\n\t}\n\n\thas(id: ServiceIdentifier<any>): boolean {\n\t\treturn this._entries.has(id);\n\t}\n\n\tget<T>(id: ServiceIdentifier<T>): T | SyncDescriptor<T> {\n\t\treturn this._entries.get(id);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { illegalState } from 'vs/base/common/errors';\nimport { create } from 'vs/base/common/types';\nimport { Graph } from 'vs/platform/instantiation/common/graph';\nimport { SyncDescriptor } from 'vs/platform/instantiation/common/descriptors';\nimport { ServiceIdentifier, IInstantiationService, ServicesAccessor, _util, optional } from 'vs/platform/instantiation/common/instantiation';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { IdleValue } from 'vs/base/common/async';\n\n// TRACING\nconst _enableTracing = false;\n\n// PROXY\n// Ghetto-declare of the global Proxy object. This isn't the proper way\n// but allows us to run this code in the browser without IE11.\ndeclare var Proxy: any;\nconst _canUseProxy = typeof Proxy === 'function';\n\nexport class InstantiationService implements IInstantiationService {\n\n\t_serviceBrand: any;\n\n\tprotected readonly _services: ServiceCollection;\n\tprotected readonly _strict: boolean;\n\tprotected readonly _parent?: InstantiationService;\n\n\tconstructor(services: ServiceCollection = new ServiceCollection(), strict: boolean = false, parent?: InstantiationService) {\n\t\tthis._services = services;\n\t\tthis._strict = strict;\n\t\tthis._parent = parent;\n\n\t\tthis._services.set(IInstantiationService, this);\n\t}\n\n\tcreateChild(services: ServiceCollection): IInstantiationService {\n\t\treturn new InstantiationService(services, this._strict, this);\n\t}\n\n\tinvokeFunction<R, TS extends any[]=[]>(fn: (accessor: ServicesAccessor, ...args: TS) => R, ...args: TS): R {\n\t\tlet _trace = Trace.traceInvocation(fn);\n\t\tlet _done = false;\n\t\ttry {\n\t\t\tconst accessor: ServicesAccessor = {\n\t\t\t\tget: <T>(id: ServiceIdentifier<T>, isOptional?: typeof optional) => {\n\n\t\t\t\t\tif (_done) {\n\t\t\t\t\t\tthrow illegalState('service accessor is only valid during the invocation of its target method');\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = this._getOrCreateServiceInstance(id, _trace);\n\t\t\t\t\tif (!result && isOptional !== optional) {\n\t\t\t\t\t\tthrow new Error(`[invokeFunction] unknown service '${id}'`);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn fn.apply(undefined, [accessor, ...args]);\n\t\t} finally {\n\t\t\t_done = true;\n\t\t\t_trace.stop();\n\t\t}\n\t}\n\n\tcreateInstance(ctorOrDescriptor: any | SyncDescriptor<any>, ...rest: any[]): any {\n\t\tlet _trace: Trace;\n\t\tlet result: any;\n\t\tif (ctorOrDescriptor instanceof SyncDescriptor) {\n\t\t\t_trace = Trace.traceCreation(ctorOrDescriptor.ctor);\n\t\t\tresult = this._createInstance(ctorOrDescriptor.ctor, ctorOrDescriptor.staticArguments.concat(rest), _trace);\n\t\t} else {\n\t\t\t_trace = Trace.traceCreation(ctorOrDescriptor);\n\t\t\tresult = this._createInstance(ctorOrDescriptor, rest, _trace);\n\t\t}\n\t\t_trace.stop();\n\t\treturn result;\n\t}\n\n\tprivate _createInstance<T>(ctor: any, args: any[] = [], _trace: Trace): T {\n\n\t\t// arguments defined by service decorators\n\t\tlet serviceDependencies = _util.getServiceDependencies(ctor).sort((a, b) => a.index - b.index);\n\t\tlet serviceArgs: any[] = [];\n\t\tfor (const dependency of serviceDependencies) {\n\t\t\tlet service = this._getOrCreateServiceInstance(dependency.id, _trace);\n\t\t\tif (!service && this._strict && !dependency.optional) {\n\t\t\t\tthrow new Error(`[createInstance] ${ctor.name} depends on UNKNOWN service ${dependency.id}.`);\n\t\t\t}\n\t\t\tserviceArgs.push(service);\n\t\t}\n\n\t\tlet firstServiceArgPos = serviceDependencies.length > 0 ? serviceDependencies[0].index : args.length;\n\n\t\t// check for argument mismatches, adjust static args if needed\n\t\tif (args.length !== firstServiceArgPos) {\n\t\t\tconsole.warn(`[createInstance] First service dependency of ${ctor.name} at position ${\n\t\t\t\tfirstServiceArgPos + 1} conflicts with ${args.length} static arguments`);\n\n\t\t\tlet delta = firstServiceArgPos - args.length;\n\t\t\tif (delta > 0) {\n\t\t\t\targs = args.concat(new Array(delta));\n\t\t\t} else {\n\t\t\t\targs = args.slice(0, firstServiceArgPos);\n\t\t\t}\n\t\t}\n\n\t\t// now create the instance\n\t\treturn <T>create.apply(null, [ctor].concat(args, serviceArgs));\n\t}\n\n\tprivate _setServiceInstance<T>(id: ServiceIdentifier<T>, instance: T): void {\n\t\tif (this._services.get(id) instanceof SyncDescriptor) {\n\t\t\tthis._services.set(id, instance);\n\t\t} else if (this._parent) {\n\t\t\tthis._parent._setServiceInstance(id, instance);\n\t\t} else {\n\t\t\tthrow new Error('illegalState - setting UNKNOWN service instance');\n\t\t}\n\t}\n\n\tprivate _getServiceInstanceOrDescriptor<T>(id: ServiceIdentifier<T>): T | SyncDescriptor<T> {\n\t\tlet instanceOrDesc = this._services.get(id);\n\t\tif (!instanceOrDesc && this._parent) {\n\t\t\treturn this._parent._getServiceInstanceOrDescriptor(id);\n\t\t} else {\n\t\t\treturn instanceOrDesc;\n\t\t}\n\t}\n\n\tprivate _getOrCreateServiceInstance<T>(id: ServiceIdentifier<T>, _trace: Trace): T {\n\t\tlet thing = this._getServiceInstanceOrDescriptor(id);\n\t\tif (thing instanceof SyncDescriptor) {\n\t\t\treturn this._createAndCacheServiceInstance(id, thing, _trace.branch(id, true));\n\t\t} else {\n\t\t\t_trace.branch(id, false);\n\t\t\treturn thing;\n\t\t}\n\t}\n\n\tprivate _createAndCacheServiceInstance<T>(id: ServiceIdentifier<T>, desc: SyncDescriptor<T>, _trace: Trace): T {\n\t\ttype Triple = { id: ServiceIdentifier<any>, desc: SyncDescriptor<any>, _trace: Trace };\n\t\tconst graph = new Graph<Triple>(data => data.id.toString());\n\n\t\tfunction throwCycleError() {\n\t\t\tconst err = new Error('[createInstance] cyclic dependency between services');\n\t\t\terr.message = graph.toString();\n\t\t\tthrow err;\n\t\t}\n\n\t\tlet count = 0;\n\t\tconst stack = [{ id, desc, _trace }];\n\t\twhile (stack.length) {\n\t\t\tconst item = stack.pop()!;\n\t\t\tgraph.lookupOrInsertNode(item);\n\n\t\t\t// TODO@joh use the graph to find a cycle\n\t\t\t// a weak heuristic for cycle checks\n\t\t\tif (count++ > 100) {\n\t\t\t\tthrowCycleError();\n\t\t\t}\n\n\t\t\t// check all dependencies for existence and if they need to be created first\n\t\t\tlet dependencies = _util.getServiceDependencies(item.desc.ctor);\n\t\t\tfor (let dependency of dependencies) {\n\n\t\t\t\tlet instanceOrDesc = this._getServiceInstanceOrDescriptor(dependency.id);\n\t\t\t\tif (!instanceOrDesc && !dependency.optional) {\n\t\t\t\t\tconsole.warn(`[createInstance] ${id} depends on ${dependency.id} which is NOT registered.`);\n\t\t\t\t}\n\n\t\t\t\tif (instanceOrDesc instanceof SyncDescriptor) {\n\t\t\t\t\tconst d = { id: dependency.id, desc: instanceOrDesc, _trace: item._trace.branch(dependency.id, true) };\n\t\t\t\t\tgraph.insertEdge(item, d);\n\t\t\t\t\tstack.push(d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twhile (true) {\n\t\t\tlet roots = graph.roots();\n\n\t\t\t// if there is no more roots but still\n\t\t\t// nodes in the graph we have a cycle\n\t\t\tif (roots.length === 0) {\n\t\t\t\tif (!graph.isEmpty()) {\n\t\t\t\t\tthrowCycleError();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfor (let { data } of roots) {\n\t\t\t\t// create instance and overwrite the service collections\n\t\t\t\tconst instance = this._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, data.desc.supportsDelayedInstantiation, data._trace);\n\t\t\t\tthis._setServiceInstance(data.id, instance);\n\t\t\t\tgraph.removeNode(data);\n\t\t\t}\n\t\t}\n\n\t\treturn <T>this._getServiceInstanceOrDescriptor(id);\n\t}\n\n\tprivate _createServiceInstanceWithOwner<T>(id: ServiceIdentifier<T>, ctor: any, args: any[] = [], supportsDelayedInstantiation: boolean, _trace: Trace): T {\n\t\tif (this._services.get(id) instanceof SyncDescriptor) {\n\t\t\treturn this._createServiceInstance(ctor, args, supportsDelayedInstantiation, _trace);\n\t\t} else if (this._parent) {\n\t\t\treturn this._parent._createServiceInstanceWithOwner(id, ctor, args, supportsDelayedInstantiation, _trace);\n\t\t} else {\n\t\t\tthrow new Error('illegalState - creating UNKNOWN service instance');\n\t\t}\n\t}\n\n\tprivate _createServiceInstance<T>(ctor: any, args: any[] = [], _supportsDelayedInstantiation: boolean, _trace: Trace): T {\n\t\tif (!_supportsDelayedInstantiation || !_canUseProxy) {\n\t\t\t// eager instantiation or no support JS proxies (e.g. IE11)\n\t\t\treturn this._createInstance(ctor, args, _trace);\n\n\t\t} else {\n\t\t\t// Return a proxy object that's backed by an idle value. That\n\t\t\t// strategy is to instantiate services in our idle time or when actually\n\t\t\t// needed but not when injected into a consumer\n\t\t\tconst idle = new IdleValue(() => this._createInstance(ctor, args, _trace));\n\t\t\treturn <T>new Proxy(Object.create(null), {\n\t\t\t\tget(_target: T, prop: PropertyKey): any {\n\t\t\t\t\treturn idle.getValue()[prop];\n\t\t\t\t},\n\t\t\t\tset(_target: T, p: PropertyKey, value: any): boolean {\n\t\t\t\t\tidle.getValue()[p] = value;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\n//#region -- tracing ---\n\nconst enum TraceType {\n\tCreation, Invocation, Branch\n}\n\nclass Trace {\n\n\tprivate static _None = new class extends Trace {\n\t\tconstructor() { super(-1, null); }\n\t\tstop() { }\n\t\tbranch() { return this; }\n\t};\n\n\tstatic traceInvocation(ctor: any): Trace {\n\t\treturn !_enableTracing ? Trace._None : new Trace(TraceType.Invocation, ctor.name || (ctor.toString() as string).substring(0, 42).replace(/\\n/g, ''));\n\t}\n\n\tstatic traceCreation(ctor: any): Trace {\n\t\treturn !_enableTracing ? Trace._None : new Trace(TraceType.Creation, ctor.name);\n\t}\n\n\tprivate static _totals: number = 0;\n\tprivate readonly _start: number = Date.now();\n\tprivate readonly _dep: [ServiceIdentifier<any>, boolean, Trace?][] = [];\n\n\tprivate constructor(\n\t\treadonly type: TraceType,\n\t\treadonly name: string | null\n\t) { }\n\n\tbranch(id: ServiceIdentifier<any>, first: boolean): Trace {\n\t\tlet child = new Trace(TraceType.Branch, id.toString());\n\t\tthis._dep.push([id, first, child]);\n\t\treturn child;\n\t}\n\n\tstop() {\n\t\tlet dur = Date.now() - this._start;\n\t\tTrace._totals += dur;\n\n\t\tlet causedCreation = false;\n\n\t\tfunction printChild(n: number, trace: Trace) {\n\t\t\tlet res: string[] = [];\n\t\t\tlet prefix = new Array(n + 1).join('\\t');\n\t\t\tfor (const [id, first, child] of trace._dep) {\n\t\t\t\tif (first && child) {\n\t\t\t\t\tcausedCreation = true;\n\t\t\t\t\tres.push(`${prefix}CREATES -> ${id}`);\n\t\t\t\t\tlet nested = printChild(n + 1, child);\n\t\t\t\t\tif (nested) {\n\t\t\t\t\t\tres.push(nested);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tres.push(`${prefix}uses -> ${id}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res.join('\\n');\n\t\t}\n\n\t\tlet lines = [\n\t\t\t`${this.type === TraceType.Creation ? 'CREATE' : 'CALL'} ${this.name}`,\n\t\t\t`${printChild(1, this)}`,\n\t\t\t`DONE, took ${dur.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`\n\t\t];\n\n\t\tif (dur > 2 || causedCreation) {\n\t\t\tconsole.log(lines.join('\\n'));\n\t\t}\n\t}\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator, ServiceIdentifier } from 'vs/platform/instantiation/common/instantiation';\nimport { IChannel, IServerChannel } from 'vs/base/parts/ipc/node/ipc';\nimport { Client } from 'vs/base/parts/ipc/electron-browser/ipc.electron-browser';\nimport { Disposable } from 'vs/base/common/lifecycle';\n\nexport const IMainProcessService = createDecorator<IMainProcessService>('mainProcessService');\n\nexport interface IMainProcessService {\n\n\t_serviceBrand: ServiceIdentifier<any>;\n\n\tgetChannel(channelName: string): IChannel;\n\n\tregisterChannel(channelName: string, channel: IServerChannel<string>): void;\n}\n\nexport class MainProcessService extends Disposable implements IMainProcessService {\n\n\t_serviceBrand: ServiceIdentifier<any>;\n\n\tprivate mainProcessConnection: Client;\n\n\tconstructor(\n\t\twindowId: number\n\t) {\n\t\tsuper();\n\n\t\tthis.mainProcessConnection = this._register(new Client(`window:${windowId}`));\n\t}\n\n\tgetChannel(channelName: string): IChannel {\n\t\treturn this.mainProcessConnection.getChannel(channelName);\n\t}\n\n\tregisterChannel(channelName: string, channel: IServerChannel<string>): void {\n\t\tthis.mainProcessConnection.registerChannel(channelName, channel);\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator as createServiceDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IDisposable, Disposable } from 'vs/base/common/lifecycle';\nimport { isWindows } from 'vs/base/common/platform';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\n\nexport const ILogService = createServiceDecorator<ILogService>('logService');\n\nfunction now(): string {\n\treturn new Date().toISOString();\n}\n\nexport enum LogLevel {\n\tTrace,\n\tDebug,\n\tInfo,\n\tWarning,\n\tError,\n\tCritical,\n\tOff\n}\n\nexport const DEFAULT_LOG_LEVEL: LogLevel = LogLevel.Info;\n\nexport interface ILogService extends IDisposable {\n\t_serviceBrand: any;\n\tonDidChangeLogLevel: Event<LogLevel>;\n\n\tgetLevel(): LogLevel;\n\tsetLevel(level: LogLevel): void;\n\ttrace(message: string, ...args: any[]): void;\n\tdebug(message: string, ...args: any[]): void;\n\tinfo(message: string, ...args: any[]): void;\n\twarn(message: string, ...args: any[]): void;\n\terror(message: string | Error, ...args: any[]): void;\n\tcritical(message: string | Error, ...args: any[]): void;\n}\n\nexport abstract class AbstractLogService extends Disposable {\n\n\tprivate level: LogLevel = DEFAULT_LOG_LEVEL;\n\tprivate readonly _onDidChangeLogLevel: Emitter<LogLevel> = this._register(new Emitter<LogLevel>());\n\treadonly onDidChangeLogLevel: Event<LogLevel> = this._onDidChangeLogLevel.event;\n\n\tsetLevel(level: LogLevel): void {\n\t\tif (this.level !== level) {\n\t\t\tthis.level = level;\n\t\t\tthis._onDidChangeLogLevel.fire(this.level);\n\t\t}\n\t}\n\n\tgetLevel(): LogLevel {\n\t\treturn this.level;\n\t}\n}\n\nexport class ConsoleLogMainService extends AbstractLogService implements ILogService {\n\n\t_serviceBrand: any;\n\tprivate useColors: boolean;\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t\tthis.useColors = !isWindows;\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.warn(`\\x1b[93m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.warn(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\terror(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.error(`\\x1b[91m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.error(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tcritical(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.error(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.error(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\t// noop\n\t}\n}\n\nexport class ConsoleLogService extends AbstractLogService implements ILogService {\n\n\t_serviceBrand: any;\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tconsole.log('%cTRACE', 'color: #888', message, ...args);\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tconsole.log('%cDEBUG', 'background: #eee; color: #888', message, ...args);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tconsole.log('%c INFO', 'color: #33f', message, ...args);\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tconsole.log('%c WARN', 'color: #993', message, ...args);\n\t\t}\n\t}\n\n\terror(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tconsole.log('%c  ERR', 'color: #f33', message, ...args);\n\t\t}\n\t}\n\n\tcritical(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tconsole.log('%cCRITI', 'background: #f33; color: white', message, ...args);\n\t\t}\n\t}\n\n\tdispose(): void { }\n}\n\nexport class MultiplexLogService extends AbstractLogService implements ILogService {\n\t_serviceBrand: any;\n\n\tconstructor(private logServices: ILogService[]) {\n\t\tsuper();\n\t\tif (logServices.length) {\n\t\t\tthis.setLevel(logServices[0].getLevel());\n\t\t}\n\t}\n\n\tsetLevel(level: LogLevel): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.setLevel(level);\n\t\t}\n\t\tsuper.setLevel(level);\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.trace(message, ...args);\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.debug(message, ...args);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.info(message, ...args);\n\t\t}\n\t}\n\n\twarn(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.warn(message, ...args);\n\t\t}\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.error(message, ...args);\n\t\t}\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.critical(message, ...args);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.dispose();\n\t\t}\n\t}\n}\n\nexport class DelegatedLogService extends Disposable implements ILogService {\n\t_serviceBrand: any;\n\n\tconstructor(private logService: ILogService) {\n\t\tsuper();\n\t\tthis._register(logService);\n\t}\n\n\tget onDidChangeLogLevel(): Event<LogLevel> {\n\t\treturn this.logService.onDidChangeLogLevel;\n\t}\n\n\tsetLevel(level: LogLevel): void {\n\t\tthis.logService.setLevel(level);\n\t}\n\n\tgetLevel(): LogLevel {\n\t\treturn this.logService.getLevel();\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tthis.logService.trace(message, ...args);\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tthis.logService.debug(message, ...args);\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tthis.logService.info(message, ...args);\n\t}\n\n\twarn(message: string, ...args: any[]): void {\n\t\tthis.logService.warn(message, ...args);\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tthis.logService.error(message, ...args);\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tthis.logService.critical(message, ...args);\n\t}\n}\n\nexport class NullLogService implements ILogService {\n\t_serviceBrand: any;\n\treadonly onDidChangeLogLevel: Event<LogLevel> = new Emitter<LogLevel>().event;\n\tsetLevel(level: LogLevel): void { }\n\tgetLevel(): LogLevel { return LogLevel.Info; }\n\ttrace(message: string, ...args: any[]): void { }\n\tdebug(message: string, ...args: any[]): void { }\n\tinfo(message: string, ...args: any[]): void { }\n\twarn(message: string, ...args: any[]): void { }\n\terror(message: string | Error, ...args: any[]): void { }\n\tcritical(message: string | Error, ...args: any[]): void { }\n\tdispose(): void { }\n}\n\nexport function getLogLevel(environmentService: IEnvironmentService): LogLevel {\n\tif (environmentService.verbose) {\n\t\treturn LogLevel.Trace;\n\t}\n\tif (typeof environmentService.args.log === 'string') {\n\t\tconst logLevel = environmentService.args.log.toLowerCase();\n\t\tswitch (logLevel) {\n\t\t\tcase 'trace':\n\t\t\t\treturn LogLevel.Trace;\n\t\t\tcase 'debug':\n\t\t\t\treturn LogLevel.Debug;\n\t\t\tcase 'info':\n\t\t\t\treturn LogLevel.Info;\n\t\t\tcase 'warn':\n\t\t\t\treturn LogLevel.Warning;\n\t\t\tcase 'error':\n\t\t\t\treturn LogLevel.Error;\n\t\t\tcase 'critical':\n\t\t\t\treturn LogLevel.Critical;\n\t\t\tcase 'off':\n\t\t\t\treturn LogLevel.Off;\n\t\t}\n\t}\n\treturn DEFAULT_LOG_LEVEL;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChannel, IServerChannel } from 'vs/base/parts/ipc/node/ipc';\nimport { LogLevel, ILogService, DelegatedLogService } from 'vs/platform/log/common/log';\nimport { Event } from 'vs/base/common/event';\n\nexport class LogLevelSetterChannel implements IServerChannel {\n\n\tonDidChangeLogLevel: Event<LogLevel>;\n\n\tconstructor(private service: ILogService) {\n\t\tthis.onDidChangeLogLevel = Event.buffer(service.onDidChangeLogLevel, true);\n\t}\n\n\tlisten(_, event: string): Event<any> {\n\t\tswitch (event) {\n\t\t\tcase 'onDidChangeLogLevel': return this.onDidChangeLogLevel;\n\t\t}\n\n\t\tthrow new Error(`Event not found: ${event}`);\n\t}\n\n\tcall(_, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\t\t\tcase 'setLevel': this.service.setLevel(arg); return Promise.resolve();\n\t\t}\n\n\t\tthrow new Error(`Call not found: ${command}`);\n\t}\n}\n\nexport class LogLevelSetterChannelClient {\n\n\tconstructor(private channel: IChannel) { }\n\n\tget onDidChangeLogLevel(): Event<LogLevel> {\n\t\treturn this.channel.listen('onDidChangeLogLevel');\n\t}\n\n\tsetLevel(level: LogLevel): void {\n\t\tthis.channel.call('setLevel', level);\n\t}\n}\n\nexport class FollowerLogService extends DelegatedLogService implements ILogService {\n\t_serviceBrand: any;\n\n\tconstructor(private master: LogLevelSetterChannelClient, logService: ILogService) {\n\t\tsuper(logService);\n\t\tthis._register(master.onDidChangeLogLevel(level => logService.setLevel(level)));\n\t}\n\n\tsetLevel(level: LogLevel): void {\n\t\tthis.master.setLevel(level);\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'vs/base/common/path';\nimport { ILogService, LogLevel, NullLogService, AbstractLogService } from 'vs/platform/log/common/log';\nimport * as spdlog from 'spdlog';\n// @ts-ignore\nimport * as fs from 'fs';\n\nexport function createSpdLogService(processName: string, logLevel: LogLevel, logsFolder: string): ILogService {\n\t// Do not crash if spdlog cannot be loaded\n\ttry {\n\t\tconst _spdlog: typeof spdlog = require.__$__nodeRequire('spdlog');\n\t\t_spdlog.setAsyncMode(8192, 500);\n\t\tconst logfilePath = path.join(logsFolder, `${processName}.log`);\n\t\tconst logger = new _spdlog.RotatingLogger(processName, logfilePath, 1024 * 1024 * 5, 6);\n\t\tlogger.setLevel(0);\n\n\t\treturn new SpdLogService(logger, logLevel);\n\t} catch (e) {\n\t\t/** Desktop console.error(e); */\n\t\treturn new NullLogService();\n\t}\n}\n\nexport function createRotatingLogger(name: string, filename: string, filesize: number, filecount: number): spdlog.RotatingLogger {\n\ttry {\n\t\tconst _spdlog: typeof spdlog = require.__$__nodeRequire('spdlog');\n\t\treturn new _spdlog.RotatingLogger(name, filename, filesize, filecount);\n\t} catch (e) {\n\t\tif (typeof window === 'undefined') {\n\t\t\t// @ts-ignore\n\t\t\tself.postMessage({\n\t\t\t\t$type: 'create-log',\n\t\t\t\t$data: {\n\t\t\t\t\tname, filename, filesize, filecount\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconst dirs = filename.split('/');\n\t\t\tdirs.pop();\n\t\t\tlet abDirPath = '';\n\t\t\tdirs.forEach(dir => {\n\t\t\t\tif (!dir) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tabDirPath += `/${dir}`;\n\t\t\t\tif (!fs.existsSync(abDirPath)) {\n\t\t\t\t\tfs.mkdirSync(abDirPath);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!fs.existsSync(filename)) {\n\t\t\t\tfs.writeFileSync(filename, '', 'utf-8');\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tflush: function () {},\n\t\t\tcritical: function (content) {\n\t\t\t\tif (typeof window === 'undefined') {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tself.postMessage({\n\t\t\t\t\t\t$type: 'log-critical',\n\t\t\t\t\t\t$data: {\n\t\t\t\t\t\t\tfilename, content\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst fileContent = fs.readFileSync(filename).toString();\n\t\t\t\t\tfs.writeFileSync(filename, fileContent + content, 'utf-8');\n\t\t\t\t}\n\t\t\t},\n\t\t\tclearFormatters: function () {},\n\t\t} as spdlog.RotatingLogger;\n\t}\n}\n\nclass SpdLogService extends AbstractLogService implements ILogService {\n\n\t_serviceBrand: any;\n\n\tconstructor(\n\t\tprivate readonly logger: spdlog.RotatingLogger,\n\t\tlevel: LogLevel = LogLevel.Error\n\t) {\n\t\tsuper();\n\t\tthis.setLevel(level);\n\t}\n\n\ttrace(): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tthis.logger.trace(this.format(arguments));\n\t\t}\n\t}\n\n\tdebug(): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tthis.logger.debug(this.format(arguments));\n\t\t}\n\t}\n\n\tinfo(): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tthis.logger.info(this.format(arguments));\n\t\t}\n\t}\n\n\twarn(): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tthis.logger.warn(this.format(arguments));\n\t\t}\n\t}\n\n\terror(): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tconst arg = arguments[0];\n\n\t\t\tif (arg instanceof Error) {\n\t\t\t\tconst array = Array.prototype.slice.call(arguments) as any[];\n\t\t\t\tarray[0] = arg.stack;\n\t\t\t\tthis.logger.error(this.format(array));\n\t\t\t} else {\n\t\t\t\tthis.logger.error(this.format(arguments));\n\t\t\t}\n\t\t}\n\t}\n\n\tcritical(): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tthis.logger.critical(this.format(arguments));\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.logger.drop();\n\t}\n\n\tprivate format(args: any): string {\n\t\tlet result = '';\n\n\t\tfor (let i = 0; i < args.length; i++) {\n\t\t\tlet a = args[i];\n\n\t\t\tif (typeof a === 'object') {\n\t\t\t\ttry {\n\t\t\t\t\ta = JSON.stringify(a);\n\t\t\t\t} catch (e) { }\n\t\t\t}\n\n\t\t\tresult += (i > 0 ? ' ' : '') + a;\n\t\t}\n\n\t\treturn result;\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'vs/base/common/path';\nimport { getPathFromAmdModule } from 'vs/base/common/amd';\n\nexport interface IPackageConfiguration {\n\tname: string;\n\tversion: string;\n}\n\nconst rootPath = path.dirname(getPathFromAmdModule(require, ''));\nconst packageJsonPath = path.join(rootPath, 'package.json');\nexport default require.__$__nodeRequire(packageJsonPath) as IPackageConfiguration;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'vs/base/common/path';\nimport { getPathFromAmdModule } from 'vs/base/common/amd';\n\nexport interface IProductConfiguration {\n\tnameShort: string;\n\tnameLong: string;\n\tapplicationName: string;\n\twin32AppId: string;\n\twin32x64AppId: string;\n\twin32UserAppId: string;\n\twin32x64UserAppId: string;\n\twin32AppUserModelId: string;\n\twin32MutexName: string;\n\tdarwinBundleIdentifier: string;\n\turlProtocol: string;\n\tdataFolderName: string;\n\tdownloadUrl: string;\n\tupdateUrl?: string;\n\tquality?: string;\n\ttarget?: string;\n\tcommit?: string;\n\tsettingsSearchBuildId?: number;\n\tsettingsSearchUrl?: string;\n\texperimentsUrl?: string;\n\tdate: string;\n\textensionsGallery: {\n\t\tserviceUrl: string;\n\t\titemUrl: string;\n\t\tcontrolUrl: string;\n\t\trecommendationsUrl: string;\n\t};\n\textensionTips: { [id: string]: string; };\n\textensionImportantTips: { [id: string]: { name: string; pattern: string; }; };\n\texeBasedExtensionTips: { [id: string]: { friendlyName: string, windowsPath?: string, recommendations: string[] }; };\n\textensionKeywords: { [extension: string]: string[]; };\n\textensionAllowedBadgeProviders: string[];\n\textensionAllowedProposedApi: string[];\n\tkeymapExtensionTips: string[];\n\tcrashReporter: {\n\t\tcompanyName: string;\n\t\tproductName: string;\n\t};\n\twelcomePage: string;\n\tenableTelemetry: boolean;\n\taiConfig: {\n\t\tasimovKey: string;\n\t};\n\tsendASmile: {\n\t\treportIssueUrl: string,\n\t\trequestFeatureUrl: string\n\t};\n\tdocumentationUrl: string;\n\treleaseNotesUrl: string;\n\tkeyboardShortcutsUrlMac: string;\n\tkeyboardShortcutsUrlLinux: string;\n\tkeyboardShortcutsUrlWin: string;\n\tintroductoryVideosUrl: string;\n\ttipsAndTricksUrl: string;\n\ttwitterUrl: string;\n\trequestFeatureUrl: string;\n\treportIssueUrl: string;\n\tlicenseUrl: string;\n\tprivacyStatementUrl: string;\n\ttelemetryOptOutUrl: string;\n\tnpsSurveyUrl: string;\n\tsurveys: ISurveyData[];\n\tchecksums: { [path: string]: string; };\n\tchecksumFailMoreInfoUrl: string;\n\thockeyApp: {\n\t\t'win32-ia32': string;\n\t\t'win32-x64': string;\n\t\t'linux-ia32': string;\n\t\t'linux-x64': string;\n\t\t'darwin': string;\n\t};\n\tlogUploaderUrl: string;\n\tportable?: string;\n\tuiExtensions?: string[];\n}\n\nexport interface ISurveyData {\n\tsurveyId: string;\n\tsurveyUrl: string;\n\tlanguageId: string;\n\teditCount: number;\n\tuserProbability: number;\n}\n\nconst rootPath = path.dirname(getPathFromAmdModule(require, ''));\nconst productJsonPath = path.join(rootPath, 'product.json');\nconst product = require.__$__nodeRequire(productJsonPath) as IProductConfiguration;\n\nif (process.env['VSCODE_DEV']) {\n\tproduct.nameShort += ' Dev';\n\tproduct.nameLong += ' Dev';\n\tproduct.dataFolderName += '-dev';\n}\n\nexport default product;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IEnvironmentService, ParsedArgs, IDebugParams, IExtensionHostDebugParams } from 'vs/platform/environment/common/environment';\nimport * as crypto from 'crypto';\nimport * as paths from 'vs/base/node/paths';\nimport * as os from 'os';\nimport * as path from 'vs/base/common/path';\nimport { memoize } from 'vs/base/common/decorators';\nimport pkg from 'vs/platform/product/node/package';\nimport product from 'vs/platform/product/node/product';\nimport { toLocalISOString } from 'vs/base/common/date';\nimport { isWindows, isLinux } from 'vs/base/common/platform';\nimport { getPathFromAmdModule } from 'vs/base/common/amd';\nimport { URI } from 'vs/base/common/uri';\n\n// Read this before there's any chance it is overwritten\n// Related to https://github.com/Microsoft/vscode/issues/30624\nconst xdgRuntimeDir = process.env['XDG_RUNTIME_DIR'];\n\nfunction getNixIPCHandle(userDataPath: string, type: string): string {\n\tif (xdgRuntimeDir) {\n\t\tconst scope = crypto.createHash('md5').update(userDataPath).digest('hex').substr(0, 8);\n\t\treturn path.join(xdgRuntimeDir, `vscode-${scope}-${pkg.version}-${type}.sock`);\n\t}\n\n\treturn path.join(userDataPath, `${pkg.version}-${type}.sock`);\n}\n\nfunction getWin32IPCHandle(userDataPath: string, type: string): string {\n\tconst scope = crypto.createHash('md5').update(userDataPath).digest('hex');\n\n\treturn `\\\\\\\\.\\\\pipe\\\\${scope}-${pkg.version}-${type}-sock`;\n}\n\nfunction getIPCHandle(userDataPath: string, type: string): string {\n\tif (isWindows) {\n\t\treturn getWin32IPCHandle(userDataPath, type);\n\t}\n\n\treturn getNixIPCHandle(userDataPath, type);\n}\n\nfunction getCLIPath(execPath: string, appRoot: string, isBuilt: boolean): string {\n\n\t// Windows\n\tif (isWindows) {\n\t\tif (isBuilt) {\n\t\t\treturn path.join(path.dirname(execPath), 'bin', `${product.applicationName}.cmd`);\n\t\t}\n\n\t\treturn path.join(appRoot, 'scripts', 'code-cli.bat');\n\t}\n\n\t// Linux\n\tif (isLinux) {\n\t\tif (isBuilt) {\n\t\t\treturn path.join(path.dirname(execPath), 'bin', `${product.applicationName}`);\n\t\t}\n\n\t\treturn path.join(appRoot, 'scripts', 'code-cli.sh');\n\t}\n\n\t// macOS\n\tif (isBuilt) {\n\t\treturn path.join(appRoot, 'bin', 'code');\n\t}\n\n\treturn path.join(appRoot, 'scripts', 'code-cli.sh');\n}\n\nexport class EnvironmentService implements IEnvironmentService {\n\n\t_serviceBrand: any;\n\n\tget args(): ParsedArgs { return this._args; }\n\n\t@memoize\n\tget appRoot(): string { return path.dirname(getPathFromAmdModule(require, '')); }\n\n\tget execPath(): string { return this._execPath; }\n\n\t@memoize\n\tget cliPath(): string { return getCLIPath(this.execPath, this.appRoot, this.isBuilt); }\n\n\treadonly logsPath: string;\n\n\t@memoize\n\tget userHome(): string { return os.homedir(); }\n\n\t@memoize\n\tget userDataPath(): string {\n\t\tconst vscodePortable = process.env['VSCODE_PORTABLE'];\n\t\tif (vscodePortable) {\n\t\t\treturn path.join(vscodePortable, 'user-data');\n\t\t}\n\n\t\treturn parseUserDataDir(this._args, process);\n\t}\n\n\tget appNameLong(): string { return product.nameLong; }\n\n\tget appQuality(): string | undefined { return product.quality; }\n\n\t@memoize\n\tget appSettingsHome(): string { return path.join(this.userDataPath, 'User'); }\n\n\t@memoize\n\tget appSettingsPath(): string { return path.join(this.appSettingsHome, 'settings.json'); }\n\n\t@memoize\n\tget globalStorageHome(): string { return path.join(this.appSettingsHome, 'globalStorage'); }\n\n\t@memoize\n\tget workspaceStorageHome(): string { return path.join(this.appSettingsHome, 'workspaceStorage'); }\n\n\t@memoize\n\tget settingsSearchBuildId(): number | undefined { return product.settingsSearchBuildId; }\n\n\t@memoize\n\tget settingsSearchUrl(): string | undefined { return product.settingsSearchUrl; }\n\n\t@memoize\n\tget appKeybindingsPath(): string { return path.join(this.appSettingsHome, 'keybindings.json'); }\n\n\t@memoize\n\tget isExtensionDevelopment(): boolean { return !!this._args.extensionDevelopmentPath; }\n\n\t@memoize\n\tget backupHome(): string { return path.join(this.userDataPath, 'Backups'); }\n\n\t@memoize\n\tget backupWorkspacesPath(): string { return path.join(this.backupHome, 'workspaces.json'); }\n\n\t@memoize\n\tget untitledWorkspacesHome(): URI { return URI.file(path.join(this.userDataPath, 'Workspaces')); }\n\n\t@memoize\n\tget installSourcePath(): string { return path.join(this.userDataPath, 'installSource'); }\n\n\t@memoize\n\tget builtinExtensionsPath(): string {\n\t\tconst fromArgs = parsePathArg(this._args['builtin-extensions-dir'], process);\n\t\tif (fromArgs) {\n\t\t\treturn fromArgs;\n\t\t} else {\n\t\t\treturn path.normalize(path.join(getPathFromAmdModule(require, ''), '..', 'extensions'));\n\t\t}\n\t}\n\n\t@memoize\n\tget extensionsPath(): string {\n\t\tconst fromArgs = parsePathArg(this._args['extensions-dir'], process);\n\n\t\tif (fromArgs) {\n\t\t\treturn fromArgs;\n\t\t}\n\n\t\tconst vscodeExtensions = process.env['VSCODE_EXTENSIONS'];\n\t\tif (vscodeExtensions) {\n\t\t\treturn vscodeExtensions;\n\t\t}\n\n\t\tconst vscodePortable = process.env['VSCODE_PORTABLE'];\n\t\tif (vscodePortable) {\n\t\t\treturn path.join(vscodePortable, 'extensions');\n\t\t}\n\n\t\treturn path.join(this.userHome, product.dataFolderName, 'extensions');\n\t}\n\n\t@memoize\n\tget extensionDevelopmentLocationURI(): URI | undefined {\n\t\tconst s = this._args.extensionDevelopmentPath;\n\t\tif (s) {\n\t\t\tif (/^[^:/?#]+?:\\/\\//.test(s)) {\n\t\t\t\treturn URI.parse(s);\n\t\t\t}\n\t\t\treturn URI.file(path.normalize(s));\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t@memoize\n\tget extensionTestsLocationURI(): URI | undefined {\n\t\tconst s = this._args.extensionTestsPath;\n\t\tif (s) {\n\t\t\tif (/^[^:/?#]+?:\\/\\//.test(s)) {\n\t\t\t\treturn URI.parse(s);\n\t\t\t}\n\t\t\treturn URI.file(path.normalize(s));\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tget disableExtensions(): boolean | string[] {\n\t\tif (this._args['disable-extensions']) {\n\t\t\treturn true;\n\t\t}\n\t\tconst disableExtensions = this._args['disable-extension'];\n\t\tif (disableExtensions) {\n\t\t\tif (typeof disableExtensions === 'string') {\n\t\t\t\treturn [disableExtensions];\n\t\t\t}\n\t\t\tif (Array.isArray(disableExtensions) && disableExtensions.length > 0) {\n\t\t\t\treturn disableExtensions;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tget skipGettingStarted(): boolean { return !!this._args['skip-getting-started']; }\n\n\tget skipReleaseNotes(): boolean { return !!this._args['skip-release-notes']; }\n\n\tget skipAddToRecentlyOpened(): boolean { return !!this._args['skip-add-to-recently-opened']; }\n\n\t@memoize\n\tget debugExtensionHost(): IExtensionHostDebugParams { return parseExtensionHostPort(this._args, this.isBuilt); }\n\n\t@memoize\n\tget debugSearch(): IDebugParams { return parseSearchPort(this._args, this.isBuilt); }\n\n\tget isBuilt(): boolean { return !process.env['VSCODE_DEV']; }\n\tget verbose(): boolean { return !!this._args.verbose; }\n\tget log(): string | undefined { return this._args.log; }\n\n\tget wait(): boolean { return !!this._args.wait; }\n\n\tget logExtensionHostCommunication(): boolean { return !!this._args.logExtensionHostCommunication; }\n\n\tget status(): boolean { return !!this._args.status; }\n\n\t@memoize\n\tget mainIPCHandle(): string { return getIPCHandle(this.userDataPath, 'main'); }\n\n\t@memoize\n\tget sharedIPCHandle(): string { return getIPCHandle(this.userDataPath, 'shared'); }\n\n\t@memoize\n\tget nodeCachedDataDir(): string | undefined { return process.env['VSCODE_NODE_CACHED_DATA_DIR'] || undefined; }\n\n\tget disableUpdates(): boolean { return !!this._args['disable-updates']; }\n\tget disableCrashReporter(): boolean { return !!this._args['disable-crash-reporter']; }\n\n\tget driverHandle(): string | undefined { return this._args['driver']; }\n\tget driverVerbose(): boolean { return !!this._args['driver-verbose']; }\n\n\tconstructor(private _args: ParsedArgs, private _execPath: string) {\n\t\tif (!process.env['VSCODE_LOGS']) {\n\t\t\tconst key = toLocalISOString(new Date()).replace(/-|:|\\.\\d+Z$/g, '');\n\t\t\tprocess.env['VSCODE_LOGS'] = path.join(this.userDataPath, 'logs', key);\n\t\t}\n\n\t\tthis.logsPath = process.env['VSCODE_LOGS']!;\n\t}\n}\n\nexport function parseExtensionHostPort(args: ParsedArgs, isBuild: boolean): IExtensionHostDebugParams {\n\treturn parseDebugPort(args['inspect-extensions'], args['inspect-brk-extensions'], 5870, isBuild, args.debugId);\n}\n\nexport function parseSearchPort(args: ParsedArgs, isBuild: boolean): IDebugParams {\n\treturn parseDebugPort(args['inspect-search'], args['inspect-brk-search'], 5876, isBuild);\n}\n\nexport function parseDebugPort(debugArg: string | undefined, debugBrkArg: string | undefined, defaultBuildPort: number, isBuild: boolean, debugId?: string): IExtensionHostDebugParams {\n\tconst portStr = debugBrkArg || debugArg;\n\tconst port = Number(portStr) || (!isBuild ? defaultBuildPort : null);\n\tconst brk = port ? Boolean(!!debugBrkArg) : false;\n\treturn { port, break: brk, debugId };\n}\n\nfunction parsePathArg(arg: string | undefined, process: NodeJS.Process): string | undefined {\n\tif (!arg) {\n\t\treturn undefined;\n\t}\n\n\t// Determine if the arg is relative or absolute, if relative use the original CWD\n\t// (VSCODE_CWD), not the potentially overridden one (process.cwd()).\n\tconst resolved = path.resolve(arg);\n\n\tif (path.normalize(arg) === resolved) {\n\t\treturn resolved;\n\t} else {\n\t\treturn path.resolve(process.env['VSCODE_CWD'] || process.cwd(), arg);\n\t}\n}\n\nexport function parseUserDataDir(args: ParsedArgs, process: NodeJS.Process): string {\n\treturn parsePathArg(args['user-data-dir'], process) || path.resolve(paths.getDefaultUserDataPath(process.platform));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as Types from 'vs/base/common/types';\nimport * as Assert from 'vs/base/common/assert';\n\nexport interface IRegistry {\n\n\t/**\n\t * Adds the extension functions and properties defined by data to the\n\t * platform. The provided id must be unique.\n\t * @param id a unique identifier\n\t * @param data a contribution\n\t */\n\tadd(id: string, data: any): void;\n\n\t/**\n\t * Returns true iff there is an extension with the provided id.\n\t * @param id an extension identifier\n\t */\n\tknows(id: string): boolean;\n\n\t/**\n\t * Returns the extension functions and properties defined by the specified key or null.\n\t * @param id an extension identifier\n\t */\n\tas<T>(id: string): T;\n}\n\nclass RegistryImpl implements IRegistry {\n\n\tprivate data: { [id: string]: any; };\n\n\tconstructor() {\n\t\tthis.data = {};\n\t}\n\n\tpublic add(id: string, data: any): void {\n\t\tAssert.ok(Types.isString(id));\n\t\tAssert.ok(Types.isObject(data));\n\t\tAssert.ok(!this.data.hasOwnProperty(id), 'There is already an extension with this id');\n\n\t\tthis.data[id] = data;\n\t}\n\n\tpublic knows(id: string): boolean {\n\t\treturn this.data.hasOwnProperty(id);\n\t}\n\n\tpublic as(id: string): any {\n\t\treturn this.data[id] || null;\n\t}\n}\n\nexport const Registry = <IRegistry>new RegistryImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport * as platform from 'vs/platform/registry/common/platform';\nimport { Event, Emitter } from 'vs/base/common/event';\n\nexport const Extensions = {\n\tJSONContribution: 'base.contributions.json'\n};\n\nexport interface ISchemaContributions {\n\tschemas: { [id: string]: IJSONSchema };\n}\n\nexport interface IJSONContributionRegistry {\n\n\treadonly onDidChangeSchema: Event<string>;\n\n\t/**\n\t * Register a schema to the registry.\n\t */\n\tregisterSchema(uri: string, unresolvedSchemaContent: IJSONSchema): void;\n\n\n\t/**\n\t * Notifies all listeners that the content of the given schema has changed.\n\t * @param uri The id of the schema\n\t */\n\tnotifySchemaChanged(uri: string): void;\n\n\t/**\n\t * Get all schemas\n\t */\n\tgetSchemaContributions(): ISchemaContributions;\n}\n\n\n\nfunction normalizeId(id: string) {\n\tif (id.length > 0 && id.charAt(id.length - 1) === '#') {\n\t\treturn id.substring(0, id.length - 1);\n\t}\n\treturn id;\n}\n\n\n\nclass JSONContributionRegistry implements IJSONContributionRegistry {\n\n\tprivate schemasById: { [id: string]: IJSONSchema };\n\n\tprivate readonly _onDidChangeSchema = new Emitter<string>();\n\treadonly onDidChangeSchema: Event<string> = this._onDidChangeSchema.event;\n\n\tconstructor() {\n\t\tthis.schemasById = {};\n\t}\n\n\tpublic registerSchema(uri: string, unresolvedSchemaContent: IJSONSchema): void {\n\t\tthis.schemasById[normalizeId(uri)] = unresolvedSchemaContent;\n\t\tthis._onDidChangeSchema.fire(uri);\n\t}\n\n\tpublic notifySchemaChanged(uri: string): void {\n\t\tthis._onDidChangeSchema.fire(uri);\n\t}\n\n\tpublic getSchemaContributions(): ISchemaContributions {\n\t\treturn {\n\t\t\tschemas: this.schemasById,\n\t\t};\n\t}\n\n}\n\nconst jsonContributionRegistry = new JSONContributionRegistry();\nplatform.Registry.add(Extensions.JSONContribution, jsonContributionRegistry);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport * as types from 'vs/base/common/types';\nimport * as strings from 'vs/base/common/strings';\nimport { IJSONContributionRegistry, Extensions as JSONExtensions } from 'vs/platform/jsonschemas/common/jsonContributionRegistry';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\n\nexport const Extensions = {\n\tConfiguration: 'base.contributions.configuration'\n};\n\nexport interface IConfigurationRegistry {\n\n\t/**\n\t * Register a configuration to the registry.\n\t */\n\tregisterConfiguration(configuration: IConfigurationNode): void;\n\n\t/**\n\t * Register multiple configurations to the registry.\n\t */\n\tregisterConfigurations(configurations: IConfigurationNode[], validate?: boolean): void;\n\n\t/**\n\t * Deregister multiple configurations from the registry.\n\t */\n\tderegisterConfigurations(configurations: IConfigurationNode[]): void;\n\n\t/**\n\t * Register multiple default configurations to the registry.\n\t */\n\tregisterDefaultConfigurations(defaultConfigurations: IDefaultConfigurationExtension[]): void;\n\n\t/**\n\t * Deregister multiple default configurations from the registry.\n\t */\n\tderegisterDefaultConfigurations(defaultConfigurations: IDefaultConfigurationExtension[]): void;\n\n\t/**\n\t * Signal that the schema of a configuration setting has changes. It is currently only supported to change enumeration values.\n\t * Property or default value changes are not allowed.\n\t */\n\tnotifyConfigurationSchemaUpdated(...configurations: IConfigurationNode[]): void;\n\n\t/**\n\t * Event that fires whenver a configuration has been\n\t * registered.\n\t */\n\tonDidSchemaChange: Event<void>;\n\n\t/**\n\t * Event that fires whenver a configuration has been\n\t * registered.\n\t */\n\tonDidUpdateConfiguration: Event<string[]>;\n\n\t/**\n\t * Returns all configuration nodes contributed to this registry.\n\t */\n\tgetConfigurations(): IConfigurationNode[];\n\n\t/**\n\t * Returns all configurations settings of all configuration nodes contributed to this registry.\n\t */\n\tgetConfigurationProperties(): { [qualifiedKey: string]: IConfigurationPropertySchema };\n\n\t/**\n\t * Returns all excluded configurations settings of all configuration nodes contributed to this registry.\n\t */\n\tgetExcludedConfigurationProperties(): { [qualifiedKey: string]: IConfigurationPropertySchema };\n\n\t/**\n\t * Register the identifiers for editor configurations\n\t */\n\tregisterOverrideIdentifiers(identifiers: string[]): void;\n}\n\nexport const enum ConfigurationScope {\n\tAPPLICATION = 1,\n\tWINDOW,\n\tRESOURCE,\n}\n\nexport interface IConfigurationPropertySchema extends IJSONSchema {\n\toverridable?: boolean;\n\tscope?: ConfigurationScope;\n\tincluded?: boolean;\n\ttags?: string[];\n}\n\nexport interface IConfigurationNode {\n\tid?: string;\n\torder?: number;\n\ttype?: string | string[];\n\ttitle?: string;\n\tdescription?: string;\n\tproperties?: { [path: string]: IConfigurationPropertySchema; };\n\tallOf?: IConfigurationNode[];\n\toverridable?: boolean;\n\tscope?: ConfigurationScope;\n\tcontributedByExtension?: boolean;\n}\n\nexport interface IDefaultConfigurationExtension {\n\tid: ExtensionIdentifier;\n\tname: string;\n\tdefaults: { [key: string]: {} };\n}\n\nexport const allSettings: { properties: {}, patternProperties: {} } = { properties: {}, patternProperties: {} };\nexport const applicationSettings: { properties: {}, patternProperties: {} } = { properties: {}, patternProperties: {} };\nexport const windowSettings: { properties: {}, patternProperties: {} } = { properties: {}, patternProperties: {} };\nexport const resourceSettings: { properties: {}, patternProperties: {} } = { properties: {}, patternProperties: {} };\n\nexport const editorConfigurationSchemaId = 'vscode://schemas/settings/editor';\nconst contributionRegistry = Registry.as<IJSONContributionRegistry>(JSONExtensions.JSONContribution);\n\nclass ConfigurationRegistry implements IConfigurationRegistry {\n\n\tprivate readonly defaultOverridesConfigurationNode: IConfigurationNode;\n\tprivate readonly configurationContributors: IConfigurationNode[];\n\tprivate readonly configurationProperties: { [qualifiedKey: string]: IJSONSchema };\n\tprivate readonly excludedConfigurationProperties: { [qualifiedKey: string]: IJSONSchema };\n\tprivate readonly editorConfigurationSchema: IJSONSchema;\n\tprivate readonly overrideIdentifiers: string[] = [];\n\tprivate overridePropertyPattern: string;\n\n\tprivate readonly _onDidSchemaChange = new Emitter<void>();\n\treadonly onDidSchemaChange: Event<void> = this._onDidSchemaChange.event;\n\n\tprivate readonly _onDidUpdateConfiguration: Emitter<string[]> = new Emitter<string[]>();\n\treadonly onDidUpdateConfiguration: Event<string[]> = this._onDidUpdateConfiguration.event;\n\n\tconstructor() {\n\t\tthis.defaultOverridesConfigurationNode = {\n\t\t\tid: 'defaultOverrides',\n\t\t\ttitle: nls.localize('defaultConfigurations.title', \"Default Configuration Overrides\"),\n\t\t\tproperties: {}\n\t\t};\n\t\tthis.configurationContributors = [this.defaultOverridesConfigurationNode];\n\t\tthis.editorConfigurationSchema = { properties: {}, patternProperties: {}, additionalProperties: false, errorMessage: 'Unknown editor configuration setting' };\n\t\tthis.configurationProperties = {};\n\t\tthis.excludedConfigurationProperties = {};\n\t\tthis.computeOverridePropertyPattern();\n\n\t\tcontributionRegistry.registerSchema(editorConfigurationSchemaId, this.editorConfigurationSchema);\n\t}\n\n\tpublic registerConfiguration(configuration: IConfigurationNode, validate: boolean = true): void {\n\t\tthis.registerConfigurations([configuration], validate);\n\t}\n\n\tpublic registerConfigurations(configurations: IConfigurationNode[], validate: boolean = true): void {\n\t\tconst properties: string[] = [];\n\t\tconfigurations.forEach(configuration => {\n\t\t\tproperties.push(...this.validateAndRegisterProperties(configuration, validate)); // fills in defaults\n\t\t\tthis.configurationContributors.push(configuration);\n\t\t\tthis.registerJSONConfiguration(configuration);\n\t\t\tthis.updateSchemaForOverrideSettingsConfiguration(configuration);\n\t\t});\n\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire(properties);\n\t}\n\n\tpublic deregisterConfigurations(configurations: IConfigurationNode[]): void {\n\t\tconst properties: string[] = [];\n\t\tconst deregisterConfiguration = (configuration: IConfigurationNode) => {\n\t\t\tif (configuration.properties) {\n\t\t\t\tfor (const key in configuration.properties) {\n\t\t\t\t\tproperties.push(key);\n\n\t\t\t\t\tdelete this.configurationProperties[key];\n\t\t\t\t\tdelete this.editorConfigurationSchema.properties![key];\n\n\t\t\t\t\t// Delete from schema\n\t\t\t\t\tdelete allSettings.properties[key];\n\t\t\t\t\tswitch (configuration.properties[key].scope) {\n\t\t\t\t\t\tcase ConfigurationScope.APPLICATION:\n\t\t\t\t\t\t\tdelete applicationSettings.properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase ConfigurationScope.WINDOW:\n\t\t\t\t\t\t\tdelete windowSettings.properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase ConfigurationScope.RESOURCE:\n\t\t\t\t\t\t\tdelete resourceSettings.properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (configuration.allOf) {\n\t\t\t\tconfiguration.allOf.forEach(node => deregisterConfiguration(node));\n\t\t\t}\n\t\t};\n\t\tfor (const configuration of configurations) {\n\t\t\tderegisterConfiguration(configuration);\n\t\t\tconst index = this.configurationContributors.indexOf(configuration);\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.configurationContributors.splice(index, 1);\n\t\t\t}\n\t\t}\n\n\t\tcontributionRegistry.registerSchema(editorConfigurationSchemaId, this.editorConfigurationSchema);\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire(properties);\n\t}\n\n\tpublic registerDefaultConfigurations(defaultConfigurations: IDefaultConfigurationExtension[]): void {\n\t\tconst properties: string[] = [];\n\n\t\tfor (const defaultConfiguration of defaultConfigurations) {\n\t\t\tfor (const key in defaultConfiguration.defaults) {\n\t\t\t\tconst defaultValue = defaultConfiguration.defaults[key];\n\t\t\t\tif (OVERRIDE_PROPERTY_PATTERN.test(key) && typeof defaultValue === 'object') {\n\t\t\t\t\tconst propertySchema: IConfigurationPropertySchema = {\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tdefault: defaultValue,\n\t\t\t\t\t\tdescription: nls.localize('overrideSettings.description', \"Configure editor settings to be overridden for {0} language.\", key),\n\t\t\t\t\t\t$ref: editorConfigurationSchemaId\n\t\t\t\t\t};\n\t\t\t\t\tallSettings.properties[key] = propertySchema;\n\t\t\t\t\tthis.defaultOverridesConfigurationNode.properties![key] = propertySchema;\n\t\t\t\t\tthis.configurationProperties[key] = propertySchema;\n\t\t\t\t\tproperties.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire(properties);\n\t}\n\n\tpublic deregisterDefaultConfigurations(defaultConfigurations: IDefaultConfigurationExtension[]): void {\n\t\tconst properties: string[] = [];\n\t\tfor (const defaultConfiguration of defaultConfigurations) {\n\t\t\tfor (const key in defaultConfiguration.defaults) {\n\t\t\t\tproperties.push(key);\n\t\t\t\tdelete allSettings.properties[key];\n\t\t\t\tdelete this.defaultOverridesConfigurationNode.properties![key];\n\t\t\t\tdelete this.configurationProperties[key];\n\t\t\t}\n\t\t}\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire(properties);\n\t}\n\n\tpublic notifyConfigurationSchemaUpdated(...configurations: IConfigurationNode[]) {\n\t\tthis._onDidSchemaChange.fire();\n\t}\n\n\tpublic registerOverrideIdentifiers(overrideIdentifiers: string[]): void {\n\t\tthis.overrideIdentifiers.push(...overrideIdentifiers);\n\t\tthis.updateOverridePropertyPatternKey();\n\t}\n\n\tprivate validateAndRegisterProperties(configuration: IConfigurationNode, validate: boolean = true, scope: ConfigurationScope = ConfigurationScope.WINDOW, overridable: boolean = false): string[] {\n\t\tscope = types.isUndefinedOrNull(configuration.scope) ? scope : configuration.scope;\n\t\toverridable = configuration.overridable || overridable;\n\t\tlet propertyKeys: string[] = [];\n\t\tlet properties = configuration.properties;\n\t\tif (properties) {\n\t\t\tfor (let key in properties) {\n\t\t\t\tlet message;\n\t\t\t\tif (validate && (message = validateProperty(key))) {\n\t\t\t\t\tconsole.warn(message);\n\t\t\t\t\tdelete properties[key];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// fill in default values\n\t\t\t\tlet property = properties[key];\n\t\t\t\tlet defaultValue = property.default;\n\t\t\t\tif (types.isUndefined(defaultValue)) {\n\t\t\t\t\tproperty.default = getDefaultValue(property.type);\n\t\t\t\t}\n\t\t\t\t// Inherit overridable property from parent\n\t\t\t\tif (overridable) {\n\t\t\t\t\tproperty.overridable = true;\n\t\t\t\t}\n\n\t\t\t\tif (OVERRIDE_PROPERTY_PATTERN.test(key)) {\n\t\t\t\t\tproperty.scope = undefined; // No scope for overridable properties `[${identifier}]`\n\t\t\t\t} else {\n\t\t\t\t\tproperty.scope = types.isUndefinedOrNull(property.scope) ? scope : property.scope;\n\t\t\t\t}\n\n\t\t\t\t// Add to properties maps\n\t\t\t\t// Property is included by default if 'included' is unspecified\n\t\t\t\tif (properties[key].hasOwnProperty('included') && !properties[key].included) {\n\t\t\t\t\tthis.excludedConfigurationProperties[key] = properties[key];\n\t\t\t\t\tdelete properties[key];\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tthis.configurationProperties[key] = properties[key];\n\t\t\t\t}\n\n\t\t\t\tpropertyKeys.push(key);\n\t\t\t}\n\t\t}\n\t\tlet subNodes = configuration.allOf;\n\t\tif (subNodes) {\n\t\t\tfor (let node of subNodes) {\n\t\t\t\tpropertyKeys.push(...this.validateAndRegisterProperties(node, validate, scope, overridable));\n\t\t\t}\n\t\t}\n\t\treturn propertyKeys;\n\t}\n\n\tgetConfigurations(): IConfigurationNode[] {\n\t\treturn this.configurationContributors;\n\t}\n\n\tgetConfigurationProperties(): { [qualifiedKey: string]: IConfigurationPropertySchema } {\n\t\treturn this.configurationProperties;\n\t}\n\n\tgetExcludedConfigurationProperties(): { [qualifiedKey: string]: IConfigurationPropertySchema } {\n\t\treturn this.excludedConfigurationProperties;\n\t}\n\n\tprivate registerJSONConfiguration(configuration: IConfigurationNode) {\n\t\tfunction register(configuration: IConfigurationNode) {\n\t\t\tlet properties = configuration.properties;\n\t\t\tif (properties) {\n\t\t\t\tfor (const key in properties) {\n\t\t\t\t\tallSettings.properties[key] = properties[key];\n\t\t\t\t\tswitch (properties[key].scope) {\n\t\t\t\t\t\tcase ConfigurationScope.APPLICATION:\n\t\t\t\t\t\t\tapplicationSettings.properties[key] = properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase ConfigurationScope.WINDOW:\n\t\t\t\t\t\t\twindowSettings.properties[key] = properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase ConfigurationScope.RESOURCE:\n\t\t\t\t\t\t\tresourceSettings.properties[key] = properties[key];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet subNodes = configuration.allOf;\n\t\t\tif (subNodes) {\n\t\t\t\tsubNodes.forEach(register);\n\t\t\t}\n\t\t}\n\t\tregister(configuration);\n\t}\n\n\tprivate updateSchemaForOverrideSettingsConfiguration(configuration: IConfigurationNode): void {\n\t\tif (configuration.id !== SETTINGS_OVERRRIDE_NODE_ID) {\n\t\t\tthis.update(configuration);\n\t\t\tcontributionRegistry.registerSchema(editorConfigurationSchemaId, this.editorConfigurationSchema);\n\t\t}\n\t}\n\n\tprivate updateOverridePropertyPatternKey(): void {\n\t\tlet patternProperties: IJSONSchema = allSettings.patternProperties[this.overridePropertyPattern];\n\t\tif (!patternProperties) {\n\t\t\tpatternProperties = {\n\t\t\t\ttype: 'object',\n\t\t\t\tdescription: nls.localize('overrideSettings.defaultDescription', \"Configure editor settings to be overridden for a language.\"),\n\t\t\t\terrorMessage: 'Unknown Identifier. Use language identifiers',\n\t\t\t\t$ref: editorConfigurationSchemaId\n\t\t\t};\n\t\t}\n\n\t\tdelete allSettings.patternProperties[this.overridePropertyPattern];\n\t\tdelete applicationSettings.patternProperties[this.overridePropertyPattern];\n\t\tdelete windowSettings.patternProperties[this.overridePropertyPattern];\n\t\tdelete resourceSettings.patternProperties[this.overridePropertyPattern];\n\n\t\tthis.computeOverridePropertyPattern();\n\n\t\tallSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\n\t\tapplicationSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\n\t\twindowSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\n\t\tresourceSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\n\n\t\tthis._onDidSchemaChange.fire();\n\t}\n\n\tprivate update(configuration: IConfigurationNode): void {\n\t\tlet properties = configuration.properties;\n\t\tif (properties) {\n\t\t\tfor (let key in properties) {\n\t\t\t\tif (properties[key].overridable) {\n\t\t\t\t\tthis.editorConfigurationSchema.properties![key] = this.getConfigurationProperties()[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet subNodes = configuration.allOf;\n\t\tif (subNodes) {\n\t\t\tsubNodes.forEach(subNode => this.update(subNode));\n\t\t}\n\t}\n\n\tprivate computeOverridePropertyPattern(): void {\n\t\tthis.overridePropertyPattern = this.overrideIdentifiers.length ? OVERRIDE_PATTERN_WITH_SUBSTITUTION.replace('${0}', this.overrideIdentifiers.map(identifier => strings.createRegExp(identifier, false).source).join('|')) : OVERRIDE_PROPERTY;\n\t}\n}\n\nconst SETTINGS_OVERRRIDE_NODE_ID = 'override';\nconst OVERRIDE_PROPERTY = '\\\\[.*\\\\]$';\nconst OVERRIDE_PATTERN_WITH_SUBSTITUTION = '\\\\[(${0})\\\\]$';\nexport const OVERRIDE_PROPERTY_PATTERN = new RegExp(OVERRIDE_PROPERTY);\n\nexport function getDefaultValue(type: string | string[] | undefined): any {\n\tconst t = Array.isArray(type) ? (<string[]>type)[0] : <string>type;\n\tswitch (t) {\n\t\tcase 'boolean':\n\t\t\treturn false;\n\t\tcase 'integer':\n\t\tcase 'number':\n\t\t\treturn 0;\n\t\tcase 'string':\n\t\t\treturn '';\n\t\tcase 'array':\n\t\t\treturn [];\n\t\tcase 'object':\n\t\t\treturn {};\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n\n\nconst configurationRegistry = new ConfigurationRegistry();\nRegistry.add(Extensions.Configuration, configurationRegistry);\n\nexport function validateProperty(property: string): string | null {\n\tif (OVERRIDE_PROPERTY_PATTERN.test(property)) {\n\t\treturn nls.localize('config.property.languageDefault', \"Cannot register '{0}'. This matches property pattern '\\\\\\\\[.*\\\\\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.\", property);\n\t}\n\tif (configurationRegistry.getConfigurationProperties()[property] !== undefined) {\n\t\treturn nls.localize('config.property.duplicate', \"Cannot register '{0}'. This property is already registered.\", property);\n\t}\n\treturn null;\n}\n\nexport function getScopes(): { [key: string]: ConfigurationScope } {\n\tconst scopes = {};\n\tconst configurationProperties = configurationRegistry.getConfigurationProperties();\n\tfor (const key of Object.keys(configurationProperties)) {\n\t\tscopes[key] = configurationProperties[key].scope;\n\t}\n\tscopes['launch'] = ConfigurationScope.RESOURCE;\n\tscopes['task'] = ConfigurationScope.RESOURCE;\n\treturn scopes;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as objects from 'vs/base/common/objects';\nimport * as types from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { Event } from 'vs/base/common/event';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IConfigurationRegistry, Extensions, OVERRIDE_PROPERTY_PATTERN } from 'vs/platform/configuration/common/configurationRegistry';\nimport { ResourceMap } from 'vs/base/common/map';\n\nexport const IConfigurationService = createDecorator<IConfigurationService>('configurationService');\n\nexport function isConfigurationOverrides(thing: any): thing is IConfigurationOverrides {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string')\n\t\t&& (!thing.resource || thing.resource instanceof URI);\n}\n\nexport interface IConfigurationOverrides {\n\toverrideIdentifier?: string | null;\n\tresource?: URI | null;\n}\n\nexport const enum ConfigurationTarget {\n\tUSER = 1,\n\tWORKSPACE,\n\tWORKSPACE_FOLDER,\n\tDEFAULT,\n\tMEMORY\n}\nexport function ConfigurationTargetToString(configurationTarget: ConfigurationTarget) {\n\tswitch (configurationTarget) {\n\t\tcase ConfigurationTarget.USER: return 'USER';\n\t\tcase ConfigurationTarget.WORKSPACE: return 'WORKSPACE';\n\t\tcase ConfigurationTarget.WORKSPACE_FOLDER: return 'WORKSPACE_FOLDER';\n\t\tcase ConfigurationTarget.DEFAULT: return 'DEFAULT';\n\t\tcase ConfigurationTarget.MEMORY: return 'MEMORY';\n\t}\n}\n\nexport interface IConfigurationChangeEvent {\n\n\tsource: ConfigurationTarget;\n\taffectedKeys: string[];\n\taffectsConfiguration(configuration: string, resource?: URI): boolean;\n\n\t// Following data is used for telemetry\n\tsourceConfig: any;\n\n\t// Following data is used for Extension host configuration event\n\tchangedConfiguration: IConfigurationModel;\n\tchangedConfigurationByResource: ResourceMap<IConfigurationModel>;\n}\n\nexport interface IConfigurationService {\n\t_serviceBrand: any;\n\n\tonDidChangeConfiguration: Event<IConfigurationChangeEvent>;\n\n\tgetConfigurationData(): IConfigurationData | null;\n\n\t/**\n\t * Fetches the value of the section for the given overrides.\n\t * Value can be of native type or an object keyed off the section name.\n\t *\n\t * @param section - Section of the configuraion. Can be `null` or `undefined`.\n\t * @param overrides - Overrides that has to be applied while fetching\n\t *\n\t */\n\tgetValue<T>(): T;\n\tgetValue<T>(section: string): T;\n\tgetValue<T>(overrides: IConfigurationOverrides): T;\n\tgetValue<T>(section: string, overrides: IConfigurationOverrides): T;\n\n\tupdateValue(key: string, value: any): Promise<void>;\n\tupdateValue(key: string, value: any, overrides: IConfigurationOverrides): Promise<void>;\n\tupdateValue(key: string, value: any, target: ConfigurationTarget): Promise<void>;\n\tupdateValue(key: string, value: any, overrides: IConfigurationOverrides, target: ConfigurationTarget, donotNotifyError?: boolean): Promise<void>;\n\n\treloadConfiguration(folder?: IWorkspaceFolder): Promise<void>;\n\n\tinspect<T>(key: string, overrides?: IConfigurationOverrides): {\n\t\tdefault: T,\n\t\tuser: T,\n\t\tworkspace?: T,\n\t\tworkspaceFolder?: T,\n\t\tmemory?: T,\n\t\tvalue: T,\n\t};\n\n\tkeys(): {\n\t\tdefault: string[];\n\t\tuser: string[];\n\t\tworkspace: string[];\n\t\tworkspaceFolder: string[];\n\t\tmemory?: string[];\n\t};\n}\n\nexport interface IConfigurationModel {\n\tcontents: any;\n\tkeys: string[];\n\toverrides: IOverrides[];\n}\n\nexport interface IOverrides {\n\tcontents: any;\n\tidentifiers: string[];\n}\n\nexport interface IConfigurationData {\n\tdefaults: IConfigurationModel;\n\tuser: IConfigurationModel;\n\tworkspace: IConfigurationModel;\n\tfolders: { [folder: string]: IConfigurationModel };\n\tisComplete: boolean;\n}\n\nexport function compare(from: IConfigurationModel, to: IConfigurationModel): { added: string[], removed: string[], updated: string[] } {\n\tconst added = to.keys.filter(key => from.keys.indexOf(key) === -1);\n\tconst removed = from.keys.filter(key => to.keys.indexOf(key) === -1);\n\tconst updated: string[] = [];\n\n\tfor (const key of from.keys) {\n\t\tconst value1 = getConfigurationValue(from.contents, key);\n\t\tconst value2 = getConfigurationValue(to.contents, key);\n\t\tif (!objects.equals(value1, value2)) {\n\t\t\tupdated.push(key);\n\t\t}\n\t}\n\n\treturn { added, removed, updated };\n}\n\nexport function toOverrides(raw: any, conflictReporter: (message: string) => void): IOverrides[] {\n\tconst overrides: IOverrides[] = [];\n\tconst configurationProperties = Registry.as<IConfigurationRegistry>(Extensions.Configuration).getConfigurationProperties();\n\tfor (const key of Object.keys(raw)) {\n\t\tif (OVERRIDE_PROPERTY_PATTERN.test(key)) {\n\t\t\tconst overrideRaw = {};\n\t\t\tfor (const keyInOverrideRaw in raw[key]) {\n\t\t\t\tif (configurationProperties[keyInOverrideRaw] && configurationProperties[keyInOverrideRaw].overridable) {\n\t\t\t\t\toverrideRaw[keyInOverrideRaw] = raw[key][keyInOverrideRaw];\n\t\t\t\t}\n\t\t\t}\n\t\t\toverrides.push({\n\t\t\t\tidentifiers: [overrideIdentifierFromKey(key).trim()],\n\t\t\t\tcontents: toValuesTree(overrideRaw, conflictReporter)\n\t\t\t});\n\t\t}\n\t}\n\treturn overrides;\n}\n\nexport function toValuesTree(properties: { [qualifiedKey: string]: any }, conflictReporter: (message: string) => void): any {\n\tconst root = Object.create(null);\n\n\tfor (let key in properties) {\n\t\taddToValueTree(root, key, properties[key], conflictReporter);\n\t}\n\n\treturn root;\n}\n\nexport function addToValueTree(settingsTreeRoot: any, key: string, value: any, conflictReporter: (message: string) => void): void {\n\tconst segments = key.split('.');\n\tconst last = segments.pop()!;\n\n\tlet curr = settingsTreeRoot;\n\tfor (let i = 0; i < segments.length; i++) {\n\t\tlet s = segments[i];\n\t\tlet obj = curr[s];\n\t\tswitch (typeof obj) {\n\t\t\tcase 'undefined':\n\t\t\t\tobj = curr[s] = Object.create(null);\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconflictReporter(`Ignoring ${key} as ${segments.slice(0, i + 1).join('.')} is ${JSON.stringify(obj)}`);\n\t\t\t\treturn;\n\t\t}\n\t\tcurr = obj;\n\t}\n\n\tif (typeof curr === 'object') {\n\t\tcurr[last] = value; // workaround https://github.com/Microsoft/vscode/issues/13606\n\t} else {\n\t\tconflictReporter(`Ignoring ${key} as ${segments.join('.')} is ${JSON.stringify(curr)}`);\n\t}\n}\n\nexport function removeFromValueTree(valueTree: any, key: string): void {\n\tconst segments = key.split('.');\n\tdoRemoveFromValueTree(valueTree, segments);\n}\n\nfunction doRemoveFromValueTree(valueTree: any, segments: string[]): void {\n\tconst first = segments.shift()!;\n\tif (segments.length === 0) {\n\t\t// Reached last segment\n\t\tdelete valueTree[first];\n\t\treturn;\n\t}\n\n\tif (Object.keys(valueTree).indexOf(first) !== -1) {\n\t\tconst value = valueTree[first];\n\t\tif (typeof value === 'object' && !Array.isArray(value)) {\n\t\t\tdoRemoveFromValueTree(value, segments);\n\t\t\tif (Object.keys(value).length === 0) {\n\t\t\t\tdelete valueTree[first];\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * A helper function to get the configuration value with a specific settings path (e.g. config.some.setting)\n */\nexport function getConfigurationValue<T>(config: any, settingPath: string, defaultValue?: T): T {\n\tfunction accessSetting(config: any, path: string[]): any {\n\t\tlet current = config;\n\t\tfor (const component of path) {\n\t\t\tif (typeof current !== 'object' || current === null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tcurrent = current[component];\n\t\t}\n\t\treturn <T>current;\n\t}\n\n\tconst path = settingPath.split('.');\n\tconst result = accessSetting(config, path);\n\n\treturn typeof result === 'undefined' ? defaultValue : result;\n}\n\nexport function merge(base: any, add: any, overwrite: boolean): void {\n\tObject.keys(add).forEach(key => {\n\t\tif (key in base) {\n\t\t\tif (types.isObject(base[key]) && types.isObject(add[key])) {\n\t\t\t\tmerge(base[key], add[key], overwrite);\n\t\t\t} else if (overwrite) {\n\t\t\t\tbase[key] = add[key];\n\t\t\t}\n\t\t} else {\n\t\t\tbase[key] = add[key];\n\t\t}\n\t});\n}\n\nexport function getConfigurationKeys(): string[] {\n\tconst properties = Registry.as<IConfigurationRegistry>(Extensions.Configuration).getConfigurationProperties();\n\treturn Object.keys(properties);\n}\n\nexport function getDefaultValues(): any {\n\tconst valueTreeRoot: any = Object.create(null);\n\tconst properties = Registry.as<IConfigurationRegistry>(Extensions.Configuration).getConfigurationProperties();\n\n\tfor (let key in properties) {\n\t\tlet value = properties[key].default;\n\t\taddToValueTree(valueTreeRoot, key, value, message => console.error(`Conflict in default settings: ${message}`));\n\t}\n\n\treturn valueTreeRoot;\n}\n\nexport function overrideIdentifierFromKey(key: string): string {\n\treturn key.substring(1, key.length - 1);\n}\n\nexport function keyFromOverrideIdentifier(overrideIdentifier: string): string {\n\treturn `[${overrideIdentifier}]`;\n}\n\nexport function getMigratedSettingValue<T>(configurationService: IConfigurationService, currentSettingName: string, legacySettingName: string): T {\n\tconst setting = configurationService.inspect<T>(currentSettingName);\n\tconst legacySetting = configurationService.inspect<T>(legacySettingName);\n\n\tif (typeof setting.user !== 'undefined' || typeof setting.workspace !== 'undefined' || typeof setting.workspaceFolder !== 'undefined') {\n\t\treturn setting.value;\n\t} else if (typeof legacySetting.user !== 'undefined' || typeof legacySetting.workspace !== 'undefined' || typeof legacySetting.workspaceFolder !== 'undefined') {\n\t\treturn legacySetting.value;\n\t} else {\n\t\treturn setting.default;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { escapeRegExpCharacters } from 'vs/base/common/strings';\nimport { ITelemetryService, ITelemetryInfo, ITelemetryData } from 'vs/platform/telemetry/common/telemetry';\nimport { ITelemetryAppender } from 'vs/platform/telemetry/common/telemetryUtils';\nimport { optional } from 'vs/platform/instantiation/common/instantiation';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IConfigurationRegistry, Extensions } from 'vs/platform/configuration/common/configurationRegistry';\nimport { IDisposable, dispose } from 'vs/base/common/lifecycle';\nimport { cloneAndChange, mixin } from 'vs/base/common/objects';\nimport { Registry } from 'vs/platform/registry/common/platform';\n\nexport interface ITelemetryServiceConfig {\n\tappender: ITelemetryAppender;\n\tcommonProperties?: Promise<{ [name: string]: any }>;\n\tpiiPaths?: string[];\n}\n\nexport class TelemetryService implements ITelemetryService {\n\n\tstatic IDLE_START_EVENT_NAME = 'UserIdleStart';\n\tstatic IDLE_STOP_EVENT_NAME = 'UserIdleStop';\n\n\t_serviceBrand: any;\n\n\tprivate _appender: ITelemetryAppender;\n\tprivate _commonProperties: Promise<{ [name: string]: any; }>;\n\tprivate _piiPaths: string[];\n\tprivate _userOptIn: boolean;\n\n\tprivate _disposables: IDisposable[] = [];\n\tprivate _cleanupPatterns: RegExp[] = [];\n\n\tconstructor(\n\t\tconfig: ITelemetryServiceConfig,\n\t\t@optional(IConfigurationService) private _configurationService: IConfigurationService\n\t) {\n\t\tthis._appender = config.appender;\n\t\tthis._commonProperties = config.commonProperties || Promise.resolve({});\n\t\tthis._piiPaths = config.piiPaths || [];\n\t\tthis._userOptIn = true;\n\n\t\t// static cleanup pattern for: `file:///DANGEROUS/PATH/resources/app/Useful/Information`\n\t\tthis._cleanupPatterns = [/file:\\/\\/\\/.*?\\/resources\\/app\\//gi];\n\n\t\tfor (let piiPath of this._piiPaths) {\n\t\t\tthis._cleanupPatterns.push(new RegExp(escapeRegExpCharacters(piiPath), 'gi'));\n\t\t}\n\n\t\tif (this._configurationService) {\n\t\t\tthis._updateUserOptIn();\n\t\t\tthis._configurationService.onDidChangeConfiguration(this._updateUserOptIn, this, this._disposables);\n\t\t\t/* __GDPR__\n\t\t\t\t\"optInStatus\" : {\n\t\t\t\t\t\"optIn\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"BusinessInsight\", \"isMeasurement\": true }\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.publicLog('optInStatus', { optIn: this._userOptIn });\n\n\t\t\tthis._commonProperties.then(values => {\n\t\t\t\tconst isHashedId = /^[a-f0-9]+$/i.test(values['common.machineId']);\n\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"machineIdFallback\" : {\n\t\t\t\t\t\t\"usingFallbackGuid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"BusinessInsight\", \"isMeasurement\": true }\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.publicLog('machineIdFallback', { usingFallbackGuid: !isHashedId });\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _updateUserOptIn(): void {\n\t\tconst config = this._configurationService.getValue<any>(TELEMETRY_SECTION_ID);\n\t\tthis._userOptIn = config ? config.enableTelemetry : this._userOptIn;\n\t}\n\n\tget isOptedIn(): boolean {\n\t\treturn this._userOptIn;\n\t}\n\n\tgetTelemetryInfo(): Promise<ITelemetryInfo> {\n\t\treturn this._commonProperties.then(values => {\n\t\t\t// well known properties\n\t\t\tlet sessionId = values['sessionID'];\n\t\t\tlet instanceId = values['common.instanceId'];\n\t\t\tlet machineId = values['common.machineId'];\n\n\t\t\treturn { sessionId, instanceId, machineId };\n\t\t});\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables = dispose(this._disposables);\n\t}\n\n\tpublicLog(eventName: string, data?: ITelemetryData, anonymizeFilePaths?: boolean): Promise<any> {\n\t\t// don't send events when the user is optout\n\t\tif (!this._userOptIn) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn this._commonProperties.then(values => {\n\n\t\t\t// (first) add common properties\n\t\t\tdata = mixin(data, values);\n\n\t\t\t// (last) remove all PII from data\n\t\t\tdata = cloneAndChange(data, value => {\n\t\t\t\tif (typeof value === 'string') {\n\t\t\t\t\treturn this._cleanupInfo(value, anonymizeFilePaths);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t});\n\n\t\t\tthis._appender.log(eventName, data);\n\n\t\t}, err => {\n\t\t\t// unsure what to do now...\n\t\t\tconsole.error(err);\n\t\t});\n\t}\n\n\tprivate _cleanupInfo(stack: string, anonymizeFilePaths?: boolean): string {\n\t\tlet updatedStack = stack;\n\n\t\tif (anonymizeFilePaths) {\n\t\t\tconst cleanUpIndexes: [number, number][] = [];\n\t\t\tfor (let regexp of this._cleanupPatterns) {\n\t\t\t\twhile (true) {\n\t\t\t\t\tconst result = regexp.exec(stack);\n\t\t\t\t\tif (!result) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcleanUpIndexes.push([result.index, regexp.lastIndex]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst nodeModulesRegex = /^[\\\\\\/]?(node_modules|node_modules\\.asar)[\\\\\\/]/;\n\t\t\tconst fileRegex = /(file:\\/\\/)?([a-zA-Z]:(\\\\\\\\|\\\\|\\/)|(\\\\\\\\|\\\\|\\/))?([\\w-\\._]+(\\\\\\\\|\\\\|\\/))+[\\w-\\._]*/g;\n\t\t\tlet lastIndex = 0;\n\t\t\tupdatedStack = '';\n\n\t\t\twhile (true) {\n\t\t\t\tconst result = fileRegex.exec(stack);\n\t\t\t\tif (!result) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// Anoynimize user file paths that do not need to be retained or cleaned up.\n\t\t\t\tif (!nodeModulesRegex.test(result[0]) && cleanUpIndexes.every(([x, y]) => result.index < x || result.index >= y)) {\n\t\t\t\t\tupdatedStack += stack.substring(lastIndex, result.index) + '<REDACTED: user-file-path>';\n\t\t\t\t\tlastIndex = fileRegex.lastIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lastIndex < stack.length) {\n\t\t\t\tupdatedStack += stack.substr(lastIndex);\n\t\t\t}\n\t\t}\n\n\t\t// sanitize with configured cleanup patterns\n\t\tfor (let regexp of this._cleanupPatterns) {\n\t\t\tupdatedStack = updatedStack.replace(regexp, '');\n\t\t}\n\t\treturn updatedStack;\n\t}\n}\n\n\nconst TELEMETRY_SECTION_ID = 'telemetry';\n\nRegistry.as<IConfigurationRegistry>(Extensions.Configuration).registerConfiguration({\n\t'id': TELEMETRY_SECTION_ID,\n\t'order': 110,\n\t'type': 'object',\n\t'title': localize('telemetryConfigurationTitle', \"Telemetry\"),\n\t'properties': {\n\t\t'telemetry.enableTelemetry': {\n\t\t\t'type': 'boolean',\n\t\t\t'description': localize('telemetry.enableTelemetry', \"Enable usage data and errors to be sent to a Microsoft online service.\"),\n\t\t\t'default': true,\n\t\t\t'tags': ['usesOnlineServices']\n\t\t}\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IConfigurationService, ConfigurationTarget, ConfigurationTargetToString } from 'vs/platform/configuration/common/configuration';\nimport { IKeybindingService, KeybindingSource } from 'vs/platform/keybinding/common/keybinding';\nimport { ITelemetryService, ITelemetryInfo, ITelemetryData } from 'vs/platform/telemetry/common/telemetry';\nimport { ILogService } from 'vs/platform/log/common/log';\n\nexport const NullTelemetryService = new class implements ITelemetryService {\n\t_serviceBrand: undefined;\n\tpublicLog(eventName: string, data?: ITelemetryData) {\n\t\treturn Promise.resolve(undefined);\n\t}\n\tisOptedIn: true;\n\tgetTelemetryInfo(): Promise<ITelemetryInfo> {\n\t\treturn Promise.resolve({\n\t\t\tinstanceId: 'someValue.instanceId',\n\t\t\tsessionId: 'someValue.sessionId',\n\t\t\tmachineId: 'someValue.machineId'\n\t\t});\n\t}\n};\n\nexport interface ITelemetryAppender {\n\tlog(eventName: string, data: any): void;\n\tdispose(): Promise<any> | undefined;\n}\n\nexport function combinedAppender(...appenders: ITelemetryAppender[]): ITelemetryAppender {\n\treturn {\n\t\tlog: (e, d) => appenders.forEach(a => a.log(e, d)),\n\t\tdispose: () => Promise.all(appenders.map(a => a.dispose()))\n\t};\n}\n\nexport const NullAppender: ITelemetryAppender = { log: () => null, dispose: () => Promise.resolve(null) };\n\n\nexport class LogAppender implements ITelemetryAppender {\n\n\tprivate commonPropertiesRegex = /^sessionID$|^version$|^timestamp$|^commitHash$|^common\\./;\n\tconstructor(@ILogService private readonly _logService: ILogService) { }\n\n\tdispose(): Promise<any> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tlog(eventName: string, data: any): void {\n\t\tconst strippedData = {};\n\t\tObject.keys(data).forEach(key => {\n\t\t\tif (!this.commonPropertiesRegex.test(key)) {\n\t\t\t\tstrippedData[key] = data[key];\n\t\t\t}\n\t\t});\n\t\tthis._logService.trace(`telemetry/${eventName}`, strippedData);\n\t}\n}\n\n/* __GDPR__FRAGMENT__\n\t\"URIDescriptor\" : {\n\t\t\"mimeType\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"scheme\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"ext\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"path\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t}\n*/\nexport interface URIDescriptor {\n\tmimeType?: string;\n\tscheme?: string;\n\text?: string;\n\tpath?: string;\n}\n\n/**\n * Only add settings that cannot contain any personal/private information of users (PII).\n */\nconst configurationValueWhitelist = [\n\t'editor.fontFamily',\n\t'editor.fontWeight',\n\t'editor.fontSize',\n\t'editor.lineHeight',\n\t'editor.letterSpacing',\n\t'editor.lineNumbers',\n\t'editor.rulers',\n\t'editor.wordSeparators',\n\t'editor.tabSize',\n\t'editor.indentSize',\n\t'editor.insertSpaces',\n\t'editor.detectIndentation',\n\t'editor.roundedSelection',\n\t'editor.scrollBeyondLastLine',\n\t'editor.minimap.enabled',\n\t'editor.minimap.side',\n\t'editor.minimap.renderCharacters',\n\t'editor.minimap.maxColumn',\n\t'editor.find.seedSearchStringFromSelection',\n\t'editor.find.autoFindInSelection',\n\t'editor.wordWrap',\n\t'editor.wordWrapColumn',\n\t'editor.wrappingIndent',\n\t'editor.mouseWheelScrollSensitivity',\n\t'editor.multiCursorModifier',\n\t'editor.quickSuggestions',\n\t'editor.quickSuggestionsDelay',\n\t'editor.parameterHints.enabled',\n\t'editor.parameterHints.cycle',\n\t'editor.autoClosingBrackets',\n\t'editor.autoClosingQuotes',\n\t'editor.autoSurround',\n\t'editor.autoIndent',\n\t'editor.formatOnType',\n\t'editor.formatOnPaste',\n\t'editor.suggestOnTriggerCharacters',\n\t'editor.acceptSuggestionOnEnter',\n\t'editor.acceptSuggestionOnCommitCharacter',\n\t'editor.snippetSuggestions',\n\t'editor.emptySelectionClipboard',\n\t'editor.wordBasedSuggestions',\n\t'editor.suggestSelection',\n\t'editor.suggestFontSize',\n\t'editor.suggestLineHeight',\n\t'editor.tabCompletion',\n\t'editor.selectionHighlight',\n\t'editor.occurrencesHighlight',\n\t'editor.overviewRulerLanes',\n\t'editor.overviewRulerBorder',\n\t'editor.cursorBlinking',\n\t'editor.cursorSmoothCaretAnimation',\n\t'editor.cursorStyle',\n\t'editor.mouseWheelZoom',\n\t'editor.fontLigatures',\n\t'editor.hideCursorInOverviewRuler',\n\t'editor.renderWhitespace',\n\t'editor.renderControlCharacters',\n\t'editor.renderIndentGuides',\n\t'editor.renderLineHighlight',\n\t'editor.codeLens',\n\t'editor.folding',\n\t'editor.showFoldingControls',\n\t'editor.matchBrackets',\n\t'editor.glyphMargin',\n\t'editor.useTabStops',\n\t'editor.trimAutoWhitespace',\n\t'editor.stablePeek',\n\t'editor.dragAndDrop',\n\t'editor.formatOnSave',\n\t'editor.colorDecorators',\n\n\t'breadcrumbs.enabled',\n\t'breadcrumbs.filePath',\n\t'breadcrumbs.symbolPath',\n\t'breadcrumbs.symbolSortOrder',\n\t'breadcrumbs.useQuickPick',\n\t'explorer.openEditors.visible',\n\t'extensions.autoUpdate',\n\t'files.associations',\n\t'files.autoGuessEncoding',\n\t'files.autoSave',\n\t'files.autoSaveDelay',\n\t'files.encoding',\n\t'files.eol',\n\t'files.hotExit',\n\t'files.trimTrailingWhitespace',\n\t'git.confirmSync',\n\t'git.enabled',\n\t'http.proxyStrictSSL',\n\t'javascript.validate.enable',\n\t'php.builtInCompletions.enable',\n\t'php.validate.enable',\n\t'php.validate.run',\n\t'terminal.integrated.fontFamily',\n\t'window.openFilesInNewWindow',\n\t'window.restoreWindows',\n\t'window.zoomLevel',\n\t'workbench.editor.enablePreview',\n\t'workbench.editor.enablePreviewFromQuickOpen',\n\t'workbench.editor.showTabs',\n\t'workbench.editor.highlightModifiedTabs',\n\t'workbench.editor.swipeToNavigate',\n\t'workbench.sideBar.location',\n\t'workbench.startupEditor',\n\t'workbench.statusBar.visible',\n\t'workbench.welcome.enabled',\n];\n\nexport function configurationTelemetry(telemetryService: ITelemetryService, configurationService: IConfigurationService): IDisposable {\n\treturn configurationService.onDidChangeConfiguration(event => {\n\t\tif (event.source !== ConfigurationTarget.DEFAULT) {\n\t\t\t/* __GDPR__\n\t\t\t\t\"updateConfiguration\" : {\n\t\t\t\t\t\"configurationSource\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"configurationKeys\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\ttelemetryService.publicLog('updateConfiguration', {\n\t\t\t\tconfigurationSource: ConfigurationTargetToString(event.source),\n\t\t\t\tconfigurationKeys: flattenKeys(event.sourceConfig)\n\t\t\t});\n\t\t\t/* __GDPR__\n\t\t\t\t\"updateConfigurationValues\" : {\n\t\t\t\t\t\"configurationSource\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"configurationValues\": { \"classification\": \"CustomerContent\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\ttelemetryService.publicLog('updateConfigurationValues', {\n\t\t\t\tconfigurationSource: ConfigurationTargetToString(event.source),\n\t\t\t\tconfigurationValues: flattenValues(event.sourceConfig, configurationValueWhitelist)\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport function keybindingsTelemetry(telemetryService: ITelemetryService, keybindingService: IKeybindingService): IDisposable {\n\treturn keybindingService.onDidUpdateKeybindings(event => {\n\t\tif (event.source === KeybindingSource.User && event.keybindings) {\n\t\t\t/* __GDPR__\n\t\t\t\t\"updateKeybindings\" : {\n\t\t\t\t\t\"bindings\": { \"classification\": \"CustomerContent\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\ttelemetryService.publicLog('updateKeybindings', {\n\t\t\t\tbindings: event.keybindings.map(binding => ({\n\t\t\t\t\tkey: binding.key,\n\t\t\t\t\tcommand: binding.command,\n\t\t\t\t\twhen: binding.when,\n\t\t\t\t\targs: binding.args ? true : undefined\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\t});\n}\n\nfunction flattenKeys(value: Object): string[] {\n\tif (!value) {\n\t\treturn [];\n\t}\n\tconst result: string[] = [];\n\tflatKeys(result, '', value);\n\treturn result;\n}\n\nfunction flatKeys(result: string[], prefix: string, value: Object): void {\n\tif (value && typeof value === 'object' && !Array.isArray(value)) {\n\t\tObject.keys(value)\n\t\t\t.forEach(key => flatKeys(result, prefix ? `${prefix}.${key}` : key, value[key]));\n\t} else {\n\t\tresult.push(prefix);\n\t}\n}\n\nfunction flattenValues(value: Object, keys: string[]): { [key: string]: any }[] {\n\tif (!value) {\n\t\treturn [];\n\t}\n\n\treturn keys.reduce((array, key) => {\n\t\tconst v = key.split('.')\n\t\t\t.reduce((tmp, k) => tmp && typeof tmp === 'object' ? tmp[k] : undefined, value);\n\t\tif (typeof v !== 'undefined') {\n\t\t\tarray.push({ [key]: v });\n\t\t}\n\t\treturn array;\n\t}, <{ [key: string]: any }[]>[]);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as Platform from 'vs/base/common/platform';\nimport * as os from 'os';\nimport * as uuid from 'vs/base/common/uuid';\nimport { readFile } from 'vs/base/node/pfs';\n\nexport function resolveCommonProperties(commit: string | undefined, version: string | undefined, machineId: string | undefined, installSourcePath: string): Promise<{ [name: string]: string | undefined; }> {\n\tconst result: { [name: string]: string | undefined; } = Object.create(null);\n\t// __GDPR__COMMON__ \"common.machineId\" : { \"endPoint\": \"MacAddressHash\", \"classification\": \"EndUserPseudonymizedInformation\", \"purpose\": \"FeatureInsight\" }\n\tresult['common.machineId'] = machineId;\n\t// __GDPR__COMMON__ \"sessionID\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\tresult['sessionID'] = uuid.generateUuid() + Date.now();\n\t// __GDPR__COMMON__ \"commitHash\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\tresult['commitHash'] = commit;\n\t// __GDPR__COMMON__ \"version\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\tresult['version'] = version;\n\t// __GDPR__COMMON__ \"common.platformVersion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\tresult['common.platformVersion'] = (os.release() || '').replace(/^(\\d+)(\\.\\d+)?(\\.\\d+)?(.*)/, '$1$2$3');\n\t// __GDPR__COMMON__ \"common.platform\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\tresult['common.platform'] = Platform.PlatformToString(Platform.platform);\n\t// __GDPR__COMMON__ \"common.nodePlatform\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\tresult['common.nodePlatform'] = process.platform;\n\t// __GDPR__COMMON__ \"common.nodeArch\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\tresult['common.nodeArch'] = process.arch;\n\n\t// dynamic properties which value differs on each call\n\tlet seq = 0;\n\tconst startTime = Date.now();\n\tObject.defineProperties(result, {\n\t\t// __GDPR__COMMON__ \"timestamp\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t'timestamp': {\n\t\t\tget: () => new Date(),\n\t\t\tenumerable: true\n\t\t},\n\t\t// __GDPR__COMMON__ \"common.timesincesessionstart\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t'common.timesincesessionstart': {\n\t\t\tget: () => Date.now() - startTime,\n\t\t\tenumerable: true\n\t\t},\n\t\t// __GDPR__COMMON__ \"common.sequence\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t'common.sequence': {\n\t\t\tget: () => seq++,\n\t\t\tenumerable: true\n\t\t}\n\t});\n\n\treturn readFile(installSourcePath, 'utf8').then(contents => {\n\n\t\t// __GDPR__COMMON__ \"common.source\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\tresult['common.source'] = contents.slice(0, 30);\n\n\t\treturn result;\n\t}, error => {\n\t\treturn result;\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChannel, IServerChannel } from 'vs/base/parts/ipc/node/ipc';\nimport { ITelemetryAppender } from 'vs/platform/telemetry/common/telemetryUtils';\nimport { Event } from 'vs/base/common/event';\n\nexport interface ITelemetryLog {\n\teventName: string;\n\tdata?: any;\n}\n\nexport class TelemetryAppenderChannel implements IServerChannel {\n\n\tconstructor(private appender: ITelemetryAppender) { }\n\n\tlisten<T>(_, event: string): Event<T> {\n\t\tthrow new Error(`Event not found: ${event}`);\n\t}\n\n\tcall(_, command: string, { eventName, data }: ITelemetryLog): Promise<any> {\n\t\tthis.appender.log(eventName, data);\n\t\treturn Promise.resolve(null);\n\t}\n}\n\nexport class TelemetryAppenderClient implements ITelemetryAppender {\n\n\tconstructor(private channel: IChannel) { }\n\n\tlog(eventName: string, data?: any): any {\n\t\tthis.channel.call('log', { eventName, data })\n\t\t\t.then(undefined, err => `Failed to log telemetry: ${console.warn(err)}`);\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tdispose(): any {\n\t\t// TODO\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { Event } from 'vs/base/common/event';\nimport { ITelemetryData } from 'vs/platform/telemetry/common/telemetry';\nimport { IProcessEnvironment, isMacintosh, isLinux } from 'vs/base/common/platform';\nimport { ParsedArgs, IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { IWorkspaceIdentifier, ISingleFolderWorkspaceIdentifier } from 'vs/platform/workspaces/common/workspaces';\nimport { IRecentlyOpened, IRecent } from 'vs/platform/history/common/history';\nimport { ISerializableCommandAction } from 'vs/platform/actions/common/actions';\nimport { ExportData } from 'vs/base/common/performance';\nimport { LogLevel } from 'vs/platform/log/common/log';\nimport { IDisposable, dispose } from 'vs/base/common/lifecycle';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\n\nexport const IWindowsService = createDecorator<IWindowsService>('windowsService');\n\nexport interface INativeOpenDialogOptions {\n\twindowId?: number;\n\tforceNewWindow?: boolean;\n\n\tdialogOptions?: OpenDialogOptions;\n\n\ttelemetryEventName?: string;\n\ttelemetryExtraData?: ITelemetryData;\n}\n\nexport interface IEnterWorkspaceResult {\n\tworkspace: IWorkspaceIdentifier;\n\tbackupPath?: string;\n}\n\nexport interface CrashReporterStartOptions {\n\tcompanyName?: string;\n\tsubmitURL: string;\n\tproductName?: string;\n\tuploadToServer?: boolean;\n\tignoreSystemCrashHandler?: boolean;\n\textra?: any;\n\tcrashesDirectory?: string;\n}\n\nexport interface OpenDialogOptions {\n\ttitle?: string;\n\tdefaultPath?: string;\n\tbuttonLabel?: string;\n\tfilters?: FileFilter[];\n\tproperties?: Array<'openFile' | 'openDirectory' | 'multiSelections' | 'showHiddenFiles' | 'createDirectory' | 'promptToCreate' | 'noResolveAliases' | 'treatPackageAsDirectory'>;\n\tmessage?: string;\n}\n\nexport interface FileFilter {\n\textensions: string[];\n\tname: string;\n}\n\nexport interface MessageBoxOptions {\n\ttype?: string;\n\tbuttons?: string[];\n\tdefaultId?: number;\n\ttitle?: string;\n\tmessage: string;\n\tdetail?: string;\n\tcheckboxLabel?: string;\n\tcheckboxChecked?: boolean;\n\tcancelId?: number;\n\tnoLink?: boolean;\n\tnormalizeAccessKeys?: boolean;\n}\n\nexport interface SaveDialogOptions {\n\ttitle?: string;\n\tdefaultPath?: string;\n\tbuttonLabel?: string;\n\tfilters?: FileFilter[];\n\tmessage?: string;\n\tnameFieldLabel?: string;\n\tshowsTagField?: boolean;\n}\n\nexport interface INewWindowOptions {\n\tremoteAuthority?: string;\n}\n\nexport interface IDevToolsOptions {\n\tmode: 'right' | 'bottom' | 'undocked' | 'detach';\n}\n\nexport interface IWindowsService {\n\n\t_serviceBrand: any;\n\n\tonWindowOpen: Event<number>;\n\tonWindowFocus: Event<number>;\n\tonWindowBlur: Event<number>;\n\tonWindowMaximize: Event<number>;\n\tonWindowUnmaximize: Event<number>;\n\tonRecentlyOpenedChange: Event<void>;\n\n\t// Dialogs\n\tpickFileFolderAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickFileAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickFolderAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickWorkspaceAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tshowMessageBox(windowId: number, options: MessageBoxOptions): Promise<IMessageBoxResult>;\n\tshowSaveDialog(windowId: number, options: SaveDialogOptions): Promise<string>;\n\tshowOpenDialog(windowId: number, options: OpenDialogOptions): Promise<string[]>;\n\n\treloadWindow(windowId: number, args?: ParsedArgs): Promise<void>;\n\topenDevTools(windowId: number, options?: IDevToolsOptions): Promise<void>;\n\ttoggleDevTools(windowId: number): Promise<void>;\n\tcloseWorkspace(windowId: number): Promise<void>;\n\tenterWorkspace(windowId: number, path: URI): Promise<IEnterWorkspaceResult | undefined>;\n\ttoggleFullScreen(windowId: number): Promise<void>;\n\tsetRepresentedFilename(windowId: number, fileName: string): Promise<void>;\n\taddRecentlyOpened(recents: IRecent[]): Promise<void>;\n\tremoveFromRecentlyOpened(paths: URI[]): Promise<void>;\n\tclearRecentlyOpened(): Promise<void>;\n\tgetRecentlyOpened(windowId: number): Promise<IRecentlyOpened>;\n\tfocusWindow(windowId: number): Promise<void>;\n\tcloseWindow(windowId: number): Promise<void>;\n\tisFocused(windowId: number): Promise<boolean>;\n\tisMaximized(windowId: number): Promise<boolean>;\n\tmaximizeWindow(windowId: number): Promise<void>;\n\tunmaximizeWindow(windowId: number): Promise<void>;\n\tminimizeWindow(windowId: number): Promise<void>;\n\tonWindowTitleDoubleClick(windowId: number): Promise<void>;\n\tsetDocumentEdited(windowId: number, flag: boolean): Promise<void>;\n\tquit(): Promise<void>;\n\trelaunch(options: { addArgs?: string[], removeArgs?: string[] }): Promise<void>;\n\n\t// macOS Native Tabs\n\tnewWindowTab(): Promise<void>;\n\tshowPreviousWindowTab(): Promise<void>;\n\tshowNextWindowTab(): Promise<void>;\n\tmoveWindowTabToNewWindow(): Promise<void>;\n\tmergeAllWindowTabs(): Promise<void>;\n\ttoggleWindowTabsBar(): Promise<void>;\n\n\t// macOS TouchBar\n\tupdateTouchBar(windowId: number, items: ISerializableCommandAction[][]): Promise<void>;\n\n\t// Shared process\n\twhenSharedProcessReady(): Promise<void>;\n\ttoggleSharedProcess(): Promise<void>;\n\n\t// Global methods\n\topenWindow(windowId: number, uris: IURIToOpen[], options?: IOpenSettings): Promise<void>;\n\topenNewWindow(options?: INewWindowOptions): Promise<void>;\n\tshowWindow(windowId: number): Promise<void>;\n\tgetWindows(): Promise<{ id: number; workspace?: IWorkspaceIdentifier; folderUri?: ISingleFolderWorkspaceIdentifier; title: string; filename?: string; }[]>;\n\tgetWindowCount(): Promise<number>;\n\tlog(severity: string, ...messages: string[]): Promise<void>;\n\tshowItemInFolder(path: URI): Promise<void>;\n\tgetActiveWindowId(): Promise<number | undefined>;\n\n\t// This needs to be handled from browser process to prevent\n\t// foreground ordering issues on Windows\n\topenExternal(url: string): Promise<boolean>;\n\n\t// TODO: this is a bit backwards\n\tstartCrashReporter(config: CrashReporterStartOptions): Promise<void>;\n\n\topenAboutDialog(): Promise<void>;\n\tresolveProxy(windowId: number, url: string): Promise<string | undefined>;\n}\n\nexport const IWindowService = createDecorator<IWindowService>('windowService');\n\nexport interface IMessageBoxResult {\n\tbutton: number;\n\tcheckboxChecked?: boolean;\n}\n\nexport interface IOpenSettings {\n\tforceNewWindow?: boolean;\n\tforceReuseWindow?: boolean;\n\tforceOpenWorkspaceAsFile?: boolean;\n\tdiffMode?: boolean;\n\taddMode?: boolean;\n\targs?: ParsedArgs;\n}\n\nexport type URIType = 'file' | 'folder';\n\nexport interface IURIToOpen {\n\turi: URI;\n\ttypeHint?: URIType;\n\tlabel?: string;\n}\n\nexport interface IWindowService {\n\n\t_serviceBrand: any;\n\n\treadonly onDidChangeFocus: Event<boolean>;\n\treadonly onDidChangeMaximize: Event<boolean>;\n\n\treadonly hasFocus: boolean;\n\n\tgetConfiguration(): IWindowConfiguration;\n\tgetCurrentWindowId(): number;\n\tpickFileFolderAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickFileAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickFolderAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\tpickWorkspaceAndOpen(options: INativeOpenDialogOptions): Promise<void>;\n\treloadWindow(args?: ParsedArgs): Promise<void>;\n\topenDevTools(options?: IDevToolsOptions): Promise<void>;\n\ttoggleDevTools(): Promise<void>;\n\tcloseWorkspace(): Promise<void>;\n\tupdateTouchBar(items: ISerializableCommandAction[][]): Promise<void>;\n\tenterWorkspace(path: URI): Promise<IEnterWorkspaceResult | undefined>;\n\ttoggleFullScreen(): Promise<void>;\n\tsetRepresentedFilename(fileName: string): Promise<void>;\n\tgetRecentlyOpened(): Promise<IRecentlyOpened>;\n\tfocusWindow(): Promise<void>;\n\tcloseWindow(): Promise<void>;\n\topenWindow(uris: IURIToOpen[], options?: IOpenSettings): Promise<void>;\n\tisFocused(): Promise<boolean>;\n\tsetDocumentEdited(flag: boolean): Promise<void>;\n\tisMaximized(): Promise<boolean>;\n\tmaximizeWindow(): Promise<void>;\n\tunmaximizeWindow(): Promise<void>;\n\tminimizeWindow(): Promise<void>;\n\tonWindowTitleDoubleClick(): Promise<void>;\n\tshow(): Promise<void>;\n\tshowMessageBox(options: MessageBoxOptions): Promise<IMessageBoxResult>;\n\tshowSaveDialog(options: SaveDialogOptions): Promise<string>;\n\tshowOpenDialog(options: OpenDialogOptions): Promise<string[]>;\n\tresolveProxy(url: string): Promise<string | undefined>;\n}\n\nexport type MenuBarVisibility = 'default' | 'visible' | 'toggle' | 'hidden';\n\nexport interface IWindowsConfiguration {\n\twindow: IWindowSettings;\n}\n\nexport interface IWindowSettings {\n\topenFilesInNewWindow: 'on' | 'off' | 'default';\n\topenFoldersInNewWindow: 'on' | 'off' | 'default';\n\topenWithoutArgumentsInNewWindow: 'on' | 'off';\n\trestoreWindows: 'all' | 'folders' | 'one' | 'none';\n\trestoreFullscreen: boolean;\n\tzoomLevel: number;\n\ttitleBarStyle: 'native' | 'custom';\n\tautoDetectHighContrast: boolean;\n\tmenuBarVisibility: MenuBarVisibility;\n\tnewWindowDimensions: 'default' | 'inherit' | 'maximized' | 'fullscreen';\n\tnativeTabs: boolean;\n\tnativeFullScreen: boolean;\n\tenableMenuBarMnemonics: boolean;\n\tcloseWhenEmpty: boolean;\n\tclickThroughInactive: boolean;\n}\n\nexport function getTitleBarStyle(configurationService: IConfigurationService, environment: IEnvironmentService, isExtensionDevelopment = environment.isExtensionDevelopment): 'native' | 'custom' {\n\tconst configuration = configurationService.getValue<IWindowSettings>('window');\n\n\tconst isDev = !environment.isBuilt || isExtensionDevelopment;\n\tif (isMacintosh && isDev) {\n\t\treturn 'native'; // not enabled when developing due to https://github.com/electron/electron/issues/3647\n\t}\n\n\tif (configuration) {\n\t\tconst useNativeTabs = isMacintosh && configuration.nativeTabs === true;\n\t\tif (useNativeTabs) {\n\t\t\treturn 'native'; // native tabs on sierra do not work with custom title style\n\t\t}\n\n\t\tconst useSimpleFullScreen = isMacintosh && configuration.nativeFullScreen === false;\n\t\tif (useSimpleFullScreen) {\n\t\t\treturn 'native'; // simple fullscreen does not work well with custom title style (https://github.com/Microsoft/vscode/issues/63291)\n\t\t}\n\n\t\tconst style = configuration.titleBarStyle;\n\t\tif (style === 'native' || style === 'custom') {\n\t\t\treturn style;\n\t\t}\n\t}\n\n\treturn isLinux ? 'native' : 'custom'; // default to custom on all macOS and Windows\n}\n\nexport const enum OpenContext {\n\n\t// opening when running from the command line\n\tCLI,\n\n\t// macOS only: opening from the dock (also when opening files to a running instance from desktop)\n\tDOCK,\n\n\t// opening from the main application window\n\tMENU,\n\n\t// opening from a file or folder dialog\n\tDIALOG,\n\n\t// opening from the OS's UI\n\tDESKTOP,\n\n\t// opening through the API\n\tAPI\n}\n\nexport const enum ReadyState {\n\n\t/**\n\t * This window has not loaded any HTML yet\n\t */\n\tNONE,\n\n\t/**\n\t * This window is loading HTML\n\t */\n\tLOADING,\n\n\t/**\n\t * This window is navigating to another HTML\n\t */\n\tNAVIGATING,\n\n\t/**\n\t * This window is done loading HTML\n\t */\n\tREADY\n}\n\nexport interface IPath extends IPathData {\n\n\t// the file path to open within a Code instance\n\tfileUri?: URI;\n}\n\nexport interface IPathsToWaitFor extends IPathsToWaitForData {\n\tpaths: IPath[];\n}\n\nexport interface IPathsToWaitForData {\n\tpaths: IPathData[];\n\twaitMarkerFilePath: string;\n}\n\nexport interface IPathData {\n\n\t// the file path to open within a Code instance\n\tfileUri?: UriComponents;\n\n\t// the line number in the file path to open\n\tlineNumber?: number;\n\n\t// the column number in the file path to open\n\tcolumnNumber?: number;\n}\n\nexport interface IOpenFileRequest {\n\tfilesToOpen?: IPathData[];\n\tfilesToCreate?: IPathData[];\n\tfilesToDiff?: IPathData[];\n\tfilesToWait?: IPathsToWaitForData;\n\ttermProgram?: string;\n}\n\nexport interface IAddFoldersRequest {\n\tfoldersToAdd: UriComponents[];\n}\n\nexport interface IWindowConfiguration extends ParsedArgs {\n\tmachineId: string;\n\twindowId: number;\n\tlogLevel: LogLevel;\n\n\tmainPid: number;\n\n\tappRoot: string;\n\texecPath: string;\n\tisInitialStartup?: boolean;\n\n\tuserEnv: IProcessEnvironment;\n\tnodeCachedDataDir?: string;\n\n\tbackupPath?: string;\n\n\tworkspace?: IWorkspaceIdentifier;\n\tfolderUri?: ISingleFolderWorkspaceIdentifier;\n\n\tremoteAuthority?: string;\n\n\tzoomLevel?: number;\n\tfullscreen?: boolean;\n\tmaximized?: boolean;\n\thighContrast?: boolean;\n\tframeless?: boolean;\n\taccessibilitySupport?: boolean;\n\tpartsSplashPath?: string;\n\n\tperfStartTime?: number;\n\tperfAppReady?: number;\n\tperfWindowLoadTime?: number;\n\tperfEntries: ExportData;\n\n\tfilesToOpen?: IPath[];\n\tfilesToCreate?: IPath[];\n\tfilesToDiff?: IPath[];\n\tfilesToWait?: IPathsToWaitFor;\n\ttermProgram?: string;\n}\n\nexport interface IRunActionInWindowRequest {\n\tid: string;\n\tfrom: 'menu' | 'touchbar' | 'mouse';\n\targs?: any[];\n}\n\nexport interface IRunKeybindingInWindowRequest {\n\tuserSettingsLabel: string;\n}\n\nexport class ActiveWindowManager implements IDisposable {\n\n\tprivate disposables: IDisposable[] = [];\n\tprivate firstActiveWindowIdPromise: Promise<any> | null;\n\tprivate _activeWindowId: number | undefined;\n\n\tconstructor(@IWindowsService windowsService: IWindowsService) {\n\t\tconst onActiveWindowChange = Event.latch(Event.any(windowsService.onWindowOpen, windowsService.onWindowFocus));\n\t\tonActiveWindowChange(this.setActiveWindow, this, this.disposables);\n\n\t\tthis.firstActiveWindowIdPromise = windowsService.getActiveWindowId()\n\t\t\t.then(id => (typeof this._activeWindowId === 'undefined') && this.setActiveWindow(id));\n\t}\n\n\tprivate setActiveWindow(windowId: number | undefined) {\n\t\tif (this.firstActiveWindowIdPromise) {\n\t\t\tthis.firstActiveWindowIdPromise = null;\n\t\t}\n\n\t\tthis._activeWindowId = windowId;\n\t}\n\n\tgetActiveClientId(): Promise<string> {\n\t\tif (this.firstActiveWindowIdPromise) {\n\t\t\treturn this.firstActiveWindowIdPromise;\n\t\t}\n\n\t\treturn Promise.resolve(`window:${this._activeWindowId}`);\n\t}\n\n\tdispose() {\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { localize } from 'vs/nls';\nimport { Event } from 'vs/base/common/event';\nimport { IWorkspaceFolder, IWorkspace } from 'vs/platform/workspace/common/workspace';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { isWindows, isLinux, isMacintosh } from 'vs/base/common/platform';\nimport { extname } from 'vs/base/common/path';\nimport { dirname, resolvePath, isEqualAuthority, isEqualOrParent, relativePath } from 'vs/base/common/resources';\nimport * as jsonEdit from 'vs/base/common/jsonEdit';\nimport * as json from 'vs/base/common/json';\nimport { Schemas } from 'vs/base/common/network';\nimport { normalizeDriveLetter } from 'vs/base/common/labels';\nimport { toSlashes } from 'vs/base/common/extpath';\n\nexport const IWorkspacesMainService = createDecorator<IWorkspacesMainService>('workspacesMainService');\nexport const IWorkspacesService = createDecorator<IWorkspacesService>('workspacesService');\n\nexport const WORKSPACE_EXTENSION = 'code-workspace';\nexport const WORKSPACE_FILTER = [{ name: localize('codeWorkspace', \"Code Workspace\"), extensions: [WORKSPACE_EXTENSION] }];\nexport const UNTITLED_WORKSPACE_NAME = 'workspace.json';\n\n/**\n * A single folder workspace identifier is just the path to the folder.\n */\nexport type ISingleFolderWorkspaceIdentifier = URI;\n\nexport interface IWorkspaceIdentifier {\n\tid: string;\n\tconfigPath: URI;\n}\n\nexport function reviveWorkspaceIdentifier(workspace: { id: string, configPath: UriComponents; }): IWorkspaceIdentifier {\n\treturn { id: workspace.id, configPath: URI.revive(workspace.configPath) };\n}\n\nexport function isStoredWorkspaceFolder(thing: any): thing is IStoredWorkspaceFolder {\n\treturn isRawFileWorkspaceFolder(thing) || isRawUriWorkspaceFolder(thing);\n}\n\nexport function isRawFileWorkspaceFolder(thing: any): thing is IRawFileWorkspaceFolder {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& typeof thing.path === 'string'\n\t\t&& (!thing.name || typeof thing.name === 'string');\n}\n\nexport function isRawUriWorkspaceFolder(thing: any): thing is IRawUriWorkspaceFolder {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& typeof thing.uri === 'string'\n\t\t&& (!thing.name || typeof thing.name === 'string');\n}\n\nexport interface IRawFileWorkspaceFolder {\n\tpath: string;\n\tname?: string;\n}\n\nexport interface IRawUriWorkspaceFolder {\n\turi: string;\n\tname?: string;\n}\n\nexport type IStoredWorkspaceFolder = IRawFileWorkspaceFolder | IRawUriWorkspaceFolder;\n\nexport interface IResolvedWorkspace extends IWorkspaceIdentifier {\n\tfolders: IWorkspaceFolder[];\n\tremoteAuthority?: string;\n}\n\nexport interface IStoredWorkspace {\n\tfolders: IStoredWorkspaceFolder[];\n}\n\nexport interface IWorkspaceSavedEvent {\n\tworkspace: IWorkspaceIdentifier;\n\toldConfigPath: string;\n}\n\nexport interface IWorkspaceFolderCreationData {\n\turi: URI;\n\tname?: string;\n}\n\nexport interface IUntitledWorkspaceInfo {\n\tworkspace: IWorkspaceIdentifier;\n\tremoteAuthority?: string;\n}\n\nexport interface IWorkspacesMainService extends IWorkspacesService {\n\t_serviceBrand: any;\n\n\tonUntitledWorkspaceDeleted: Event<IWorkspaceIdentifier>;\n\n\tcreateUntitledWorkspaceSync(folders?: IWorkspaceFolderCreationData[]): IWorkspaceIdentifier;\n\n\tresolveLocalWorkspaceSync(path: URI): IResolvedWorkspace | null;\n\n\tisUntitledWorkspace(workspace: IWorkspaceIdentifier): boolean;\n\n\tdeleteUntitledWorkspaceSync(workspace: IWorkspaceIdentifier): void;\n\n\tgetUntitledWorkspacesSync(): IUntitledWorkspaceInfo[];\n}\n\nexport interface IWorkspacesService {\n\t_serviceBrand: any;\n\n\tcreateUntitledWorkspace(folders?: IWorkspaceFolderCreationData[], remoteAuthority?: string): Promise<IWorkspaceIdentifier>;\n\n\tdeleteUntitledWorkspace(workspace: IWorkspaceIdentifier): Promise<void>;\n\n\tgetWorkspaceIdentifier(workspacePath: URI): Promise<IWorkspaceIdentifier>;\n}\n\nexport function isSingleFolderWorkspaceIdentifier(obj: any): obj is ISingleFolderWorkspaceIdentifier {\n\treturn obj instanceof URI;\n}\n\nexport function isWorkspaceIdentifier(obj: any): obj is IWorkspaceIdentifier {\n\tconst workspaceIdentifier = obj as IWorkspaceIdentifier;\n\n\treturn workspaceIdentifier && typeof workspaceIdentifier.id === 'string' && workspaceIdentifier.configPath instanceof URI;\n}\n\nexport function toWorkspaceIdentifier(workspace: IWorkspace): IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined {\n\tif (workspace.configuration) {\n\t\treturn {\n\t\t\tconfigPath: workspace.configuration,\n\t\t\tid: workspace.id\n\t\t};\n\t}\n\tif (workspace.folders.length === 1) {\n\t\treturn workspace.folders[0].uri;\n\t}\n\n\t// Empty workspace\n\treturn undefined;\n}\n\nexport type IMultiFolderWorkspaceInitializationPayload = IWorkspaceIdentifier;\nexport interface ISingleFolderWorkspaceInitializationPayload { id: string; folder: ISingleFolderWorkspaceIdentifier; }\nexport interface IEmptyWorkspaceInitializationPayload { id: string; }\n\nexport type IWorkspaceInitializationPayload = IMultiFolderWorkspaceInitializationPayload | ISingleFolderWorkspaceInitializationPayload | IEmptyWorkspaceInitializationPayload;\n\nexport function isSingleFolderWorkspaceInitializationPayload(obj: any): obj is ISingleFolderWorkspaceInitializationPayload {\n\treturn isSingleFolderWorkspaceIdentifier((obj.folder as ISingleFolderWorkspaceIdentifier));\n}\n\nconst WORKSPACE_SUFFIX = '.' + WORKSPACE_EXTENSION;\n\nexport function hasWorkspaceFileExtension(path: string) {\n\treturn extname(path) === WORKSPACE_SUFFIX;\n}\n\nconst SLASH = '/';\n\n/**\n * Given a folder URI and the workspace config folder, computes the IStoredWorkspaceFolder using\n* a relative or absolute path or a uri.\n * Undefined is returned if the folderURI and the targetConfigFolderURI don't have the same schema or authority\n *\n * @param folderURI a workspace folder\n * @param folderName a workspace name\n * @param targetConfigFolderURI the folder where the workspace is living in\n * @param useSlashForPath if set, use forward slashes for file paths on windows\n */\nexport function getStoredWorkspaceFolder(folderURI: URI, folderName: string | undefined, targetConfigFolderURI: URI, useSlashForPath = !isWindows): IStoredWorkspaceFolder {\n\n\tif (folderURI.scheme !== targetConfigFolderURI.scheme || !isEqualAuthority(folderURI.authority, targetConfigFolderURI.authority)) {\n\t\treturn { name: folderName, uri: folderURI.toString(true) };\n\t}\n\n\tlet folderPath: string | undefined;\n\tif (isEqualOrParent(folderURI, targetConfigFolderURI)) {\n\t\t// use relative path\n\t\tfolderPath = relativePath(targetConfigFolderURI, folderURI) || '.'; // always uses forward slashes\n\t\tif (isWindows && folderURI.scheme === Schemas.file && !useSlashForPath) {\n\t\t\t// Windows gets special treatment:\n\t\t\t// - use backslahes unless slash is used by other existing folders\n\t\t\tfolderPath = folderPath.replace(/\\//g, '\\\\');\n\t\t}\n\t} else {\n\t\t// use absolute path\n\t\tif (folderURI.scheme === Schemas.file) {\n\t\t\tfolderPath = folderURI.fsPath;\n\t\t\tif (isWindows) {\n\t\t\t\t// Windows gets special treatment:\n\t\t\t\t// - normalize all paths to get nice casing of drive letters\n\t\t\t\t// - use backslahes unless slash is used by other existing folders\n\t\t\t\tfolderPath = normalizeDriveLetter(folderPath);\n\t\t\t\tif (useSlashForPath) {\n\t\t\t\t\tfolderPath = toSlashes(folderPath);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfolderPath = folderURI.path;\n\t\t}\n\t}\n\treturn { name: folderName, path: folderPath };\n}\n\n/**\n * Rewrites the content of a workspace file to be saved at a new location.\n * Throws an exception if file is not a valid workspace file\n */\nexport function rewriteWorkspaceFileForNewLocation(rawWorkspaceContents: string, configPathURI: URI, targetConfigPathURI: URI) {\n\tlet storedWorkspace = doParseStoredWorkspace(configPathURI, rawWorkspaceContents);\n\n\tconst sourceConfigFolder = dirname(configPathURI);\n\tconst targetConfigFolder = dirname(targetConfigPathURI);\n\n\tconst rewrittenFolders: IStoredWorkspaceFolder[] = [];\n\tconst slashForPath = useSlashForPath(storedWorkspace.folders);\n\n\t// Rewrite absolute paths to relative paths if the target workspace folder\n\t// is a parent of the location of the workspace file itself. Otherwise keep\n\t// using absolute paths.\n\tfor (const folder of storedWorkspace.folders) {\n\t\tlet folderURI = isRawFileWorkspaceFolder(folder) ? resolvePath(sourceConfigFolder, folder.path) : URI.parse(folder.uri);\n\t\trewrittenFolders.push(getStoredWorkspaceFolder(folderURI, folder.name, targetConfigFolder, slashForPath));\n\t}\n\n\t// Preserve as much of the existing workspace as possible by using jsonEdit\n\t// and only changing the folders portion.\n\tlet newRawWorkspaceContents = rawWorkspaceContents;\n\tconst edits = jsonEdit.setProperty(rawWorkspaceContents, ['folders'], rewrittenFolders, { insertSpaces: false, tabSize: 4, eol: (isLinux || isMacintosh) ? '\\n' : '\\r\\n' });\n\tedits.forEach(edit => {\n\t\tnewRawWorkspaceContents = jsonEdit.applyEdit(rawWorkspaceContents, edit);\n\t});\n\treturn newRawWorkspaceContents;\n}\n\nfunction doParseStoredWorkspace(path: URI, contents: string): IStoredWorkspace {\n\n\t// Parse workspace file\n\tlet storedWorkspace: IStoredWorkspace = json.parse(contents); // use fault tolerant parser\n\n\t// Filter out folders which do not have a path or uri set\n\tif (Array.isArray(storedWorkspace.folders)) {\n\t\tstoredWorkspace.folders = storedWorkspace.folders.filter(folder => isStoredWorkspaceFolder(folder));\n\t}\n\n\t// Validate\n\tif (!Array.isArray(storedWorkspace.folders)) {\n\t\tthrow new Error(`${path} looks like an invalid workspace file.`);\n\t}\n\n\treturn storedWorkspace;\n}\n\nexport function useSlashForPath(storedFolders: IStoredWorkspaceFolder[]): boolean {\n\tif (isWindows) {\n\t\tfor (const folder of storedFolders) {\n\t\t\tif (isRawFileWorkspaceFolder(folder) && folder.path.indexOf(SLASH) >= 0) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { IChannel } from 'vs/base/parts/ipc/node/ipc';\nimport { IWindowsService, INativeOpenDialogOptions, IEnterWorkspaceResult, CrashReporterStartOptions, IMessageBoxResult, MessageBoxOptions, SaveDialogOptions, OpenDialogOptions, IDevToolsOptions, INewWindowOptions, IURIToOpen } from 'vs/platform/windows/common/windows';\nimport { IWorkspaceIdentifier, ISingleFolderWorkspaceIdentifier, reviveWorkspaceIdentifier } from 'vs/platform/workspaces/common/workspaces';\nimport { IRecentlyOpened, IRecent, isRecentWorkspace } from 'vs/platform/history/common/history';\nimport { ISerializableCommandAction } from 'vs/platform/actions/common/actions';\nimport { URI } from 'vs/base/common/uri';\nimport { ParsedArgs } from 'vs/platform/environment/common/environment';\nimport { IMainProcessService } from 'vs/platform/ipc/electron-browser/mainProcessService';\n\nexport class WindowsService implements IWindowsService {\n\n\t_serviceBrand: any;\n\n\tprivate channel: IChannel;\n\n\tconstructor(@IMainProcessService mainProcessService: IMainProcessService) {\n\t\tthis.channel = mainProcessService.getChannel('windows');\n\t}\n\n\tget onWindowOpen(): Event<number> { return this.channel.listen('onWindowOpen'); }\n\tget onWindowFocus(): Event<number> { return this.channel.listen('onWindowFocus'); }\n\tget onWindowBlur(): Event<number> { return this.channel.listen('onWindowBlur'); }\n\tget onWindowMaximize(): Event<number> { return this.channel.listen('onWindowMaximize'); }\n\tget onWindowUnmaximize(): Event<number> { return this.channel.listen('onWindowUnmaximize'); }\n\tget onRecentlyOpenedChange(): Event<void> { return this.channel.listen('onRecentlyOpenedChange'); }\n\n\tpickFileFolderAndOpen(options: INativeOpenDialogOptions): Promise<void> {\n\t\treturn this.channel.call('pickFileFolderAndOpen', options);\n\t}\n\n\tpickFileAndOpen(options: INativeOpenDialogOptions): Promise<void> {\n\t\treturn this.channel.call('pickFileAndOpen', options);\n\t}\n\n\tpickFolderAndOpen(options: INativeOpenDialogOptions): Promise<void> {\n\t\treturn this.channel.call('pickFolderAndOpen', options);\n\t}\n\n\tpickWorkspaceAndOpen(options: INativeOpenDialogOptions): Promise<void> {\n\t\treturn this.channel.call('pickWorkspaceAndOpen', options);\n\t}\n\n\tshowMessageBox(windowId: number, options: MessageBoxOptions): Promise<IMessageBoxResult> {\n\t\treturn this.channel.call('showMessageBox', [windowId, options]);\n\t}\n\n\tshowSaveDialog(windowId: number, options: SaveDialogOptions): Promise<string> {\n\t\treturn this.channel.call('showSaveDialog', [windowId, options]);\n\t}\n\n\tshowOpenDialog(windowId: number, options: OpenDialogOptions): Promise<string[]> {\n\t\treturn this.channel.call('showOpenDialog', [windowId, options]);\n\t}\n\n\treloadWindow(windowId: number, args?: ParsedArgs): Promise<void> {\n\t\treturn this.channel.call('reloadWindow', [windowId, args]);\n\t}\n\n\topenDevTools(windowId: number, options?: IDevToolsOptions): Promise<void> {\n\t\treturn this.channel.call('openDevTools', [windowId, options]);\n\t}\n\n\ttoggleDevTools(windowId: number): Promise<void> {\n\t\treturn this.channel.call('toggleDevTools', windowId);\n\t}\n\n\tcloseWorkspace(windowId: number): Promise<void> {\n\t\treturn this.channel.call('closeWorkspace', windowId);\n\t}\n\n\tenterWorkspace(windowId: number, path: URI): Promise<IEnterWorkspaceResult> {\n\t\treturn this.channel.call('enterWorkspace', [windowId, path]).then((result: IEnterWorkspaceResult) => {\n\t\t\tresult.workspace = reviveWorkspaceIdentifier(result.workspace);\n\t\t\treturn result;\n\t\t});\n\t}\n\n\ttoggleFullScreen(windowId: number): Promise<void> {\n\t\treturn this.channel.call('toggleFullScreen', windowId);\n\t}\n\n\tsetRepresentedFilename(windowId: number, fileName: string): Promise<void> {\n\t\treturn this.channel.call('setRepresentedFilename', [windowId, fileName]);\n\t}\n\n\taddRecentlyOpened(recent: IRecent[]): Promise<void> {\n\t\treturn this.channel.call('addRecentlyOpened', recent);\n\t}\n\n\tremoveFromRecentlyOpened(paths: Array<URI>): Promise<void> {\n\t\treturn this.channel.call('removeFromRecentlyOpened', paths);\n\t}\n\n\tclearRecentlyOpened(): Promise<void> {\n\t\treturn this.channel.call('clearRecentlyOpened');\n\t}\n\n\tgetRecentlyOpened(windowId: number): Promise<IRecentlyOpened> {\n\t\treturn this.channel.call('getRecentlyOpened', windowId)\n\t\t\t.then((recentlyOpened: IRecentlyOpened) => {\n\t\t\t\trecentlyOpened.workspaces.forEach(recent => isRecentWorkspace(recent) ? recent.workspace = reviveWorkspaceIdentifier(recent.workspace) : recent.folderUri = URI.revive(recent.folderUri));\n\t\t\t\trecentlyOpened.files.forEach(recent => recent.fileUri = URI.revive(recent.fileUri));\n\t\t\t\treturn recentlyOpened;\n\t\t\t});\n\t}\n\n\tnewWindowTab(): Promise<void> {\n\t\treturn this.channel.call('newWindowTab');\n\t}\n\n\tshowPreviousWindowTab(): Promise<void> {\n\t\treturn this.channel.call('showPreviousWindowTab');\n\t}\n\n\tshowNextWindowTab(): Promise<void> {\n\t\treturn this.channel.call('showNextWindowTab');\n\t}\n\n\tmoveWindowTabToNewWindow(): Promise<void> {\n\t\treturn this.channel.call('moveWindowTabToNewWindow');\n\t}\n\n\tmergeAllWindowTabs(): Promise<void> {\n\t\treturn this.channel.call('mergeAllWindowTabs');\n\t}\n\n\ttoggleWindowTabsBar(): Promise<void> {\n\t\treturn this.channel.call('toggleWindowTabsBar');\n\t}\n\n\tfocusWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('focusWindow', windowId);\n\t}\n\n\tcloseWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('closeWindow', windowId);\n\t}\n\n\tisFocused(windowId: number): Promise<boolean> {\n\t\treturn this.channel.call('isFocused', windowId);\n\t}\n\n\tisMaximized(windowId: number): Promise<boolean> {\n\t\treturn this.channel.call('isMaximized', windowId);\n\t}\n\n\tmaximizeWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('maximizeWindow', windowId);\n\t}\n\n\tunmaximizeWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('unmaximizeWindow', windowId);\n\t}\n\n\tminimizeWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('minimizeWindow', windowId);\n\t}\n\n\tonWindowTitleDoubleClick(windowId: number): Promise<void> {\n\t\treturn this.channel.call('onWindowTitleDoubleClick', windowId);\n\t}\n\n\tsetDocumentEdited(windowId: number, flag: boolean): Promise<void> {\n\t\treturn this.channel.call('setDocumentEdited', [windowId, flag]);\n\t}\n\n\tquit(): Promise<void> {\n\t\treturn this.channel.call('quit');\n\t}\n\n\trelaunch(options: { addArgs?: string[], removeArgs?: string[] }): Promise<void> {\n\t\treturn this.channel.call('relaunch', [options]);\n\t}\n\n\twhenSharedProcessReady(): Promise<void> {\n\t\tif (process.env.isBrowser) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this.channel.call('whenSharedProcessReady');\n\t}\n\n\ttoggleSharedProcess(): Promise<void> {\n\t\treturn this.channel.call('toggleSharedProcess');\n\t}\n\n\topenWindow(windowId: number, uris: IURIToOpen[], options?: { forceNewWindow?: boolean, forceReuseWindow?: boolean, forceOpenWorkspaceAsFile?: boolean, args?: ParsedArgs }): Promise<void> {\n\t\treturn this.channel.call('openWindow', [windowId, uris, options]);\n\t}\n\n\topenNewWindow(options?: INewWindowOptions): Promise<void> {\n\t\treturn this.channel.call('openNewWindow', options);\n\t}\n\n\tshowWindow(windowId: number): Promise<void> {\n\t\treturn this.channel.call('showWindow', windowId);\n\t}\n\n\tgetWindows(): Promise<{ id: number; workspace?: IWorkspaceIdentifier; folderUri?: ISingleFolderWorkspaceIdentifier; title: string; filename?: string; }[]> {\n\t\treturn this.channel.call<{ id: number; workspace?: IWorkspaceIdentifier; folderUri?: ISingleFolderWorkspaceIdentifier; title: string; filename?: string; }[]>('getWindows').then(result => {\n\t\t\tfor (const win of result) {\n\t\t\t\tif (win.folderUri) {\n\t\t\t\t\twin.folderUri = URI.revive(win.folderUri);\n\t\t\t\t}\n\t\t\t\tif (win.workspace) {\n\t\t\t\t\twin.workspace = reviveWorkspaceIdentifier(win.workspace);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tgetWindowCount(): Promise<number> {\n\t\treturn this.channel.call('getWindowCount');\n\t}\n\n\tlog(severity: string, ...messages: string[]): Promise<void> {\n\t\treturn this.channel.call('log', [severity, messages]);\n\t}\n\n\tshowItemInFolder(path: URI): Promise<void> {\n\t\treturn this.channel.call('showItemInFolder', path);\n\t}\n\n\tgetActiveWindowId(): Promise<number | undefined> {\n\t\treturn this.channel.call('getActiveWindowId');\n\t}\n\n\topenExternal(url: string): Promise<boolean> {\n\t\treturn this.channel.call('openExternal', url);\n\t}\n\n\tstartCrashReporter(config: CrashReporterStartOptions): Promise<void> {\n\t\treturn this.channel.call('startCrashReporter', config);\n\t}\n\n\tupdateTouchBar(windowId: number, items: ISerializableCommandAction[][]): Promise<void> {\n\t\treturn this.channel.call('updateTouchBar', [windowId, items]);\n\t}\n\n\topenAboutDialog(): Promise<void> {\n\t\treturn this.channel.call('openAboutDialog');\n\t}\n\n\tresolveProxy(windowId: number, url: string): Promise<string | undefined> {\n\t\treturn Promise.resolve(this.channel.call('resolveProxy', [windowId, url]));\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/issueReporter';\nimport { shell, ipcRenderer, webFrame, clipboard } from 'electron';\nimport { localize } from 'vs/nls';\nimport { $ } from 'vs/base/browser/dom';\nimport * as collections from 'vs/base/common/collections';\nimport * as browser from 'vs/base/browser/browser';\nimport { escape } from 'vs/base/common/strings';\nimport product from 'vs/platform/product/node/product';\nimport pkg from 'vs/platform/product/node/package';\nimport * as os from 'os';\nimport { debounce } from 'vs/base/common/decorators';\nimport * as platform from 'vs/base/common/platform';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { getDelayedChannel } from 'vs/base/parts/ipc/node/ipc';\nimport { connect as connectNet } from 'vs/base/parts/ipc/node/ipc.net';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { IWindowConfiguration, IWindowsService } from 'vs/platform/windows/common/windows';\nimport { NullTelemetryService, combinedAppender, LogAppender } from 'vs/platform/telemetry/common/telemetryUtils';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { ITelemetryServiceConfig, TelemetryService } from 'vs/platform/telemetry/common/telemetryService';\nimport { TelemetryAppenderClient } from 'vs/platform/telemetry/node/telemetryIpc';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { InstantiationService } from 'vs/platform/instantiation/common/instantiationService';\nimport { resolveCommonProperties } from 'vs/platform/telemetry/node/commonProperties';\nimport { WindowsService } from 'vs/platform/windows/electron-browser/windowsService';\nimport { MainProcessService, IMainProcessService } from 'vs/platform/ipc/electron-browser/mainProcessService';\nimport { EnvironmentService } from 'vs/platform/environment/node/environmentService';\nimport { IssueReporterModel } from 'vs/code/electron-browser/issue/issueReporterModel';\nimport { IssueReporterData, IssueReporterStyles, IssueType, ISettingsSearchIssueReporterData, IssueReporterFeatures, IssueReporterExtensionData } from 'vs/platform/issue/common/issue';\nimport BaseHtml from 'vs/code/electron-browser/issue/issueReporterPage';\nimport { createSpdLogService } from 'vs/platform/log/node/spdlogService';\nimport { LogLevelSetterChannelClient, FollowerLogService } from 'vs/platform/log/node/logIpc';\nimport { ILogService, getLogLevel } from 'vs/platform/log/common/log';\nimport { OcticonLabel } from 'vs/base/browser/ui/octiconLabel/octiconLabel';\nimport { normalizeGitHubUrl } from 'vs/code/electron-browser/issue/issueReporterUtil';\nimport { Button } from 'vs/base/browser/ui/button/button';\n\nconst MAX_URL_LENGTH = platform.isWindows ? 2081 : 5400;\n\ninterface SearchResult {\n\thtml_url: string;\n\ttitle: string;\n\tstate?: string;\n}\n\nexport interface IssueReporterConfiguration extends IWindowConfiguration {\n\tdata: IssueReporterData;\n\tfeatures: IssueReporterFeatures;\n}\n\nexport function startup(configuration: IssueReporterConfiguration) {\n\tdocument.body.innerHTML = BaseHtml();\n\tconst issueReporter = new IssueReporter(configuration);\n\tissueReporter.render();\n\tdocument.body.style.display = 'block';\n}\n\nexport class IssueReporter extends Disposable {\n\tprivate environmentService: IEnvironmentService;\n\tprivate telemetryService: ITelemetryService;\n\tprivate logService: ILogService;\n\tprivate readonly issueReporterModel: IssueReporterModel;\n\tprivate numberOfSearchResultsDisplayed = 0;\n\tprivate receivedSystemInfo = false;\n\tprivate receivedPerformanceInfo = false;\n\tprivate shouldQueueSearch = false;\n\tprivate hasBeenSubmitted = false;\n\n\tprivate readonly previewButton: Button;\n\n\tconstructor(configuration: IssueReporterConfiguration) {\n\t\tsuper();\n\n\t\tthis.initServices(configuration);\n\n\t\tthis.issueReporterModel = new IssueReporterModel({\n\t\t\tissueType: configuration.data.issueType || IssueType.Bug,\n\t\t\tversionInfo: {\n\t\t\t\tvscodeVersion: `${pkg.name} ${pkg.version} (${product.commit || 'Commit unknown'}, ${product.date || 'Date unknown'})`,\n\t\t\t\tos: `${os.type()} ${os.arch()} ${os.release()}`\n\t\t\t},\n\t\t\textensionsDisabled: !!this.environmentService.disableExtensions,\n\t\t});\n\n\t\tconst issueReporterElement = this.getElementById('issue-reporter');\n\t\tif (issueReporterElement) {\n\t\t\tthis.previewButton = new Button(issueReporterElement);\n\t\t}\n\n\t\tipcRenderer.on('vscode:issuePerformanceInfoResponse', (_, info) => {\n\t\t\tthis.logService.trace('issueReporter: Received performance data');\n\t\t\tthis.issueReporterModel.update(info);\n\t\t\tthis.receivedPerformanceInfo = true;\n\n\t\t\tconst state = this.issueReporterModel.getData();\n\t\t\tthis.updateProcessInfo(state);\n\t\t\tthis.updateWorkspaceInfo(state);\n\t\t\tthis.updatePreviewButtonState();\n\t\t});\n\n\t\tipcRenderer.on('vscode:issueSystemInfoResponse', (_, info) => {\n\t\t\tthis.logService.trace('issueReporter: Received system data');\n\t\t\tthis.issueReporterModel.update({ systemInfo: info });\n\t\t\tthis.receivedSystemInfo = true;\n\n\t\t\tthis.updateSystemInfo(this.issueReporterModel.getData());\n\t\t\tthis.updatePreviewButtonState();\n\t\t});\n\n\t\tipcRenderer.send('vscode:issueSystemInfoRequest');\n\t\tif (configuration.data.issueType === IssueType.PerformanceIssue) {\n\t\t\tipcRenderer.send('vscode:issuePerformanceInfoRequest');\n\t\t}\n\t\tthis.logService.trace('issueReporter: Sent data requests');\n\n\t\tif (window.document.documentElement.lang !== 'en') {\n\t\t\tshow(this.getElementById('english'));\n\t\t}\n\n\t\tthis.setUpTypes();\n\t\tthis.setEventHandlers();\n\t\tthis.applyZoom(configuration.data.zoomLevel);\n\t\tthis.applyStyles(configuration.data.styles);\n\t\tthis.handleExtensionData(configuration.data.enabledExtensions);\n\n\t\tif (configuration.data.issueType === IssueType.SettingsSearchIssue) {\n\t\t\tthis.handleSettingsSearchData(<ISettingsSearchIssueReporterData>configuration.data);\n\t\t}\n\t}\n\n\trender(): void {\n\t\tthis.renderBlocks();\n\t}\n\n\tprivate applyZoom(zoomLevel: number) {\n\t\twebFrame.setZoomLevel(zoomLevel);\n\t\tbrowser.setZoomFactor(webFrame.getZoomFactor());\n\t\t// See https://github.com/Microsoft/vscode/issues/26151\n\t\t// Cannot be trusted because the webFrame might take some time\n\t\t// until it really applies the new zoom level\n\t\tbrowser.setZoomLevel(webFrame.getZoomLevel(), /*isTrusted*/false);\n\t}\n\n\tprivate applyStyles(styles: IssueReporterStyles) {\n\t\tconst styleTag = document.createElement('style');\n\t\tconst content: string[] = [];\n\n\t\tif (styles.inputBackground) {\n\t\t\tcontent.push(`input[type=\"text\"], textarea, select, .issues-container > .issue > .issue-state, .block-info { background-color: ${styles.inputBackground}; }`);\n\t\t}\n\n\t\tif (styles.inputBorder) {\n\t\t\tcontent.push(`input[type=\"text\"], textarea, select { border: 1px solid ${styles.inputBorder}; }`);\n\t\t} else {\n\t\t\tcontent.push(`input[type=\"text\"], textarea, select { border: 1px solid transparent; }`);\n\t\t}\n\n\t\tif (styles.inputForeground) {\n\t\t\tcontent.push(`input[type=\"text\"], textarea, select, .issues-container > .issue > .issue-state, .block-info { color: ${styles.inputForeground}; }`);\n\t\t}\n\n\t\tif (styles.inputErrorBorder) {\n\t\t\tcontent.push(`.invalid-input, .invalid-input:focus { border: 1px solid ${styles.inputErrorBorder} !important; }`);\n\t\t\tcontent.push(`.validation-error, .required-input { color: ${styles.inputErrorBorder}; }`);\n\t\t}\n\n\t\tif (styles.inputActiveBorder) {\n\t\t\tcontent.push(`input[type='text']:focus, textarea:focus, select:focus, summary:focus, button:focus, a:focus, .workbenchCommand:focus  { border: 1px solid ${styles.inputActiveBorder}; outline-style: none; }`);\n\t\t}\n\n\t\tif (styles.textLinkColor) {\n\t\t\tcontent.push(`a, .workbenchCommand { color: ${styles.textLinkColor}; }`);\n\t\t}\n\n\t\tif (styles.textLinkColor) {\n\t\t\tcontent.push(`a { color: ${styles.textLinkColor}; }`);\n\t\t}\n\n\t\tif (styles.textLinkActiveForeground) {\n\t\t\tcontent.push(`a:hover, .workbenchCommand:hover { color: ${styles.textLinkActiveForeground}; }`);\n\t\t}\n\n\t\tif (styles.sliderBackgroundColor) {\n\t\t\tcontent.push(`::-webkit-scrollbar-thumb { background-color: ${styles.sliderBackgroundColor}; }`);\n\t\t}\n\n\t\tif (styles.sliderActiveColor) {\n\t\t\tcontent.push(`::-webkit-scrollbar-thumb:active { background-color: ${styles.sliderActiveColor}; }`);\n\t\t}\n\n\t\tif (styles.sliderHoverColor) {\n\t\t\tcontent.push(`::--webkit-scrollbar-thumb:hover { background-color: ${styles.sliderHoverColor}; }`);\n\t\t}\n\n\t\tif (styles.buttonBackground) {\n\t\t\tcontent.push(`.monaco-text-button { background-color: ${styles.buttonBackground} !important; }`);\n\t\t}\n\n\t\tif (styles.buttonForeground) {\n\t\t\tcontent.push(`.monaco-text-button { color: ${styles.buttonForeground} !important; }`);\n\t\t}\n\n\t\tif (styles.buttonHoverBackground) {\n\t\t\tcontent.push(`.monaco-text-button:hover, .monaco-text-button:focus { background-color: ${styles.buttonHoverBackground} !important; }`);\n\t\t}\n\n\t\tstyleTag.innerHTML = content.join('\\n');\n\t\tdocument.head.appendChild(styleTag);\n\t\tdocument.body.style.color = styles.color || null;\n\t}\n\n\tprivate handleExtensionData(extensions: IssueReporterExtensionData[]) {\n\t\tconst { nonThemes, themes } = collections.groupBy(extensions, ext => {\n\t\t\treturn ext.isTheme ? 'themes' : 'nonThemes';\n\t\t});\n\n\t\tconst numberOfThemeExtesions = themes && themes.length;\n\t\tthis.issueReporterModel.update({ numberOfThemeExtesions, enabledNonThemeExtesions: nonThemes, allExtensions: extensions });\n\t\tthis.updateExtensionTable(nonThemes, numberOfThemeExtesions);\n\n\t\tif (this.environmentService.disableExtensions || extensions.length === 0) {\n\t\t\t(<HTMLButtonElement>this.getElementById('disableExtensions')).disabled = true;\n\t\t}\n\n\t\tthis.updateExtensionSelector(extensions);\n\t}\n\n\tprivate handleSettingsSearchData(data: ISettingsSearchIssueReporterData): void {\n\t\tthis.issueReporterModel.update({\n\t\t\tactualSearchResults: data.actualSearchResults,\n\t\t\tquery: data.query,\n\t\t\tfilterResultCount: data.filterResultCount\n\t\t});\n\t\tthis.updateSearchedExtensionTable(data.enabledExtensions);\n\t\tthis.updateSettingsSearchDetails(data);\n\t}\n\n\tprivate updateSettingsSearchDetails(data: ISettingsSearchIssueReporterData): void {\n\t\tconst target = document.querySelector('.block-settingsSearchResults .block-info');\n\t\tif (target) {\n\t\t\tconst details = `\n\t\t\t<div class='block-settingsSearchResults-details'>\n\t\t\t\t<div>Query: \"${data.query}\"</div>\n\t\t\t\t<div>Literal match count: ${data.filterResultCount}</div>\n\t\t\t</div>\n\t\t\t`;\n\n\t\t\tlet table = `\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Setting</th>\n\t\t\t\t\t<th>Extension</th>\n\t\t\t\t\t<th>Score</th>\n\t\t\t\t</tr>`;\n\n\t\t\tdata.actualSearchResults\n\t\t\t\t.forEach(setting => {\n\t\t\t\t\ttable += `\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>${setting.key}</td>\n\t\t\t\t\t\t\t<td>${setting.extensionId}</td>\n\t\t\t\t\t\t\t<td>${String(setting.score).slice(0, 5)}</td>\n\t\t\t\t\t\t</tr>`;\n\t\t\t\t});\n\n\t\t\ttarget.innerHTML = `${details}<table>${table}</table>`;\n\t\t}\n\t}\n\n\tprivate initServices(configuration: IWindowConfiguration): void {\n\t\tconst serviceCollection = new ServiceCollection();\n\t\tconst mainProcessService = new MainProcessService(configuration.windowId);\n\t\tserviceCollection.set(IMainProcessService, mainProcessService);\n\n\t\tserviceCollection.set(IWindowsService, new WindowsService(mainProcessService));\n\t\tthis.environmentService = new EnvironmentService(configuration, configuration.execPath);\n\n\t\tconst logService = createSpdLogService(`issuereporter${configuration.windowId}`, getLogLevel(this.environmentService), this.environmentService.logsPath);\n\t\tconst logLevelClient = new LogLevelSetterChannelClient(mainProcessService.getChannel('loglevel'));\n\t\tthis.logService = new FollowerLogService(logLevelClient, logService);\n\n\t\tconst sharedProcess = (<IWindowsService>serviceCollection.get(IWindowsService)).whenSharedProcessReady()\n\t\t\t.then(() => connectNet(this.environmentService.sharedIPCHandle, `window:${configuration.windowId}`));\n\n\t\tconst instantiationService = new InstantiationService(serviceCollection, true);\n\t\tif (!this.environmentService.isExtensionDevelopment && !this.environmentService.args['disable-telemetry'] && !!product.enableTelemetry) {\n\t\t\tconst channel = getDelayedChannel(sharedProcess.then(c => c.getChannel('telemetryAppender')));\n\t\t\tconst appender = combinedAppender(new TelemetryAppenderClient(channel), new LogAppender(logService));\n\t\t\tconst commonProperties = resolveCommonProperties(product.commit || 'Commit unknown', pkg.version, configuration.machineId, this.environmentService.installSourcePath);\n\t\t\tconst piiPaths = [this.environmentService.appRoot, this.environmentService.extensionsPath];\n\t\t\tconst config: ITelemetryServiceConfig = { appender, commonProperties, piiPaths };\n\n\t\t\tconst telemetryService = instantiationService.createInstance(TelemetryService, config);\n\t\t\tthis._register(telemetryService);\n\n\t\t\tthis.telemetryService = telemetryService;\n\t\t} else {\n\t\t\tthis.telemetryService = NullTelemetryService;\n\t\t}\n\t}\n\n\tprivate setEventHandlers(): void {\n\t\tthis.addEventListener('issue-type', 'change', (event: Event) => {\n\t\t\tconst issueType = parseInt((<HTMLInputElement>event.target).value);\n\t\t\tthis.issueReporterModel.update({ issueType: issueType });\n\t\t\tif (issueType === IssueType.PerformanceIssue && !this.receivedPerformanceInfo) {\n\t\t\t\tipcRenderer.send('vscode:issuePerformanceInfoRequest');\n\t\t\t}\n\t\t\tthis.updatePreviewButtonState();\n\t\t\tthis.setSourceOptions();\n\t\t\tthis.render();\n\t\t});\n\n\t\t['includeSystemInfo', 'includeProcessInfo', 'includeWorkspaceInfo', 'includeExtensions', 'includeSearchedExtensions', 'includeSettingsSearchDetails'].forEach(elementId => {\n\t\t\tthis.addEventListener(elementId, 'click', (event: Event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.issueReporterModel.update({ [elementId]: !this.issueReporterModel.getData()[elementId] });\n\t\t\t});\n\t\t});\n\n\t\tconst showInfoElements = document.getElementsByClassName('showInfo');\n\t\tfor (let i = 0; i < showInfoElements.length; i++) {\n\t\t\tconst showInfo = showInfoElements.item(i);\n\t\t\tshowInfo!.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst label = (<HTMLDivElement>e.target);\n\t\t\t\tif (label) {\n\t\t\t\t\tconst containingElement = label.parentElement && label.parentElement.parentElement;\n\t\t\t\t\tconst info = containingElement && containingElement.lastElementChild;\n\t\t\t\t\tif (info && info.classList.contains('hidden')) {\n\t\t\t\t\t\tshow(info);\n\t\t\t\t\t\tlabel.textContent = localize('hide', \"hide\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\thide(info);\n\t\t\t\t\t\tlabel.textContent = localize('show', \"show\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.addEventListener('issue-source', 'change', (e: Event) => {\n\t\t\tconst value = (<HTMLInputElement>e.target).value;\n\t\t\tconst problemSourceHelpText = this.getElementById('problem-source-help-text')!;\n\t\t\tif (value === '') {\n\t\t\t\tthis.issueReporterModel.update({ fileOnExtension: undefined });\n\t\t\t\tshow(problemSourceHelpText);\n\t\t\t\tthis.clearSearchResults();\n\t\t\t\tthis.render();\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\thide(problemSourceHelpText);\n\t\t\t}\n\n\t\t\tconst fileOnExtension = JSON.parse(value);\n\t\t\tthis.issueReporterModel.update({ fileOnExtension: fileOnExtension });\n\t\t\tthis.render();\n\n\t\t\tconst title = (<HTMLInputElement>this.getElementById('issue-title')).value;\n\t\t\tif (fileOnExtension) {\n\t\t\t\tthis.searchExtensionIssues(title);\n\t\t\t} else {\n\t\t\t\tconst description = this.issueReporterModel.getData().issueDescription;\n\t\t\t\tthis.searchVSCodeIssues(title, description);\n\t\t\t}\n\t\t});\n\n\t\tthis.addEventListener('description', 'input', (e: Event) => {\n\t\t\tconst issueDescription = (<HTMLInputElement>e.target).value;\n\t\t\tthis.issueReporterModel.update({ issueDescription });\n\n\t\t\t// Only search for extension issues on title change\n\t\t\tif (this.issueReporterModel.fileOnExtension() === false) {\n\t\t\t\tconst title = (<HTMLInputElement>this.getElementById('issue-title')).value;\n\t\t\t\tthis.searchVSCodeIssues(title, issueDescription);\n\t\t\t}\n\t\t});\n\n\t\tthis.addEventListener('issue-title', 'input', (e: Event) => {\n\t\t\tconst title = (<HTMLInputElement>e.target).value;\n\t\t\tconst lengthValidationMessage = this.getElementById('issue-title-length-validation-error');\n\t\t\tif (title && this.getIssueUrlWithTitle(title).length > MAX_URL_LENGTH) {\n\t\t\t\tshow(lengthValidationMessage);\n\t\t\t} else {\n\t\t\t\thide(lengthValidationMessage);\n\t\t\t}\n\n\t\t\tconst fileOnExtension = this.issueReporterModel.fileOnExtension();\n\t\t\tif (fileOnExtension === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (fileOnExtension) {\n\t\t\t\tthis.searchExtensionIssues(title);\n\t\t\t} else {\n\t\t\t\tconst description = this.issueReporterModel.getData().issueDescription;\n\t\t\t\tthis.searchVSCodeIssues(title, description);\n\t\t\t}\n\t\t});\n\n\t\tthis.previewButton.onDidClick(() => this.createIssue());\n\n\t\tfunction sendWorkbenchCommand(commandId: string) {\n\t\t\tipcRenderer.send('vscode:workbenchCommand', { id: commandId, from: 'issueReporter' });\n\t\t}\n\n\t\tthis.addEventListener('disableExtensions', 'click', () => {\n\t\t\tsendWorkbenchCommand('workbench.action.reloadWindowWithExtensionsDisabled');\n\t\t});\n\n\t\tthis.addEventListener('disableExtensions', 'keydown', (e: KeyboardEvent) => {\n\t\t\te.stopPropagation();\n\t\t\tif (e.keyCode === 13 || e.keyCode === 32) {\n\t\t\t\tsendWorkbenchCommand('workbench.extensions.action.disableAll');\n\t\t\t\tsendWorkbenchCommand('workbench.action.reloadWindow');\n\t\t\t}\n\t\t});\n\n\t\tdocument.onkeydown = (e: KeyboardEvent) => {\n\t\t\tconst cmdOrCtrlKey = platform.isMacintosh ? e.metaKey : e.ctrlKey;\n\t\t\t// Cmd/Ctrl+Enter previews issue and closes window\n\t\t\tif (cmdOrCtrlKey && e.keyCode === 13) {\n\t\t\t\tif (this.createIssue()) {\n\t\t\t\t\tipcRenderer.send('vscode:closeIssueReporter');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cmd/Ctrl + w closes issue window\n\t\t\tif (cmdOrCtrlKey && e.keyCode === 87) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\n\t\t\t\tconst issueTitle = (<HTMLInputElement>this.getElementById('issue-title'))!.value;\n\t\t\t\tconst { issueDescription } = this.issueReporterModel.getData();\n\t\t\t\tif (!this.hasBeenSubmitted && (issueTitle || issueDescription)) {\n\t\t\t\t\tipcRenderer.send('vscode:issueReporterConfirmClose');\n\t\t\t\t} else {\n\t\t\t\t\tipcRenderer.send('vscode:closeIssueReporter');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cmd/Ctrl + zooms in\n\t\t\tif (cmdOrCtrlKey && e.keyCode === 187) {\n\t\t\t\tthis.applyZoom(webFrame.getZoomLevel() + 1);\n\t\t\t}\n\n\t\t\t// Cmd/Ctrl - zooms out\n\t\t\tif (cmdOrCtrlKey && e.keyCode === 189) {\n\t\t\t\tthis.applyZoom(webFrame.getZoomLevel() - 1);\n\t\t\t}\n\n\t\t\t// With latest electron upgrade, cmd+a is no longer propagating correctly for inputs in this window on mac\n\t\t\t// Manually perform the selection\n\t\t\tif (platform.isMacintosh) {\n\t\t\t\tif (cmdOrCtrlKey && e.keyCode === 65 && e.target) {\n\t\t\t\t\tif (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {\n\t\t\t\t\t\t(<HTMLInputElement>e.target).select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate updatePreviewButtonState() {\n\t\tif (this.isPreviewEnabled()) {\n\t\t\tthis.previewButton.label = localize('previewOnGitHub', \"Preview on GitHub\");\n\t\t\tthis.previewButton.enabled = true;\n\t\t} else {\n\t\t\tthis.previewButton.enabled = false;\n\t\t\tthis.previewButton.label = localize('loadingData', \"Loading data...\");\n\t\t}\n\t}\n\n\tprivate isPreviewEnabled() {\n\t\tconst issueType = this.issueReporterModel.getData().issueType;\n\t\tif (issueType === IssueType.Bug && this.receivedSystemInfo) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (issueType === IssueType.PerformanceIssue && this.receivedSystemInfo && this.receivedPerformanceInfo) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (issueType === IssueType.FeatureRequest) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (issueType === IssueType.SettingsSearchIssue) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate getExtensionRepositoryUrl(): string | undefined {\n\t\tconst selectedExtension = this.issueReporterModel.getData().selectedExtension;\n\t\treturn selectedExtension && selectedExtension.repositoryUrl;\n\t}\n\n\tprivate getExtensionBugsUrl(): string | undefined {\n\t\tconst selectedExtension = this.issueReporterModel.getData().selectedExtension;\n\t\treturn selectedExtension && selectedExtension.bugsUrl;\n\t}\n\n\tprivate searchVSCodeIssues(title: string, issueDescription?: string): void {\n\t\tif (title) {\n\t\t\tthis.searchDuplicates(title, issueDescription);\n\t\t} else {\n\t\t\tthis.clearSearchResults();\n\t\t}\n\t}\n\n\tprivate searchExtensionIssues(title: string): void {\n\t\tconst url = this.getExtensionGitHubUrl();\n\t\tif (title) {\n\t\t\tconst matches = /^https?:\\/\\/github\\.com\\/(.*)/.exec(url);\n\t\t\tif (matches && matches.length) {\n\t\t\t\tconst repo = matches[1];\n\t\t\t\treturn this.searchGitHub(repo, title);\n\t\t\t}\n\n\t\t\t// If the extension has no repository, display empty search results\n\t\t\tif (this.issueReporterModel.getData().selectedExtension) {\n\t\t\t\tthis.clearSearchResults();\n\t\t\t\treturn this.displaySearchResults([]);\n\n\t\t\t}\n\t\t}\n\n\t\tthis.clearSearchResults();\n\t}\n\n\tprivate clearSearchResults(): void {\n\t\tconst similarIssues = this.getElementById('similar-issues')!;\n\t\tsimilarIssues.innerHTML = '';\n\t\tthis.numberOfSearchResultsDisplayed = 0;\n\t}\n\n\t@debounce(300)\n\tprivate searchGitHub(repo: string, title: string): void {\n\t\tconst query = `is:issue+repo:${repo}+${title}`;\n\t\tconst similarIssues = this.getElementById('similar-issues')!;\n\n\t\twindow.fetch(`https://api.github.com/search/issues?q=${query}`).then((response) => {\n\t\t\tresponse.json().then(result => {\n\t\t\t\tsimilarIssues.innerHTML = '';\n\t\t\t\tif (result && result.items) {\n\t\t\t\t\tthis.displaySearchResults(result.items);\n\t\t\t\t} else {\n\t\t\t\t\t// If the items property isn't present, the rate limit has been hit\n\t\t\t\t\tconst message = $('div.list-title');\n\t\t\t\t\tmessage.textContent = localize('rateLimited', \"GitHub query limit exceeded. Please wait.\");\n\t\t\t\t\tsimilarIssues.appendChild(message);\n\n\t\t\t\t\tconst resetTime = response.headers.get('X-RateLimit-Reset');\n\t\t\t\t\tconst timeToWait = resetTime ? parseInt(resetTime) - Math.floor(Date.now() / 1000) : 1;\n\t\t\t\t\tif (this.shouldQueueSearch) {\n\t\t\t\t\t\tthis.shouldQueueSearch = false;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.searchGitHub(repo, title);\n\t\t\t\t\t\t\tthis.shouldQueueSearch = true;\n\t\t\t\t\t\t}, timeToWait * 1000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).catch(e => {\n\t\t\t\tthis.logSearchError(e);\n\t\t\t});\n\t\t}).catch(e => {\n\t\t\tthis.logSearchError(e);\n\t\t});\n\t}\n\n\t@debounce(300)\n\tprivate searchDuplicates(title: string, body?: string): void {\n\t\tconst url = 'https://vscode-probot.westus.cloudapp.azure.com:7890/duplicate_candidates';\n\t\tconst init = {\n\t\t\tmethod: 'POST',\n\t\t\tbody: JSON.stringify({\n\t\t\t\ttitle,\n\t\t\t\tbody\n\t\t\t}),\n\t\t\theaders: new Headers({\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t})\n\t\t};\n\n\t\twindow.fetch(url, init).then((response) => {\n\t\t\tresponse.json().then(result => {\n\t\t\t\tthis.clearSearchResults();\n\n\t\t\t\tif (result && result.candidates) {\n\t\t\t\t\tthis.displaySearchResults(result.candidates);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Unexpected response, no candidates property');\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.logSearchError(error);\n\t\t\t});\n\t\t}).catch((error) => {\n\t\t\tthis.logSearchError(error);\n\t\t});\n\t}\n\n\tprivate displaySearchResults(results: SearchResult[]) {\n\t\tconst similarIssues = this.getElementById('similar-issues')!;\n\t\tif (results.length) {\n\t\t\tconst issues = $('div.issues-container');\n\t\t\tconst issuesText = $('div.list-title');\n\t\t\tissuesText.textContent = localize('similarIssues', \"Similar issues\");\n\n\t\t\tthis.numberOfSearchResultsDisplayed = results.length < 5 ? results.length : 5;\n\t\t\tfor (let i = 0; i < this.numberOfSearchResultsDisplayed; i++) {\n\t\t\t\tconst issue = results[i];\n\t\t\t\tconst link = $('a.issue-link', { href: issue.html_url });\n\t\t\t\tlink.textContent = issue.title;\n\t\t\t\tlink.title = issue.title;\n\t\t\t\tlink.addEventListener('click', (e) => this.openLink(e));\n\t\t\t\tlink.addEventListener('auxclick', (e) => this.openLink(<MouseEvent>e));\n\n\t\t\t\tlet issueState: HTMLElement;\n\t\t\t\tlet item: HTMLElement;\n\t\t\t\tif (issue.state) {\n\t\t\t\t\tissueState = $('span.issue-state');\n\n\t\t\t\t\tconst issueIcon = $('span.issue-icon');\n\t\t\t\t\tconst octicon = new OcticonLabel(issueIcon);\n\t\t\t\t\tocticon.text = issue.state === 'open' ? '$(issue-opened)' : '$(issue-closed)';\n\n\t\t\t\t\tconst issueStateLabel = $('span.issue-state.label');\n\t\t\t\t\tissueStateLabel.textContent = issue.state === 'open' ? localize('open', \"Open\") : localize('closed', \"Closed\");\n\n\t\t\t\t\tissueState.title = issue.state === 'open' ? localize('open', \"Open\") : localize('closed', \"Closed\");\n\t\t\t\t\tissueState.appendChild(issueIcon);\n\t\t\t\t\tissueState.appendChild(issueStateLabel);\n\n\t\t\t\t\titem = $('div.issue', {}, issueState, link);\n\t\t\t\t} else {\n\t\t\t\t\titem = $('div.issue', {}, link);\n\t\t\t\t}\n\n\t\t\t\tissues.appendChild(item);\n\t\t\t}\n\n\t\t\tsimilarIssues.appendChild(issuesText);\n\t\t\tsimilarIssues.appendChild(issues);\n\t\t} else {\n\t\t\tconst message = $('div.list-title');\n\t\t\tmessage.textContent = localize('noSimilarIssues', \"No similar issues found\");\n\t\t\tsimilarIssues.appendChild(message);\n\t\t}\n\t}\n\n\tprivate logSearchError(error: Error) {\n\t\tthis.logService.warn('issueReporter#search ', error.message);\n\t\t/* __GDPR__\n\t\t\"issueReporterSearchError\" : {\n\t\t\t\t\"message\" : { \"classification\": \"CallstackOrException\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('issueReporterSearchError', { message: error.message });\n\t}\n\n\tprivate setUpTypes(): void {\n\t\tconst makeOption = (issueType: IssueType, description: string) => `<option value=\"${issueType.valueOf()}\">${escape(description)}</option>`;\n\n\t\tconst typeSelect = this.getElementById('issue-type')! as HTMLSelectElement;\n\t\tconst { issueType } = this.issueReporterModel.getData();\n\t\tif (issueType === IssueType.SettingsSearchIssue) {\n\t\t\ttypeSelect.innerHTML = makeOption(IssueType.SettingsSearchIssue, localize('settingsSearchIssue', \"Settings Search Issue\"));\n\t\t\ttypeSelect.disabled = true;\n\t\t} else {\n\t\t\ttypeSelect.innerHTML = [\n\t\t\t\tmakeOption(IssueType.Bug, localize('bugReporter', \"Bug Report\")),\n\t\t\t\tmakeOption(IssueType.FeatureRequest, localize('featureRequest', \"Feature Request\")),\n\t\t\t\tmakeOption(IssueType.PerformanceIssue, localize('performanceIssue', \"Performance Issue\"))\n\t\t\t].join('\\n');\n\t\t}\n\n\t\ttypeSelect.value = issueType.toString();\n\n\t\tthis.setSourceOptions();\n\t}\n\n\tprivate makeOption(value: string, description: string, disabled: boolean): HTMLOptionElement {\n\t\tconst option: HTMLOptionElement = document.createElement('option');\n\t\toption.disabled = disabled;\n\t\toption.value = value;\n\t\toption.textContent = description;\n\n\t\treturn option;\n\t}\n\n\tprivate setSourceOptions(): void {\n\t\tconst sourceSelect = this.getElementById('issue-source')! as HTMLSelectElement;\n\t\tconst selected = sourceSelect.selectedIndex;\n\t\tsourceSelect.innerHTML = '';\n\t\tconst { issueType } = this.issueReporterModel.getData();\n\t\tif (issueType === IssueType.FeatureRequest) {\n\t\t\tsourceSelect.append(...[\n\t\t\t\tthis.makeOption('', localize('selectSource', \"Select source\"), true),\n\t\t\t\tthis.makeOption('false', localize('vscode', \"Visual Studio Code\"), false),\n\t\t\t\tthis.makeOption('true', localize('extension', \"An extension\"), false)\n\t\t\t]);\n\t\t} else {\n\t\t\tsourceSelect.append(...[\n\t\t\t\tthis.makeOption('', localize('selectSource', \"Select source\"), true),\n\t\t\t\tthis.makeOption('false', localize('vscode', \"Visual Studio Code\"), false),\n\t\t\t\tthis.makeOption('true', localize('extension', \"An extension\"), false),\n\t\t\t\tthis.makeOption('', localize('unknown', \"Don't Know\"), false)\n\t\t\t]);\n\t\t}\n\n\t\tif (selected !== -1 && selected < sourceSelect.options.length) {\n\t\t\tsourceSelect.selectedIndex = selected;\n\t\t} else {\n\t\t\tsourceSelect.selectedIndex = 0;\n\t\t\thide(this.getElementById('problem-source-help-text'));\n\t\t}\n\t}\n\n\tprivate renderBlocks(): void {\n\t\t// Depending on Issue Type, we render different blocks and text\n\t\tconst { issueType, fileOnExtension } = this.issueReporterModel.getData();\n\t\tconst blockContainer = this.getElementById('block-container');\n\t\tconst systemBlock = document.querySelector('.block-system');\n\t\tconst processBlock = document.querySelector('.block-process');\n\t\tconst workspaceBlock = document.querySelector('.block-workspace');\n\t\tconst extensionsBlock = document.querySelector('.block-extensions');\n\t\tconst searchedExtensionsBlock = document.querySelector('.block-searchedExtensions');\n\t\tconst settingsSearchResultsBlock = document.querySelector('.block-settingsSearchResults');\n\n\t\tconst problemSource = this.getElementById('problem-source')!;\n\t\tconst descriptionTitle = this.getElementById('issue-description-label')!;\n\t\tconst descriptionSubtitle = this.getElementById('issue-description-subtitle')!;\n\t\tconst extensionSelector = this.getElementById('extension-selection')!;\n\n\t\t// Hide all by default\n\t\thide(blockContainer);\n\t\thide(systemBlock);\n\t\thide(processBlock);\n\t\thide(workspaceBlock);\n\t\thide(extensionsBlock);\n\t\thide(searchedExtensionsBlock);\n\t\thide(settingsSearchResultsBlock);\n\t\thide(problemSource);\n\t\thide(extensionSelector);\n\n\t\tif (issueType === IssueType.Bug) {\n\t\t\tshow(blockContainer);\n\t\t\tshow(systemBlock);\n\t\t\tshow(problemSource);\n\n\t\t\tif (fileOnExtension) {\n\t\t\t\tshow(extensionSelector);\n\t\t\t} else {\n\t\t\t\tshow(extensionsBlock);\n\t\t\t}\n\n\t\t\tdescriptionTitle.innerHTML = `${localize('stepsToReproduce', \"Steps to Reproduce\")} <span class=\"required-input\">*</span>`;\n\t\t\tdescriptionSubtitle.innerHTML = localize('bugDescription', \"Share the steps needed to reliably reproduce the problem. Please include actual and expected results. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.\");\n\t\t} else if (issueType === IssueType.PerformanceIssue) {\n\t\t\tshow(blockContainer);\n\t\t\tshow(systemBlock);\n\t\t\tshow(processBlock);\n\t\t\tshow(workspaceBlock);\n\t\t\tshow(problemSource);\n\n\t\t\tif (fileOnExtension) {\n\t\t\t\tshow(extensionSelector);\n\t\t\t} else {\n\t\t\t\tshow(extensionsBlock);\n\t\t\t}\n\n\t\t\tdescriptionTitle.innerHTML = `${localize('stepsToReproduce', \"Steps to Reproduce\")} <span class=\"required-input\">*</span>`;\n\t\t\tdescriptionSubtitle.innerHTML = localize('performanceIssueDesciption', \"When did this performance issue happen? Does it occur on startup or after a specific series of actions? We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.\");\n\t\t} else if (issueType === IssueType.FeatureRequest) {\n\t\t\tdescriptionTitle.innerHTML = `${localize('description', \"Description\")} <span class=\"required-input\">*</span>`;\n\t\t\tdescriptionSubtitle.innerHTML = localize('featureRequestDescription', \"Please describe the feature you would like to see. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.\");\n\t\t\tshow(problemSource);\n\n\t\t\tif (fileOnExtension) {\n\t\t\t\tshow(extensionSelector);\n\t\t\t}\n\t\t} else if (issueType === IssueType.SettingsSearchIssue) {\n\t\t\tshow(blockContainer);\n\t\t\tshow(searchedExtensionsBlock);\n\t\t\tshow(settingsSearchResultsBlock);\n\n\t\t\tdescriptionTitle.innerHTML = `${localize('expectedResults', \"Expected Results\")} <span class=\"required-input\">*</span>`;\n\t\t\tdescriptionSubtitle.innerHTML = localize('settingsSearchResultsDescription', \"Please list the results that you were expecting to see when you searched with this query. We support GitHub-flavored Markdown. You will be able to edit your issue and add screenshots when we preview it on GitHub.\");\n\t\t}\n\t}\n\n\tprivate validateInput(inputId: string): boolean {\n\t\tconst inputElement = (<HTMLInputElement>this.getElementById(inputId));\n\t\tif (!inputElement.value) {\n\t\t\tinputElement.classList.add('invalid-input');\n\t\t\treturn false;\n\t\t} else {\n\t\t\tinputElement.classList.remove('invalid-input');\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tprivate validateInputs(): boolean {\n\t\tlet isValid = true;\n\t\t['issue-title', 'description', 'issue-source'].forEach(elementId => {\n\t\t\tisValid = this.validateInput(elementId) && isValid;\n\t\t});\n\n\t\tif (this.issueReporterModel.fileOnExtension()) {\n\t\t\tisValid = this.validateInput('extension-selector') && isValid;\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tprivate createIssue(): boolean {\n\t\tif (!this.validateInputs()) {\n\t\t\t// If inputs are invalid, set focus to the first one and add listeners on them\n\t\t\t// to detect further changes\n\t\t\tconst invalidInput = document.getElementsByClassName('invalid-input');\n\t\t\tif (invalidInput.length) {\n\t\t\t\t(<HTMLInputElement>invalidInput[0]).focus();\n\t\t\t}\n\n\t\t\tthis.addEventListener('issue-title', 'input', _ => {\n\t\t\t\tthis.validateInput('issue-title');\n\t\t\t});\n\n\t\t\tthis.addEventListener('description', 'input', _ => {\n\t\t\t\tthis.validateInput('description');\n\t\t\t});\n\n\t\t\tthis.addEventListener('issue-source', 'change', _ => {\n\t\t\t\tthis.validateInput('issue-source');\n\t\t\t});\n\n\t\t\tif (this.issueReporterModel.fileOnExtension()) {\n\t\t\t\tthis.addEventListener('extension-selector', 'change', _ => {\n\t\t\t\t\tthis.validateInput('extension-selector');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t/* __GDPR__\n\t\t\t\"issueReporterSubmit\" : {\n\t\t\t\t\"issueType\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\"numSimilarIssuesDisplayed\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('issueReporterSubmit', { issueType: this.issueReporterModel.getData().issueType, numSimilarIssuesDisplayed: this.numberOfSearchResultsDisplayed });\n\t\tthis.hasBeenSubmitted = true;\n\n\t\tconst baseUrl = this.getIssueUrlWithTitle((<HTMLInputElement>this.getElementById('issue-title')).value);\n\t\tconst issueBody = this.issueReporterModel.serialize();\n\t\tlet url = baseUrl + `&body=${encodeURIComponent(issueBody)}`;\n\n\t\tif (url.length > MAX_URL_LENGTH) {\n\t\t\tclipboard.writeText(issueBody);\n\t\t\turl = baseUrl + `&body=${encodeURIComponent(localize('pasteData', \"We have written the needed data into your clipboard because it was too large to send. Please paste.\"))}`;\n\t\t}\n\n\t\tipcRenderer.send('vscode:openExternal', url);\n\t\treturn true;\n\t}\n\n\tprivate getExtensionGitHubUrl(): string {\n\t\tlet repositoryUrl = '';\n\t\tconst bugsUrl = this.getExtensionBugsUrl();\n\t\tconst extensionUrl = this.getExtensionRepositoryUrl();\n\t\t// If given, try to match the extension's bug url\n\t\tif (bugsUrl && bugsUrl.match(/^https?:\\/\\/github\\.com\\/(.*)/)) {\n\t\t\trepositoryUrl = normalizeGitHubUrl(bugsUrl);\n\t\t} else if (extensionUrl && extensionUrl.match(/^https?:\\/\\/github\\.com\\/(.*)/)) {\n\t\t\trepositoryUrl = normalizeGitHubUrl(extensionUrl);\n\t\t}\n\n\t\treturn repositoryUrl;\n\t}\n\n\tprivate getIssueUrlWithTitle(issueTitle: string): string {\n\t\tlet repositoryUrl = product.reportIssueUrl;\n\t\tif (this.issueReporterModel.fileOnExtension()) {\n\t\t\tconst extensionGitHubUrl = this.getExtensionGitHubUrl();\n\t\t\tif (extensionGitHubUrl) {\n\t\t\t\trepositoryUrl = extensionGitHubUrl + '/issues/new';\n\t\t\t}\n\t\t}\n\n\t\tconst queryStringPrefix = product.reportIssueUrl.indexOf('?') === -1 ? '?' : '&';\n\t\treturn `${repositoryUrl}${queryStringPrefix}title=${encodeURIComponent(issueTitle)}`;\n\t}\n\n\tprivate updateSystemInfo = (state) => {\n\t\tconst target = document.querySelector('.block-system .block-info');\n\t\tif (target) {\n\t\t\tlet tableHtml = '';\n\t\t\tObject.keys(state.systemInfo).forEach(k => {\n\t\t\t\tconst data = typeof state.systemInfo[k] === 'object'\n\t\t\t\t\t? Object.keys(state.systemInfo[k]).map(key => `${key}: ${state.systemInfo[k][key]}`).join('<br>')\n\t\t\t\t\t: state.systemInfo[k];\n\n\t\t\t\ttableHtml += `\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>${k}</td>\n\t\t\t\t\t\t<td>${data}</td>\n\t\t\t\t\t</tr>`;\n\t\t\t});\n\t\t\ttarget.innerHTML = `<table>${tableHtml}</table>`;\n\t\t}\n\t}\n\n\tprivate updateExtensionSelector(extensions: IssueReporterExtensionData[]): void {\n\t\tinterface IOption {\n\t\t\tname: string;\n\t\t\tid: string;\n\t\t}\n\n\t\tconst extensionOptions: IOption[] = extensions.map(extension => {\n\t\t\treturn {\n\t\t\t\tname: extension.displayName || extension.name || '',\n\t\t\t\tid: extension.id\n\t\t\t};\n\t\t});\n\n\t\t// Sort extensions by name\n\t\textensionOptions.sort((a, b) => {\n\t\t\tconst aName = a.name.toLowerCase();\n\t\t\tconst bName = b.name.toLowerCase();\n\t\t\tif (aName > bName) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (aName < bName) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t});\n\n\t\tconst makeOption = (extension: IOption) => `<option value=\"${extension.id}\">${escape(extension.name)}</option>`;\n\t\tconst extensionsSelector = this.getElementById('extension-selector');\n\t\tif (extensionsSelector) {\n\t\t\textensionsSelector.innerHTML = '<option></option>' + extensionOptions.map(makeOption).join('\\n');\n\n\t\t\tthis.addEventListener('extension-selector', 'change', (e: Event) => {\n\t\t\t\tconst selectedExtensionId = (<HTMLInputElement>e.target).value;\n\t\t\t\tconst extensions = this.issueReporterModel.getData().allExtensions;\n\t\t\t\tconst matches = extensions.filter(extension => extension.id === selectedExtensionId);\n\t\t\t\tif (matches.length) {\n\t\t\t\t\tthis.issueReporterModel.update({ selectedExtension: matches[0] });\n\n\t\t\t\t\tconst title = (<HTMLInputElement>this.getElementById('issue-title')).value;\n\t\t\t\t\tthis.searchExtensionIssues(title);\n\t\t\t\t} else {\n\t\t\t\t\tthis.issueReporterModel.update({ selectedExtension: undefined });\n\t\t\t\t\tthis.clearSearchResults();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate updateProcessInfo = (state) => {\n\t\tconst target = document.querySelector('.block-process .block-info');\n\t\tif (target) {\n\t\t\ttarget.innerHTML = `<code>${state.processInfo}</code>`;\n\t\t}\n\t}\n\n\tprivate updateWorkspaceInfo = (state) => {\n\t\tdocument.querySelector('.block-workspace .block-info code')!.textContent = '\\n' + state.workspaceInfo;\n\t}\n\n\tprivate updateExtensionTable(extensions: IssueReporterExtensionData[], numThemeExtensions: number): void {\n\t\tconst target = document.querySelector('.block-extensions .block-info');\n\t\tif (target) {\n\t\t\tif (this.environmentService.disableExtensions) {\n\t\t\t\ttarget.innerHTML = localize('disabledExtensions', \"Extensions are disabled\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst themeExclusionStr = numThemeExtensions ? `\\n(${numThemeExtensions} theme extensions excluded)` : '';\n\t\t\textensions = extensions || [];\n\n\t\t\tif (!extensions.length) {\n\t\t\t\ttarget.innerHTML = 'Extensions: none' + themeExclusionStr;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst table = this.getExtensionTableHtml(extensions);\n\t\t\ttarget.innerHTML = `<table>${table}</table>${themeExclusionStr}`;\n\t\t}\n\t}\n\n\tprivate updateSearchedExtensionTable(extensions: IssueReporterExtensionData[]): void {\n\t\tconst target = document.querySelector('.block-searchedExtensions .block-info');\n\t\tif (target) {\n\t\t\tif (!extensions.length) {\n\t\t\t\ttarget.innerHTML = 'Extensions: none';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst table = this.getExtensionTableHtml(extensions);\n\t\t\ttarget.innerHTML = `<table>${table}</table>`;\n\t\t}\n\t}\n\n\tprivate getExtensionTableHtml(extensions: IssueReporterExtensionData[]): string {\n\t\tlet table = `\n\t\t\t<tr>\n\t\t\t\t<th>Extension</th>\n\t\t\t\t<th>Author (truncated)</th>\n\t\t\t\t<th>Version</th>\n\t\t\t</tr>`;\n\n\t\ttable += extensions.map(extension => {\n\t\t\treturn `\n\t\t\t\t<tr>\n\t\t\t\t\t<td>${extension.name}</td>\n\t\t\t\t\t<td>${extension.publisher.substr(0, 3)}</td>\n\t\t\t\t\t<td>${extension.version}</td>\n\t\t\t\t</tr>`;\n\t\t}).join('');\n\n\t\treturn table;\n\t}\n\n\tprivate openLink(event: MouseEvent): void {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\t// Exclude right click\n\t\tif (event.which < 3) {\n\t\t\tshell.openExternal((<HTMLAnchorElement>event.target).href);\n\n\t\t\t/* __GDPR__\n\t\t\t\t\"issueReporterViewSimilarIssue\" : { }\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('issueReporterViewSimilarIssue');\n\t\t}\n\t}\n\n\tprivate getElementById(elementId: string): HTMLElement | undefined {\n\t\tconst element = document.getElementById(elementId);\n\t\tif (element) {\n\t\t\treturn element;\n\t\t} else {\n\t\t\tconst error = new Error(`${elementId} not found.`);\n\t\t\tthis.logService.error(error);\n\t\t\t/* __GDPR__\n\t\t\t\t\"issueReporterGetElementError\" : {\n\t\t\t\t\t\t\"message\" : { \"classification\": \"CallstackOrException\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('issueReporterGetElementError', { message: error.message });\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate addEventListener(elementId: string, eventType: string, handler: (event: Event) => void): void {\n\t\tconst element = this.getElementById(elementId);\n\t\tif (element) {\n\t\t\telement.addEventListener(eventType, handler);\n\t\t}\n\t}\n}\n\n// helper functions\n\nfunction hide(el) {\n\tel.classList.add('hidden');\n}\nfunction show(el) {\n\tel.classList.remove('hidden');\n}\n"]}